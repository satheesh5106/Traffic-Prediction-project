exports.id=787,exports.ids=[787],exports.modules={9666:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});var O=R(3971),N=R(4442),M=R(5381),L=R(2643);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(T){this.container=T}getPlatformInfoString(){let T=this.container.getProviders();return T.map(T=>{if(!V(T))return null;{let S=T.getImmediate();return`${S.library}/${S.version}`}}).filter(T=>T).join(" ")}}function V(T){let S=T.getComponent();return S?.type==="VERSION"}let K="@firebase/app",$="0.14.1",Q=new N.Logger("@firebase/app"),Y="@firebase/app-compat",X="@firebase/analytics-compat",Z="@firebase/analytics",ee="@firebase/app-check-compat",et="@firebase/app-check",er="@firebase/auth",en="@firebase/auth-compat",ei="@firebase/database",es="@firebase/data-connect",ea="@firebase/database-compat",eo="@firebase/functions",eu="@firebase/functions-compat",ec="@firebase/installations",ed="@firebase/installations-compat",eh="@firebase/messaging",ef="@firebase/messaging-compat",ep="@firebase/performance",em="@firebase/performance-compat",eg="@firebase/remote-config",ey="@firebase/remote-config-compat",ev="@firebase/storage",eb="@firebase/storage-compat",e_="@firebase/firestore",eT="@firebase/ai",eS="@firebase/firestore-compat",eE="firebase",ew="12.1.0",eC="[DEFAULT]",eI={[K]:"fire-core",[Y]:"fire-core-compat",[Z]:"fire-analytics",[X]:"fire-analytics-compat",[et]:"fire-app-check",[ee]:"fire-app-check-compat",[er]:"fire-auth",[en]:"fire-auth-compat",[ei]:"fire-rtdb",[es]:"fire-data-connect",[ea]:"fire-rtdb-compat",[eo]:"fire-fn",[eu]:"fire-fn-compat",[ec]:"fire-iid",[ed]:"fire-iid-compat",[eh]:"fire-fcm",[ef]:"fire-fcm-compat",[ep]:"fire-perf",[em]:"fire-perf-compat",[eg]:"fire-rc",[ey]:"fire-rc-compat",[ev]:"fire-gcs",[eb]:"fire-gcs-compat",[e_]:"fire-fst",[eS]:"fire-fst-compat",[eT]:"fire-vertex","fire-js":"fire-js",[eE]:"fire-js-all"},eR=new Map,eA=new Map,eO=new Map;function eN(T,S){try{T.container.addComponent(S)}catch(R){Q.debug(`Component ${S.name} failed to register with FirebaseApp ${T.name}`,R)}}function ek(T,S){T.container.addOrOverwriteComponent(S)}function eP(T){let S=T.name;if(eO.has(S))return Q.debug(`There were multiple attempts to register component ${S}.`),!1;for(let R of(eO.set(S,T),eR.values()))eN(R,T);for(let S of eA.values())eN(S,T);return!0}function eD(T,S){let R=T.container.getProvider("heartbeat").getImmediate({optional:!0});return R&&R.triggerHeartbeat(),T.container.getProvider(S)}function eM(T,S,R=eC){eD(T,S).clearInstance(R)}function ex(T){return void 0!==T.options}function eL(T){return!ex(T)&&("authIdToken"in T||"appCheckToken"in T||"releaseOnDeref"in T||"automaticDataCollectionEnabled"in T)}function eF(T){return null!=T&&void 0!==T.settings}function eU(){eO.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ej={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},eB=new M.ErrorFactory("app","Firebase",ej);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eV{constructor(T,S,R){this._isDeleted=!1,this._options={...T},this._config={...S},this._name=S.name,this._automaticDataCollectionEnabled=S.automaticDataCollectionEnabled,this._container=R,this.container.addComponent(new O.Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(T){this.checkDestroyed(),this._automaticDataCollectionEnabled=T}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(T){this._isDeleted=T}checkDestroyed(){if(this.isDeleted)throw eB.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ez(T,S){let R=M.base64Decode(T.split(".")[1]);if(null===R){console.error(`FirebaseServerApp ${S} is invalid: second part could not be parsed.`);return}let O=JSON.parse(R).exp;if(void 0===O){console.error(`FirebaseServerApp ${S} is invalid: expiration claim could not be parsed`);return}let N=1e3*JSON.parse(R).exp,L=new Date().getTime(),U=N-L;U<=0&&console.error(`FirebaseServerApp ${S} is invalid: the token has expired.`)}class eq extends eV{constructor(T,S,R,O){let N=void 0===S.automaticDataCollectionEnabled||S.automaticDataCollectionEnabled,M={name:R,automaticDataCollectionEnabled:N};if(void 0!==T.apiKey)super(T,M,O);else{let S=T;super(S.options,M,O)}this._serverConfig={automaticDataCollectionEnabled:N,...S},this._serverConfig.authIdToken&&ez(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&ez(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,"undefined"!=typeof FinalizationRegistry&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,S.releaseOnDeref=void 0,eY(K,$,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(T){this.isDeleted||(this._refCount++,void 0!==T&&null!==this._finalizationRegistry&&this._finalizationRegistry.register(T,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){eQ(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw eB.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eH=ew;function eG(T,S={}){let R=T;if("object"!=typeof S){let T=S;S={name:T}}let N={name:eC,automaticDataCollectionEnabled:!0,...S},L=N.name;if("string"!=typeof L||!L)throw eB.create("bad-app-name",{appName:String(L)});if(R||(R=M.getDefaultAppConfig()),!R)throw eB.create("no-options");let U=eR.get(L);if(U){if(M.deepEqual(R,U.options)&&M.deepEqual(N,U.config))return U;throw eB.create("duplicate-app",{appName:L})}let V=new O.ComponentContainer(L);for(let T of eO.values())V.addComponent(T);let K=new eV(R,N,V);return eR.set(L,K),K}function eW(T,S={}){let R;if(M.isBrowser()&&!M.isWebWorker())throw eB.create("invalid-server-app-environment");let N=S||{};if(T&&(ex(T)?R=T.options:eL(T)?N=T:R=T),void 0===N.automaticDataCollectionEnabled&&(N.automaticDataCollectionEnabled=!0),R||(R=M.getDefaultAppConfig()),!R)throw eB.create("no-options");let L={...N,...R};void 0!==L.releaseOnDeref&&delete L.releaseOnDeref;let U=T=>[...T].reduce((T,S)=>Math.imul(31,T)+S.charCodeAt(0)|0,0);if(void 0!==N.releaseOnDeref&&"undefined"==typeof FinalizationRegistry)throw eB.create("finalization-registry-not-supported",{});let V=""+U(JSON.stringify(L)),K=eA.get(V);if(K)return K.incRefCount(N.releaseOnDeref),K;let $=new O.ComponentContainer(V);for(let T of eO.values())$.addComponent(T);let Q=new eq(R,N,V,$);return eA.set(V,Q),Q}function eK(T=eC){let S=eR.get(T);if(!S&&T===eC&&M.getDefaultAppConfig())return eG();if(!S)throw eB.create("no-app",{appName:T});return S}function e$(){return Array.from(eR.values())}async function eQ(T){let S=!1,R=T.name;if(eR.has(R))S=!0,eR.delete(R);else if(eA.has(R)){let O=T;0>=O.decRefCount()&&(eA.delete(R),S=!0)}S&&(await Promise.all(T.container.getProviders().map(T=>T.delete())),T.isDeleted=!0)}function eY(T,S,R){let N=eI[T]??T;R&&(N+=`-${R}`);let M=N.match(/\s|\//),L=S.match(/\s|\//);if(M||L){let T=[`Unable to register library "${N}" with version "${S}":`];M&&T.push(`library name "${N}" contains illegal characters (whitespace or "/")`),M&&L&&T.push("and"),L&&T.push(`version name "${S}" contains illegal characters (whitespace or "/")`),Q.warn(T.join(" "));return}eP(new O.Component(`${N}-version`,()=>({library:N,version:S}),"VERSION"))}function eJ(T,S){if(null!==T&&"function"!=typeof T)throw eB.create("invalid-log-argument");N.setUserLogHandler(T,S)}function eX(T){N.setLogLevel(T)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eZ="firebase-heartbeat-database",e0=1,e1="firebase-heartbeat-store",e2=null;function e3(){return e2||(e2=L.openDB(eZ,e0,{upgrade:(T,S)=>{if(0===S)try{T.createObjectStore(e1)}catch(T){console.warn(T)}}}).catch(T=>{throw eB.create("idb-open",{originalErrorMessage:T.message})})),e2}async function e4(T){try{let S=await e3(),R=S.transaction(e1),O=await R.objectStore(e1).get(e9(T));return await R.done,O}catch(T){if(T instanceof M.FirebaseError)Q.warn(T.message);else{let S=eB.create("idb-get",{originalErrorMessage:T?.message});Q.warn(S.message)}}}async function e6(T,S){try{let R=await e3(),O=R.transaction(e1,"readwrite"),N=O.objectStore(e1);await N.put(S,e9(T)),await O.done}catch(T){if(T instanceof M.FirebaseError)Q.warn(T.message);else{let S=eB.create("idb-set",{originalErrorMessage:T?.message});Q.warn(S.message)}}}function e9(T){return`${T.name}!${T.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e5=1024,e8=30;class e7{constructor(T){this.container=T,this._heartbeatsCache=null;let S=this.container.getProvider("app").getImmediate();this._storage=new tr(S),this._heartbeatsCachePromise=this._storage.read().then(T=>(this._heartbeatsCache=T,T))}async triggerHeartbeat(){try{let T=this.container.getProvider("platform-logger").getImmediate(),S=T.getPlatformInfoString(),R=te();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===R||this._heartbeatsCache.heartbeats.some(T=>T.date===R))return;if(this._heartbeatsCache.heartbeats.push({date:R,agent:S}),this._heartbeatsCache.heartbeats.length>e8){let T=ts(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(T,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(T){Q.warn(T)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||0===this._heartbeatsCache.heartbeats.length)return"";let T=te(),{heartbeatsToSend:S,unsentEntries:R}=tt(this._heartbeatsCache.heartbeats),O=M.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:S}));return this._heartbeatsCache.lastSentHeartbeatDate=T,R.length>0?(this._heartbeatsCache.heartbeats=R,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),O}catch(T){return Q.warn(T),""}}}function te(){let T=new Date;return T.toISOString().substring(0,10)}function tt(T,S=e5){let R=[],O=T.slice();for(let N of T){let T=R.find(T=>T.agent===N.agent);if(T){if(T.dates.push(N.date),ti(R)>S){T.dates.pop();break}}else if(R.push({agent:N.agent,dates:[N.date]}),ti(R)>S){R.pop();break}O=O.slice(1)}return{heartbeatsToSend:R,unsentEntries:O}}class tr{constructor(T){this.app=T,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!M.isIndexedDBAvailable()&&M.validateIndexedDBOpenable().then(()=>!0).catch(()=>!1)}async read(){let T=await this._canUseIndexedDBPromise;if(!T)return{heartbeats:[]};{let T=await e4(this.app);return T?.heartbeats?T:{heartbeats:[]}}}async overwrite(T){let S=await this._canUseIndexedDBPromise;if(S){let S=await this.read();return e6(this.app,{lastSentHeartbeatDate:T.lastSentHeartbeatDate??S.lastSentHeartbeatDate,heartbeats:T.heartbeats})}}async add(T){let S=await this._canUseIndexedDBPromise;if(S){let S=await this.read();return e6(this.app,{lastSentHeartbeatDate:T.lastSentHeartbeatDate??S.lastSentHeartbeatDate,heartbeats:[...S.heartbeats,...T.heartbeats]})}}}function ti(T){return M.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:T})).length}function ts(T){if(0===T.length)return -1;let S=0,R=T[0].date;for(let O=1;O<T.length;O++)T[O].date<R&&(R=T[O].date,S=O);return S}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(T){eP(new O.Component("platform-logger",T=>new U(T),"PRIVATE")),eP(new O.Component("heartbeat",T=>new e7(T),"PRIVATE")),eY(K,$,T),eY(K,$,"cjs2020"),eY("fire-js","")})("node"),Object.defineProperty(S,"FirebaseError",{enumerable:!0,get:function(){return M.FirebaseError}}),S.SDK_VERSION=eH,S._DEFAULT_ENTRY_NAME=eC,S._addComponent=eN,S._addOrOverwriteComponent=ek,S._apps=eR,S._clearComponents=eU,S._components=eO,S._getProvider=eD,S._isFirebaseApp=ex,S._isFirebaseServerApp=eF,S._isFirebaseServerAppSettings=eL,S._registerComponent=eP,S._removeServiceInstance=eM,S._serverApps=eA,S.deleteApp=eQ,S.getApp=eK,S.getApps=e$,S.initializeApp=eG,S.initializeServerApp=eW,S.onLog=eJ,S.registerVersion=eY,S.setLogLevel=eX},4831:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});var O=R(6592);R(9666),R(5381),R(3971),R(4442),S.ActionCodeOperation=O.ActionCodeOperation,S.ActionCodeURL=O.ActionCodeURL,S.AuthCredential=O.AuthCredential,S.AuthErrorCodes=O.AUTH_ERROR_CODES_MAP_DO_NOT_USE_INTERNALLY,S.EmailAuthCredential=O.EmailAuthCredential,S.EmailAuthProvider=O.EmailAuthProvider,S.FacebookAuthProvider=O.FacebookAuthProvider,S.FactorId=O.FactorId,S.GithubAuthProvider=O.GithubAuthProvider,S.GoogleAuthProvider=O.GoogleAuthProvider,S.OAuthCredential=O.OAuthCredential,S.OAuthProvider=O.OAuthProvider,S.OperationType=O.OperationType,S.PhoneAuthCredential=O.PhoneAuthCredential,S.PhoneAuthProvider=O.PhoneAuthProvider,S.PhoneMultiFactorGenerator=O.PhoneMultiFactorGenerator,S.ProviderId=O.ProviderId,S.RecaptchaVerifier=O.RecaptchaVerifier,S.SAMLAuthProvider=O.SAMLAuthProvider,S.SignInMethod=O.SignInMethod,S.TotpMultiFactorGenerator=O.TotpMultiFactorGenerator,S.TotpSecret=O.TotpSecret,S.TwitterAuthProvider=O.TwitterAuthProvider,S.applyActionCode=O.applyActionCode,S.beforeAuthStateChanged=O.beforeAuthStateChanged,S.browserCookiePersistence=O.browserCookiePersistence,S.browserLocalPersistence=O.browserLocalPersistence,S.browserPopupRedirectResolver=O.browserPopupRedirectResolver,S.browserSessionPersistence=O.browserSessionPersistence,S.checkActionCode=O.checkActionCode,S.confirmPasswordReset=O.confirmPasswordReset,S.connectAuthEmulator=O.connectAuthEmulator,S.createUserWithEmailAndPassword=O.createUserWithEmailAndPassword,S.debugErrorMap=O.debugErrorMap,S.deleteUser=O.deleteUser,S.fetchSignInMethodsForEmail=O.fetchSignInMethodsForEmail,S.getAdditionalUserInfo=O.getAdditionalUserInfo,S.getAuth=O.getAuth,S.getIdToken=O.getIdToken,S.getIdTokenResult=O.getIdTokenResult,S.getMultiFactorResolver=O.getMultiFactorResolver,S.getRedirectResult=O.getRedirectResult,S.inMemoryPersistence=O.inMemoryPersistence,S.indexedDBLocalPersistence=O.indexedDBLocalPersistence,S.initializeAuth=O.initializeAuth,S.initializeRecaptchaConfig=O.initializeRecaptchaConfig,S.isSignInWithEmailLink=O.isSignInWithEmailLink,S.linkWithCredential=O.linkWithCredential,S.linkWithPhoneNumber=O.linkWithPhoneNumber,S.linkWithPopup=O.linkWithPopup,S.linkWithRedirect=O.linkWithRedirect,S.multiFactor=O.multiFactor,S.onAuthStateChanged=O.onAuthStateChanged,S.onIdTokenChanged=O.onIdTokenChanged,S.parseActionCodeURL=O.parseActionCodeURL,S.prodErrorMap=O.prodErrorMap,S.reauthenticateWithCredential=O.reauthenticateWithCredential,S.reauthenticateWithPhoneNumber=O.reauthenticateWithPhoneNumber,S.reauthenticateWithPopup=O.reauthenticateWithPopup,S.reauthenticateWithRedirect=O.reauthenticateWithRedirect,S.reload=O.reload,S.revokeAccessToken=O.revokeAccessToken,S.sendEmailVerification=O.sendEmailVerification,S.sendPasswordResetEmail=O.sendPasswordResetEmail,S.sendSignInLinkToEmail=O.sendSignInLinkToEmail,S.setPersistence=O.setPersistence,S.signInAnonymously=O.signInAnonymously,S.signInWithCredential=O.signInWithCredential,S.signInWithCustomToken=O.signInWithCustomToken,S.signInWithEmailAndPassword=O.signInWithEmailAndPassword,S.signInWithEmailLink=O.signInWithEmailLink,S.signInWithPhoneNumber=O.signInWithPhoneNumber,S.signInWithPopup=O.signInWithPopup,S.signInWithRedirect=O.signInWithRedirect,S.signOut=O.signOut,S.unlink=O.unlink,S.updateCurrentUser=O.updateCurrentUser,S.updateEmail=O.updateEmail,S.updatePassword=O.updatePassword,S.updatePhoneNumber=O.updatePhoneNumber,S.updateProfile=O.updateProfile,S.useDeviceLanguage=O.useDeviceLanguage,S.validatePassword=O.validatePassword,S.verifyBeforeUpdateEmail=O.verifyBeforeUpdateEmail,S.verifyPasswordResetCode=O.verifyPasswordResetCode},6592:(T,S,R)=>{"use strict";var O=R(9666),N=R(5381),M=R(3971),L=R(4442);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let U={PHONE:"phone",TOTP:"totp"},V={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},K={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},$={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},Q={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function X(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}let Z=Y,ee=X,et=new N.ErrorFactory("auth","Firebase",X()),er={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_LOGIN_CREDENTIALS:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized",RECAPTCHA_NOT_ENABLED:"auth/recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"auth/missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"auth/invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"auth/invalid-recaptcha-action",MISSING_CLIENT_TYPE:"auth/missing-client-type",MISSING_RECAPTCHA_VERSION:"auth/missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"auth/invalid-recaptcha-version",INVALID_REQ_TYPE:"auth/invalid-req-type",INVALID_HOSTING_LINK_DOMAIN:"auth/invalid-hosting-link-domain"},en=new L.Logger("@firebase/auth");function ei(T,...S){en.logLevel<=L.LogLevel.WARN&&en.warn(`Auth (${O.SDK_VERSION}): ${T}`,...S)}function es(T,...S){en.logLevel<=L.LogLevel.ERROR&&en.error(`Auth (${O.SDK_VERSION}): ${T}`,...S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ea(T,...S){throw ed(T,...S)}function eo(T,...S){return ed(T,...S)}function eu(T,S,R){let O={...ee(),[S]:R},M=new N.ErrorFactory("auth","Firebase",O);return M.create(S,{appName:T.name})}function ec(T){return eu(T,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ed(T,...S){if("string"!=typeof T){let R=S[0],O=[...S.slice(1)];return O[0]&&(O[0].appName=T.name),T._errorFactory.create(R,...O)}return et.create(T,...S)}function eh(T,S,...R){if(!T)throw ed(S,...R)}function ef(T){let S="INTERNAL ASSERTION FAILED: "+T;throw es(S),Error(S)}function ep(T,S){T||ef(S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function em(){return"undefined"!=typeof self&&self.location?.href||""}function eg(){return"http:"===ey()||"https:"===ey()}function ey(){return"undefined"!=typeof self&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ev(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(eg()||N.isBrowserExtension()||"connection"in navigator))||navigator.onLine}function eb(){if("undefined"==typeof navigator)return null;let T=navigator;return T.languages&&T.languages[0]||T.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e_{constructor(T,S){this.shortDelay=T,this.longDelay=S,ep(S>T,"Short delay should be less than long delay!"),this.isMobile=N.isMobileCordova()||N.isReactNative()}get(){return ev()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eT(T,S){ep(T.emulator,"Emulator should always be set here");let{url:R}=T.emulator;return S?`${R}${S.startsWith("/")?S.slice(1):S}`:R}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{static initialize(T,S,R){this.fetchImpl=T,S&&(this.headersImpl=S),R&&(this.responseImpl=R)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void ef("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void ef("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void ef("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eE={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},ew=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],eC=new e_(3e4,6e4);function eI(T,S){return T.tenantId&&!S.tenantId?{...S,tenantId:T.tenantId}:S}async function eR(T,S,R,O,M={}){return eA(T,M,async()=>{let M={},L={};O&&("GET"===S?L=O:M={body:JSON.stringify(O)});let U=N.querystring({key:T.config.apiKey,...L}).slice(1),V=await T._getAdditionalHeaders();V["Content-Type"]="application/json",T.languageCode&&(V["X-Firebase-Locale"]=T.languageCode);let K={method:S,headers:V,...M};return N.isCloudflareWorker()||(K.referrerPolicy="no-referrer"),T.emulatorConfig&&N.isCloudWorkstation(T.emulatorConfig.host)&&(K.credentials="include"),eS.fetch()(await eN(T,T.config.apiHost,R,U),K)})}async function eA(T,S,R){T._canInitEmulator=!1;let O={...eE,...S};try{let S=new eP(T),N=await Promise.race([R(),S.promise]);S.clearNetworkTimeout();let M=await N.json();if("needConfirmation"in M)throw eD(T,"account-exists-with-different-credential",M);if(N.ok&&!("errorMessage"in M))return M;{let S=N.ok?M.errorMessage:M.error.message,[R,L]=S.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===R)throw eD(T,"credential-already-in-use",M);if("EMAIL_EXISTS"===R)throw eD(T,"email-already-in-use",M);if("USER_DISABLED"===R)throw eD(T,"user-disabled",M);let U=O[R]||R.toLowerCase().replace(/[_\s]+/g,"-");if(L)throw eu(T,U,L);ea(T,U)}}catch(S){if(S instanceof N.FirebaseError)throw S;ea(T,"network-request-failed",{message:String(S)})}}async function eO(T,S,R,O,N={}){let M=await eR(T,S,R,O,N);return"mfaPendingCredential"in M&&ea(T,"multi-factor-auth-required",{_serverResponse:M}),M}async function eN(T,S,R,O){let N=`${S}${R}?${O}`,M=T,L=M.config.emulator?eT(T.config,N):`${T.config.apiScheme}://${N}`;if(ew.includes(R)&&(await M._persistenceManagerAvailable,"COOKIE"===M._getPersistenceType())){let T=M._getPersistence();return T._getFinalTarget(L).toString()}return L}function ek(T){switch(T){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class eP{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(T){this.auth=T,this.timer=null,this.promise=new Promise((T,S)=>{this.timer=setTimeout(()=>S(eo(this.auth,"network-request-failed")),eC.get())})}}function eD(T,S,R){let O={appName:T.name};R.email&&(O.email=R.email),R.phoneNumber&&(O.phoneNumber=R.phoneNumber);let N=eo(T,S,O);return N.customData._tokenResponse=R,N}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eM(T){return void 0!==T&&void 0!==T.enterprise}class ex{constructor(T){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===T.recaptchaKey)throw Error("recaptchaKey undefined");this.siteKey=T.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=T.recaptchaEnforcementState}getProviderEnforcementState(T){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(let S of this.recaptchaEnforcementState)if(S.provider&&S.provider===T)return ek(S.enforcementState);return null}isProviderEnabled(T){return"ENFORCE"===this.getProviderEnforcementState(T)||"AUDIT"===this.getProviderEnforcementState(T)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eL(T,S){return eR(T,"GET","/v2/recaptchaConfig",eI(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eF(T,S){return eR(T,"POST","/v1/accounts:delete",S)}async function eU(T,S){return eR(T,"POST","/v1/accounts:update",S)}async function ej(T,S){return eR(T,"POST","/v1/accounts:lookup",S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eB(T){if(T)try{let S=new Date(Number(T));if(!isNaN(S.getTime()))return S.toUTCString()}catch(T){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eV(T,S=!1){return N.getModularInstance(T).getIdToken(S)}async function ez(T,S=!1){let R=N.getModularInstance(T),O=await R.getIdToken(S),M=eH(O);eh(M&&M.exp&&M.auth_time&&M.iat,R.auth,"internal-error");let L="object"==typeof M.firebase?M.firebase:void 0,U=L?.sign_in_provider;return{claims:M,token:O,authTime:eB(eq(M.auth_time)),issuedAtTime:eB(eq(M.iat)),expirationTime:eB(eq(M.exp)),signInProvider:U||null,signInSecondFactor:L?.sign_in_second_factor||null}}function eq(T){return 1e3*Number(T)}function eH(T){let[S,R,O]=T.split(".");if(void 0===S||void 0===R||void 0===O)return es("JWT malformed, contained fewer than 3 sections"),null;try{let T=N.base64Decode(R);if(!T)return es("Failed to decode base64 JWT payload"),null;return JSON.parse(T)}catch(T){return es("Caught error parsing JWT payload as JSON",T?.toString()),null}}function eG(T){let S=eH(T);return eh(S,"internal-error"),eh(void 0!==S.exp,"internal-error"),eh(void 0!==S.iat,"internal-error"),Number(S.exp)-Number(S.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eW(T,S,R=!1){if(R)return S;try{return await S}catch(S){throw S instanceof N.FirebaseError&&eK(S)&&T.auth.currentUser===T&&await T.auth.signOut(),S}}function eK({code:T}){return"auth/user-disabled"===T||"auth/user-token-expired"===T}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e${constructor(T){this.user=T,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(T){if(T){let T=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),T}{this.errorBackoff=3e4;let T=this.user.stsTokenManager.expirationTime??0,S=T-Date.now()-3e5;return Math.max(0,S)}}schedule(T=!1){if(!this.isRunning)return;let S=this.getInterval(T);this.timerId=setTimeout(async()=>{await this.iteration()},S)}async iteration(){try{await this.user.getIdToken(!0)}catch(T){T?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eQ{constructor(T,S){this.createdAt=T,this.lastLoginAt=S,this._initializeTime()}_initializeTime(){this.lastSignInTime=eB(this.lastLoginAt),this.creationTime=eB(this.createdAt)}_copy(T){this.createdAt=T.createdAt,this.lastLoginAt=T.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eY(T){let S=T.auth,R=await T.getIdToken(),O=await eW(T,ej(S,{idToken:R}));eh(O?.users.length,S,"internal-error");let N=O.users[0];T._notifyReloadListener(N);let M=N.providerUserInfo?.length?eZ(N.providerUserInfo):[],L=eX(T.providerData,M),U=T.isAnonymous,V=!(T.email&&N.passwordHash)&&!L?.length,K=!!U&&V,$={uid:N.localId,displayName:N.displayName||null,photoURL:N.photoUrl||null,email:N.email||null,emailVerified:N.emailVerified||!1,phoneNumber:N.phoneNumber||null,tenantId:N.tenantId||null,providerData:L,metadata:new eQ(N.createdAt,N.lastLoginAt),isAnonymous:K};Object.assign(T,$)}async function eJ(T){let S=N.getModularInstance(T);await eY(S),await S.auth._persistUserIfCurrent(S),S.auth._notifyListenersIfCurrent(S)}function eX(T,S){let R=T.filter(T=>!S.some(S=>S.providerId===T.providerId));return[...R,...S]}function eZ(T){return T.map(({providerId:T,...S})=>({providerId:T,uid:S.rawId||"",displayName:S.displayName||null,email:S.email||null,phoneNumber:S.phoneNumber||null,photoURL:S.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e0(T,S){let R=await eA(T,{},async()=>{let R=N.querystring({grant_type:"refresh_token",refresh_token:S}).slice(1),{tokenApiHost:O,apiKey:M}=T.config,L=await eN(T,O,"/v1/token",`key=${M}`),U=await T._getAdditionalHeaders();U["Content-Type"]="application/x-www-form-urlencoded";let V={method:"POST",headers:U,body:R};return T.emulatorConfig&&N.isCloudWorkstation(T.emulatorConfig.host)&&(V.credentials="include"),eS.fetch()(L,V)});return{accessToken:R.access_token,expiresIn:R.expires_in,refreshToken:R.refresh_token}}async function e1(T,S){return eR(T,"POST","/v2/accounts:revokeToken",eI(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(T){eh(T.idToken,"internal-error"),eh(void 0!==T.idToken,"internal-error"),eh(void 0!==T.refreshToken,"internal-error");let S="expiresIn"in T&&void 0!==T.expiresIn?Number(T.expiresIn):eG(T.idToken);this.updateTokensAndExpiration(T.idToken,T.refreshToken,S)}updateFromIdToken(T){eh(0!==T.length,"internal-error");let S=eG(T);this.updateTokensAndExpiration(T,null,S)}async getToken(T,S=!1){return S||!this.accessToken||this.isExpired?(eh(this.refreshToken,T,"user-token-expired"),this.refreshToken)?(await this.refresh(T,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(T,S){let{accessToken:R,refreshToken:O,expiresIn:N}=await e0(T,S);this.updateTokensAndExpiration(R,O,Number(N))}updateTokensAndExpiration(T,S,R){this.refreshToken=S||null,this.accessToken=T||null,this.expirationTime=Date.now()+1e3*R}static fromJSON(T,S){let{refreshToken:R,accessToken:O,expirationTime:N}=S,M=new e2;return R&&(eh("string"==typeof R,"internal-error",{appName:T}),M.refreshToken=R),O&&(eh("string"==typeof O,"internal-error",{appName:T}),M.accessToken=O),N&&(eh("number"==typeof N,"internal-error",{appName:T}),M.expirationTime=N),M}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(T){this.accessToken=T.accessToken,this.refreshToken=T.refreshToken,this.expirationTime=T.expirationTime}_clone(){return Object.assign(new e2,this.toJSON())}_performRefresh(){return ef("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e3(T,S){eh("string"==typeof T||void 0===T,"internal-error",{appName:S})}class e4{constructor({uid:T,auth:S,stsTokenManager:R,...O}){this.providerId="firebase",this.proactiveRefresh=new e$(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=T,this.auth=S,this.stsTokenManager=R,this.accessToken=R.accessToken,this.displayName=O.displayName||null,this.email=O.email||null,this.emailVerified=O.emailVerified||!1,this.phoneNumber=O.phoneNumber||null,this.photoURL=O.photoURL||null,this.isAnonymous=O.isAnonymous||!1,this.tenantId=O.tenantId||null,this.providerData=O.providerData?[...O.providerData]:[],this.metadata=new eQ(O.createdAt||void 0,O.lastLoginAt||void 0)}async getIdToken(T){let S=await eW(this,this.stsTokenManager.getToken(this.auth,T));return eh(S,this.auth,"internal-error"),this.accessToken!==S&&(this.accessToken=S,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),S}getIdTokenResult(T){return ez(this,T)}reload(){return eJ(this)}_assign(T){this!==T&&(eh(this.uid===T.uid,this.auth,"internal-error"),this.displayName=T.displayName,this.photoURL=T.photoURL,this.email=T.email,this.emailVerified=T.emailVerified,this.phoneNumber=T.phoneNumber,this.isAnonymous=T.isAnonymous,this.tenantId=T.tenantId,this.providerData=T.providerData.map(T=>({...T})),this.metadata._copy(T.metadata),this.stsTokenManager._assign(T.stsTokenManager))}_clone(T){let S=new e4({...this,auth:T,stsTokenManager:this.stsTokenManager._clone()});return S.metadata._copy(this.metadata),S}_onReload(T){eh(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=T,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(T){this.reloadListener?this.reloadListener(T):this.reloadUserInfo=T}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(T,S=!1){let R=!1;T.idToken&&T.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(T),R=!0),S&&await eY(this),await this.auth._persistUserIfCurrent(this),R&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(O._isFirebaseServerApp(this.auth.app))return Promise.reject(ec(this.auth));let T=await this.getIdToken();return await eW(this,eF(this.auth,{idToken:T})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(T=>({...T})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(T,S){let R=S.displayName??void 0,O=S.email??void 0,N=S.phoneNumber??void 0,M=S.photoURL??void 0,L=S.tenantId??void 0,U=S._redirectEventId??void 0,V=S.createdAt??void 0,K=S.lastLoginAt??void 0,{uid:$,emailVerified:Q,isAnonymous:Y,providerData:X,stsTokenManager:Z}=S;eh($&&Z,T,"internal-error");let ee=e2.fromJSON(this.name,Z);eh("string"==typeof $,T,"internal-error"),e3(R,T.name),e3(O,T.name),eh("boolean"==typeof Q,T,"internal-error"),eh("boolean"==typeof Y,T,"internal-error"),e3(N,T.name),e3(M,T.name),e3(L,T.name),e3(U,T.name),e3(V,T.name),e3(K,T.name);let et=new e4({uid:$,auth:T,email:O,emailVerified:Q,displayName:R,isAnonymous:Y,photoURL:M,phoneNumber:N,tenantId:L,stsTokenManager:ee,createdAt:V,lastLoginAt:K});return X&&Array.isArray(X)&&(et.providerData=X.map(T=>({...T}))),U&&(et._redirectEventId=U),et}static async _fromIdTokenResponse(T,S,R=!1){let O=new e2;O.updateFromServerResponse(S);let N=new e4({uid:S.localId,auth:T,stsTokenManager:O,isAnonymous:R});return await eY(N),N}static async _fromGetAccountInfoResponse(T,S,R){let O=S.users[0];eh(void 0!==O.localId,"internal-error");let N=void 0!==O.providerUserInfo?eZ(O.providerUserInfo):[],M=!(O.email&&O.passwordHash)&&!N?.length,L=new e2;L.updateFromIdToken(R);let U=new e4({uid:O.localId,auth:T,stsTokenManager:L,isAnonymous:M}),V={uid:O.localId,displayName:O.displayName||null,photoURL:O.photoUrl||null,email:O.email||null,emailVerified:O.emailVerified||!1,phoneNumber:O.phoneNumber||null,tenantId:O.tenantId||null,providerData:N,metadata:new eQ(O.createdAt,O.lastLoginAt),isAnonymous:!(O.email&&O.passwordHash)&&!N?.length};return Object.assign(U,V),U}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e6=new Map;function e9(T){ep(T instanceof Function,"Expected a class definition");let S=e6.get(T);return S?ep(S instanceof T,"Instance stored in cache mismatched with class"):(S=new T,e6.set(T,S)),S}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e5{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(T,S){this.storage[T]=S}async _get(T){let S=this.storage[T];return void 0===S?null:S}async _remove(T){delete this.storage[T]}_addListener(T,S){}_removeListener(T,S){}}e5.type="NONE";let e8=e5;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e7(T,S,R){return`firebase:${T}:${S}:${R}`}class te{constructor(T,S,R){this.persistence=T,this.auth=S,this.userKey=R;let{config:O,name:N}=this.auth;this.fullUserKey=e7(this.userKey,O.apiKey,N),this.fullPersistenceKey=e7("persistence",O.apiKey,N),this.boundEventHandler=S._onStorageEvent.bind(S),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(T){return this.persistence._set(this.fullUserKey,T.toJSON())}async getCurrentUser(){let T=await this.persistence._get(this.fullUserKey);if(!T)return null;if("string"==typeof T){let S=await ej(this.auth,{idToken:T}).catch(()=>void 0);return S?e4._fromGetAccountInfoResponse(this.auth,S,T):null}return e4._fromJSON(this.auth,T)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(T){if(this.persistence===T)return;let S=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=T,S)return this.setCurrentUser(S)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(T,S,R="authUser"){if(!S.length)return new te(e9(e8),T,R);let O=(await Promise.all(S.map(async T=>{if(await T._isAvailable())return T}))).filter(T=>T),N=O[0]||e9(e8),M=e7(R,T.config.apiKey,T.name),L=null;for(let R of S)try{let S=await R._get(M);if(S){let O;if("string"==typeof S){let R=await ej(T,{idToken:S}).catch(()=>void 0);if(!R)break;O=await e4._fromGetAccountInfoResponse(T,R,S)}else O=e4._fromJSON(T,S);R!==N&&(L=O),N=R;break}}catch{}let U=O.filter(T=>T._shouldAllowMigration);return N._shouldAllowMigration&&U.length&&(N=U[0],L&&await N._set(M,L.toJSON()),await Promise.all(S.map(async T=>{if(T!==N)try{await T._remove(M)}catch{}}))),new te(N,T,R)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tt(T){let S=T.toLowerCase();if(S.includes("opera/")||S.includes("opr/")||S.includes("opios/"))return"Opera";if(ta(S))return"IEMobile";if(S.includes("msie")||S.includes("trident/"))return"IE";{if(S.includes("edge/"))return"Edge";if(tr(S))return"Firefox";if(S.includes("silk/"))return"Silk";if(tu(S))return"Blackberry";if(tc(S))return"Webos";if(ti(S))return"Safari";if((S.includes("chrome/")||ts(S))&&!S.includes("edge/"))return"Chrome";if(tl(S))return"Android";let R=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,O=T.match(R);if(O?.length===2)return O[1]}return"Other"}function tr(T=N.getUA()){return/firefox\//i.test(T)}function ti(T=N.getUA()){let S=T.toLowerCase();return S.includes("safari/")&&!S.includes("chrome/")&&!S.includes("crios/")&&!S.includes("android")}function ts(T=N.getUA()){return/crios\//i.test(T)}function ta(T=N.getUA()){return/iemobile/i.test(T)}function tl(T=N.getUA()){return/android/i.test(T)}function tu(T=N.getUA()){return/blackberry/i.test(T)}function tc(T=N.getUA()){return/webos/i.test(T)}function td(T=N.getUA()){return/iphone|ipad|ipod/i.test(T)||/macintosh/i.test(T)&&/mobile/i.test(T)}function th(T=N.getUA()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(T)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(T)}function tf(){return N.isIE()&&10===document.documentMode}function tp(T=N.getUA()){return td(T)||tl(T)||tc(T)||tu(T)||/windows phone/i.test(T)||ta(T)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tm(T,S=[]){let R;switch(T){case"Browser":R=tt(N.getUA());break;case"Worker":R=`${tt(N.getUA())}-${T}`;break;default:R=T}let M=S.length?S.join(","):"FirebaseCore-web";return`${R}/JsCore/${O.SDK_VERSION}/${M}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tg{constructor(T){this.auth=T,this.queue=[]}pushCallback(T,S){let R=S=>new Promise((R,O)=>{try{let O=T(S);R(O)}catch(T){O(T)}});R.onAbort=S,this.queue.push(R);let O=this.queue.length-1;return()=>{this.queue[O]=()=>Promise.resolve()}}async runMiddleware(T){if(this.auth.currentUser===T)return;let S=[];try{for(let R of this.queue)await R(T),R.onAbort&&S.push(R.onAbort)}catch(T){for(let T of(S.reverse(),S))try{T()}catch(T){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:T?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ty(T,S={}){return eR(T,"GET","/v2/passwordPolicy",eI(T,S))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tv=6;class tb{constructor(T){let S=T.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=S.minPasswordLength??tv,S.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=S.maxPasswordLength),void 0!==S.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=S.containsLowercaseCharacter),void 0!==S.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=S.containsUppercaseCharacter),void 0!==S.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=S.containsNumericCharacter),void 0!==S.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=S.containsNonAlphanumericCharacter),this.enforcementState=T.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=T.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=T.forceUpgradeOnSignin??!1,this.schemaVersion=T.schemaVersion}validatePassword(T){let S={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(T,S),this.validatePasswordCharacterOptions(T,S),S.isValid&&(S.isValid=S.meetsMinPasswordLength??!0),S.isValid&&(S.isValid=S.meetsMaxPasswordLength??!0),S.isValid&&(S.isValid=S.containsLowercaseLetter??!0),S.isValid&&(S.isValid=S.containsUppercaseLetter??!0),S.isValid&&(S.isValid=S.containsNumericCharacter??!0),S.isValid&&(S.isValid=S.containsNonAlphanumericCharacter??!0),S}validatePasswordLengthOptions(T,S){let R=this.customStrengthOptions.minPasswordLength,O=this.customStrengthOptions.maxPasswordLength;R&&(S.meetsMinPasswordLength=T.length>=R),O&&(S.meetsMaxPasswordLength=T.length<=O)}validatePasswordCharacterOptions(T,S){let R;this.updatePasswordCharacterOptionsStatuses(S,!1,!1,!1,!1);for(let O=0;O<T.length;O++)R=T.charAt(O),this.updatePasswordCharacterOptionsStatuses(S,R>="a"&&R<="z",R>="A"&&R<="Z",R>="0"&&R<="9",this.allowedNonAlphanumericCharacters.includes(R))}updatePasswordCharacterOptionsStatuses(T,S,R,O,N){this.customStrengthOptions.containsLowercaseLetter&&(T.containsLowercaseLetter||(T.containsLowercaseLetter=S)),this.customStrengthOptions.containsUppercaseLetter&&(T.containsUppercaseLetter||(T.containsUppercaseLetter=R)),this.customStrengthOptions.containsNumericCharacter&&(T.containsNumericCharacter||(T.containsNumericCharacter=O)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(T.containsNonAlphanumericCharacter||(T.containsNonAlphanumericCharacter=N))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_{constructor(T,S,R,O){this.app=T,this.heartbeatServiceProvider=S,this.appCheckServiceProvider=R,this.config=O,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new tS(this),this.idTokenSubscription=new tS(this),this.beforeStateQueue=new tg(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=et,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=T.name,this.clientVersion=O.sdkClientVersion,this._persistenceManagerAvailable=new Promise(T=>this._resolvePersistenceManagerAvailable=T)}_initializeWithPersistence(T,S){return S&&(this._popupRedirectResolver=e9(S)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await te.create(this,T),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(T){}await this.initializeCurrentUser(S),this.lastNotifiedUid=this.currentUser?.uid||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let T=await this.assertedPersistence.getCurrentUser();if(this.currentUser||T){if(this.currentUser&&T&&this.currentUser.uid===T.uid){this._currentUser._assign(T),await this.currentUser.getIdToken();return}await this._updateCurrentUser(T,!0)}}async initializeCurrentUserFromIdToken(T){try{let S=await ej(this,{idToken:T}),R=await e4._fromGetAccountInfoResponse(this,S,T);await this.directlySetCurrentUser(R)}catch(T){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",T),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(T){if(O._isFirebaseServerApp(this.app)){let T=this.app.settings.authIdToken;return T?new Promise(S=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(T).then(S,S))}):this.directlySetCurrentUser(null)}let S=await this.assertedPersistence.getCurrentUser(),R=S,N=!1;if(T&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let S=this.redirectUser?._redirectEventId,O=R?._redirectEventId,M=await this.tryRedirectSignIn(T);(!S||S===O)&&M?.user&&(R=M.user,N=!0)}if(!R)return this.directlySetCurrentUser(null);if(!R._redirectEventId){if(N)try{await this.beforeStateQueue.runMiddleware(R)}catch(T){R=S,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(T))}return R?this.reloadAndSetCurrentUserOrClear(R):this.directlySetCurrentUser(null)}return(eh(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===R._redirectEventId)?this.directlySetCurrentUser(R):this.reloadAndSetCurrentUserOrClear(R)}async tryRedirectSignIn(T){let S=null;try{S=await this._popupRedirectResolver._completeRedirectFn(this,T,!0)}catch(T){await this._setRedirectUser(null)}return S}async reloadAndSetCurrentUserOrClear(T){try{await eY(T)}catch(T){if(T?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(T)}useDeviceLanguage(){this.languageCode=eb()}async _delete(){this._deleted=!0}async updateCurrentUser(T){if(O._isFirebaseServerApp(this.app))return Promise.reject(ec(this));let S=T?N.getModularInstance(T):null;return S&&eh(S.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(S&&S._clone(this))}async _updateCurrentUser(T,S=!1){if(!this._deleted)return T&&eh(this.tenantId===T.tenantId,this,"tenant-id-mismatch"),S||await this.beforeStateQueue.runMiddleware(T),this.queue(async()=>{await this.directlySetCurrentUser(T),this.notifyAuthListeners()})}async signOut(){return O._isFirebaseServerApp(this.app)?Promise.reject(ec(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(T){return O._isFirebaseServerApp(this.app)?Promise.reject(ec(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(e9(T))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(T){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let S=this._getPasswordPolicyInternal();return S.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):S.validatePassword(T)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let T=await ty(this),S=new tb(T);null===this.tenantId?this._projectPasswordPolicy=S:this._tenantPasswordPolicies[this.tenantId]=S}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(T){this._errorFactory=new N.ErrorFactory("auth","Firebase",T())}onAuthStateChanged(T,S,R){return this.registerStateListener(this.authStateSubscription,T,S,R)}beforeAuthStateChanged(T,S){return this.beforeStateQueue.pushCallback(T,S)}onIdTokenChanged(T,S,R){return this.registerStateListener(this.idTokenSubscription,T,S,R)}authStateReady(){return new Promise((T,S)=>{if(this.currentUser)T();else{let R=this.onAuthStateChanged(()=>{R(),T()},S)}})}async revokeAccessToken(T){if(this.currentUser){let S=await this.currentUser.getIdToken(),R={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:T,idToken:S};null!=this.tenantId&&(R.tenantId=this.tenantId),await e1(this,R)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(T,S){let R=await this.getOrInitRedirectPersistenceManager(S);return null===T?R.removeCurrentUser():R.setCurrentUser(T)}async getOrInitRedirectPersistenceManager(T){if(!this.redirectPersistenceManager){let S=T&&e9(T)||this._popupRedirectResolver;eh(S,this,"argument-error"),this.redirectPersistenceManager=await te.create(this,[e9(S._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(T){return(this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===T)?this._currentUser:this.redirectUser?._redirectEventId===T?this.redirectUser:null}async _persistUserIfCurrent(T){if(T===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(T))}_notifyListenersIfCurrent(T){T===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let T=this.currentUser?.uid??null;this.lastNotifiedUid!==T&&(this.lastNotifiedUid=T,this.authStateSubscription.next(this.currentUser))}registerStateListener(T,S,R,O){if(this._deleted)return()=>{};let N="function"==typeof S?S:S.next.bind(S),M=!1,L=this._isInitialized?Promise.resolve():this._initializationPromise;if(eh(L,this,"internal-error"),L.then(()=>{M||N(this.currentUser)}),"function"==typeof S){let N=T.addObserver(S,R,O);return()=>{M=!0,N()}}{let R=T.addObserver(S);return()=>{M=!0,R()}}}async directlySetCurrentUser(T){this.currentUser&&this.currentUser!==T&&this._currentUser._stopProactiveRefresh(),T&&this.isProactiveRefreshEnabled&&T._startProactiveRefresh(),this.currentUser=T,T?await this.assertedPersistence.setCurrentUser(T):await this.assertedPersistence.removeCurrentUser()}queue(T){return this.operations=this.operations.then(T,T),this.operations}get assertedPersistence(){return eh(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(T){!T||this.frameworks.includes(T)||(this.frameworks.push(T),this.frameworks.sort(),this.clientVersion=tm(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let T={"X-Client-Version":this.clientVersion};this.app.options.appId&&(T["X-Firebase-gmpid"]=this.app.options.appId);let S=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();S&&(T["X-Firebase-Client"]=S);let R=await this._getAppCheckToken();return R&&(T["X-Firebase-AppCheck"]=R),T}async _getAppCheckToken(){if(O._isFirebaseServerApp(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let T=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return T?.error&&ei(`Error while retrieving App Check token: ${T.error}`),T?.token}}function tT(T){return N.getModularInstance(T)}class tS{constructor(T){this.auth=T,this.observer=null,this.addObserver=N.createSubscribe(T=>this.observer=T)}get next(){return eh(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tE={async loadJS(){throw Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function tw(T){return tE.loadJS(T)}function tC(){return tE.recaptchaEnterpriseScript}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI{constructor(){this.enterprise=new tR}ready(T){T()}execute(T,S){return Promise.resolve("token")}render(T,S){return""}}class tR{ready(T){T()}execute(T,S){return Promise.resolve("token")}render(T,S){return""}}let tA="recaptcha-enterprise",tO="NO_RECAPTCHA";class tN{constructor(T){this.type=tA,this.auth=tT(T)}async verify(T="verify",S=!1){async function R(T){if(!S){if(null==T.tenantId&&null!=T._agentRecaptchaConfig)return T._agentRecaptchaConfig.siteKey;if(null!=T.tenantId&&void 0!==T._tenantRecaptchaConfigs[T.tenantId])return T._tenantRecaptchaConfigs[T.tenantId].siteKey}return new Promise(async(S,R)=>{eL(T,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(O=>{if(void 0===O.recaptchaKey)R(Error("recaptcha Enterprise site key undefined"));else{let R=new ex(O);return null==T.tenantId?T._agentRecaptchaConfig=R:T._tenantRecaptchaConfigs[T.tenantId]=R,S(R.siteKey)}}).catch(T=>{R(T)})})}function O(S,R,O){let N=window.grecaptcha;eM(N)?N.enterprise.ready(()=>{N.enterprise.execute(S,{action:T}).then(T=>{R(T)}).catch(()=>{R(tO)})}):O(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){let T=new tI;return T.execute("siteKey",{action:"verify"})}return new Promise((T,N)=>{R(this.auth).then(R=>{if(!S&&eM(window.grecaptcha))O(R,T,N);else{if("undefined"==typeof window){N(Error("RecaptchaVerifier is only supported in browser"));return}let S=tC();0!==S.length&&(S+=R),tw(S).then(()=>{O(R,T,N)}).catch(T=>{N(T)})}}).catch(T=>{N(T)})})}}async function tk(T,S,R,O=!1,N=!1){let M;let L=new tN(T);if(N)M=tO;else try{M=await L.verify(R)}catch(T){M=await L.verify(R,!0)}let U={...S};if("mfaSmsEnrollment"===R||"mfaSmsSignIn"===R){if("phoneEnrollmentInfo"in U){let T=U.phoneEnrollmentInfo.phoneNumber,S=U.phoneEnrollmentInfo.recaptchaToken;Object.assign(U,{phoneEnrollmentInfo:{phoneNumber:T,recaptchaToken:S,captchaResponse:M,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in U){let T=U.phoneSignInInfo.recaptchaToken;Object.assign(U,{phoneSignInInfo:{recaptchaToken:T,captchaResponse:M,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return U}return O?Object.assign(U,{captchaResp:M}):Object.assign(U,{captchaResponse:M}),Object.assign(U,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(U,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),U}async function tP(T,S,R,O,N){if("EMAIL_PASSWORD_PROVIDER"===N){if(!T._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER"))return O(T,S).catch(async N=>{if("auth/missing-recaptcha-token"!==N.code)return Promise.reject(N);{console.log(`${R} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let N=await tk(T,S,R,"getOobCode"===R);return O(T,N)}});{let N=await tk(T,S,R,"getOobCode"===R);return O(T,N)}}if("PHONE_PROVIDER"!==N)return Promise.reject(N+" provider is not supported.");if(T._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){let N=await tk(T,S,R);return O(T,N).catch(async N=>{if(T._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&("auth/missing-recaptcha-token"===N.code||"auth/invalid-app-credential"===N.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${R} flow.`);let N=await tk(T,S,R,!1,!0);return O(T,N)}return Promise.reject(N)})}{let N=await tk(T,S,R,!1,!0);return O(T,N)}}async function tD(T){let S=tT(T),R=await eL(S,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),O=new ex(R);if(null==S.tenantId?S._agentRecaptchaConfig=O:S._tenantRecaptchaConfigs[S.tenantId]=O,O.isAnyProviderEnabled()){let T=new tN(S);T.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tM(T,S){let R=O._getProvider(T,"auth");if(R.isInitialized()){let T=R.getImmediate(),O=R.getOptions();if(N.deepEqual(O,S??{}))return T;ea(T,"already-initialized")}let M=R.initialize({options:S});return M}function tL(T,S){let R=S?.persistence||[],O=(Array.isArray(R)?R:[R]).map(e9);S?.errorMap&&T._updateErrorMap(S.errorMap),T._initializeWithPersistence(O,S?.popupRedirectResolver)}function tF(T,S,R){let O=tT(T);eh(/^https?:\/\//.test(S),O,"invalid-emulator-scheme");let M=!!R?.disableWarnings,L=tU(S),{host:U,port:V}=tj(S),K=null===V?"":`:${V}`,$={url:`${L}//${U}${K}/`},Q=Object.freeze({host:U,port:V,protocol:L.replace(":",""),options:Object.freeze({disableWarnings:M})});if(!O._canInitEmulator){eh(O.config.emulator&&O.emulatorConfig,O,"emulator-config-failed"),eh(N.deepEqual($,O.config.emulator)&&N.deepEqual(Q,O.emulatorConfig),O,"emulator-config-failed");return}O.config.emulator=$,O.emulatorConfig=Q,O.settings.appVerificationDisabledForTesting=!0,N.isCloudWorkstation(U)?(N.pingServer(`${L}//${U}${K}`),N.updateEmulatorBanner("Auth",!0)):M||tV()}function tU(T){let S=T.indexOf(":");return S<0?"":T.substr(0,S+1)}function tj(T){let S=tU(T),R=/(\/\/)?([^?#/]+)/.exec(T.substr(S.length));if(!R)return{host:"",port:null};let O=R[2].split("@").pop()||"",N=/^(\[[^\]]+\])(:|$)/.exec(O);if(N){let T=N[1];return{host:T,port:tB(O.substr(T.length+1))}}{let[T,S]=O.split(":");return{host:T,port:tB(S)}}}function tB(T){if(!T)return null;let S=Number(T);return isNaN(S)?null:S}function tV(){function T(){let T=document.createElement("p"),S=T.style;T.innerText="Running in emulator mode. Do not use with production credentials.",S.position="fixed",S.width="100%",S.backgroundColor="#ffffff",S.border=".1em solid #000000",S.color="#b50000",S.bottom="0px",S.left="0px",S.margin="0px",S.zIndex="10000",S.textAlign="center",T.classList.add("firebase-emulator-warning"),document.body.appendChild(T)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",T):T())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tz{constructor(T,S){this.providerId=T,this.signInMethod=S}toJSON(){return ef("not implemented")}_getIdTokenResponse(T){return ef("not implemented")}_linkToIdToken(T,S){return ef("not implemented")}_getReauthenticationResolver(T){return ef("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tq(T,S){return eR(T,"POST","/v1/accounts:resetPassword",eI(T,S))}async function tH(T,S){return eR(T,"POST","/v1/accounts:update",S)}async function tG(T,S){return eR(T,"POST","/v1/accounts:signUp",S)}async function tW(T,S){return eR(T,"POST","/v1/accounts:update",eI(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tK(T,S){return eO(T,"POST","/v1/accounts:signInWithPassword",eI(T,S))}async function t$(T,S){return eR(T,"POST","/v1/accounts:sendOobCode",eI(T,S))}async function tQ(T,S){return t$(T,S)}async function tY(T,S){return t$(T,S)}async function tJ(T,S){return t$(T,S)}async function tX(T,S){return t$(T,S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tZ(T,S){return eO(T,"POST","/v1/accounts:signInWithEmailLink",eI(T,S))}async function t0(T,S){return eO(T,"POST","/v1/accounts:signInWithEmailLink",eI(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1 extends tz{constructor(T,S,R,O=null){super("password",R),this._email=T,this._password=S,this._tenantId=O}static _fromEmailAndPassword(T,S){return new t1(T,S,"password")}static _fromEmailAndCode(T,S,R=null){return new t1(T,S,"emailLink",R)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(T){let S="string"==typeof T?JSON.parse(T):T;if(S?.email&&S?.password){if("password"===S.signInMethod)return this._fromEmailAndPassword(S.email,S.password);if("emailLink"===S.signInMethod)return this._fromEmailAndCode(S.email,S.password,S.tenantId)}return null}async _getIdTokenResponse(T){switch(this.signInMethod){case"password":let S={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tP(T,S,"signInWithPassword",tK,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return tZ(T,{email:this._email,oobCode:this._password});default:ea(T,"internal-error")}}async _linkToIdToken(T,S){switch(this.signInMethod){case"password":let R={idToken:S,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tP(T,R,"signUpPassword",tG,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return t0(T,{idToken:S,email:this._email,oobCode:this._password});default:ea(T,"internal-error")}}_getReauthenticationResolver(T){return this._getIdTokenResponse(T)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t2(T,S){return eO(T,"POST","/v1/accounts:signInWithIdp",eI(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let t3="http://localhost";class t4 extends tz{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(T){let S=new t4(T.providerId,T.signInMethod);return T.idToken||T.accessToken?(T.idToken&&(S.idToken=T.idToken),T.accessToken&&(S.accessToken=T.accessToken),T.nonce&&!T.pendingToken&&(S.nonce=T.nonce),T.pendingToken&&(S.pendingToken=T.pendingToken)):T.oauthToken&&T.oauthTokenSecret?(S.accessToken=T.oauthToken,S.secret=T.oauthTokenSecret):ea("argument-error"),S}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(T){let S="string"==typeof T?JSON.parse(T):T,{providerId:R,signInMethod:O,...N}=S;if(!R||!O)return null;let M=new t4(R,O);return M.idToken=N.idToken||void 0,M.accessToken=N.accessToken||void 0,M.secret=N.secret,M.nonce=N.nonce,M.pendingToken=N.pendingToken||null,M}_getIdTokenResponse(T){let S=this.buildRequest();return t2(T,S)}_linkToIdToken(T,S){let R=this.buildRequest();return R.idToken=S,t2(T,R)}_getReauthenticationResolver(T){let S=this.buildRequest();return S.autoCreate=!1,t2(T,S)}buildRequest(){let T={requestUri:t3,returnSecureToken:!0};if(this.pendingToken)T.pendingToken=this.pendingToken;else{let S={};this.idToken&&(S.id_token=this.idToken),this.accessToken&&(S.access_token=this.accessToken),this.secret&&(S.oauth_token_secret=this.secret),S.providerId=this.providerId,this.nonce&&!this.pendingToken&&(S.nonce=this.nonce),T.postBody=N.querystring(S)}return T}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t6(T,S){return eO(T,"POST","/v1/accounts:signInWithPhoneNumber",eI(T,S))}async function t9(T,S){let R=await eO(T,"POST","/v1/accounts:signInWithPhoneNumber",eI(T,S));if(R.temporaryProof)throw eD(T,"account-exists-with-different-credential",R);return R}let t5={USER_NOT_FOUND:"user-not-found"};async function t8(T,S){let R={...S,operation:"REAUTH"};return eO(T,"POST","/v1/accounts:signInWithPhoneNumber",eI(T,R),t5)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t7 extends tz{constructor(T){super("phone","phone"),this.params=T}static _fromVerification(T,S){return new t7({verificationId:T,verificationCode:S})}static _fromTokenResponse(T,S){return new t7({phoneNumber:T,temporaryProof:S})}_getIdTokenResponse(T){return t6(T,this._makeVerificationRequest())}_linkToIdToken(T,S){return t9(T,{idToken:S,...this._makeVerificationRequest()})}_getReauthenticationResolver(T){return t8(T,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:T,phoneNumber:S,verificationId:R,verificationCode:O}=this.params;return T&&S?{temporaryProof:T,phoneNumber:S}:{sessionInfo:R,code:O}}toJSON(){let T={providerId:this.providerId};return this.params.phoneNumber&&(T.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(T.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(T.verificationCode=this.params.verificationCode),this.params.verificationId&&(T.verificationId=this.params.verificationId),T}static fromJSON(T){"string"==typeof T&&(T=JSON.parse(T));let{verificationId:S,verificationCode:R,phoneNumber:O,temporaryProof:N}=T;return R||S||O||N?new t7({verificationId:S,verificationCode:R,phoneNumber:O,temporaryProof:N}):null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rt(T){switch(T){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function rr(T){let S=N.querystringDecode(N.extractQuerystring(T)).link,R=S?N.querystringDecode(N.extractQuerystring(S)).deep_link_id:null,O=N.querystringDecode(N.extractQuerystring(T)).deep_link_id,M=O?N.querystringDecode(N.extractQuerystring(O)).link:null;return M||O||R||S||T}class rn{constructor(T){let S=N.querystringDecode(N.extractQuerystring(T)),R=S.apiKey??null,O=S.oobCode??null,M=rt(S.mode??null);eh(R&&O&&M,"argument-error"),this.apiKey=R,this.operation=M,this.code=O,this.continueUrl=S.continueUrl??null,this.languageCode=S.lang??null,this.tenantId=S.tenantId??null}static parseLink(T){let S=rr(T);try{return new rn(S)}catch{return null}}}function ri(T){return rn.parseLink(T)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(){this.providerId=rs.PROVIDER_ID}static credential(T,S){return t1._fromEmailAndPassword(T,S)}static credentialWithLink(T,S){let R=rn.parseLink(S);return eh(R,"argument-error"),t1._fromEmailAndCode(T,R.code,R.tenantId)}}rs.PROVIDER_ID="password",rs.EMAIL_PASSWORD_SIGN_IN_METHOD="password",rs.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(T){this.providerId=T,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(T){this.defaultLanguageCode=T}setCustomParameters(T){return this.customParameters=T,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro extends ra{constructor(){super(...arguments),this.scopes=[]}addScope(T){return this.scopes.includes(T)||this.scopes.push(T),this}getScopes(){return[...this.scopes]}}class rl extends ro{static credentialFromJSON(T){let S="string"==typeof T?JSON.parse(T):T;return eh("providerId"in S&&"signInMethod"in S,"argument-error"),t4._fromParams(S)}credential(T){return this._credential({...T,nonce:T.rawNonce})}_credential(T){return eh(T.idToken||T.accessToken,"argument-error"),t4._fromParams({...T,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(T){return rl.oauthCredentialFromTaggedObject(T)}static credentialFromError(T){return rl.oauthCredentialFromTaggedObject(T.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:T}){if(!T)return null;let{oauthIdToken:S,oauthAccessToken:R,oauthTokenSecret:O,pendingToken:N,nonce:M,providerId:L}=T;if(!R&&!O&&!S&&!N||!L)return null;try{return new rl(L)._credential({idToken:S,accessToken:R,nonce:M,pendingToken:N})}catch(T){return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru extends ro{constructor(){super("facebook.com")}static credential(T){return t4._fromParams({providerId:ru.PROVIDER_ID,signInMethod:ru.FACEBOOK_SIGN_IN_METHOD,accessToken:T})}static credentialFromResult(T){return ru.credentialFromTaggedObject(T)}static credentialFromError(T){return ru.credentialFromTaggedObject(T.customData||{})}static credentialFromTaggedObject({_tokenResponse:T}){if(!T||!("oauthAccessToken"in T)||!T.oauthAccessToken)return null;try{return ru.credential(T.oauthAccessToken)}catch{return null}}}ru.FACEBOOK_SIGN_IN_METHOD="facebook.com",ru.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc extends ro{constructor(){super("google.com"),this.addScope("profile")}static credential(T,S){return t4._fromParams({providerId:rc.PROVIDER_ID,signInMethod:rc.GOOGLE_SIGN_IN_METHOD,idToken:T,accessToken:S})}static credentialFromResult(T){return rc.credentialFromTaggedObject(T)}static credentialFromError(T){return rc.credentialFromTaggedObject(T.customData||{})}static credentialFromTaggedObject({_tokenResponse:T}){if(!T)return null;let{oauthIdToken:S,oauthAccessToken:R}=T;if(!S&&!R)return null;try{return rc.credential(S,R)}catch{return null}}}rc.GOOGLE_SIGN_IN_METHOD="google.com",rc.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd extends ro{constructor(){super("github.com")}static credential(T){return t4._fromParams({providerId:rd.PROVIDER_ID,signInMethod:rd.GITHUB_SIGN_IN_METHOD,accessToken:T})}static credentialFromResult(T){return rd.credentialFromTaggedObject(T)}static credentialFromError(T){return rd.credentialFromTaggedObject(T.customData||{})}static credentialFromTaggedObject({_tokenResponse:T}){if(!T||!("oauthAccessToken"in T)||!T.oauthAccessToken)return null;try{return rd.credential(T.oauthAccessToken)}catch{return null}}}rd.GITHUB_SIGN_IN_METHOD="github.com",rd.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rh="http://localhost";class rf extends tz{constructor(T,S){super(T,T),this.pendingToken=S}_getIdTokenResponse(T){let S=this.buildRequest();return t2(T,S)}_linkToIdToken(T,S){let R=this.buildRequest();return R.idToken=S,t2(T,R)}_getReauthenticationResolver(T){let S=this.buildRequest();return S.autoCreate=!1,t2(T,S)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(T){let S="string"==typeof T?JSON.parse(T):T,{providerId:R,signInMethod:O,pendingToken:N}=S;return R&&O&&N&&R===O?new rf(R,N):null}static _create(T,S){return new rf(T,S)}buildRequest(){return{requestUri:rh,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rp="saml.";class rm extends ra{constructor(T){eh(T.startsWith(rp),"argument-error"),super(T)}static credentialFromResult(T){return rm.samlCredentialFromTaggedObject(T)}static credentialFromError(T){return rm.samlCredentialFromTaggedObject(T.customData||{})}static credentialFromJSON(T){let S=rf.fromJSON(T);return eh(S,"argument-error"),S}static samlCredentialFromTaggedObject({_tokenResponse:T}){if(!T)return null;let{pendingToken:S,providerId:R}=T;if(!S||!R)return null;try{return rf._create(R,S)}catch(T){return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg extends ro{constructor(){super("twitter.com")}static credential(T,S){return t4._fromParams({providerId:rg.PROVIDER_ID,signInMethod:rg.TWITTER_SIGN_IN_METHOD,oauthToken:T,oauthTokenSecret:S})}static credentialFromResult(T){return rg.credentialFromTaggedObject(T)}static credentialFromError(T){return rg.credentialFromTaggedObject(T.customData||{})}static credentialFromTaggedObject({_tokenResponse:T}){if(!T)return null;let{oauthAccessToken:S,oauthTokenSecret:R}=T;if(!S||!R)return null;try{return rg.credential(S,R)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ry(T,S){return eO(T,"POST","/v1/accounts:signUp",eI(T,S))}rg.TWITTER_SIGN_IN_METHOD="twitter.com",rg.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(T){this.user=T.user,this.providerId=T.providerId,this._tokenResponse=T._tokenResponse,this.operationType=T.operationType}static async _fromIdTokenResponse(T,S,R,O=!1){let N=await e4._fromIdTokenResponse(T,R,O),M=rb(R),L=new rv({user:N,providerId:M,_tokenResponse:R,operationType:S});return L}static async _forOperation(T,S,R){await T._updateTokensIfNecessary(R,!0);let O=rb(R);return new rv({user:T,providerId:O,_tokenResponse:R,operationType:S})}}function rb(T){return T.providerId?T.providerId:"phoneNumber"in T?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r_(T){if(O._isFirebaseServerApp(T.app))return Promise.reject(ec(T));let S=tT(T);if(await S._initializationPromise,S.currentUser?.isAnonymous)return new rv({user:S.currentUser,providerId:null,operationType:"signIn"});let R=await ry(S,{returnSecureToken:!0}),N=await rv._fromIdTokenResponse(S,"signIn",R,!0);return await S._updateCurrentUser(N.user),N}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT extends N.FirebaseError{constructor(T,S,R,O){super(S.code,S.message),this.operationType=R,this.user=O,Object.setPrototypeOf(this,rT.prototype),this.customData={appName:T.name,tenantId:T.tenantId??void 0,_serverResponse:S.customData._serverResponse,operationType:R}}static _fromErrorAndOperation(T,S,R,O){return new rT(T,S,R,O)}}function rS(T,S,R,O){let N="reauthenticate"===S?R._getReauthenticationResolver(T):R._getIdTokenResponse(T);return N.catch(R=>{if("auth/multi-factor-auth-required"===R.code)throw rT._fromErrorAndOperation(T,R,S,O);throw R})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(T){return new Set(T.map(({providerId:T})=>T).filter(T=>!!T))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rw(T,S){let R=N.getModularInstance(T);await rI(!0,R,S);let{providerUserInfo:O}=await eU(R.auth,{idToken:await R.getIdToken(),deleteProvider:[S]}),M=rE(O||[]);return R.providerData=R.providerData.filter(T=>M.has(T.providerId)),M.has("phone")||(R.phoneNumber=null),await R.auth._persistUserIfCurrent(R),R}async function rC(T,S,R=!1){let O=await eW(T,S._linkToIdToken(T.auth,await T.getIdToken()),R);return rv._forOperation(T,"link",O)}async function rI(T,S,R){await eY(S);let O=rE(S.providerData),N=!1===T?"provider-already-linked":"no-such-provider";eh(O.has(R)===T,S.auth,N)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rR(T,S,R=!1){let{auth:N}=T;if(O._isFirebaseServerApp(N.app))return Promise.reject(ec(N));let M="reauthenticate";try{let O=await eW(T,rS(N,M,S,T),R);eh(O.idToken,N,"internal-error");let L=eH(O.idToken);eh(L,N,"internal-error");let{sub:U}=L;return eh(T.uid===U,N,"user-mismatch"),rv._forOperation(T,M,O)}catch(T){throw T?.code==="auth/user-not-found"&&ea(N,"user-mismatch"),T}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rA(T,S,R=!1){if(O._isFirebaseServerApp(T.app))return Promise.reject(ec(T));let N="signIn",M=await rS(T,N,S),L=await rv._fromIdTokenResponse(T,N,M);return R||await T._updateCurrentUser(L.user),L}async function rO(T,S){return rA(tT(T),S)}async function rN(T,S){let R=N.getModularInstance(T);return await rI(!1,R,S.providerId),rC(R,S)}async function rk(T,S){return rR(N.getModularInstance(T),S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rP(T,S){return eO(T,"POST","/v1/accounts:signInWithCustomToken",eI(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rD(T,S){if(O._isFirebaseServerApp(T.app))return Promise.reject(ec(T));let R=tT(T),N=await rP(R,{token:S,returnSecureToken:!0}),M=await rv._fromIdTokenResponse(R,"signIn",N);return await R._updateCurrentUser(M.user),M}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rM{constructor(T,S){this.factorId=T,this.uid=S.mfaEnrollmentId,this.enrollmentTime=new Date(S.enrolledAt).toUTCString(),this.displayName=S.displayName}static _fromServerResponse(T,S){return"phoneInfo"in S?rx._fromServerResponse(T,S):"totpInfo"in S?rL._fromServerResponse(T,S):ea(T,"internal-error")}}class rx extends rM{constructor(T){super("phone",T),this.phoneNumber=T.phoneInfo}static _fromServerResponse(T,S){return new rx(S)}}class rL extends rM{constructor(T){super("totp",T)}static _fromServerResponse(T,S){return new rL(S)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rF(T,S,R){eh(R.url?.length>0,T,"invalid-continue-uri"),eh(void 0===R.dynamicLinkDomain||R.dynamicLinkDomain.length>0,T,"invalid-dynamic-link-domain"),eh(void 0===R.linkDomain||R.linkDomain.length>0,T,"invalid-hosting-link-domain"),S.continueUrl=R.url,S.dynamicLinkDomain=R.dynamicLinkDomain,S.linkDomain=R.linkDomain,S.canHandleCodeInApp=R.handleCodeInApp,R.iOS&&(eh(R.iOS.bundleId.length>0,T,"missing-ios-bundle-id"),S.iOSBundleId=R.iOS.bundleId),R.android&&(eh(R.android.packageName.length>0,T,"missing-android-pkg-name"),S.androidInstallApp=R.android.installApp,S.androidMinimumVersionCode=R.android.minimumVersion,S.androidPackageName=R.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rU(T){let S=tT(T);S._getPasswordPolicyInternal()&&await S._updatePasswordPolicy()}async function rj(T,S,R){let O=tT(T),N={requestType:"PASSWORD_RESET",email:S,clientType:"CLIENT_TYPE_WEB"};R&&rF(O,N,R),await tP(O,N,"getOobCode",tY,"EMAIL_PASSWORD_PROVIDER")}async function rB(T,S,R){await tq(N.getModularInstance(T),{oobCode:S,newPassword:R}).catch(async S=>{throw"auth/password-does-not-meet-requirements"===S.code&&rU(T),S})}async function rV(T,S){await tW(N.getModularInstance(T),{oobCode:S})}async function rz(T,S){let R=N.getModularInstance(T),O=await tq(R,{oobCode:S}),M=O.requestType;switch(eh(M,R,"internal-error"),M){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":eh(O.newEmail,R,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":eh(O.mfaInfo,R,"internal-error");default:eh(O.email,R,"internal-error")}let L=null;return O.mfaInfo&&(L=rM._fromServerResponse(tT(R),O.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===O.requestType?O.newEmail:O.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===O.requestType?O.email:O.newEmail)||null,multiFactorInfo:L},operation:M}}async function rq(T,S){let{data:R}=await rz(N.getModularInstance(T),S);return R.email}async function rH(T,S,R){if(O._isFirebaseServerApp(T.app))return Promise.reject(ec(T));let N=tT(T),M={returnSecureToken:!0,email:S,password:R,clientType:"CLIENT_TYPE_WEB"},L=tP(N,M,"signUpPassword",ry,"EMAIL_PASSWORD_PROVIDER"),U=await L.catch(S=>{throw"auth/password-does-not-meet-requirements"===S.code&&rU(T),S}),V=await rv._fromIdTokenResponse(N,"signIn",U);return await N._updateCurrentUser(V.user),V}function rG(T,S,R){return O._isFirebaseServerApp(T.app)?Promise.reject(ec(T)):rO(N.getModularInstance(T),rs.credential(S,R)).catch(async S=>{throw"auth/password-does-not-meet-requirements"===S.code&&rU(T),S})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rW(T,S,R){let O=tT(T),N={requestType:"EMAIL_SIGNIN",email:S,clientType:"CLIENT_TYPE_WEB"};(function(T,S){eh(S.handleCodeInApp,O,"argument-error"),S&&rF(O,T,S)})(N,R),await tP(O,N,"getOobCode",tJ,"EMAIL_PASSWORD_PROVIDER")}function rK(T,S){let R=rn.parseLink(S);return R?.operation==="EMAIL_SIGNIN"}async function r$(T,S,R){if(O._isFirebaseServerApp(T.app))return Promise.reject(ec(T));let M=N.getModularInstance(T),L=rs.credentialWithLink(S,R||em());return eh(L._tenantId===(M.tenantId||null),M,"tenant-id-mismatch"),rO(M,L)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rQ(T,S){return eR(T,"POST","/v1/accounts:createAuthUri",eI(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rY(T,S){let R=eg()?em():"http://localhost",O={identifier:S,continueUri:R},{signinMethods:M}=await rQ(N.getModularInstance(T),O);return M||[]}async function rJ(T,S){let R=N.getModularInstance(T),O=await T.getIdToken(),M={requestType:"VERIFY_EMAIL",idToken:O};S&&rF(R.auth,M,S);let{email:L}=await tQ(R.auth,M);L!==T.email&&await T.reload()}async function rX(T,S,R){let O=N.getModularInstance(T),M=await T.getIdToken(),L={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:M,newEmail:S};R&&rF(O.auth,L,R);let{email:U}=await tX(O.auth,L);U!==T.email&&await T.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rZ(T,S){return eR(T,"POST","/v1/accounts:update",S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r0(T,{displayName:S,photoURL:R}){if(void 0===S&&void 0===R)return;let O=N.getModularInstance(T),M=await O.getIdToken(),L={idToken:M,displayName:S,photoUrl:R,returnSecureToken:!0},U=await eW(O,rZ(O.auth,L));O.displayName=U.displayName||null,O.photoURL=U.photoUrl||null;let V=O.providerData.find(({providerId:T})=>"password"===T);V&&(V.displayName=O.displayName,V.photoURL=O.photoURL),await O._updateTokensIfNecessary(U)}function r1(T,S){let R=N.getModularInstance(T);return O._isFirebaseServerApp(R.auth.app)?Promise.reject(ec(R.auth)):r3(R,S,null)}function r2(T,S){return r3(N.getModularInstance(T),null,S)}async function r3(T,S,R){let{auth:O}=T,N=await T.getIdToken(),M={idToken:N,returnSecureToken:!0};S&&(M.email=S),R&&(M.password=R);let L=await eW(T,tH(O,M));await T._updateTokensIfNecessary(L,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r4(T){if(!T)return null;let{providerId:S}=T,R=T.rawUserInfo?JSON.parse(T.rawUserInfo):{},O=T.isNewUser||"identitytoolkit#SignupNewUserResponse"===T.kind;if(!S&&T?.idToken){let S=eH(T.idToken)?.firebase?.sign_in_provider;if(S){let T="anonymous"!==S&&"custom"!==S?S:null;return new r6(O,T)}}if(!S)return null;switch(S){case"facebook.com":return new r5(O,R);case"github.com":return new r8(O,R);case"google.com":return new r7(O,R);case"twitter.com":return new ne(O,R,T.screenName||null);case"custom":case"anonymous":return new r6(O,null);default:return new r6(O,S,R)}}class r6{constructor(T,S,R={}){this.isNewUser=T,this.providerId=S,this.profile=R}}class r9 extends r6{constructor(T,S,R,O){super(T,S,R),this.username=O}}class r5 extends r6{constructor(T,S){super(T,"facebook.com",S)}}class r8 extends r9{constructor(T,S){super(T,"github.com",S,"string"==typeof S?.login?S?.login:null)}}class r7 extends r6{constructor(T,S){super(T,"google.com",S)}}class ne extends r9{constructor(T,S,R){super(T,"twitter.com",S,R)}}function nt(T){let{user:S,_tokenResponse:R}=T;return S.isAnonymous&&!R?{providerId:null,isNewUser:!1,profile:null}:r4(R)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nn(T,S){return N.getModularInstance(T).setPersistence(S)}function ni(T){return tD(T)}async function na(T,S){let R=tT(T);return R.validatePassword(S)}function no(T,S,R,O){return N.getModularInstance(T).onIdTokenChanged(S,R,O)}function nu(T,S,R){return N.getModularInstance(T).beforeAuthStateChanged(S,R)}function nc(T,S,R,O){return N.getModularInstance(T).onAuthStateChanged(S,R,O)}function nd(T){N.getModularInstance(T).useDeviceLanguage()}function nh(T,S){return N.getModularInstance(T).updateCurrentUser(S)}function nf(T){return N.getModularInstance(T).signOut()}function np(T,S){let R=tT(T);return R.revokeAccessToken(S)}async function nm(T){return N.getModularInstance(T).delete()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(T,S,R){this.type=T,this.credential=S,this.user=R}static _fromIdtoken(T,S){return new ng("enroll",T,S)}static _fromMfaPendingCredential(T){return new ng("signin",T)}toJSON(){let T="enroll"===this.type?"idToken":"pendingCredential";return{multiFactorSession:{[T]:this.credential}}}static fromJSON(T){if(T?.multiFactorSession){if(T.multiFactorSession?.pendingCredential)return ng._fromMfaPendingCredential(T.multiFactorSession.pendingCredential);if(T.multiFactorSession?.idToken)return ng._fromIdtoken(T.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(T,S,R){this.session=T,this.hints=S,this.signInResolver=R}static _fromError(T,S){let R=tT(T),O=S.customData._serverResponse,N=(O.mfaInfo||[]).map(T=>rM._fromServerResponse(R,T));eh(O.mfaPendingCredential,R,"internal-error");let M=ng._fromMfaPendingCredential(O.mfaPendingCredential);return new ny(M,N,async T=>{let N=await T._process(R,M);delete O.mfaInfo,delete O.mfaPendingCredential;let L={...O,idToken:N.idToken,refreshToken:N.refreshToken};switch(S.operationType){case"signIn":let U=await rv._fromIdTokenResponse(R,S.operationType,L);return await R._updateCurrentUser(U.user),U;case"reauthenticate":return eh(S.user,R,"internal-error"),rv._forOperation(S.user,S.operationType,L);default:ea(R,"internal-error")}})}async resolveSignIn(T){let S=T;return this.signInResolver(S)}}function nv(T,S){let R=N.getModularInstance(T),O=S;return eh(S.customData.operationType,R,"argument-error"),eh(O.customData._serverResponse?.mfaPendingCredential,R,"argument-error"),ny._fromError(R,O)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nb(T,S){return eR(T,"POST","/v2/accounts/mfaEnrollment:start",eI(T,S))}function n_(T,S){return eR(T,"POST","/v2/accounts/mfaEnrollment:finalize",eI(T,S))}function nT(T,S){return eR(T,"POST","/v2/accounts/mfaEnrollment:withdraw",eI(T,S))}class nS{constructor(T){this.user=T,this.enrolledFactors=[],T._onReload(S=>{S.mfaInfo&&(this.enrolledFactors=S.mfaInfo.map(S=>rM._fromServerResponse(T.auth,S)))})}static _fromUser(T){return new nS(T)}async getSession(){return ng._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(T,S){let R=T,O=await this.getSession(),N=await eW(this.user,R._process(this.user.auth,O,S));return await this.user._updateTokensIfNecessary(N),this.user.reload()}async unenroll(T){let S="string"==typeof T?T:T.uid,R=await this.user.getIdToken();try{let T=await eW(this.user,nT(this.user.auth,{idToken:R,mfaEnrollmentId:S}));this.enrolledFactors=this.enrolledFactors.filter(({uid:T})=>T!==S),await this.user._updateTokensIfNecessary(T),await this.user.reload()}catch(T){throw T}}}let nE=new WeakMap;function nw(T){let S=N.getModularInstance(T);return nE.has(S)||nE.set(S,nS._fromUser(S)),nE.get(S)}var nC="@firebase/auth",nI="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(T){this.auth=T,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(T){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;let S=await this.auth.currentUser.getIdToken(T);return{accessToken:S}}addAuthTokenListener(T){if(this.assertAuthConfigured(),this.internalListeners.has(T))return;let S=this.auth.onIdTokenChanged(S=>{T(S?.stsTokenManager.accessToken||null)});this.internalListeners.set(T,S),this.updateProactiveRefresh()}removeAuthTokenListener(T){this.assertAuthConfigured();let S=this.internalListeners.get(T);S&&(this.internalListeners.delete(T),S(),this.updateProactiveRefresh())}assertAuthConfigured(){eh(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nA(T){switch(T){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function nO(T){O._registerComponent(new M.Component("auth",(S,{options:R})=>{let O=S.getProvider("app").getImmediate(),N=S.getProvider("heartbeat"),M=S.getProvider("app-check-internal"),{apiKey:L,authDomain:U}=O.options;eh(L&&!L.includes(":"),"invalid-api-key",{appName:O.name});let V={apiKey:L,authDomain:U,clientPlatform:T,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:tm(T)},K=new t_(O,N,M,V);return tL(K,R),K},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((T,S,R)=>{let O=T.getProvider("auth-internal");O.initialize()})),O._registerComponent(new M.Component("auth-internal",T=>{var S;let R=tT(T.getProvider("auth").getImmediate());return S=R,new nR(S)},"PRIVATE").setInstantiationMode("EXPLICIT")),O.registerVersion(nC,nI,nA(T)),O.registerVersion(nC,nI,"cjs2020")}function nN(T=O.getApp()){let S=O._getProvider(T,"auth");if(S.isInitialized())return S.getImmediate();let R=tM(T),M=N.getDefaultEmulatorHost("auth");return M&&tF(R,`http://${M}`),R}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */eS.initialize(fetch,Headers,Response),nO("Node");let nk=eo("operation-not-supported-in-this-environment");async function nP(){throw nk}class nD{constructor(){throw nk}}let nM=e8,nx=e8,nL=e8,nF=e8,nU=nk,nj=nD,nB=nP,nV=nP,nz=nP,nq=nP,nH=nP,nG=nP,nW=nP,nK=nP,n$=nP,nQ=nP,nY=nP,nJ=nD;class nX{static assertion(){throw nk}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nZ(T,S){return eR(T,"POST","/v2/accounts/mfaSignIn:finalize",eI(T,S))}t_.prototype.setPersistence=async()=>{};class n0{constructor(T){this.factorId=T}_process(T,S,R){switch(S.type){case"enroll":return this._finalizeEnroll(T,S.credential,R);case"signin":return this._finalizeSignIn(T,S.credential);default:return ef("unexpected MultiFactorSessionType")}}}class n3{static assertionForEnrollment(T,S){return n4._fromSecret(T,S)}static assertionForSignIn(T,S){return n4._fromEnrollmentId(T,S)}static async generateSecret(T){let S=T;eh(void 0!==S.user?.auth,"internal-error");let R=await nb(S.user.auth,{idToken:S.credential,totpEnrollmentInfo:{}});return n6._fromStartTotpMfaEnrollmentResponse(R,S.user.auth)}}n3.FACTOR_ID="totp";class n4 extends n0{constructor(T,S,R){super("totp"),this.otp=T,this.enrollmentId=S,this.secret=R}static _fromSecret(T,S){return new n4(S,void 0,T)}static _fromEnrollmentId(T,S){return new n4(S,T)}async _finalizeEnroll(T,S,R){return eh(void 0!==this.secret,T,"argument-error"),n_(T,{idToken:S,displayName:R,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(T,S){eh(void 0!==this.enrollmentId&&void 0!==this.otp,T,"argument-error");let R={verificationCode:this.otp};return nZ(T,{mfaPendingCredential:S,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:R})}}class n6{constructor(T,S,R,O,N,M,L){this.sessionInfo=M,this.auth=L,this.secretKey=T,this.hashingAlgorithm=S,this.codeLength=R,this.codeIntervalSeconds=O,this.enrollmentCompletionDeadline=N}static _fromStartTotpMfaEnrollmentResponse(T,S){return new n6(T.totpSessionInfo.sharedSecretKey,T.totpSessionInfo.hashingAlgorithm,T.totpSessionInfo.verificationCodeLength,T.totpSessionInfo.periodSec,new Date(T.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),T.totpSessionInfo.sessionInfo,S)}_makeTotpVerificationInfo(T){return{sessionInfo:this.sessionInfo,verificationCode:T}}generateQrCodeUrl(T,S){let R=!1;return(n9(T)||n9(S))&&(R=!0),R&&(n9(T)&&(T=this.auth.currentUser?.email||"unknownuser"),n9(S)&&(S=this.auth.name)),`otpauth://totp/${S}:${T}?secret=${this.secretKey}&issuer=${S}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function n9(T){return void 0===T||T?.length===0}S.AUTH_ERROR_CODES_MAP_DO_NOT_USE_INTERNALLY=er,S.ActionCodeOperation=Q,S.ActionCodeURL=rn,S.AuthCredential=tz,S.AuthImpl=t_,S.BaseOAuthProvider=ro,S.EmailAuthCredential=t1,S.EmailAuthProvider=rs,S.FacebookAuthProvider=ru,S.FactorId=U,S.FederatedAuthProvider=ra,S.FetchProvider=eS,S.GithubAuthProvider=rd,S.GoogleAuthProvider=rc,S.OAuthCredential=t4,S.OAuthProvider=rl,S.OperationType=$,S.PhoneAuthCredential=t7,S.PhoneAuthProvider=nj,S.PhoneMultiFactorGenerator=nX,S.ProviderId=V,S.RecaptchaVerifier=nJ,S.SAMLAuthCredential=rf,S.SAMLAuthProvider=rm,S.SignInMethod=K,S.TotpMultiFactorGenerator=n3,S.TotpSecret=n6,S.TwitterAuthProvider=rg,S.UserImpl=e4,S._assert=eh,S._castAuth=tT,S._createError=eo,S._emulatorUrl=eT,S._fail=ea,S._getClientVersion=tm,S._getInstance=e9,S._isAndroid=tl,S._isIE10=tf,S._isIOS=td,S._isIOS7Or8=th,S._isMobileBrowser=tp,S._link=rC,S._performApiRequest=eR,S._persistenceKeyName=e7,S._reauthenticate=rR,S._serverAppCurrentUserOperationNotSupportedError=ec,S._signInWithCredential=rA,S.applyActionCode=rV,S.beforeAuthStateChanged=nu,S.browserCookiePersistence=nL,S.browserLocalPersistence=nM,S.browserPopupRedirectResolver=nU,S.browserSessionPersistence=nx,S.checkActionCode=rz,S.confirmPasswordReset=rB,S.connectAuthEmulator=tF,S.createUserWithEmailAndPassword=rH,S.debugAssert=ep,S.debugErrorMap=Z,S.deleteUser=nm,S.fetchSignInMethodsForEmail=rY,S.getAdditionalUserInfo=nt,S.getAuth=nN,S.getIdToken=eV,S.getIdTokenResult=ez,S.getMultiFactorResolver=nv,S.getRedirectResult=nY,S.inMemoryPersistence=e8,S.indexedDBLocalPersistence=nF,S.initializeAuth=tM,S.initializeRecaptchaConfig=ni,S.isSignInWithEmailLink=rK,S.linkWithCredential=rN,S.linkWithPhoneNumber=nV,S.linkWithPopup=nG,S.linkWithRedirect=n$,S.multiFactor=nw,S.onAuthStateChanged=nc,S.onIdTokenChanged=no,S.parseActionCodeURL=ri,S.prodErrorMap=ee,S.reauthenticateWithCredential=rk,S.reauthenticateWithPhoneNumber=nz,S.reauthenticateWithPopup=nW,S.reauthenticateWithRedirect=nQ,S.reload=eJ,S.revokeAccessToken=np,S.sendEmailVerification=rJ,S.sendPasswordResetEmail=rj,S.sendSignInLinkToEmail=rW,S.setPersistence=nn,S.signInAnonymously=r_,S.signInWithCredential=rO,S.signInWithCustomToken=rD,S.signInWithEmailAndPassword=rG,S.signInWithEmailLink=r$,S.signInWithIdp=t2,S.signInWithPhoneNumber=nB,S.signInWithPopup=nH,S.signInWithRedirect=nK,S.signOut=nf,S.unlink=rw,S.updateCurrentUser=nh,S.updateEmail=r1,S.updatePassword=r2,S.updatePhoneNumber=nq,S.updateProfile=r0,S.useDeviceLanguage=nd,S.validatePassword=na,S.verifyBeforeUpdateEmail=rX,S.verifyPasswordResetCode=rq},3971:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});var O=R(5381);class N{constructor(T,S,R){this.name=T,this.instanceFactory=S,this.type=R,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(T){return this.instantiationMode=T,this}setMultipleInstances(T){return this.multipleInstances=T,this}setServiceProps(T){return this.serviceProps=T,this}setInstanceCreatedCallback(T){return this.onInstanceCreated=T,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let M="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L{constructor(T,S){this.name=T,this.container=S,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(T){let S=this.normalizeInstanceIdentifier(T);if(!this.instancesDeferred.has(S)){let T=new O.Deferred;if(this.instancesDeferred.set(S,T),this.isInitialized(S)||this.shouldAutoInitialize())try{let R=this.getOrInitializeService({instanceIdentifier:S});R&&T.resolve(R)}catch(T){}}return this.instancesDeferred.get(S).promise}getImmediate(T){let S=this.normalizeInstanceIdentifier(T?.identifier),R=T?.optional??!1;if(this.isInitialized(S)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:S})}catch(T){if(R)return null;throw T}else{if(R)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(T){if(T.name!==this.name)throw Error(`Mismatching Component ${T.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=T,this.shouldAutoInitialize()){if(V(T))try{this.getOrInitializeService({instanceIdentifier:M})}catch(T){}for(let[T,S]of this.instancesDeferred.entries()){let R=this.normalizeInstanceIdentifier(T);try{let T=this.getOrInitializeService({instanceIdentifier:R});S.resolve(T)}catch(T){}}}}clearInstance(T=M){this.instancesDeferred.delete(T),this.instancesOptions.delete(T),this.instances.delete(T)}async delete(){let T=Array.from(this.instances.values());await Promise.all([...T.filter(T=>"INTERNAL"in T).map(T=>T.INTERNAL.delete()),...T.filter(T=>"_delete"in T).map(T=>T._delete())])}isComponentSet(){return null!=this.component}isInitialized(T=M){return this.instances.has(T)}getOptions(T=M){return this.instancesOptions.get(T)||{}}initialize(T={}){let{options:S={}}=T,R=this.normalizeInstanceIdentifier(T.instanceIdentifier);if(this.isInitialized(R))throw Error(`${this.name}(${R}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let O=this.getOrInitializeService({instanceIdentifier:R,options:S});for(let[T,S]of this.instancesDeferred.entries()){let N=this.normalizeInstanceIdentifier(T);R===N&&S.resolve(O)}return O}onInit(T,S){let R=this.normalizeInstanceIdentifier(S),O=this.onInitCallbacks.get(R)??new Set;O.add(T),this.onInitCallbacks.set(R,O);let N=this.instances.get(R);return N&&T(N,R),()=>{O.delete(T)}}invokeOnInitCallbacks(T,S){let R=this.onInitCallbacks.get(S);if(R)for(let O of R)try{O(T,S)}catch{}}getOrInitializeService({instanceIdentifier:T,options:S={}}){let R=this.instances.get(T);if(!R&&this.component&&(R=this.component.instanceFactory(this.container,{instanceIdentifier:U(T),options:S}),this.instances.set(T,R),this.instancesOptions.set(T,S),this.invokeOnInitCallbacks(R,T),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,T,R)}catch{}return R||null}normalizeInstanceIdentifier(T=M){return this.component?this.component.multipleInstances?T:M:T}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function U(T){return T===M?void 0:T}function V(T){return"EAGER"===T.instantiationMode}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{constructor(T){this.name=T,this.providers=new Map}addComponent(T){let S=this.getProvider(T.name);if(S.isComponentSet())throw Error(`Component ${T.name} has already been registered with ${this.name}`);S.setComponent(T)}addOrOverwriteComponent(T){let S=this.getProvider(T.name);S.isComponentSet()&&this.providers.delete(T.name),this.addComponent(T)}getProvider(T){if(this.providers.has(T))return this.providers.get(T);let S=new L(T,this);return this.providers.set(T,S),S}getProviders(){return Array.from(this.providers.values())}}S.Component=N,S.ComponentContainer=K,S.Provider=L},4442:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let R=[];S.LogLevel=void 0,function(T){T[T.DEBUG=0]="DEBUG",T[T.VERBOSE=1]="VERBOSE",T[T.INFO=2]="INFO",T[T.WARN=3]="WARN",T[T.ERROR=4]="ERROR",T[T.SILENT=5]="SILENT"}(S.LogLevel||(S.LogLevel={}));let O={debug:S.LogLevel.DEBUG,verbose:S.LogLevel.VERBOSE,info:S.LogLevel.INFO,warn:S.LogLevel.WARN,error:S.LogLevel.ERROR,silent:S.LogLevel.SILENT},N=S.LogLevel.INFO,M={[S.LogLevel.DEBUG]:"log",[S.LogLevel.VERBOSE]:"log",[S.LogLevel.INFO]:"info",[S.LogLevel.WARN]:"warn",[S.LogLevel.ERROR]:"error"},L=(T,S,...R)=>{if(S<T.logLevel)return;let O=new Date().toISOString(),N=M[S];if(N)console[N](`[${O}]  ${T.name}:`,...R);else throw Error(`Attempted to log a message with an invalid logType (value: ${S})`)};class U{constructor(T){this.name=T,this._logLevel=N,this._logHandler=L,this._userLogHandler=null,R.push(this)}get logLevel(){return this._logLevel}set logLevel(T){if(!(T in S.LogLevel))throw TypeError(`Invalid value "${T}" assigned to \`logLevel\``);this._logLevel=T}setLogLevel(T){this._logLevel="string"==typeof T?O[T]:T}get logHandler(){return this._logHandler}set logHandler(T){if("function"!=typeof T)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=T}get userLogHandler(){return this._userLogHandler}set userLogHandler(T){this._userLogHandler=T}debug(...T){this._userLogHandler&&this._userLogHandler(this,S.LogLevel.DEBUG,...T),this._logHandler(this,S.LogLevel.DEBUG,...T)}log(...T){this._userLogHandler&&this._userLogHandler(this,S.LogLevel.VERBOSE,...T),this._logHandler(this,S.LogLevel.VERBOSE,...T)}info(...T){this._userLogHandler&&this._userLogHandler(this,S.LogLevel.INFO,...T),this._logHandler(this,S.LogLevel.INFO,...T)}warn(...T){this._userLogHandler&&this._userLogHandler(this,S.LogLevel.WARN,...T),this._logHandler(this,S.LogLevel.WARN,...T)}error(...T){this._userLogHandler&&this._userLogHandler(this,S.LogLevel.ERROR,...T),this._logHandler(this,S.LogLevel.ERROR,...T)}}function V(T){R.forEach(S=>{S.setLogLevel(T)})}function K(T,N){for(let M of R){let R=null;N&&N.level&&(R=O[N.level]),null===T?M.userLogHandler=null:M.userLogHandler=(O,N,...M)=>{let L=M.map(T=>{if(null==T)return null;if("string"==typeof T)return T;if("number"==typeof T||"boolean"==typeof T)return T.toString();if(T instanceof Error)return T.message;try{return JSON.stringify(T)}catch(T){return null}}).filter(T=>T).join(" ");N>=(R??O.logLevel)&&T({level:S.LogLevel[N].toLowerCase(),message:L,args:M,type:O.name})}}}S.Logger=U,S.setLogLevel=V,S.setUserLogHandler=K},5381:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});var O=R(7535);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let N={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},M=function(T,S){if(!T)throw L(S)},L=function(T){return Error("Firebase Database ("+N.SDK_VERSION+") INTERNAL ASSERT FAILED: "+T)},U=function(T){let S=[],R=0;for(let O=0;O<T.length;O++){let N=T.charCodeAt(O);N<128?S[R++]=N:(N<2048?S[R++]=N>>6|192:((64512&N)==55296&&O+1<T.length&&(64512&T.charCodeAt(O+1))==56320?(N=65536+((1023&N)<<10)+(1023&T.charCodeAt(++O)),S[R++]=N>>18|240,S[R++]=N>>12&63|128):S[R++]=N>>12|224,S[R++]=N>>6&63|128),S[R++]=63&N|128)}return S},V=function(T){let S=[],R=0,O=0;for(;R<T.length;){let N=T[R++];if(N<128)S[O++]=String.fromCharCode(N);else if(N>191&&N<224){let M=T[R++];S[O++]=String.fromCharCode((31&N)<<6|63&M)}else if(N>239&&N<365){let M=T[R++],L=T[R++],U=T[R++],V=((7&N)<<18|(63&M)<<12|(63&L)<<6|63&U)-65536;S[O++]=String.fromCharCode(55296+(V>>10)),S[O++]=String.fromCharCode(56320+(1023&V))}else{let M=T[R++],L=T[R++];S[O++]=String.fromCharCode((15&N)<<12|(63&M)<<6|63&L)}}return S.join("")},K={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(T,S){if(!Array.isArray(T))throw Error("encodeByteArray takes an array as a parameter");this.init_();let R=S?this.byteToCharMapWebSafe_:this.byteToCharMap_,O=[];for(let S=0;S<T.length;S+=3){let N=T[S],M=S+1<T.length,L=M?T[S+1]:0,U=S+2<T.length,V=U?T[S+2]:0,K=N>>2,$=(3&N)<<4|L>>4,Q=(15&L)<<2|V>>6,Y=63&V;U||(Y=64,M||(Q=64)),O.push(R[K],R[$],R[Q],R[Y])}return O.join("")},encodeString(T,S){return this.HAS_NATIVE_SUPPORT&&!S?btoa(T):this.encodeByteArray(U(T),S)},decodeString(T,S){return this.HAS_NATIVE_SUPPORT&&!S?atob(T):V(this.decodeStringToByteArray(T,S))},decodeStringToByteArray(T,S){this.init_();let R=S?this.charToByteMapWebSafe_:this.charToByteMap_,O=[];for(let S=0;S<T.length;){let N=R[T.charAt(S++)],M=S<T.length,L=M?R[T.charAt(S)]:0;++S;let U=S<T.length,V=U?R[T.charAt(S)]:64;++S;let K=S<T.length,Q=K?R[T.charAt(S)]:64;if(++S,null==N||null==L||null==V||null==Q)throw new $;let Y=N<<2|L>>4;if(O.push(Y),64!==V){let T=L<<4&240|V>>2;if(O.push(T),64!==Q){let T=V<<6&192|Q;O.push(T)}}}return O},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let T=0;T<this.ENCODED_VALS.length;T++)this.byteToCharMap_[T]=this.ENCODED_VALS.charAt(T),this.charToByteMap_[this.byteToCharMap_[T]]=T,this.byteToCharMapWebSafe_[T]=this.ENCODED_VALS_WEBSAFE.charAt(T),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[T]]=T,T>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(T)]=T,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(T)]=T)}}};class $ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let Q=function(T){let S=U(T);return K.encodeByteArray(S,!0)},Y=function(T){return Q(T).replace(/\./g,"")},X=function(T){try{return K.decodeString(T,!0)}catch(T){console.error("base64Decode failed: ",T)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z(T){return ee(void 0,T)}function ee(T,S){if(!(S instanceof Object))return S;switch(S.constructor){case Date:let R=S;return new Date(R.getTime());case Object:void 0===T&&(T={});break;case Array:T=[];break;default:return S}for(let R in S)S.hasOwnProperty(R)&&et(R)&&(T[R]=ee(T[R],S[R]));return T}function et(T){return"__proto__"!==T}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function er(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let en=()=>er().__FIREBASE_DEFAULTS__,ei=()=>{if("undefined"==typeof process||void 0===process.env)return;let T=process.env.__FIREBASE_DEFAULTS__;if(T)return JSON.parse(T)},es=()=>{let T;if("undefined"==typeof document)return;try{T=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(T){return}let S=T&&X(T[1]);return S&&JSON.parse(S)},ea=()=>{try{return O.getDefaultsFromPostinstall()||en()||ei()||es()}catch(T){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${T}`);return}},eo=T=>ea()?.emulatorHosts?.[T],eu=T=>{let S=eo(T);if(!S)return;let R=S.lastIndexOf(":");if(R<=0||R+1===S.length)throw Error(`Invalid host ${S} with no separate hostname and port!`);let O=parseInt(S.substring(R+1),10);return"["===S[0]?[S.substring(1,R-1),O]:[S.substring(0,R),O]},ec=()=>ea()?.config,ed=T=>ea()?.[`_${T}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((T,S)=>{this.resolve=T,this.reject=S})}wrapCallback(T){return(S,R)=>{S?this.reject(S):this.resolve(R),"function"==typeof T&&(this.promise.catch(()=>{}),1===T.length?T(S):T(S,R))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ef(T){try{let S=T.startsWith("http://")||T.startsWith("https://")?new URL(T).hostname:T;return S.endsWith(".cloudworkstations.dev")}catch{return!1}}async function ep(T){let S=await fetch(T,{credentials:"include"});return S.ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function em(T,S){if(T.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let R={alg:"none",type:"JWT"},O=S||"demo-project",N=T.iat||0,M=T.sub||T.user_id;if(!M)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let L={iss:`https://securetoken.google.com/${O}`,aud:O,iat:N,exp:N+3600,auth_time:N,sub:M,user_id:M,firebase:{sign_in_provider:"custom",identities:{}},...T},U="";return[Y(JSON.stringify(R)),Y(JSON.stringify(L)),U].join(".")}let eg={};function ey(){let T={prod:[],emulator:[]};for(let S of Object.keys(eg))eg[S]?T.emulator.push(S):T.prod.push(S);return T}function ev(T){let S=document.getElementById(T),R=!1;return S||((S=document.createElement("div")).setAttribute("id",T),R=!0),{created:R,element:S}}let eb=!1;function e_(T,S){if("undefined"==typeof window||"undefined"==typeof document||!ef(window.location.host)||eg[T]===S||eg[T]||eb)return;function R(T){return`__firebase__banner__${T}`}eg[T]=S;let O="__firebase__banner",N=ey(),M=N.prod.length>0;function L(){let T=document.getElementById(O);T&&T.remove()}function U(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function V(T,S){T.setAttribute("width","24"),T.setAttribute("id",S),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function K(){let T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{eb=!0,L()},T}function $(T,S){T.setAttribute("id",S),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function Q(){let T=ev(O),S=R("text"),N=document.getElementById(S)||document.createElement("span"),L=R("learnmore"),Q=document.getElementById(L)||document.createElement("a"),Y=R("preprendIcon"),X=document.getElementById(Y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){let S=T.element;U(S),$(Q,L);let R=K();V(X,Y),S.append(X,N,Q,R),document.body.appendChild(S)}M?(N.innerText="Preview backend disconnected.",X.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(X.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,N.innerText="Preview backend running in this workspace."),N.setAttribute("id",S)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",Q):Q()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eT(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function eS(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(eT())}function eE(){let T=ea()?.forceEnvironment;if("node"===T)return!0;if("browser"===T)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(T){return!1}}function ew(){return"undefined"!=typeof window||eC()}function eC(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function eI(){return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function eR(){let T="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof T&&void 0!==T.id}function eA(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function eO(){return eT().indexOf("Electron/")>=0}function eN(){let T=eT();return T.indexOf("MSIE ")>=0||T.indexOf("Trident/")>=0}function ek(){return eT().indexOf("MSAppHost/")>=0}function eP(){return!0===N.NODE_CLIENT||!0===N.NODE_ADMIN}function eD(){return!eE()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function eM(){return!eE()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function ex(){try{return"object"==typeof indexedDB}catch(T){return!1}}function eL(){return new Promise((T,S)=>{try{let R=!0,O="validate-browser-context-for-indexeddb-analytics-module",N=self.indexedDB.open(O);N.onsuccess=()=>{N.result.close(),R||self.indexedDB.deleteDatabase(O),T(!0)},N.onupgradeneeded=()=>{R=!1},N.onerror=()=>{S(N.error?.message||"")}}catch(T){S(T)}})}function eF(){return"undefined"!=typeof navigator&&!!navigator.cookieEnabled}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eU="FirebaseError";class ej extends Error{constructor(T,S,R){super(S),this.code=T,this.customData=R,this.name=eU,Object.setPrototypeOf(this,ej.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,eB.prototype.create)}}class eB{constructor(T,S,R){this.service=T,this.serviceName=S,this.errors=R}create(T,...S){let R=S[0]||{},O=`${this.service}/${T}`,N=this.errors[T],M=N?eV(N,R):"Error",L=`${this.serviceName}: ${M} (${O}).`,U=new ej(O,L,R);return U}}function eV(T,S){return T.replace(ez,(T,R)=>{let O=S[R];return null!=O?String(O):`<${R}?>`})}let ez=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eq(T){return JSON.parse(T)}function eH(T){return JSON.stringify(T)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eG=function(T){let S={},R={},O={},N="";try{let M=T.split(".");S=eq(X(M[0])||""),R=eq(X(M[1])||""),N=M[2],O=R.d||{},delete R.d}catch(T){}return{header:S,claims:R,data:O,signature:N}},eW=function(T){let S=eG(T).claims,R=Math.floor(new Date().getTime()/1e3),O=0,N=0;return"object"==typeof S&&(S.hasOwnProperty("nbf")?O=S.nbf:S.hasOwnProperty("iat")&&(O=S.iat),N=S.hasOwnProperty("exp")?S.exp:O+86400),!!R&&!!O&&!!N&&R>=O&&R<=N},eK=function(T){let S=eG(T).claims;return"object"==typeof S&&S.hasOwnProperty("iat")?S.iat:null},e$=function(T){let S=eG(T),R=S.claims;return!!R&&"object"==typeof R&&R.hasOwnProperty("iat")},eQ=function(T){let S=eG(T).claims;return"object"==typeof S&&!0===S.admin};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eY(T,S){return Object.prototype.hasOwnProperty.call(T,S)}function eJ(T,S){return Object.prototype.hasOwnProperty.call(T,S)?T[S]:void 0}function eX(T){for(let S in T)if(Object.prototype.hasOwnProperty.call(T,S))return!1;return!0}function eZ(T,S,R){let O={};for(let N in T)Object.prototype.hasOwnProperty.call(T,N)&&(O[N]=S.call(R,T[N],N,T));return O}function e0(T,S){if(T===S)return!0;let R=Object.keys(T),O=Object.keys(S);for(let N of R){if(!O.includes(N))return!1;let R=T[N],M=S[N];if(e1(R)&&e1(M)){if(!e0(R,M))return!1}else if(R!==M)return!1}for(let T of O)if(!R.includes(T))return!1;return!0}function e1(T){return null!==T&&"object"==typeof T}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e2(T,S=2e3){let R=new eh;return setTimeout(()=>R.reject("timeout!"),S),T.then(R.resolve,R.reject),R.promise}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e3(T){let S=[];for(let[R,O]of Object.entries(T))Array.isArray(O)?O.forEach(T=>{S.push(encodeURIComponent(R)+"="+encodeURIComponent(T))}):S.push(encodeURIComponent(R)+"="+encodeURIComponent(O));return S.length?"&"+S.join("&"):""}function e4(T){let S={},R=T.replace(/^\?/,"").split("&");return R.forEach(T=>{if(T){let[R,O]=T.split("=");S[decodeURIComponent(R)]=decodeURIComponent(O)}}),S}function e6(T){let S=T.indexOf("?");if(!S)return"";let R=T.indexOf("#",S);return T.substring(S,R>0?R:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e9{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let T=1;T<this.blockSize;++T)this.pad_[T]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(T,S){let R,O;S||(S=0);let N=this.W_;if("string"==typeof T)for(let R=0;R<16;R++)N[R]=T.charCodeAt(S)<<24|T.charCodeAt(S+1)<<16|T.charCodeAt(S+2)<<8|T.charCodeAt(S+3),S+=4;else for(let R=0;R<16;R++)N[R]=T[S]<<24|T[S+1]<<16|T[S+2]<<8|T[S+3],S+=4;for(let T=16;T<80;T++){let S=N[T-3]^N[T-8]^N[T-14]^N[T-16];N[T]=(S<<1|S>>>31)&4294967295}let M=this.chain_[0],L=this.chain_[1],U=this.chain_[2],V=this.chain_[3],K=this.chain_[4];for(let T=0;T<80;T++){T<40?T<20?(R=V^L&(U^V),O=1518500249):(R=L^U^V,O=1859775393):T<60?(R=L&U|V&(L|U),O=2400959708):(R=L^U^V,O=3395469782);let S=(M<<5|M>>>27)+R+K+O+N[T]&4294967295;K=V,V=U,U=(L<<30|L>>>2)&4294967295,L=M,M=S}this.chain_[0]=this.chain_[0]+M&4294967295,this.chain_[1]=this.chain_[1]+L&4294967295,this.chain_[2]=this.chain_[2]+U&4294967295,this.chain_[3]=this.chain_[3]+V&4294967295,this.chain_[4]=this.chain_[4]+K&4294967295}update(T,S){if(null==T)return;void 0===S&&(S=T.length);let R=S-this.blockSize,O=0,N=this.buf_,M=this.inbuf_;for(;O<S;){if(0===M)for(;O<=R;)this.compress_(T,O),O+=this.blockSize;if("string"==typeof T){for(;O<S;)if(N[M]=T.charCodeAt(O),++M,++O,M===this.blockSize){this.compress_(N),M=0;break}}else for(;O<S;)if(N[M]=T[O],++M,++O,M===this.blockSize){this.compress_(N),M=0;break}}this.inbuf_=M,this.total_+=S}digest(){let T=[],S=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let T=this.blockSize-1;T>=56;T--)this.buf_[T]=255&S,S/=256;this.compress_(this.buf_);let R=0;for(let S=0;S<5;S++)for(let O=24;O>=0;O-=8)T[R]=this.chain_[S]>>O&255,++R;return T}}function e5(T,S){let R=new e8(T,S);return R.subscribe.bind(R)}class e8{constructor(T,S){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=S,this.task.then(()=>{T(this)}).catch(T=>{this.error(T)})}next(T){this.forEachObserver(S=>{S.next(T)})}error(T){this.forEachObserver(S=>{S.error(T)}),this.close(T)}complete(){this.forEachObserver(T=>{T.complete()}),this.close()}subscribe(T,S,R){let O;if(void 0===T&&void 0===S&&void 0===R)throw Error("Missing Observer.");void 0===(O=te(T,["next","error","complete"])?T:{next:T,error:S,complete:R}).next&&(O.next=tt),void 0===O.error&&(O.error=tt),void 0===O.complete&&(O.complete=tt);let N=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?O.error(this.finalError):O.complete()}catch(T){}}),this.observers.push(O),N}unsubscribeOne(T){void 0!==this.observers&&void 0!==this.observers[T]&&(delete this.observers[T],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(T){if(!this.finalized)for(let S=0;S<this.observers.length;S++)this.sendOne(S,T)}sendOne(T,S){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[T])try{S(this.observers[T])}catch(T){"undefined"!=typeof console&&console.error&&console.error(T)}})}close(T){this.finalized||(this.finalized=!0,void 0!==T&&(this.finalError=T),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function e7(T,S){return(...R)=>{Promise.resolve(!0).then(()=>{T(...R)}).catch(T=>{S&&S(T)})}}function te(T,S){if("object"!=typeof T||null===T)return!1;for(let R of S)if(R in T&&"function"==typeof T[R])return!0;return!1}function tt(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tr=function(T,S,R,O){let N;if(O<S?N="at least "+S:O>R&&(N=0===R?"none":"no more than "+R),N){let S=T+" failed: Was called with "+O+(1===O?" argument.":" arguments.")+" Expects "+N+".";throw Error(S)}};function ti(T,S){return`${T} failed: ${S} argument `}function ts(T,S,R){if((!R||S)&&"string"!=typeof S)throw Error(ti(T,"namespace")+"must be a valid firebase namespace.")}function ta(T,S,R,O){if((!O||R)&&"function"!=typeof R)throw Error(ti(T,S)+"must be a valid function.")}function tl(T,S,R,O){if((!O||R)&&("object"!=typeof R||null===R))throw Error(ti(T,S)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tu=function(T){let S=[],R=0;for(let O=0;O<T.length;O++){let N=T.charCodeAt(O);if(N>=55296&&N<=56319){let S=N-55296;M(++O<T.length,"Surrogate pair missing trail surrogate.");let R=T.charCodeAt(O)-56320;N=65536+(S<<10)+R}N<128?S[R++]=N:(N<2048?S[R++]=N>>6|192:(N<65536?S[R++]=N>>12|224:(S[R++]=N>>18|240,S[R++]=N>>12&63|128),S[R++]=N>>6&63|128),S[R++]=63&N|128)}return S},tc=function(T){let S=0;for(let R=0;R<T.length;R++){let O=T.charCodeAt(R);O<128?S++:O<2048?S+=2:O>=55296&&O<=56319?(S+=4,R++):S+=3}return S},td=1e3,th=2,tf=144e5,tp=.5;function tm(T,S=td,R=th){let O=S*Math.pow(R,T),N=Math.round(tp*O*(Math.random()-.5)*2);return Math.min(tf,O+N)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tg(T){return Number.isFinite(T)?T+ty(T):`${T}`}function ty(T){T=Math.abs(T);let S=T%100;if(S>=10&&S<=20)return"th";let R=T%10;return 1===R?"st":2===R?"nd":3===R?"rd":"th"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tv(T){return T&&T._delegate?T._delegate:T}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */N.NODE_CLIENT=!0,S.CONSTANTS=N,S.DecodeBase64StringError=$,S.Deferred=eh,S.ErrorFactory=eB,S.FirebaseError=ej,S.MAX_VALUE_MILLIS=tf,S.RANDOM_FACTOR=tp,S.Sha1=e9,S.areCookiesEnabled=eF,S.assert=M,S.assertionError=L,S.async=e7,S.base64=K,S.base64Decode=X,S.base64Encode=Q,S.base64urlEncodeWithoutPadding=Y,S.calculateBackoffMillis=tm,S.contains=eY,S.createMockUserToken=em,S.createSubscribe=e5,S.decode=eG,S.deepCopy=Z,S.deepEqual=e0,S.deepExtend=ee,S.errorPrefix=ti,S.extractQuerystring=e6,S.getDefaultAppConfig=ec,S.getDefaultEmulatorHost=eo,S.getDefaultEmulatorHostnameAndPort=eu,S.getDefaults=ea,S.getExperimentalSetting=ed,S.getGlobal=er,S.getModularInstance=tv,S.getUA=eT,S.isAdmin=eQ,S.isBrowser=ew,S.isBrowserExtension=eR,S.isCloudWorkstation=ef,S.isCloudflareWorker=eI,S.isElectron=eO,S.isEmpty=eX,S.isIE=eN,S.isIndexedDBAvailable=ex,S.isMobileCordova=eS,S.isNode=eE,S.isNodeSdk=eP,S.isReactNative=eA,S.isSafari=eD,S.isSafariOrWebkit=eM,S.isUWP=ek,S.isValidFormat=e$,S.isValidTimestamp=eW,S.isWebWorker=eC,S.issuedAtTime=eK,S.jsonEval=eq,S.map=eZ,S.ordinal=tg,S.pingServer=ep,S.promiseWithTimeout=e2,S.querystring=e3,S.querystringDecode=e4,S.safeGet=eJ,S.stringLength=tc,S.stringToByteArray=tu,S.stringify=eH,S.updateEmulatorBanner=e_,S.validateArgCount=tr,S.validateCallback=ta,S.validateContextObject=tl,S.validateIndexedDBOpenable=eL,S.validateNamespace=ts},7535:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.getDefaultsFromPostinstall=()=>void 0},1605:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.addAdminServicesToServer=S.registerAdminService=void 0;let R=[];function O(T,S){R.push({getServiceDefinition:T,getHandlers:S})}function N(T){for(let{getServiceDefinition:S,getHandlers:O}of R)T.addService(S(),O())}S.registerAdminService=O,S.addAdminServicesToServer=N},7257:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.BackoffTimeout=void 0;let R=1e3,O=1.6,N=12e4,M=.2;function L(T,S){return Math.random()*(S-T)+T}class U{constructor(T,S){this.callback=T,this.initialDelay=R,this.multiplier=O,this.maxDelay=N,this.jitter=M,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,S&&(S.initialDelay&&(this.initialDelay=S.initialDelay),S.multiplier&&(this.multiplier=S.multiplier),S.jitter&&(this.jitter=S.jitter),S.maxDelay&&(this.maxDelay=S.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(T){var S,R;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},T),this.hasRef||null===(R=(S=this.timerId).unref)||void 0===R||R.call(S)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let T=Math.min(this.nextDelay*this.multiplier,this.maxDelay),S=T*this.jitter;this.nextDelay=T+L(-S,S)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let T=new Date,S=this.startTime;S.setMilliseconds(S.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),T<S?this.runTimer(S.getTime()-T.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var T,S;this.hasRef=!0,null===(S=(T=this.timerId).ref)||void 0===S||S.call(T)}unref(){var T,S;this.hasRef=!1,null===(S=(T=this.timerId).unref)||void 0===S||S.call(T)}getEndTime(){return this.endTime}}S.BackoffTimeout=U},8612:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.CallCredentials=void 0;let O=R(2908);function N(T){return"getRequestHeaders"in T&&"function"==typeof T.getRequestHeaders}class M{static createFromMetadataGenerator(T){return new U(T)}static createFromGoogleCredential(T){return M.createFromMetadataGenerator((S,R)=>{let M;(M=N(T)?T.getRequestHeaders(S.service_url):new Promise((R,O)=>{T.getRequestMetadata(S.service_url,(T,S)=>{if(T){O(T);return}if(!S){O(Error("Headers not set by metadata plugin"));return}R(S)})})).then(T=>{let S=new O.Metadata;for(let R of Object.keys(T))S.add(R,T[R]);R(null,S)},T=>{R(T)})})}static createEmpty(){return new V}}S.CallCredentials=M;class L extends M{constructor(T){super(),this.creds=T}async generateMetadata(T){let S=new O.Metadata,R=await Promise.all(this.creds.map(S=>S.generateMetadata(T)));for(let T of R)S.merge(T);return S}compose(T){return new L(this.creds.concat([T]))}_equals(T){return this===T||T instanceof L&&this.creds.every((S,R)=>S._equals(T.creds[R]))}}class U extends M{constructor(T){super(),this.metadataGenerator=T}generateMetadata(T){return new Promise((S,R)=>{this.metadataGenerator(T,(T,O)=>{void 0!==O?S(O):R(T)})})}compose(T){return new L([this,T])}_equals(T){return this===T||T instanceof U&&this.metadataGenerator===T.metadataGenerator}}class V extends M{generateMetadata(T){return Promise.resolve(new O.Metadata)}compose(T){return T}_equals(T){return T instanceof V}}},8577:(T,S)=>{"use strict";function R(T){return void 0!==T.onReceiveMetadata&&1===T.onReceiveMetadata.length}Object.defineProperty(S,"__esModule",{value:!0}),S.InterceptingListenerImpl=S.isInterceptingListener=void 0,S.isInterceptingListener=R;class O{constructor(T,S){this.listener=T,this.nextListener=S,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(T){this.processingMetadata=!0,this.listener.onReceiveMetadata(T,T=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(T),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(T){this.processingMessage=!0,this.listener.onReceiveMessage(T,T=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=T,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(T),this.processPendingStatus())})}onReceiveStatus(T){this.listener.onReceiveStatus(T,T=>{this.processingMetadata||this.processingMessage?this.pendingStatus=T:this.nextListener.onReceiveStatus(T)})}}S.InterceptingListenerImpl=O},60:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.getNextCallNumber=void 0;let R=0;function O(){return R++}S.getNextCallNumber=O},2953:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ClientDuplexStreamImpl=S.ClientWritableStreamImpl=S.ClientReadableStreamImpl=S.ClientUnaryCallImpl=S.callErrorFromStatus=void 0;let O=R(2361),N=R(2781),M=R(9238);function L(T,S){let R=`${T.code} ${M.Status[T.code]}: ${T.details}`,O=Error(R),N=`${O.stack}
for call at
${S}`;return Object.assign(Error(R),T,{stack:N})}S.callErrorFromStatus=L;class U extends O.EventEmitter{constructor(){super()}cancel(){var T;null===(T=this.call)||void 0===T||T.cancelWithStatus(M.Status.CANCELLED,"Cancelled on client")}getPeer(){var T,S;return null!==(S=null===(T=this.call)||void 0===T?void 0:T.getPeer())&&void 0!==S?S:"unknown"}}S.ClientUnaryCallImpl=U;class V extends N.Readable{constructor(T){super({objectMode:!0}),this.deserialize=T}cancel(){var T;null===(T=this.call)||void 0===T||T.cancelWithStatus(M.Status.CANCELLED,"Cancelled on client")}getPeer(){var T,S;return null!==(S=null===(T=this.call)||void 0===T?void 0:T.getPeer())&&void 0!==S?S:"unknown"}_read(T){var S;null===(S=this.call)||void 0===S||S.startRead()}}S.ClientReadableStreamImpl=V;class K extends N.Writable{constructor(T){super({objectMode:!0}),this.serialize=T}cancel(){var T;null===(T=this.call)||void 0===T||T.cancelWithStatus(M.Status.CANCELLED,"Cancelled on client")}getPeer(){var T,S;return null!==(S=null===(T=this.call)||void 0===T?void 0:T.getPeer())&&void 0!==S?S:"unknown"}_write(T,S,R){var O;let N={callback:R},M=Number(S);Number.isNaN(M)||(N.flags=M),null===(O=this.call)||void 0===O||O.sendMessageWithContext(N,T)}_final(T){var S;null===(S=this.call)||void 0===S||S.halfClose(),T()}}S.ClientWritableStreamImpl=K;class $ extends N.Duplex{constructor(T,S){super({objectMode:!0}),this.serialize=T,this.deserialize=S}cancel(){var T;null===(T=this.call)||void 0===T||T.cancelWithStatus(M.Status.CANCELLED,"Cancelled on client")}getPeer(){var T,S;return null!==(S=null===(T=this.call)||void 0===T?void 0:T.getPeer())&&void 0!==S?S:"unknown"}_read(T){var S;null===(S=this.call)||void 0===S||S.startRead()}_write(T,S,R){var O;let N={callback:R},M=Number(S);Number.isNaN(M)||(N.flags=M),null===(O=this.call)||void 0===O||O.sendMessageWithContext(N,T)}_final(T){var S;null===(S=this.call)||void 0===S||S.halfClose(),T()}}S.ClientDuplexStreamImpl=$},7021:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ChannelCredentials=void 0;let O=R(4404),N=R(8612),M=R(6801);function L(T,S){if(T&&!(T instanceof Buffer))throw TypeError(`${S}, if provided, must be a Buffer.`)}class U{constructor(T){this.callCredentials=T||N.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(T,S,R,N){var U;if(L(T,"Root certificate"),L(S,"Private key"),L(R,"Certificate chain"),S&&!R)throw Error("Private key must be given with accompanying certificate chain");if(!S&&R)throw Error("Certificate chain must be given with accompanying private key");let V=(0,O.createSecureContext)({ca:null!==(U=null!=T?T:(0,M.getDefaultRootsData)())&&void 0!==U?U:void 0,key:null!=S?S:void 0,cert:null!=R?R:void 0,ciphers:M.CIPHER_SUITES});return new K(V,null!=N?N:{})}static createFromSecureContext(T,S){return new K(T,null!=S?S:{})}static createInsecure(){return new V}}S.ChannelCredentials=U;class V extends U{constructor(T){super(T)}compose(T){throw Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(T){return T instanceof V}}class K extends U{constructor(T,S){super(),this.secureContext=T,this.verifyOptions=S,this.connectionOptions={secureContext:T},(null==S?void 0:S.checkServerIdentity)&&(this.connectionOptions.checkServerIdentity=S.checkServerIdentity)}compose(T){let S=this.callCredentials.compose(T);return new $(this,S)}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(T){return this===T||T instanceof K&&this.secureContext===T.secureContext&&this.verifyOptions.checkServerIdentity===T.verifyOptions.checkServerIdentity}}class $ extends U{constructor(T,S){super(S),this.channelCredentials=T}compose(T){let S=this.callCredentials.compose(T);return new $(this.channelCredentials,S)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(T){return this===T||T instanceof $&&this.channelCredentials._equals(T.channelCredentials)&&this.callCredentials._equals(T.callCredentials)}}},332:(T,S)=>{"use strict";function R(T,S){let R=Object.keys(T).sort(),O=Object.keys(S).sort();if(R.length!==O.length)return!1;for(let N=0;N<R.length;N+=1)if(R[N]!==O[N]||T[R[N]]!==S[O[N]])return!1;return!0}Object.defineProperty(S,"__esModule",{value:!0}),S.channelOptionsEqual=S.recognizedOptions=void 0,S.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0},S.channelOptionsEqual=R},9914:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ChannelImplementation=void 0;let O=R(7021),N=R(5233);class M{constructor(T,S,R){if("string"!=typeof T)throw TypeError("Channel target must be a string");if(!(S instanceof O.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(R&&"object"!=typeof R)throw TypeError("Channel options must be an object");this.internalChannel=new N.InternalChannel(T,S,R)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(T){return this.internalChannel.getConnectivityState(T)}watchConnectivityState(T,S,R){this.internalChannel.watchConnectivityState(T,S,R)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(T,S,R,O,N){if("string"!=typeof T)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof S||S instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(T,S,R,O,N)}}S.ChannelImplementation=M},3316:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.setup=S.getChannelzServiceDefinition=S.getChannelzHandlers=S.unregisterChannelzRef=S.registerChannelzSocket=S.registerChannelzServer=S.registerChannelzSubchannel=S.registerChannelzChannel=S.ChannelzCallTracker=S.ChannelzChildrenTracker=S.ChannelzTrace=void 0;let O=R(1808),N=R(1360),M=R(9238),L=R(2782),U=R(1605),V=R(7697);function K(T){return{channel_id:T.id,name:T.name}}function $(T){return{subchannel_id:T.id,name:T.name}}function Q(T){return{server_id:T.id}}function Y(T){return{socket_id:T.id,name:T.name}}let X=32;class Z{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(T,S,R){let O=new Date;this.events.push({description:S,severity:T,timestamp:O,childChannel:(null==R?void 0:R.kind)==="channel"?R:void 0,childSubchannel:(null==R?void 0:R.kind)==="subchannel"?R:void 0}),this.events.length>=2*X&&(this.events=this.events.slice(X)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:ev(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(T=>({description:T.description,severity:T.severity,timestamp:ev(T.timestamp),channel_ref:T.childChannel?K(T.childChannel):null,subchannel_ref:T.childSubchannel?$(T.childSubchannel):null}))}}}S.ChannelzTrace=Z;class ee{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(T){var S,R,O;switch(T.kind){case"channel":{let R=null!==(S=this.channelChildren.get(T.id))&&void 0!==S?S:{ref:T,count:0};R.count+=1,this.channelChildren.set(T.id,R);break}case"subchannel":{let S=null!==(R=this.subchannelChildren.get(T.id))&&void 0!==R?R:{ref:T,count:0};S.count+=1,this.subchannelChildren.set(T.id,S);break}case"socket":{let S=null!==(O=this.socketChildren.get(T.id))&&void 0!==O?O:{ref:T,count:0};S.count+=1,this.socketChildren.set(T.id,S)}}}unrefChild(T){switch(T.kind){case"channel":{let S=this.channelChildren.get(T.id);void 0!==S&&(S.count-=1,0===S.count?this.channelChildren.delete(T.id):this.channelChildren.set(T.id,S));break}case"subchannel":{let S=this.subchannelChildren.get(T.id);void 0!==S&&(S.count-=1,0===S.count?this.subchannelChildren.delete(T.id):this.subchannelChildren.set(T.id,S));break}case"socket":{let S=this.socketChildren.get(T.id);void 0!==S&&(S.count-=1,0===S.count?this.socketChildren.delete(T.id):this.socketChildren.set(T.id,S))}}}getChildLists(){let T=[];for(let{ref:S}of this.channelChildren.values())T.push(S);let S=[];for(let{ref:T}of this.subchannelChildren.values())S.push(T);let R=[];for(let{ref:T}of this.socketChildren.values())R.push(T);return{channels:T,subchannels:S,sockets:R}}}S.ChannelzChildrenTracker=ee;class et{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}}S.ChannelzCallTracker=et;let er=1;function en(){return er++}let ei=[],es=[],ea=[],eo=[];function eu(T,S,R){let O=en(),N={id:O,name:T,kind:"channel"};return R&&(ei[O]={ref:N,getInfo:S}),N}function ec(T,S,R){let O=en(),N={id:O,name:T,kind:"subchannel"};return R&&(es[O]={ref:N,getInfo:S}),N}function ed(T,S){let R=en(),O={id:R,kind:"server"};return S&&(ea[R]={ref:O,getInfo:T}),O}function eh(T,S,R){let O=en(),N={id:O,name:T,kind:"socket"};return R&&(eo[O]={ref:N,getInfo:S}),N}function ef(T){switch(T.kind){case"channel":delete ei[T.id];return;case"subchannel":delete es[T.id];return;case"server":delete ea[T.id];return;case"socket":delete eo[T.id];return}}function ep(T){let S=Number.parseInt(T,16);return[S/256|0,S%256]}function em(T){if(""===T)return[];let S=T.split(":").map(T=>ep(T)),R=[];return R.concat(...S)}function eg(T){if((0,O.isIPv4)(T))return Buffer.from(Uint8Array.from(T.split(".").map(T=>Number.parseInt(T))));if(!(0,O.isIPv6)(T))return null;{let S,R;let O=T.indexOf("::");-1===O?(S=T,R=""):(S=T.substring(0,O),R=T.substring(O+2));let N=Buffer.from(em(S)),M=Buffer.from(em(R)),L=Buffer.alloc(16-N.length-M.length,0);return Buffer.concat([N,L,M])}}function ey(T){switch(T){case N.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case N.ConnectivityState.IDLE:return{state:"IDLE"};case N.ConnectivityState.READY:return{state:"READY"};case N.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case N.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function ev(T){if(!T)return null;let S=T.getTime();return{seconds:S/1e3|0,nanos:S%1e3*1e6}}function eb(T){let S=T.getInfo();return{ref:K(T.ref),data:{target:S.target,state:ey(S.state),calls_started:S.callTracker.callsStarted,calls_succeeded:S.callTracker.callsSucceeded,calls_failed:S.callTracker.callsFailed,last_call_started_timestamp:ev(S.callTracker.lastCallStartedTimestamp),trace:S.trace.getTraceMessage()},channel_ref:S.children.channels.map(T=>K(T)),subchannel_ref:S.children.subchannels.map(T=>$(T))}}function e_(T,S){let R=Number.parseInt(T.request.channel_id),O=ei[R];if(void 0===O){S({code:M.Status.NOT_FOUND,details:"No channel data found for id "+R});return}S(null,{channel:eb(O)})}function eT(T,S){let R=Number.parseInt(T.request.max_results),O=[],N=Number.parseInt(T.request.start_channel_id);for(;N<ei.length;N++){let T=ei[N];if(void 0!==T&&(O.push(eb(T)),O.length>=R))break}S(null,{channel:O,end:N>=ea.length})}function eS(T){let S=T.getInfo();return{ref:Q(T.ref),data:{calls_started:S.callTracker.callsStarted,calls_succeeded:S.callTracker.callsSucceeded,calls_failed:S.callTracker.callsFailed,last_call_started_timestamp:ev(S.callTracker.lastCallStartedTimestamp),trace:S.trace.getTraceMessage()},listen_socket:S.listenerChildren.sockets.map(T=>Y(T))}}function eE(T,S){let R=Number.parseInt(T.request.server_id),O=ea[R];if(void 0===O){S({code:M.Status.NOT_FOUND,details:"No server data found for id "+R});return}S(null,{server:eS(O)})}function ew(T,S){let R=Number.parseInt(T.request.max_results),O=[],N=Number.parseInt(T.request.start_server_id);for(;N<ea.length;N++){let T=ea[N];if(void 0!==T&&(O.push(eS(T)),O.length>=R))break}S(null,{server:O,end:N>=ea.length})}function eC(T,S){let R=Number.parseInt(T.request.subchannel_id),O=es[R];if(void 0===O){S({code:M.Status.NOT_FOUND,details:"No subchannel data found for id "+R});return}let N=O.getInfo(),L={ref:$(O.ref),data:{target:N.target,state:ey(N.state),calls_started:N.callTracker.callsStarted,calls_succeeded:N.callTracker.callsSucceeded,calls_failed:N.callTracker.callsFailed,last_call_started_timestamp:ev(N.callTracker.lastCallStartedTimestamp),trace:N.trace.getTraceMessage()},socket_ref:N.children.sockets.map(T=>Y(T))};S(null,{subchannel:L})}function eI(T){var S;return(0,L.isTcpSubchannelAddress)(T)?{address:"tcpip_address",tcpip_address:{ip_address:null!==(S=eg(T.host))&&void 0!==S?S:void 0,port:T.port}}:{address:"uds_address",uds_address:{filename:T.path}}}function eR(T,S){var R,O,N,L,U;let V=Number.parseInt(T.request.socket_id),K=eo[V];if(void 0===K){S({code:M.Status.NOT_FOUND,details:"No socket data found for id "+V});return}let $=K.getInfo(),Q=$.security?{model:"tls",tls:{cipher_suite:$.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:null!==(R=$.security.cipherSuiteStandardName)&&void 0!==R?R:void 0,other_name:null!==(O=$.security.cipherSuiteOtherName)&&void 0!==O?O:void 0,local_certificate:null!==(N=$.security.localCertificate)&&void 0!==N?N:void 0,remote_certificate:null!==(L=$.security.remoteCertificate)&&void 0!==L?L:void 0}}:null,X={ref:Y(K.ref),local:$.localAddress?eI($.localAddress):null,remote:$.remoteAddress?eI($.remoteAddress):null,remote_name:null!==(U=$.remoteName)&&void 0!==U?U:void 0,security:Q,data:{keep_alives_sent:$.keepAlivesSent,streams_started:$.streamsStarted,streams_succeeded:$.streamsSucceeded,streams_failed:$.streamsFailed,last_local_stream_created_timestamp:ev($.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:ev($.lastRemoteStreamCreatedTimestamp),messages_received:$.messagesReceived,messages_sent:$.messagesSent,last_message_received_timestamp:ev($.lastMessageReceivedTimestamp),last_message_sent_timestamp:ev($.lastMessageSentTimestamp),local_flow_control_window:$.localFlowControlWindow?{value:$.localFlowControlWindow}:null,remote_flow_control_window:$.remoteFlowControlWindow?{value:$.remoteFlowControlWindow}:null}};S(null,{socket:X})}function eA(T,S){let R=Number.parseInt(T.request.server_id),O=ea[R];if(void 0===O){S({code:M.Status.NOT_FOUND,details:"No server data found for id "+R});return}let N=Number.parseInt(T.request.start_socket_id),L=Number.parseInt(T.request.max_results),U=O.getInfo(),V=U.sessionChildren.sockets.sort((T,S)=>T.id-S.id),K=[],$=0;for(;$<V.length&&(!(V[$].id>=N)||(K.push(Y(V[$])),!(K.length>=L)));$++);S(null,{socket_ref:K,end:$>=V.length})}function eO(){return{GetChannel:e_,GetTopChannels:eT,GetServer:eE,GetServers:ew,GetSubchannel:eC,GetSocket:eR,GetServerSockets:eA}}S.registerChannelzChannel=eu,S.registerChannelzSubchannel=ec,S.registerChannelzServer=ed,S.registerChannelzSocket=eh,S.unregisterChannelzRef=ef,S.getChannelzHandlers=eO;let eN=null;function ek(){if(eN)return eN;let T=R(8196).J_,S=T("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]}),O=(0,V.loadPackageDefinition)(S);return eN=O.grpc.channelz.v1.Channelz.service}function eP(){(0,U.registerAdminService)(ek,eO)}S.getChannelzServiceDefinition=ek,S.setup=eP},2158:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.getInterceptingCall=S.InterceptingCall=S.RequesterBuilder=S.ListenerBuilder=S.InterceptorConfigurationError=void 0;let O=R(2908),N=R(8577),M=R(9238),L=R(9006);class U extends Error{constructor(T){super(T),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,U)}}S.InterceptorConfigurationError=U;class V{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(T){return this.metadata=T,this}withOnReceiveMessage(T){return this.message=T,this}withOnReceiveStatus(T){return this.status=T,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}}S.ListenerBuilder=V;class K{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(T){return this.start=T,this}withSendMessage(T){return this.message=T,this}withHalfClose(T){return this.halfClose=T,this}withCancel(T){return this.cancel=T,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}}S.RequesterBuilder=K;let $={onReceiveMetadata:(T,S)=>{S(T)},onReceiveMessage:(T,S)=>{S(T)},onReceiveStatus:(T,S)=>{S(T)}},Q={start:(T,S,R)=>{R(T,S)},sendMessage:(T,S)=>{S(T)},halfClose:T=>{T()},cancel:T=>{T()}};class Y{constructor(T,S){var R,O,N,M;this.nextCall=T,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,S?this.requester={start:null!==(R=S.start)&&void 0!==R?R:Q.start,sendMessage:null!==(O=S.sendMessage)&&void 0!==O?O:Q.sendMessage,halfClose:null!==(N=S.halfClose)&&void 0!==N?N:Q.halfClose,cancel:null!==(M=S.cancel)&&void 0!==M?M:Q.cancel}:this.requester=Q}cancelWithStatus(T,S){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(T,S)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(T,S){var R,O,M,L,U,V;let K={onReceiveMetadata:null!==(O=null===(R=null==S?void 0:S.onReceiveMetadata)||void 0===R?void 0:R.bind(S))&&void 0!==O?O:T=>{},onReceiveMessage:null!==(L=null===(M=null==S?void 0:S.onReceiveMessage)||void 0===M?void 0:M.bind(S))&&void 0!==L?L:T=>{},onReceiveStatus:null!==(V=null===(U=null==S?void 0:S.onReceiveStatus)||void 0===U?void 0:U.bind(S))&&void 0!==V?V:T=>{}};this.processingMetadata=!0,this.requester.start(T,K,(T,S)=>{var R,O,M;let L;if(this.processingMetadata=!1,(0,N.isInterceptingListener)(S))L=S;else{let T={onReceiveMetadata:null!==(R=S.onReceiveMetadata)&&void 0!==R?R:$.onReceiveMetadata,onReceiveMessage:null!==(O=S.onReceiveMessage)&&void 0!==O?O:$.onReceiveMessage,onReceiveStatus:null!==(M=S.onReceiveStatus)&&void 0!==M?M:$.onReceiveStatus};L=new N.InterceptingListenerImpl(T,K)}this.nextCall.start(T,L),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(T,S){this.processingMessage=!0,this.requester.sendMessage(S,R=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=T,this.pendingMessage=S):(this.nextCall.sendMessageWithContext(T,R),this.processPendingHalfClose())})}sendMessage(T){this.sendMessageWithContext({},T)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}}function X(T,S,R){var O,N;let M=null!==(O=R.deadline)&&void 0!==O?O:1/0,L=R.host,U=null!==(N=R.parent)&&void 0!==N?N:null,V=R.propagate_flags,K=R.credentials,$=T.createCall(S,M,L,U,V);return K&&$.setCredentials(K),$}S.InterceptingCall=Y;class Z{constructor(T,S){this.call=T,this.methodDefinition=S}cancelWithStatus(T,S){this.call.cancelWithStatus(T,S)}getPeer(){return this.call.getPeer()}sendMessageWithContext(T,S){let R;try{R=this.methodDefinition.requestSerialize(S)}catch(T){this.call.cancelWithStatus(M.Status.INTERNAL,`Request message serialization failure: ${(0,L.getErrorMessage)(T)}`);return}this.call.sendMessageWithContext(T,R)}sendMessage(T){this.sendMessageWithContext({},T)}start(T,S){let R=null;this.call.start(T,{onReceiveMetadata:T=>{var R;null===(R=null==S?void 0:S.onReceiveMetadata)||void 0===R||R.call(S,T)},onReceiveMessage:T=>{var N;let U;try{U=this.methodDefinition.responseDeserialize(T)}catch(T){R={code:M.Status.INTERNAL,details:`Response message parsing error: ${(0,L.getErrorMessage)(T)}`,metadata:new O.Metadata},this.call.cancelWithStatus(R.code,R.details);return}null===(N=null==S?void 0:S.onReceiveMessage)||void 0===N||N.call(S,U)},onReceiveStatus:T=>{var O,N;R?null===(O=null==S?void 0:S.onReceiveStatus)||void 0===O||O.call(S,R):null===(N=null==S?void 0:S.onReceiveStatus)||void 0===N||N.call(S,T)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}}class ee extends Z{constructor(T,S){super(T,S)}start(T,S){var R,O;let N=!1,M={onReceiveMetadata:null!==(O=null===(R=null==S?void 0:S.onReceiveMetadata)||void 0===R?void 0:R.bind(S))&&void 0!==O?O:T=>{},onReceiveMessage:T=>{var R;N=!0,null===(R=null==S?void 0:S.onReceiveMessage)||void 0===R||R.call(S,T)},onReceiveStatus:T=>{var R,O;N||null===(R=null==S?void 0:S.onReceiveMessage)||void 0===R||R.call(S,null),null===(O=null==S?void 0:S.onReceiveStatus)||void 0===O||O.call(S,T)}};super.start(T,M),this.call.startRead()}}class et extends Z{}function er(T,S,R){let O=X(T,R.path,S);return R.responseStream?new et(O,R):new ee(O,R)}function en(T,S,R,O){if(T.clientInterceptors.length>0&&T.clientInterceptorProviders.length>0)throw new U("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(T.callInterceptors.length>0&&T.callInterceptorProviders.length>0)throw new U("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let N=[];N=T.callInterceptors.length>0||T.callInterceptorProviders.length>0?[].concat(T.callInterceptors,T.callInterceptorProviders.map(T=>T(S))).filter(T=>T):[].concat(T.clientInterceptors,T.clientInterceptorProviders.map(T=>T(S))).filter(T=>T);let M=Object.assign({},R,{method_definition:S}),L=N.reduceRight((T,S)=>R=>S(R,T),T=>er(O,T,S));return L(M)}S.getInterceptingCall=en},7307:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Client=void 0;let O=R(2953),N=R(9914),M=R(1360),L=R(9238),U=R(2908),V=R(2158),K=Symbol(),$=Symbol(),Q=Symbol(),Y=Symbol();function X(T){return"function"==typeof T}function Z(T){return T.stack.split("\n").slice(1).join("\n")}class ee{constructor(T,S,R={}){var O,M;if(R=Object.assign({},R),this[$]=null!==(O=R.interceptors)&&void 0!==O?O:[],delete R.interceptors,this[Q]=null!==(M=R.interceptor_providers)&&void 0!==M?M:[],delete R.interceptor_providers,this[$].length>0&&this[Q].length>0)throw Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[Y]=R.callInvocationTransformer,delete R.callInvocationTransformer,R.channelOverride)this[K]=R.channelOverride;else if(R.channelFactoryOverride){let O=R.channelFactoryOverride;delete R.channelFactoryOverride,this[K]=O(T,S,R)}else this[K]=new N.ChannelImplementation(T,S,R)}close(){this[K].close()}getChannel(){return this[K]}waitForReady(T,S){let R=O=>{let N;if(O){S(Error("Failed to connect before the deadline"));return}try{N=this[K].getConnectivityState(!0)}catch(T){S(Error("The channel has been closed"));return}if(N===M.ConnectivityState.READY)S();else try{this[K].watchConnectivityState(N,T,R)}catch(T){S(Error("The channel has been closed"))}};setImmediate(R)}checkOptionalUnaryResponseArguments(T,S,R){if(X(T))return{metadata:new U.Metadata,options:{},callback:T};if(X(S))return T instanceof U.Metadata?{metadata:T,options:{},callback:S}:{metadata:new U.Metadata,options:T,callback:S};if(!(T instanceof U.Metadata&&S instanceof Object&&X(R)))throw Error("Incorrect arguments passed");return{metadata:T,options:S,callback:R}}makeUnaryRequest(T,S,R,N,M,U,X){var ee,et;let er=this.checkOptionalUnaryResponseArguments(M,U,X),en={path:T,requestStream:!1,responseStream:!1,requestSerialize:S,responseDeserialize:R},ei={argument:N,metadata:er.metadata,call:new O.ClientUnaryCallImpl,channel:this[K],methodDefinition:en,callOptions:er.options,callback:er.callback};this[Y]&&(ei=this[Y](ei));let es=ei.call,ea={clientInterceptors:this[$],clientInterceptorProviders:this[Q],callInterceptors:null!==(ee=ei.callOptions.interceptors)&&void 0!==ee?ee:[],callInterceptorProviders:null!==(et=ei.callOptions.interceptor_providers)&&void 0!==et?et:[]},eo=(0,V.getInterceptingCall)(ea,ei.methodDefinition,ei.callOptions,ei.channel);es.call=eo;let eu=null,ec=!1,ed=Error();return eo.start(ei.metadata,{onReceiveMetadata:T=>{es.emit("metadata",T)},onReceiveMessage(T){null!==eu&&eo.cancelWithStatus(L.Status.INTERNAL,"Too many responses received"),eu=T},onReceiveStatus(T){if(!ec){if(ec=!0,T.code===L.Status.OK){if(null===eu){let S=Z(ed);ei.callback((0,O.callErrorFromStatus)({code:L.Status.INTERNAL,details:"No message received",metadata:T.metadata},S))}else ei.callback(null,eu)}else{let S=Z(ed);ei.callback((0,O.callErrorFromStatus)(T,S))}ed=null,es.emit("status",T)}}}),eo.sendMessage(N),eo.halfClose(),es}makeClientStreamRequest(T,S,R,N,M,U){var X,ee;let et=this.checkOptionalUnaryResponseArguments(N,M,U),er={path:T,requestStream:!0,responseStream:!1,requestSerialize:S,responseDeserialize:R},en={metadata:et.metadata,call:new O.ClientWritableStreamImpl(S),channel:this[K],methodDefinition:er,callOptions:et.options,callback:et.callback};this[Y]&&(en=this[Y](en));let ei=en.call,es={clientInterceptors:this[$],clientInterceptorProviders:this[Q],callInterceptors:null!==(X=en.callOptions.interceptors)&&void 0!==X?X:[],callInterceptorProviders:null!==(ee=en.callOptions.interceptor_providers)&&void 0!==ee?ee:[]},ea=(0,V.getInterceptingCall)(es,en.methodDefinition,en.callOptions,en.channel);ei.call=ea;let eo=null,eu=!1,ec=Error();return ea.start(en.metadata,{onReceiveMetadata:T=>{ei.emit("metadata",T)},onReceiveMessage(T){null!==eo&&ea.cancelWithStatus(L.Status.INTERNAL,"Too many responses received"),eo=T},onReceiveStatus(T){if(!eu){if(eu=!0,T.code===L.Status.OK){if(null===eo){let S=Z(ec);en.callback((0,O.callErrorFromStatus)({code:L.Status.INTERNAL,details:"No message received",metadata:T.metadata},S))}else en.callback(null,eo)}else{let S=Z(ec);en.callback((0,O.callErrorFromStatus)(T,S))}ec=null,ei.emit("status",T)}}}),ei}checkMetadataAndOptions(T,S){let R,O;return T instanceof U.Metadata?(R=T,O=S||{}):(O=T||{},R=new U.Metadata),{metadata:R,options:O}}makeServerStreamRequest(T,S,R,N,M,U){var X,ee;let et=this.checkMetadataAndOptions(M,U),er={path:T,requestStream:!1,responseStream:!0,requestSerialize:S,responseDeserialize:R},en={argument:N,metadata:et.metadata,call:new O.ClientReadableStreamImpl(R),channel:this[K],methodDefinition:er,callOptions:et.options};this[Y]&&(en=this[Y](en));let ei=en.call,es={clientInterceptors:this[$],clientInterceptorProviders:this[Q],callInterceptors:null!==(X=en.callOptions.interceptors)&&void 0!==X?X:[],callInterceptorProviders:null!==(ee=en.callOptions.interceptor_providers)&&void 0!==ee?ee:[]},ea=(0,V.getInterceptingCall)(es,en.methodDefinition,en.callOptions,en.channel);ei.call=ea;let eo=!1,eu=Error();return ea.start(en.metadata,{onReceiveMetadata(T){ei.emit("metadata",T)},onReceiveMessage(T){ei.push(T)},onReceiveStatus(T){if(!eo){if(eo=!0,ei.push(null),T.code!==L.Status.OK){let S=Z(eu);ei.emit("error",(0,O.callErrorFromStatus)(T,S))}eu=null,ei.emit("status",T)}}}),ea.sendMessage(N),ea.halfClose(),ei}makeBidiStreamRequest(T,S,R,N,M){var U,X;let ee=this.checkMetadataAndOptions(N,M),et={path:T,requestStream:!0,responseStream:!0,requestSerialize:S,responseDeserialize:R},er={metadata:ee.metadata,call:new O.ClientDuplexStreamImpl(S,R),channel:this[K],methodDefinition:et,callOptions:ee.options};this[Y]&&(er=this[Y](er));let en=er.call,ei={clientInterceptors:this[$],clientInterceptorProviders:this[Q],callInterceptors:null!==(U=er.callOptions.interceptors)&&void 0!==U?U:[],callInterceptorProviders:null!==(X=er.callOptions.interceptor_providers)&&void 0!==X?X:[]},es=(0,V.getInterceptingCall)(ei,er.methodDefinition,er.callOptions,er.channel);en.call=es;let ea=!1,eo=Error();return es.start(er.metadata,{onReceiveMetadata(T){en.emit("metadata",T)},onReceiveMessage(T){en.push(T)},onReceiveStatus(T){if(!ea){if(ea=!0,en.push(null),T.code!==L.Status.OK){let S=Z(eo);en.emit("error",(0,O.callErrorFromStatus)(T,S))}eo=null,en.emit("status",T)}}}),en}}S.Client=ee},6702:(T,S)=>{"use strict";var R;Object.defineProperty(S,"__esModule",{value:!0}),S.CompressionAlgorithms=void 0,function(T){T[T.identity=0]="identity",T[T.deflate=1]="deflate",T[T.gzip=2]="gzip"}(R||(S.CompressionAlgorithms=R={}))},9718:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.CompressionFilterFactory=S.CompressionFilter=void 0;let O=R(9796),N=R(6702),M=R(9238),L=R(1818),U=R(8200),V=T=>"number"==typeof T&&"string"==typeof N.CompressionAlgorithms[T];class K{async writeMessage(T,S){let R=T;S&&(R=await this.compressMessage(R));let O=Buffer.allocUnsafe(R.length+5);return O.writeUInt8(S?1:0,0),O.writeUInt32BE(R.length,1),R.copy(O,5),O}async readMessage(T){let S=1===T.readUInt8(0),R=T.slice(5);return S&&(R=await this.decompressMessage(R)),R}}class $ extends K{async compressMessage(T){return T}async writeMessage(T,S){let R=Buffer.allocUnsafe(T.length+5);return R.writeUInt8(0,0),R.writeUInt32BE(T.length,1),T.copy(R,5),R}decompressMessage(T){return Promise.reject(Error('Received compressed message but "grpc-encoding" header was identity'))}}class Q extends K{constructor(T){super(),this.maxRecvMessageLength=T}compressMessage(T){return new Promise((S,R)=>{O.deflate(T,(T,O)=>{T?R(T):S(O)})})}decompressMessage(T){return new Promise((S,R)=>{let N=0,L=[],U=O.createInflate();U.on("data",T=>{L.push(T),N+=T.byteLength,-1!==this.maxRecvMessageLength&&N>this.maxRecvMessageLength&&(U.destroy(),R({code:M.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),U.on("end",()=>{S(Buffer.concat(L))}),U.write(T),U.end()})}}class Y extends K{constructor(T){super(),this.maxRecvMessageLength=T}compressMessage(T){return new Promise((S,R)=>{O.gzip(T,(T,O)=>{T?R(T):S(O)})})}decompressMessage(T){return new Promise((S,R)=>{let N=0,L=[],U=O.createGunzip();U.on("data",T=>{L.push(T),N+=T.byteLength,-1!==this.maxRecvMessageLength&&N>this.maxRecvMessageLength&&(U.destroy(),R({code:M.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),U.on("end",()=>{S(Buffer.concat(L))}),U.write(T),U.end()})}}class X extends K{constructor(T){super(),this.compressionName=T}compressMessage(T){return Promise.reject(Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(T){return Promise.reject(Error(`Compression method not supported: ${this.compressionName}`))}}function Z(T,S){switch(T){case"identity":return new $;case"deflate":return new Q(S);case"gzip":return new Y(S);default:return new X(T)}}class ee extends L.BaseFilter{constructor(T,S){var R,O;super(),this.sharedFilterConfig=S,this.sendCompression=new $,this.receiveCompression=new $,this.currentCompressionAlgorithm="identity";let L=T["grpc.default_compression_algorithm"];if(this.maxReceiveMessageLength=null!==(R=T["grpc.max_receive_message_length"])&&void 0!==R?R:M.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,void 0!==L){if(V(L)){let T=N.CompressionAlgorithms[L],R=null===(O=S.serverSupportedEncodingHeader)||void 0===O?void 0:O.split(",");(!R||R.includes(T))&&(this.currentCompressionAlgorithm=T,this.sendCompression=Z(this.currentCompressionAlgorithm,-1))}else U.log(M.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${L}`)}}async sendMetadata(T){let S=await T;return S.set("grpc-accept-encoding","identity,deflate,gzip"),S.set("accept-encoding","identity"),"identity"===this.currentCompressionAlgorithm?S.remove("grpc-encoding"):S.set("grpc-encoding",this.currentCompressionAlgorithm),S}receiveMetadata(T){let S=T.get("grpc-encoding");if(S.length>0){let T=S[0];"string"==typeof T&&(this.receiveCompression=Z(T,this.maxReceiveMessageLength))}T.remove("grpc-encoding");let R=T.get("grpc-accept-encoding")[0];if(R){this.sharedFilterConfig.serverSupportedEncodingHeader=R;let T=R.split(",");T.includes(this.currentCompressionAlgorithm)||(this.sendCompression=new $,this.currentCompressionAlgorithm="identity")}return T.remove("grpc-accept-encoding"),T}async sendMessage(T){var S;let R;let O=await T;return R=!(this.sendCompression instanceof $)&&((null!==(S=O.flags)&&void 0!==S?S:0)&2)==0,{message:await this.sendCompression.writeMessage(O.message,R),flags:O.flags}}async receiveMessage(T){return this.receiveCompression.readMessage(await T)}}S.CompressionFilter=ee;class et{constructor(T,S){this.options=S,this.sharedFilterConfig={}}createFilter(){return new ee(this.options,this.sharedFilterConfig)}}S.CompressionFilterFactory=et},1360:(T,S)=>{"use strict";var R;Object.defineProperty(S,"__esModule",{value:!0}),S.ConnectivityState=void 0,function(T){T[T.IDLE=0]="IDLE",T[T.CONNECTING=1]="CONNECTING",T[T.READY=2]="READY",T[T.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",T[T.SHUTDOWN=4]="SHUTDOWN"}(R||(S.ConnectivityState=R={}))},9238:(T,S)=>{"use strict";var R,O,N;Object.defineProperty(S,"__esModule",{value:!0}),S.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=S.DEFAULT_MAX_SEND_MESSAGE_LENGTH=S.Propagate=S.LogVerbosity=S.Status=void 0,function(T){T[T.OK=0]="OK",T[T.CANCELLED=1]="CANCELLED",T[T.UNKNOWN=2]="UNKNOWN",T[T.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",T[T.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",T[T.NOT_FOUND=5]="NOT_FOUND",T[T.ALREADY_EXISTS=6]="ALREADY_EXISTS",T[T.PERMISSION_DENIED=7]="PERMISSION_DENIED",T[T.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",T[T.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",T[T.ABORTED=10]="ABORTED",T[T.OUT_OF_RANGE=11]="OUT_OF_RANGE",T[T.UNIMPLEMENTED=12]="UNIMPLEMENTED",T[T.INTERNAL=13]="INTERNAL",T[T.UNAVAILABLE=14]="UNAVAILABLE",T[T.DATA_LOSS=15]="DATA_LOSS",T[T.UNAUTHENTICATED=16]="UNAUTHENTICATED"}(R||(S.Status=R={})),function(T){T[T.DEBUG=0]="DEBUG",T[T.INFO=1]="INFO",T[T.ERROR=2]="ERROR",T[T.NONE=3]="NONE"}(O||(S.LogVerbosity=O={})),function(T){T[T.DEADLINE=1]="DEADLINE",T[T.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",T[T.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",T[T.CANCELLATION=8]="CANCELLATION",T[T.DEFAULTS=65535]="DEFAULTS"}(N||(S.Propagate=N={})),S.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1,S.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4194304},6614:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.restrictControlPlaneStatusCode=void 0;let O=R(9238),N=[O.Status.OK,O.Status.INVALID_ARGUMENT,O.Status.NOT_FOUND,O.Status.ALREADY_EXISTS,O.Status.FAILED_PRECONDITION,O.Status.ABORTED,O.Status.OUT_OF_RANGE,O.Status.DATA_LOSS];function M(T,S){return N.includes(T)?{code:O.Status.INTERNAL,details:`Invalid status from control plane: ${T} ${O.Status[T]} ${S}`}:{code:T,details:S}}S.restrictControlPlaneStatusCode=M},823:(T,S)=>{"use strict";function R(...T){let S=1/0;for(let R of T){let T=R instanceof Date?R.getTime():R;T<S&&(S=T)}return S}Object.defineProperty(S,"__esModule",{value:!0}),S.deadlineToString=S.getRelativeTimeout=S.getDeadlineTimeoutString=S.minDeadline=void 0,S.minDeadline=R;let O=[["m",1],["S",1e3],["M",6e4],["H",36e5]];function N(T){let S=new Date().getTime();T instanceof Date&&(T=T.getTime());let R=Math.max(T-S,0);for(let[T,S]of O){let O=R/S;if(O<1e8)return String(Math.ceil(O))+T}throw Error("Deadline is too far in the future")}S.getDeadlineTimeoutString=N;let M=2147483647;function L(T){let S=T instanceof Date?T.getTime():T,R=new Date().getTime(),O=S-R;return O<0?0:O>M?1/0:O}function U(T){if(T instanceof Date)return T.toISOString();{let S=new Date(T);return Number.isNaN(S.getTime())?""+T:S.toISOString()}}S.getRelativeTimeout=L,S.deadlineToString=U},9589:(T,S)=>{"use strict";function R(T){return{seconds:T/1e3|0,nanos:T%1e3*1e6|0}}function O(T){return 1e3*T.seconds+T.nanos/1e6|0}function N(T){return"number"==typeof T.seconds&&"number"==typeof T.nanos}Object.defineProperty(S,"__esModule",{value:!0}),S.isDuration=S.durationToMs=S.msToDuration=void 0,S.msToDuration=R,S.durationToMs=O,S.isDuration=N},9006:(T,S)=>{"use strict";function R(T){return T instanceof Error?T.message:String(T)}function O(T){return"object"==typeof T&&null!==T&&"code"in T&&"number"==typeof T.code?T.code:null}Object.defineProperty(S,"__esModule",{value:!0}),S.getErrorCode=S.getErrorMessage=void 0,S.getErrorMessage=R,S.getErrorCode=O},6868:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.OutlierDetectionLoadBalancingConfig=S.BaseSubchannelWrapper=S.registerAdminService=S.FilterStackFactory=S.BaseFilter=S.PickResultType=S.QueuePicker=S.UnavailablePicker=S.ChildLoadBalancerHandler=S.subchannelAddressToString=S.validateLoadBalancingConfig=S.getFirstUsableConfig=S.registerLoadBalancerType=S.createChildChannelControlHelper=S.BackoffTimeout=S.durationToMs=S.uriToString=S.createResolver=S.registerResolver=S.log=S.trace=void 0;var O=R(8200);Object.defineProperty(S,"trace",{enumerable:!0,get:function(){return O.trace}}),Object.defineProperty(S,"log",{enumerable:!0,get:function(){return O.log}});var N=R(4755);Object.defineProperty(S,"registerResolver",{enumerable:!0,get:function(){return N.registerResolver}}),Object.defineProperty(S,"createResolver",{enumerable:!0,get:function(){return N.createResolver}});var M=R(4717);Object.defineProperty(S,"uriToString",{enumerable:!0,get:function(){return M.uriToString}});var L=R(9589);Object.defineProperty(S,"durationToMs",{enumerable:!0,get:function(){return L.durationToMs}});var U=R(7257);Object.defineProperty(S,"BackoffTimeout",{enumerable:!0,get:function(){return U.BackoffTimeout}});var V=R(7203);Object.defineProperty(S,"createChildChannelControlHelper",{enumerable:!0,get:function(){return V.createChildChannelControlHelper}}),Object.defineProperty(S,"registerLoadBalancerType",{enumerable:!0,get:function(){return V.registerLoadBalancerType}}),Object.defineProperty(S,"getFirstUsableConfig",{enumerable:!0,get:function(){return V.getFirstUsableConfig}}),Object.defineProperty(S,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return V.validateLoadBalancingConfig}});var K=R(2782);Object.defineProperty(S,"subchannelAddressToString",{enumerable:!0,get:function(){return K.subchannelAddressToString}});var $=R(8390);Object.defineProperty(S,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return $.ChildLoadBalancerHandler}});var Q=R(2939);Object.defineProperty(S,"UnavailablePicker",{enumerable:!0,get:function(){return Q.UnavailablePicker}}),Object.defineProperty(S,"QueuePicker",{enumerable:!0,get:function(){return Q.QueuePicker}}),Object.defineProperty(S,"PickResultType",{enumerable:!0,get:function(){return Q.PickResultType}});var Y=R(1818);Object.defineProperty(S,"BaseFilter",{enumerable:!0,get:function(){return Y.BaseFilter}});var X=R(4213);Object.defineProperty(S,"FilterStackFactory",{enumerable:!0,get:function(){return X.FilterStackFactory}});var Z=R(1605);Object.defineProperty(S,"registerAdminService",{enumerable:!0,get:function(){return Z.registerAdminService}});var ee=R(9609);Object.defineProperty(S,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return ee.BaseSubchannelWrapper}});var et=R(5683);Object.defineProperty(S,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return et.OutlierDetectionLoadBalancingConfig}})},4213:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.FilterStackFactory=S.FilterStack=void 0;class R{constructor(T){this.filters=T}sendMetadata(T){let S=T;for(let T=0;T<this.filters.length;T++)S=this.filters[T].sendMetadata(S);return S}receiveMetadata(T){let S=T;for(let T=this.filters.length-1;T>=0;T--)S=this.filters[T].receiveMetadata(S);return S}sendMessage(T){let S=T;for(let T=0;T<this.filters.length;T++)S=this.filters[T].sendMessage(S);return S}receiveMessage(T){let S=T;for(let T=this.filters.length-1;T>=0;T--)S=this.filters[T].receiveMessage(S);return S}receiveTrailers(T){let S=T;for(let T=this.filters.length-1;T>=0;T--)S=this.filters[T].receiveTrailers(S);return S}push(T){this.filters.unshift(...T)}getFilters(){return this.filters}}S.FilterStack=R;class O{constructor(T){this.factories=T}push(T){this.factories.unshift(...T)}clone(){return new O([...this.factories])}createFilter(){return new R(this.factories.map(T=>T.createFilter()))}}S.FilterStackFactory=O},1818:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.BaseFilter=void 0;class R{async sendMetadata(T){return T}receiveMetadata(T){return T}async sendMessage(T){return T}async receiveMessage(T){return T}receiveTrailers(T){return T}}S.BaseFilter=R},8304:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.getProxiedConnection=S.mapProxyName=void 0;let O=R(8200),N=R(9238),M=R(4755),L=R(3685),U=R(4404),V=R(8200),K=R(2782),$=R(4717),Q=R(7310),Y=R(4988),X="proxy";function Z(T){V.trace(N.LogVerbosity.DEBUG,X,T)}function ee(){let T,S="",R="";if(process.env.grpc_proxy)R="grpc_proxy",S=process.env.grpc_proxy;else if(process.env.https_proxy)R="https_proxy",S=process.env.https_proxy;else{if(!process.env.http_proxy)return{};R="http_proxy",S=process.env.http_proxy}try{T=new Q.URL(S)}catch(T){return(0,O.log)(N.LogVerbosity.ERROR,`cannot parse value of "${R}" env var`),{}}if("http:"!==T.protocol)return(0,O.log)(N.LogVerbosity.ERROR,`"${T.protocol}" scheme not supported in proxy URI`),{};let M=null;T.username&&(T.password?((0,O.log)(N.LogVerbosity.INFO,"userinfo found in proxy URI"),M=`${T.username}:${T.password}`):M=T.username);let L=T.hostname,U=T.port;""===U&&(U="80");let V={address:`${L}:${U}`};return M&&(V.creds=M),Z("Proxy server "+V.address+" set by environment variable "+R),V}function et(){let T=process.env.no_grpc_proxy,S="no_grpc_proxy";return(T||(T=process.env.no_proxy,S="no_proxy"),T)?(Z("No proxy server list set by environment variable "+S),T.split(",")):[]}function er(T,S){var R;let O={target:T,extraOptions:{}};if((null!==(R=S["grpc.enable_http_proxy"])&&void 0!==R?R:1)===0||"unix"===T.scheme)return O;let N=ee();if(!N.address)return O;let M=(0,$.splitHostPort)(T.path);if(!M)return O;let L=M.host;for(let S of et())if(S===L)return Z("Not using proxy for target in no_proxy list: "+(0,$.uriToString)(T)),O;let U={"grpc.http_connect_target":(0,$.uriToString)(T)};return N.creds&&(U["grpc.http_connect_creds"]=N.creds),{target:{scheme:"dns",path:N.address},extraOptions:U}}function en(T,S,R){var V;if(!("grpc.http_connect_target"in S))return Promise.resolve({});let Q=S["grpc.http_connect_target"],X=(0,$.parseUri)(Q);if(null===X)return Promise.resolve({});let ee=(0,$.splitHostPort)(X.path);if(null===ee)return Promise.resolve({});let et=`${ee.host}:${null!==(V=ee.port)&&void 0!==V?V:Y.DEFAULT_PORT}`,er={method:"CONNECT",path:et},en={Host:et};(0,K.isTcpSubchannelAddress)(T)?(er.host=T.host,er.port=T.port):er.socketPath=T.path,"grpc.http_connect_creds"in S&&(en["Proxy-Authorization"]="Basic "+Buffer.from(S["grpc.http_connect_creds"]).toString("base64")),er.headers=en;let ei=(0,K.subchannelAddressToString)(T);return Z("Using proxy "+ei+" to connect to "+er.path),new Promise((T,S)=>{let V=L.request(er);V.once("connect",(L,K,Q)=>{var Y;if(V.removeAllListeners(),K.removeAllListeners(),200===L.statusCode){if(Z("Successfully connected to "+er.path+" through proxy "+ei),"secureContext"in R){let O=(0,M.getDefaultAuthority)(X),N=(0,$.splitHostPort)(O),L=null!==(Y=null==N?void 0:N.host)&&void 0!==Y?Y:O,V=U.connect(Object.assign({host:L,servername:L,socket:K},R),()=>{Z("Successfully established a TLS connection to "+er.path+" through proxy "+ei),T({socket:V,realTarget:X})});V.on("error",T=>{Z("Failed to establish a TLS connection to "+er.path+" through proxy "+ei+" with error "+T.message),S()})}else Z("Successfully established a plaintext connection to "+er.path+" through proxy "+ei),T({socket:K,realTarget:X})}else(0,O.log)(N.LogVerbosity.ERROR,"Failed to connect to "+er.path+" through proxy "+ei+" with status "+L.statusCode),S()}),V.once("error",T=>{V.removeAllListeners(),(0,O.log)(N.LogVerbosity.ERROR,"Failed to connect to proxy "+ei+" with error "+T.message),S()}),V.end()})}S.mapProxyName=er,S.getProxiedConnection=en},6063:(T,S,R)=>{"use strict";eu={value:!0},eu=eu=eu=eu=eu=eu=eu=eu=eu=eu=eu=eu=eu=eu=eu=eu=eu=eu=eu=eu=eu=eu=eu=S.Rz=eu=eu=eu=eu=eu=eu=S.SF=S.K9=void 0;let O=R(8612);eu={enumerable:!0,get:function(){return O.CallCredentials}};let N=R(9914);eu={enumerable:!0,get:function(){return N.ChannelImplementation}};let M=R(6702);eu={enumerable:!0,get:function(){return M.CompressionAlgorithms}};let L=R(1360);eu={enumerable:!0,get:function(){return L.ConnectivityState}};let U=R(7021);eu={enumerable:!0,get:function(){return U.ChannelCredentials}};let V=R(7307);eu={enumerable:!0,get:function(){return V.Client}};let K=R(9238);eu={enumerable:!0,get:function(){return K.LogVerbosity}},eu={enumerable:!0,get:function(){return K.Status}},eu={enumerable:!0,get:function(){return K.Propagate}};let $=R(8200),Q=R(7697);Object.defineProperty(S,"Rz",{enumerable:!0,get:function(){return Q.loadPackageDefinition}}),eu={enumerable:!0,get:function(){return Q.makeClientConstructor}},eu={enumerable:!0,get:function(){return Q.makeClientConstructor}};let Y=R(2908);Object.defineProperty(S,"SF",{enumerable:!0,get:function(){return Y.Metadata}});let X=R(2903);eu={enumerable:!0,get:function(){return X.Server}};let Z=R(2501);eu={enumerable:!0,get:function(){return Z.ServerCredentials}};let ee=R(9929);eu={enumerable:!0,get:function(){return ee.StatusBuilder}},S.K9={combineChannelCredentials:(T,...S)=>S.reduce((T,S)=>T.compose(S),T),combineCallCredentials:(T,...S)=>S.reduce((T,S)=>T.compose(S),T),createInsecure:U.ChannelCredentials.createInsecure,createSsl:U.ChannelCredentials.createSsl,createFromSecureContext:U.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:O.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:O.CallCredentials.createFromGoogleCredential,createEmpty:O.CallCredentials.createEmpty};let et=T=>T.close();eu=et;let er=(T,S,R)=>T.waitForReady(S,R);eu=er;let en=(T,S)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};eu=en;let ei=(T,S,R)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};eu=ei;let es=T=>{$.setLogger(T)};eu=es;let ea=T=>{$.setLoggerVerbosity(T)};eu=ea;let eo=T=>V.Client.prototype.getChannel.call(T);eu=eo;var eu,ec=R(2158);eu={enumerable:!0,get:function(){return ec.ListenerBuilder}},eu={enumerable:!0,get:function(){return ec.RequesterBuilder}},eu={enumerable:!0,get:function(){return ec.InterceptingCall}},eu={enumerable:!0,get:function(){return ec.InterceptorConfigurationError}};var ed=R(3316);eu={enumerable:!0,get:function(){return ed.getChannelzServiceDefinition}},eu={enumerable:!0,get:function(){return ed.getChannelzHandlers}};var eh=R(1605);eu={enumerable:!0,get:function(){return eh.addAdminServicesToServer}};let ef=R(6868);eu=ef;let ep=R(4988),em=R(864),eg=R(6633),ey=R(2190),ev=R(9580),eb=R(5683),e_=R(3316);(()=>{ep.setup(),em.setup(),eg.setup(),ey.setup(),ev.setup(),eb.setup(),e_.setup()})()},5233:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.InternalChannel=void 0;let O=R(7021),N=R(1839),M=R(8364),L=R(2939),U=R(9238),V=R(4213),K=R(9718),$=R(4755),Q=R(8200),Y=R(8304),X=R(4717),Z=R(1360),ee=R(3316),et=R(439),er=R(823),en=R(5700),ei=R(60),es=R(6614),ea=R(7564),eo=R(9609),eu=2147483647,ec=1e3,ed=18e5,eh=new Map,ef=16777216,ep=1048576;class em extends eo.BaseSubchannelWrapper{constructor(T,S){super(T),this.channel=S,this.refCount=0,this.subchannelStateListener=(T,R,O,N)=>{S.throttleKeepalive(N)},T.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}}class eg{constructor(T,S,R){var et,er,en,ei,eo,eg,ey,ev;if(this.credentials=S,this.options=R,this.connectivityState=Z.ConnectivityState.IDLE,this.currentPicker=new L.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new ee.ChannelzCallTracker,this.childrenTracker=new ee.ChannelzChildrenTracker,"string"!=typeof T)throw TypeError("Channel target must be a string");if(!(S instanceof O.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(R&&"object"!=typeof R)throw TypeError("Channel options must be an object");this.originalTarget=T;let eb=(0,X.parseUri)(T);if(null===eb)throw Error(`Could not parse target name "${T}"`);let e_=(0,$.mapUriDefaultScheme)(eb);if(null===e_)throw Error(`Could not find a default scheme for target name "${T}"`);this.callRefTimer=setInterval(()=>{},eu),null===(er=(et=this.callRefTimer).unref)||void 0===er||er.call(et),0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new ee.ChannelzTrace,this.channelzRef=(0,ee.registerChannelzChannel)(T,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,$.getDefaultAuthority)(e_);let eT=(0,Y.mapProxyName)(e_,R);this.target=eT.target,this.options=Object.assign({},this.options,eT.extraOptions),this.subchannelPool=(0,M.getSubchannelPool)((null!==(en=R["grpc.use_local_subchannel_pool"])&&void 0!==en?en:0)===0),this.retryBufferTracker=new ea.MessageBufferTracker(null!==(ei=R["grpc.retry_buffer_size"])&&void 0!==ei?ei:ef,null!==(eo=R["grpc.per_rpc_retry_buffer_size"])&&void 0!==eo?eo:ep),this.keepaliveTime=null!==(eg=R["grpc.keepalive_time_ms"])&&void 0!==eg?eg:-1,this.idleTimeoutMs=Math.max(null!==(ey=R["grpc.client_idle_timeout_ms"])&&void 0!==ey?ey:ed,ec);let eS={createSubchannel:(T,S)=>{let R=this.subchannelPool.getOrCreateSubchannel(this.target,T,Object.assign({},this.options,S),this.credentials);R.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",R.getChannelzRef());let O=new em(R,this);return this.wrappedSubchannels.add(O),O},updateState:(T,S)=>{this.currentPicker=S;let R=this.pickQueue.slice();for(let T of(this.pickQueue=[],R.length>0&&this.callRefTimerUnref(),R))T.doPick();this.updateState(T)},requestReresolution:()=>{throw Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:T=>{this.channelzEnabled&&this.childrenTracker.refChild(T)},removeChannelzChild:T=>{this.channelzEnabled&&this.childrenTracker.unrefChild(T)}};this.resolvingLoadBalancer=new N.ResolvingLoadBalancer(this.target,eS,R,(T,S)=>{T.retryThrottling?eh.set(this.getTarget(),new ea.RetryThrottler(T.retryThrottling.maxTokens,T.retryThrottling.tokenRatio,eh.get(this.getTarget()))):eh.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=S,this.currentResolutionError=null,process.nextTick(()=>{let T=this.configSelectionQueue;for(let S of(this.configSelectionQueue=[],T.length>0&&this.callRefTimerUnref(),T))S.getConfig()})},T=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+T.code+' and details "'+T.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),null===this.configSelector&&(this.currentResolutionError=Object.assign(Object.assign({},(0,es.restrictControlPlaneStatusCode)(T.code,T.details)),{metadata:T.metadata}));let S=this.configSelectionQueue;for(let R of(this.configSelectionQueue=[],S.length>0&&this.callRefTimerUnref(),S))R.reportResolverError(T)}),this.filterStackFactory=new V.FilterStackFactory([new K.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(R,void 0,2));let eE=Error();(0,Q.trace)(U.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+") Channel constructed \n"+(null===(ev=eE.stack)||void 0===ev?void 0:ev.substring(eE.stack.indexOf("\n")+1))),this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(T,S){(0,Q.trace)(null!=S?S:U.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,X.uriToString)(this.target)+" "+T)}callRefTimerRef(){var T,S,R,O;(null===(S=(T=this.callRefTimer).hasRef)||void 0===S?void 0:S.call(T))||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null===(O=(R=this.callRefTimer).ref)||void 0===O||O.call(R))}callRefTimerUnref(){var T,S;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null===(S=(T=this.callRefTimer).unref)||void 0===S||S.call(T))}removeConnectivityStateWatcher(T){let S=this.connectivityStateWatchers.findIndex(S=>S===T);S>=0&&this.connectivityStateWatchers.splice(S,1)}updateState(T){(0,Q.trace)(U.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,X.uriToString)(this.target)+" "+Z.ConnectivityState[this.connectivityState]+" -> "+Z.ConnectivityState[T]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+Z.ConnectivityState[T]),this.connectivityState=T;let S=this.connectivityStateWatchers.slice();for(let R of S)T!==R.currentState&&(R.timer&&clearTimeout(R.timer),this.removeConnectivityStateWatcher(R),R.callback());T!==Z.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(T){if(T>this.keepaliveTime)for(let S of(this.keepaliveTime=T,this.wrappedSubchannels))S.throttleKeepalive(T)}removeWrappedSubchannel(T){this.wrappedSubchannels.delete(T)}doPick(T,S){return this.currentPicker.pick({metadata:T,extraPickInfo:S})}queueCallForPick(T){this.pickQueue.push(T),this.callRefTimerRef()}getConfig(T,S){return(this.resolvingLoadBalancer.exitIdle(),this.configSelector)?{type:"SUCCESS",config:this.configSelector(T,S)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(T){this.configSelectionQueue.push(T),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(Z.ConnectivityState.IDLE),this.currentPicker=new L.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}startIdleTimeout(T){var S,R;this.idleTimer=setTimeout(()=>{if(this.callCount>0){this.startIdleTimeout(this.idleTimeoutMs);return}let T=new Date,S=T.valueOf()-this.lastActivityTimestamp.valueOf();S>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-S)},T),null===(R=(S=this.idleTimer).unref)||void 0===R||R.call(S)}maybeStartIdleTimer(){this.connectivityState===Z.ConnectivityState.SHUTDOWN||this.idleTimer||this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(T){this.channelzEnabled&&(T.code===U.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(T,S,R,O,N){let M=(0,ei.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+M+'] method="'+S+'"'),new et.LoadBalancingCall(this,T,S,R,O,N,M)}createRetryingCall(T,S,R,O,N){let M=(0,ei.getNextCallNumber)();return this.trace("createRetryingCall ["+M+'] method="'+S+'"'),new ea.RetryingCall(this,T,S,R,O,N,M,this.retryBufferTracker,eh.get(this.getTarget()))}createInnerCall(T,S,R,O,N){return 0===this.options["grpc.enable_retries"]?this.createLoadBalancingCall(T,S,R,O,N):this.createRetryingCall(T,S,R,O,N)}createResolvingCall(T,S,R,O,N){let M=(0,ei.getNextCallNumber)();this.trace("createResolvingCall ["+M+'] method="'+T+'", deadline='+(0,er.deadlineToString)(S));let L={deadline:S,flags:null!=N?N:U.Propagate.DEFAULTS,host:null!=R?R:this.defaultAuthority,parentCall:O},V=new en.ResolvingCall(this,T,L,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),M);return this.onCallStart(),V.addStatusWatcher(T=>{this.onCallEnd(T)}),V}close(){this.resolvingLoadBalancer.destroy(),this.updateState(Z.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,ee.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,X.uriToString)(this.target)}getConnectivityState(T){let S=this.connectivityState;return T&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),S}watchConnectivityState(T,S,R){if(this.connectivityState===Z.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");let O=null;if(S!==1/0){let T=S instanceof Date?S:new Date(S),M=new Date;if(S===-1/0||T<=M){process.nextTick(R,Error("Deadline passed without connectivity state change"));return}O=setTimeout(()=>{this.removeConnectivityStateWatcher(N),R(Error("Deadline passed without connectivity state change"))},T.getTime()-M.getTime())}let N={currentState:T,callback:R,timer:O};this.connectivityStateWatchers.push(N)}getChannelzRef(){return this.channelzRef}createCall(T,S,R,O,N){if("string"!=typeof T)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof S||S instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===Z.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");return this.createResolvingCall(T,S,R,O,N)}}S.InternalChannel=eg},8390:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ChildLoadBalancerHandler=void 0;let O=R(7203),N=R(1360),M="child_load_balancer_helper";class L{constructor(T){this.channelControlHelper=T,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(T){this.parent=T,this.child=null}createSubchannel(T,S){return this.parent.channelControlHelper.createSubchannel(T,S)}updateState(T,S){var R;if(this.calledByPendingChild()){if(T===N.ConnectivityState.CONNECTING)return;null===(R=this.parent.currentChild)||void 0===R||R.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(T,S)}requestReresolution(){var T;let S=null!==(T=this.parent.pendingChild)&&void 0!==T?T:this.parent.currentChild;this.child===S&&this.parent.channelControlHelper.requestReresolution()}setChild(T){this.child=T}addChannelzChild(T){this.parent.channelControlHelper.addChannelzChild(T)}removeChannelzChild(T){this.parent.channelControlHelper.removeChannelzChild(T)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(T,S){return T.getLoadBalancerName()!==S.getLoadBalancerName()}updateAddressList(T,S,R){let N;if(null===this.currentChild||null===this.latestConfig||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,S)){let T=new this.ChildPolicyHelper(this),R=(0,O.createLoadBalancer)(S,T);T.setChild(R),null===this.currentChild?(this.currentChild=R,N=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=R,N=this.pendingChild)}else N=null===this.pendingChild?this.currentChild:this.pendingChild;this.latestConfig=S,N.updateAddressList(T,S,R)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return M}}S.ChildLoadBalancerHandler=L},5683:(T,S,R)=>{"use strict";var O;Object.defineProperty(S,"__esModule",{value:!0}),S.setup=S.OutlierDetectionLoadBalancer=S.OutlierDetectionLoadBalancingConfig=void 0;let N=R(1360),M=R(9238),L=R(9589),U=R(6868),V=R(7203),K=R(8390),$=R(2939),Q=R(2782),Y=R(9609),X=R(8200),Z="outlier_detection";function ee(T){X.trace(M.LogVerbosity.DEBUG,Z,T)}let et="outlier_detection",er=(null!==(O=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)&&void 0!==O?O:"true")==="true",en={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},ei={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function es(T,S,R,O){if(S in T&&typeof T[S]!==R){let N=O?`${O}.${S}`:S;throw Error(`outlier detection config ${N} parse error: expected ${R}, got ${typeof T[S]}`)}}function ea(T,S,R){let O=R?`${R}.${S}`:S;if(S in T){if(!(0,L.isDuration)(T[S]))throw Error(`outlier detection config ${O} parse error: expected Duration, got ${typeof T[S]}`);if(!(T[S].seconds>=0&&T[S].seconds<=315576e6&&T[S].nanos>=0&&T[S].nanos<=999999999))throw Error(`outlier detection config ${O} parse error: values out of range for non-negative Duaration`)}}function eo(T,S,R){let O=R?`${R}.${S}`:S;if(es(T,S,"number",R),S in T&&!(T[S]>=0&&T[S]<=100))throw Error(`outlier detection config ${O} parse error: value out of range for percentage (0-100)`)}class eu{constructor(T,S,R,O,N,M,L){if(this.childPolicy=L,L.length>0&&"pick_first"===L[0].getLoadBalancerName())throw Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=null!=T?T:1e4,this.baseEjectionTimeMs=null!=S?S:3e4,this.maxEjectionTimeMs=null!=R?R:3e5,this.maxEjectionPercent=null!=O?O:10,this.successRateEjection=N?Object.assign(Object.assign({},en),N):null,this.failurePercentageEjection=M?Object.assign(Object.assign({},ei),M):null}getLoadBalancerName(){return et}toJsonObject(){return{interval:(0,L.msToDuration)(this.intervalMs),base_ejection_time:(0,L.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,L.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(T=>T.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(T){return new eu(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,T)}static createFromJson(T){var S;if(ea(T,"interval"),ea(T,"base_ejection_time"),ea(T,"max_ejection_time"),eo(T,"max_ejection_percent"),"success_rate_ejection"in T){if("object"!=typeof T.success_rate_ejection)throw Error("outlier detection config success_rate_ejection must be an object");es(T.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),eo(T.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),es(T.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),es(T.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in T){if("object"!=typeof T.failure_percentage_ejection)throw Error("outlier detection config failure_percentage_ejection must be an object");eo(T.failure_percentage_ejection,"threshold","failure_percentage_ejection"),eo(T.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),es(T.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),es(T.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new eu(T.interval?(0,L.durationToMs)(T.interval):null,T.base_ejection_time?(0,L.durationToMs)(T.base_ejection_time):null,T.max_ejection_time?(0,L.durationToMs)(T.max_ejection_time):null,null!==(S=T.max_ejection_percent)&&void 0!==S?S:null,T.success_rate_ejection,T.failure_percentage_ejection,T.child_policy.map(V.validateLoadBalancingConfig))}}S.OutlierDetectionLoadBalancingConfig=eu;class ec extends Y.BaseSubchannelWrapper{constructor(T,S){super(T),this.mapEntry=S,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=T.getConnectivityState(),T.addConnectivityStateListener((T,S,R,O)=>{if(this.childSubchannelState=R,!this.ejected)for(let T of this.stateListeners)T(this,S,R,O)})}getConnectivityState(){return this.ejected?N.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(T){this.stateListeners.push(T)}removeConnectivityStateListener(T){let S=this.stateListeners.indexOf(T);S>-1&&this.stateListeners.splice(S,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let T=this.mapEntry.subchannelWrappers.indexOf(this);T>=0&&this.mapEntry.subchannelWrappers.splice(T,1)}}eject(){for(let T of(this.ejected=!0,this.stateListeners))T(this,this.childSubchannelState,N.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){for(let T of(this.ejected=!1,this.stateListeners))T(this,N.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}}function ed(){return{success:0,failure:0}}class eh{constructor(){this.activeBucket=ed(),this.inactiveBucket=ed()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=ed()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}}class ef{constructor(T,S){this.wrappedPicker=T,this.countCalls=S}pick(T){let S=this.wrappedPicker.pick(T);if(S.pickResultType!==$.PickResultType.COMPLETE)return S;{let T=S.subchannel,R=T.getMapEntry();if(!R)return Object.assign(Object.assign({},S),{subchannel:T.getWrappedSubchannel()});{let O=S.onCallEnded;return this.countCalls&&(O=T=>{var O;T===M.Status.OK?R.counter.addSuccess():R.counter.addFailure(),null===(O=S.onCallEnded)||void 0===O||O.call(S,T)}),Object.assign(Object.assign({},S),{subchannel:T.getWrappedSubchannel(),onCallEnded:O})}}}}class ep{constructor(T){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new K.ChildLoadBalancerHandler((0,U.createChildChannelControlHelper)(T,{createSubchannel:(S,R)=>{let O=T.createSubchannel(S,R),N=this.addressMap.get((0,Q.subchannelAddressToString)(S)),M=new ec(O,N);return(null==N?void 0:N.currentEjectionTimestamp)!==null&&M.eject(),null==N||N.subchannelWrappers.push(M),M},updateState:(S,R)=>{S===N.ConnectivityState.READY?T.updateState(S,new ef(R,this.isCountingEnabled())):T.updateState(S,R)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return null!==this.latestConfig&&(null!==this.latestConfig.getSuccessRateEjectionConfig()||null!==this.latestConfig.getFailurePercentageEjectionConfig())}getCurrentEjectionPercent(){let T=0;for(let S of this.addressMap.values())null!==S.currentEjectionTimestamp&&(T+=1);return 100*T/this.addressMap.size}runSuccessRateCheck(T){if(!this.latestConfig)return;let S=this.latestConfig.getSuccessRateEjectionConfig();if(!S)return;ee("Running success rate check");let R=S.request_volume,O=0,N=[];for(let[T,S]of this.addressMap){let M=S.counter.getLastSuccesses(),L=S.counter.getLastFailures();ee("Stats for "+T+": successes="+M+" failures="+L+" targetRequestVolume="+R),M+L>=R&&(O+=1,N.push(M/(M+L)))}if(ee("Found "+O+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+N+"]"),O<S.minimum_hosts)return;let M=N.reduce((T,S)=>T+S)/N.length,L=0;for(let T of N){let S=T-M;L+=S*S}let U=L/N.length,V=Math.sqrt(U),K=M-V*(S.stdev_factor/1e3);for(let[O,N]of(ee("stdev="+V+" ejectionThreshold="+K),this.addressMap.entries())){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let M=N.counter.getLastSuccesses(),L=N.counter.getLastFailures();if(M+L<R)continue;let U=M/(M+L);if(ee("Checking candidate "+O+" successRate="+U),U<K){let R=100*Math.random();ee("Candidate "+O+" randomNumber="+R+" enforcement_percentage="+S.enforcement_percentage),R<S.enforcement_percentage&&(ee("Ejecting candidate "+O),this.eject(N,T))}}}runFailurePercentageCheck(T){if(!this.latestConfig)return;let S=this.latestConfig.getFailurePercentageEjectionConfig();if(!S)return;ee("Running failure percentage check. threshold="+S.threshold+" request volume threshold="+S.request_volume);let R=0;for(let T of this.addressMap.values()){let O=T.counter.getLastSuccesses(),N=T.counter.getLastFailures();O+N>=S.request_volume&&(R+=1)}if(!(R<S.minimum_hosts))for(let[R,O]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let N=O.counter.getLastSuccesses(),M=O.counter.getLastFailures();if(ee("Candidate successes="+N+" failures="+M),N+M<S.request_volume)continue;let L=100*M/(M+N);if(L>S.threshold){let N=100*Math.random();ee("Candidate "+R+" randomNumber="+N+" enforcement_percentage="+S.enforcement_percentage),N<S.enforcement_percentage&&(ee("Ejecting candidate "+R),this.eject(O,T))}}}eject(T,S){for(let S of(T.currentEjectionTimestamp=new Date,T.ejectionTimeMultiplier+=1,T.subchannelWrappers))S.eject()}uneject(T){for(let S of(T.currentEjectionTimestamp=null,T.subchannelWrappers))S.uneject()}switchAllBuckets(){for(let T of this.addressMap.values())T.counter.switchBuckets()}startTimer(T){var S,R;this.ejectionTimer=setTimeout(()=>this.runChecks(),T),null===(R=(S=this.ejectionTimer).unref)||void 0===R||R.call(S)}runChecks(){let T=new Date;if(ee("Ejection timer running"),this.switchAllBuckets(),this.latestConfig)for(let[S,R]of(this.timerStartTime=T,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(T),this.runFailurePercentageCheck(T),this.addressMap.entries()))if(null===R.currentEjectionTimestamp)R.ejectionTimeMultiplier>0&&(R.ejectionTimeMultiplier-=1);else{let T=this.latestConfig.getBaseEjectionTimeMs(),O=this.latestConfig.getMaxEjectionTimeMs(),N=new Date(R.currentEjectionTimestamp.getTime());N.setMilliseconds(N.getMilliseconds()+Math.min(T*R.ejectionTimeMultiplier,Math.max(T,O))),N<new Date&&(ee("Unejecting "+S),this.uneject(R))}}updateAddressList(T,S,R){if(!(S instanceof eu))return;let O=new Set;for(let S of T)O.add((0,Q.subchannelAddressToString)(S));for(let T of O)this.addressMap.has(T)||(ee("Adding map entry for "+T),this.addressMap.set(T,{counter:new eh,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let T of this.addressMap.keys())O.has(T)||(ee("Removing map entry for "+T),this.addressMap.delete(T));let N=(0,V.getFirstUsableConfig)(S.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(T,N,R),S.getSuccessRateEjectionConfig()||S.getFailurePercentageEjectionConfig()){if(this.timerStartTime){ee("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let T=S.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(T)}else ee("Starting new timer"),this.timerStartTime=new Date,this.startTimer(S.getIntervalMs()),this.switchAllBuckets()}else for(let T of(ee("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer),this.addressMap.values()))this.uneject(T),T.ejectionTimeMultiplier=0;this.latestConfig=S}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return et}}function em(){er&&(0,U.registerLoadBalancerType)(et,ep,eu)}S.OutlierDetectionLoadBalancer=ep,S.setup=em},2190:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.setup=S.PickFirstLoadBalancer=S.shuffled=S.PickFirstLoadBalancingConfig=void 0;let O=R(7203),N=R(1360),M=R(2939),L=R(8200),U=R(9238),V="pick_first";function K(T){L.trace(U.LogVerbosity.DEBUG,V,T)}let $="pick_first",Q=250;class Y{constructor(T){this.shuffleAddressList=T}getLoadBalancerName(){return $}toJsonObject(){return{[$]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(T){if("shuffleAddressList"in T&&"boolean"!=typeof T.shuffleAddressList)throw Error("pick_first config field shuffleAddressList must be a boolean if provided");return new Y(!0===T.shuffleAddressList)}}S.PickFirstLoadBalancingConfig=Y;class X{constructor(T){this.subchannel=T}pick(T){return{pickResultType:M.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}}function Z(T){let S=T.slice();for(let T=S.length-1;T>1;T--){let R=Math.floor(Math.random()*(T+1)),O=S[T];S[T]=S[R],S[R]=O}return S}S.shuffled=Z;class ee{constructor(T){this.channelControlHelper=T,this.children=[],this.currentState=N.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(T,S,R,O,N)=>{this.onSubchannelStateUpdate(T,S,R,N)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(T=>T.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(N.ConnectivityState.READY,new X(this.currentPick)):0===this.children.length?this.updateState(N.ConnectivityState.IDLE,new M.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(N.ConnectivityState.TRANSIENT_FAILURE,new M.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(N.ConnectivityState.CONNECTING,new M.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){for(let{subchannel:T}of(this.stickyTransientFailureMode=!0,this.children))T.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(null!==this.currentPick){let T=this.currentPick;this.currentPick=null,T.unref(),T.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(T.getChannelzRef())}}onSubchannelStateUpdate(T,S,R,O){var M;if(null===(M=this.currentPick)||void 0===M?void 0:M.realSubchannelEquals(T)){R!==N.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[S,M]of this.children.entries())if(T.realSubchannelEquals(M.subchannel)){R===N.ConnectivityState.READY&&this.pickSubchannel(M.subchannel),R===N.ConnectivityState.TRANSIENT_FAILURE&&(M.hasReportedTransientFailure=!0,O&&(this.lastError=O),this.maybeEnterStickyTransientFailureMode(),S===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(S+1)),M.subchannel.startConnecting();return}}startNextSubchannelConnecting(T){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[S,R]of this.children.entries())if(S>=T){let T=R.subchannel.getConnectivityState();if(T===N.ConnectivityState.IDLE||T===N.ConnectivityState.CONNECTING){this.startConnecting(S);return}}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(T){var S,R;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=T,this.children[T].subchannel.getConnectivityState()===N.ConnectivityState.IDLE&&(K("Start connecting to subchannel with address "+this.children[T].subchannel.getAddress()),process.nextTick(()=>{var S;null===(S=this.children[T])||void 0===S||S.subchannel.startConnecting()})),this.connectionDelayTimeout=null===(R=(S=setTimeout(()=>{this.startNextSubchannelConnecting(T+1)},Q)).unref)||void 0===R?void 0:R.call(S)}pickSubchannel(T){this.currentPick&&T.realSubchannelEquals(this.currentPick)||(K("Pick subchannel with address "+T.getAddress()),this.stickyTransientFailureMode=!1,null!==this.currentPick&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=T,T.ref(),this.channelControlHelper.addChannelzChild(T.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(T,S){K(N.ConnectivityState[this.currentState]+" -> "+N.ConnectivityState[T]),this.currentState=T,this.channelControlHelper.updateState(T,S)}resetSubchannelList(){for(let T of this.children)this.currentPick&&T.subchannel.realSubchannelEquals(this.currentPick)||T.subchannel.removeConnectivityStateListener(this.subchannelStateListener),T.subchannel.unref(),this.channelControlHelper.removeChannelzChild(T.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(T){let S=T.map(T=>({subchannel:this.channelControlHelper.createSubchannel(T,{}),hasReportedTransientFailure:!1}));for(let{subchannel:T}of S)T.ref(),this.channelControlHelper.addChannelzChild(T.getChannelzRef());for(let{subchannel:T}of(this.resetSubchannelList(),this.children=S,this.children))if(T.addConnectivityStateListener(this.subchannelStateListener),T.getConnectivityState()===N.ConnectivityState.READY){this.pickSubchannel(T);return}for(let T of this.children)T.subchannel.getConnectivityState()===N.ConnectivityState.TRANSIENT_FAILURE&&(T.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(T,S){S instanceof Y&&(S.getShuffleAddressList()&&(T=Z(T)),this.latestAddressList=T,this.connectToAddressList(T))}exitIdle(){this.currentState===N.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return $}}function et(){(0,O.registerLoadBalancerType)($,ee,Y),(0,O.registerDefaultLoadBalancerType)($)}S.PickFirstLoadBalancer=ee,S.setup=et},9580:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.setup=S.RoundRobinLoadBalancer=void 0;let O=R(7203),N=R(1360),M=R(2939),L=R(2782),U=R(8200),V=R(9238),K="round_robin";function $(T){U.trace(V.LogVerbosity.DEBUG,K,T)}let Q="round_robin";class Y{getLoadBalancerName(){return Q}constructor(){}toJsonObject(){return{[Q]:{}}}static createFromJson(T){return new Y}}class X{constructor(T,S=0){this.subchannelList=T,this.nextIndex=S}pick(T){let S=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:M.PickResultType.COMPLETE,subchannel:S,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}}class Z{constructor(T){this.channelControlHelper=T,this.subchannels=[],this.currentState=N.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(T,S,R,O,M)=>{this.calculateAndUpdateState(),(R===N.ConnectivityState.TRANSIENT_FAILURE||R===N.ConnectivityState.IDLE)&&(M&&(this.lastError=M),this.channelControlHelper.requestReresolution(),T.startConnecting())}}countSubchannelsWithState(T){return this.subchannels.filter(S=>S.getConnectivityState()===T).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(N.ConnectivityState.READY)>0){let T=this.subchannels.filter(T=>T.getConnectivityState()===N.ConnectivityState.READY),S=0;null!==this.currentReadyPicker&&(S=T.indexOf(this.currentReadyPicker.peekNextSubchannel()))<0&&(S=0),this.updateState(N.ConnectivityState.READY,new X(T,S))}else this.countSubchannelsWithState(N.ConnectivityState.CONNECTING)>0?this.updateState(N.ConnectivityState.CONNECTING,new M.QueuePicker(this)):this.countSubchannelsWithState(N.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(N.ConnectivityState.TRANSIENT_FAILURE,new M.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(N.ConnectivityState.IDLE,new M.QueuePicker(this))}updateState(T,S){$(N.ConnectivityState[this.currentState]+" -> "+N.ConnectivityState[T]),T===N.ConnectivityState.READY?this.currentReadyPicker=S:this.currentReadyPicker=null,this.currentState=T,this.channelControlHelper.updateState(T,S)}resetSubchannelList(){for(let T of this.subchannels)T.removeConnectivityStateListener(this.subchannelStateListener),T.unref(),this.channelControlHelper.removeChannelzChild(T.getChannelzRef());this.subchannels=[]}updateAddressList(T,S){for(let S of(this.resetSubchannelList(),$("Connect to address list "+T.map(T=>(0,L.subchannelAddressToString)(T))),this.subchannels=T.map(T=>this.channelControlHelper.createSubchannel(T,{})),this.subchannels)){S.ref(),S.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(S.getChannelzRef());let T=S.getConnectivityState();(T===N.ConnectivityState.IDLE||T===N.ConnectivityState.TRANSIENT_FAILURE)&&S.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let T of this.subchannels)T.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return Q}}function ee(){(0,O.registerLoadBalancerType)(Q,Z,Y)}S.RoundRobinLoadBalancer=Z,S.setup=ee},7203:(T,S)=>{"use strict";function R(T,S){var R,O,N,M,L,U,V,K,$,Q;return{createSubchannel:null!==(O=null===(R=S.createSubchannel)||void 0===R?void 0:R.bind(S))&&void 0!==O?O:T.createSubchannel.bind(T),updateState:null!==(M=null===(N=S.updateState)||void 0===N?void 0:N.bind(S))&&void 0!==M?M:T.updateState.bind(T),requestReresolution:null!==(U=null===(L=S.requestReresolution)||void 0===L?void 0:L.bind(S))&&void 0!==U?U:T.requestReresolution.bind(T),addChannelzChild:null!==(K=null===(V=S.addChannelzChild)||void 0===V?void 0:V.bind(S))&&void 0!==K?K:T.addChannelzChild.bind(T),removeChannelzChild:null!==(Q=null===($=S.removeChannelzChild)||void 0===$?void 0:$.bind(S))&&void 0!==Q?Q:T.removeChannelzChild.bind(T)}}Object.defineProperty(S,"__esModule",{value:!0}),S.validateLoadBalancingConfig=S.getFirstUsableConfig=S.isLoadBalancerNameRegistered=S.createLoadBalancer=S.registerDefaultLoadBalancerType=S.registerLoadBalancerType=S.createChildChannelControlHelper=void 0,S.createChildChannelControlHelper=R;let O={},N=null;function M(T,S,R){O[T]={LoadBalancer:S,LoadBalancingConfig:R}}function L(T){N=T}function U(T,S){let R=T.getLoadBalancerName();return R in O?new O[R].LoadBalancer(S):null}function V(T){return T in O}function K(T,S=!1){for(let S of T)if(S.getLoadBalancerName() in O)return S;return S&&N?new O[N].LoadBalancingConfig:null}function $(T){if(!(null!==T&&"object"==typeof T))throw Error("Load balancing config must be an object");let S=Object.keys(T);if(1!==S.length)throw Error("Provided load balancing config has multiple conflicting entries");let R=S[0];if(R in O)return O[R].LoadBalancingConfig.createFromJson(T[R]);throw Error(`Unrecognized load balancing config name ${R}`)}S.registerLoadBalancerType=M,S.registerDefaultLoadBalancerType=L,S.createLoadBalancer=U,S.isLoadBalancerNameRegistered=V,S.getFirstUsableConfig=K,S.validateLoadBalancingConfig=$},439:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.LoadBalancingCall=void 0;let O=R(1360),N=R(9238),M=R(823),L=R(2908),U=R(2939),V=R(4717),K=R(8200),$=R(6614),Q=R(5158),Y="load_balancing_call";class X{constructor(T,S,R,O,N,M,L){var U,K;this.channel=T,this.callConfig=S,this.methodName=R,this.host=O,this.credentials=N,this.deadline=M,this.callNumber=L,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;let $=this.methodName.split("/"),Q="";$.length>=2&&(Q=$[1]);let Y=null!==(K=null===(U=(0,V.splitHostPort)(this.host))||void 0===U?void 0:U.host)&&void 0!==K?K:"localhost";this.serviceUrl=`https://${Y}/${Q}`}trace(T){K.trace(N.LogVerbosity.DEBUG,Y,"["+this.callNumber+"] "+T)}outputStatus(T,S){var R,O;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+T.code+' details="'+T.details+'"');let N=Object.assign(Object.assign({},T),{progress:S});null===(R=this.listener)||void 0===R||R.onReceiveStatus(N),null===(O=this.onCallEnded)||void 0===O||O.call(this,N.code)}}doPick(){var T,S;if(this.ended)return;if(!this.metadata)throw Error("doPick called before start");this.trace("Pick called");let R=this.channel.doPick(this.metadata,this.callConfig.pickInformation),V=R.subchannel?"("+R.subchannel.getChannelzRef().id+") "+R.subchannel.getAddress():""+R.subchannel;switch(this.trace("Pick result: "+U.PickResultType[R.pickResultType]+" subchannel: "+V+" status: "+(null===(T=R.status)||void 0===T?void 0:T.code)+" "+(null===(S=R.status)||void 0===S?void 0:S.details)),R.pickResultType){case U.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(T=>{var S,U,K;if(this.ended){this.trace("Credentials metadata generation finished after call ended");return}let $=this.metadata.clone();if($.merge(T),$.get("authorization").length>1&&this.outputStatus({code:N.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new L.Metadata},"PROCESSED"),R.subchannel.getConnectivityState()!==O.ConnectivityState.READY){this.trace("Picked subchannel "+V+" has state "+O.ConnectivityState[R.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&$.set("grpc-timeout",(0,M.getDeadlineTimeoutString)(this.deadline));try{this.child=R.subchannel.getRealSubchannel().createCall($,this.host,this.methodName,{onReceiveMetadata:T=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(T)},onReceiveMessage:T=>{this.trace("Received message"),this.listener.onReceiveMessage(T)},onReceiveStatus:T=>{this.trace("Received status"),T.rstCode===Q.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(T,"REFUSED"):this.outputStatus(T,"PROCESSED")}})}catch(T){this.trace("Failed to start call on picked subchannel "+V+" with error "+T.message),this.outputStatus({code:N.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+T.message,metadata:new L.Metadata},"NOT_STARTED");return}null===(U=(S=this.callConfig).onCommitted)||void 0===U||U.call(S),null===(K=R.onCallStarted)||void 0===K||K.call(R),this.onCallEnded=R.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},T=>{let{code:S,details:R}=(0,$.restrictControlPlaneStatusCode)("number"==typeof T.code?T.code:N.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${T.message}`);this.outputStatus({code:S,details:R,metadata:new L.Metadata},"PROCESSED")});break;case U.PickResultType.DROP:let{code:K,details:Y}=(0,$.restrictControlPlaneStatusCode)(R.status.code,R.status.details);setImmediate(()=>{this.outputStatus({code:K,details:Y,metadata:R.status.metadata},"DROP")});break;case U.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:T,details:S}=(0,$.restrictControlPlaneStatusCode)(R.status.code,R.status.details);setImmediate(()=>{this.outputStatus({code:T,details:S,metadata:R.status.metadata},"PROCESSED")})}break;case U.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(T,S){var R;this.trace("cancelWithStatus code: "+T+' details: "'+S+'"'),null===(R=this.child)||void 0===R||R.cancelWithStatus(T,S),this.outputStatus({code:T,details:S,metadata:new L.Metadata},"PROCESSED")}getPeer(){var T,S;return null!==(S=null===(T=this.child)||void 0===T?void 0:T.getPeer())&&void 0!==S?S:this.channel.getTarget()}start(T,S){this.trace("start called"),this.listener=S,this.metadata=T,this.doPick()}sendMessageWithContext(T,S){this.trace("write() called with message of length "+S.length),this.child?this.child.sendMessageWithContext(T,S):this.pendingMessage={context:T,message:S}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(T){throw Error("Method not implemented.")}getCallNumber(){return this.callNumber}}S.LoadBalancingCall=X},8200:(T,S,R)=>{"use strict";var O,N,M,L;Object.defineProperty(S,"__esModule",{value:!0}),S.isTracerEnabled=S.trace=S.log=S.setLoggerVerbosity=S.setLogger=S.getLogger=void 0;let U=R(9238),V=R(7282),K=R(1513).i8,$={error:(T,...S)=>{console.error("E "+T,...S)},info:(T,...S)=>{console.error("I "+T,...S)},debug:(T,...S)=>{console.error("D "+T,...S)}},Q=$,Y=U.LogVerbosity.ERROR,X=null!==(N=null!==(O=process.env.GRPC_NODE_VERBOSITY)&&void 0!==O?O:process.env.GRPC_VERBOSITY)&&void 0!==N?N:"";switch(X.toUpperCase()){case"DEBUG":Y=U.LogVerbosity.DEBUG;break;case"INFO":Y=U.LogVerbosity.INFO;break;case"ERROR":Y=U.LogVerbosity.ERROR;break;case"NONE":Y=U.LogVerbosity.NONE}let Z=()=>Q;S.getLogger=Z;let ee=T=>{Q=T};S.setLogger=ee;let et=T=>{Y=T};S.setLoggerVerbosity=et;let er=(T,...S)=>{let R;if(T>=Y){switch(T){case U.LogVerbosity.DEBUG:R=Q.debug;break;case U.LogVerbosity.INFO:R=Q.info;break;case U.LogVerbosity.ERROR:R=Q.error}R||(R=Q.error),R&&R.bind(Q)(...S)}};S.log=er;let en=null!==(L=null!==(M=process.env.GRPC_NODE_TRACE)&&void 0!==M?M:process.env.GRPC_TRACE)&&void 0!==L?L:"",ei=new Set,es=new Set;for(let T of en.split(","))T.startsWith("-")?es.add(T.substring(1)):ei.add(T);let ea=ei.has("all");function eo(T,R,O){eu(R)&&(0,S.log)(T,new Date().toISOString()+" | v"+K+" "+V.pid+" | "+R+" | "+O)}function eu(T){return!es.has(T)&&(ea||ei.has(T))}S.trace=eo,S.isTracerEnabled=eu},7697:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.loadPackageDefinition=S.makeClientConstructor=void 0;let O=R(7307),N={unary:O.Client.prototype.makeUnaryRequest,server_stream:O.Client.prototype.makeServerStreamRequest,client_stream:O.Client.prototype.makeClientStreamRequest,bidi:O.Client.prototype.makeBidiStreamRequest};function M(T){return["__proto__","prototype","constructor"].includes(T)}function L(T,S,R){R||(R={});class L extends O.Client{}return Object.keys(T).forEach(S=>{let R;if(M(S))return;let O=T[S];if("string"==typeof S&&"$"===S.charAt(0))throw Error("Method names cannot start with $");R=O.requestStream?O.responseStream?"bidi":"client_stream":O.responseStream?"server_stream":"unary";let V=O.requestSerialize,K=O.responseDeserialize,$=U(N[R],O.path,V,K);L.prototype[S]=$,Object.assign(L.prototype[S],O),O.originalName&&!M(O.originalName)&&(L.prototype[O.originalName]=L.prototype[S])}),L.service=T,L.serviceName=S,L}function U(T,S,R,O){return function(...N){return T.call(this,S,R,O,...N)}}function V(T){return"format"in T}function K(T){let S={};for(let R in T)if(Object.prototype.hasOwnProperty.call(T,R)){let O=T[R],N=R.split(".");if(N.some(T=>M(T)))continue;let U=N[N.length-1],K=S;for(let T of N.slice(0,-1))K[T]||(K[T]={}),K=K[T];V(O)?K[U]=O:K[U]=L(O,U,{})}return S}S.makeClientConstructor=L,S.loadPackageDefinition=K},2908:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Metadata=void 0;let O=R(8200),N=R(9238),M=R(9006),L=/^[0-9a-z_.-]+$/,U=/^[ -~]*$/;function V(T){return L.test(T)}function K(T){return U.test(T)}function $(T){return T.endsWith("-bin")}function Q(T){return!T.startsWith("grpc-")}function Y(T){return T.toLowerCase()}function X(T,S){if(!V(T))throw Error('Metadata key "'+T+'" contains illegal characters');if(null!=S){if($(T)){if(!Buffer.isBuffer(S))throw Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(S))throw Error("keys that don't end with '-bin' must have String values");if(!K(S))throw Error('Metadata string value "'+S+'" contains illegal characters')}}}class Z{constructor(T={}){this.internalRepr=new Map,this.options=T}set(T,S){X(T=Y(T),S),this.internalRepr.set(T,[S])}add(T,S){X(T=Y(T),S);let R=this.internalRepr.get(T);void 0===R?this.internalRepr.set(T,[S]):R.push(S)}remove(T){T=Y(T),this.internalRepr.delete(T)}get(T){return T=Y(T),this.internalRepr.get(T)||[]}getMap(){let T={};for(let[S,R]of this.internalRepr)if(R.length>0){let O=R[0];T[S]=Buffer.isBuffer(O)?Buffer.from(O):O}return T}clone(){let T=new Z(this.options),S=T.internalRepr;for(let[T,R]of this.internalRepr){let O=R.map(T=>Buffer.isBuffer(T)?Buffer.from(T):T);S.set(T,O)}return T}merge(T){for(let[S,R]of T.internalRepr){let T=(this.internalRepr.get(S)||[]).concat(R);this.internalRepr.set(S,T)}}setOptions(T){this.options=T}getOptions(){return this.options}toHttp2Headers(){let T={};for(let[S,R]of this.internalRepr)T[S]=R.map(ee);return T}toJSON(){let T={};for(let[S,R]of this.internalRepr)T[S]=R;return T}static fromHttp2Headers(T){let S=new Z;for(let R of Object.keys(T)){if(":"===R.charAt(0))continue;let L=T[R];try{$(R)?Array.isArray(L)?L.forEach(T=>{S.add(R,Buffer.from(T,"base64"))}):void 0!==L&&(Q(R)?L.split(",").forEach(T=>{S.add(R,Buffer.from(T.trim(),"base64"))}):S.add(R,Buffer.from(L,"base64"))):Array.isArray(L)?L.forEach(T=>{S.add(R,T)}):void 0!==L&&S.add(R,L)}catch(S){let T=`Failed to add metadata entry ${R}: ${L}. ${(0,M.getErrorMessage)(S)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,O.log)(N.LogVerbosity.ERROR,T)}}return S}}S.Metadata=Z;let ee=T=>Buffer.isBuffer(T)?T.toString("base64"):T},2939:(T,S,R)=>{"use strict";var O;Object.defineProperty(S,"__esModule",{value:!0}),S.QueuePicker=S.UnavailablePicker=S.PickResultType=void 0;let N=R(2908),M=R(9238);!function(T){T[T.COMPLETE=0]="COMPLETE",T[T.QUEUE=1]="QUEUE",T[T.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",T[T.DROP=3]="DROP"}(O||(S.PickResultType=O={}));class L{constructor(T){this.status=Object.assign({code:M.Status.UNAVAILABLE,details:"No connection established",metadata:new N.Metadata},T)}pick(T){return{pickResultType:O.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}}S.UnavailablePicker=L;class U{constructor(T){this.loadBalancer=T,this.calledExitIdle=!1}pick(T){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:O.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}}S.QueuePicker=U},4988:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.setup=S.DEFAULT_PORT=void 0;let O=R(4755),N=R(9523),M=R(3837),L=R(5914),U=R(9238),V=R(2908),K=R(8200),$=R(9238),Q=R(4717),Y=R(1808),X=R(7257),Z="dns_resolver";function ee(T){K.trace($.LogVerbosity.DEBUG,Z,T)}S.DEFAULT_PORT=443;let et=3e4,er=M.promisify(N.resolveTxt),en=M.promisify(N.lookup);function ei(...T){let S=[];for(let R=0;R<Math.max.apply(null,T.map(T=>T.length));R++)for(let O of T)R<O.length&&S.push(O[R]);return S}class es{constructor(T,R,O){var N,M,L;this.target=T,this.listener=R,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,ee("Resolver constructed for target "+(0,Q.uriToString)(T));let K=(0,Q.splitHostPort)(T.path);null===K?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,Y.isIPv4)(K.host)||(0,Y.isIPv6)(K.host)?(this.ipResult=[{host:K.host,port:null!==(N=K.port)&&void 0!==N?N:S.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=K.host,this.port=null!==(M=K.port)&&void 0!==M?M:S.DEFAULT_PORT),this.percentage=100*Math.random(),1===O["grpc.service_config_disable_resolution"]&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:U.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,Q.uriToString)(this.target)}`,metadata:new V.Metadata};let $={initialDelay:O["grpc.initial_reconnect_backoff_ms"],maxDelay:O["grpc.max_reconnect_backoff_ms"]};this.backoff=new X.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},$),this.backoff.unref(),this.minTimeBetweenResolutionsMs=null!==(L=O["grpc.dns_min_time_between_resolutions_ms"])&&void 0!==L?L:et,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(null!==this.ipResult){this.returnedIpResult||(ee("Returning IP address for target "+(0,Q.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(null===this.dnsHostname)ee("Failed to parse DNS address "+(0,Q.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:U.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,Q.uriToString)(this.target)}`,metadata:new V.Metadata})}),this.stopNextResolutionTimer();else{if(null!==this.pendingLookupPromise)return;ee("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let T=this.dnsHostname;this.pendingLookupPromise=en(T,{all:!0}),this.pendingLookupPromise.then(T=>{if(null===this.pendingLookupPromise)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let S=T.filter(T=>4===T.family),R=T.filter(T=>6===T.family);this.latestLookupResult=ei(R,S).map(T=>({host:T.address,port:+this.port}));let O="["+this.latestLookupResult.map(T=>T.host+":"+T.port).join(",")+"]";if(ee("Resolved addresses for target "+(0,Q.uriToString)(this.target)+": "+O),0===this.latestLookupResult.length){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},T=>{null!==this.pendingLookupPromise&&(ee("Resolution error for target "+(0,Q.uriToString)(this.target)+": "+T.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&null===this.pendingTxtPromise&&(this.pendingTxtPromise=er(T),this.pendingTxtPromise.then(T=>{if(null!==this.pendingTxtPromise){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,L.extractAndSelectServiceConfig)(T,this.percentage)}catch(T){this.latestServiceConfigError={code:U.Status.UNAVAILABLE,details:`Parsing service config failed with error ${T.message}`,metadata:new V.Metadata}}null!==this.latestLookupResult&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},T=>{}))}}startNextResolutionTimer(){var T,S;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=null===(S=(T=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)||void 0===S?void 0:S.call(T),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){null===this.pendingLookupPromise&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){null===this.pendingLookupPromise&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?ee('resolution update delayed by "min time between resolutions" rate limit'):ee("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(T){return T.path}}function ea(){(0,O.registerResolver)("dns",es),(0,O.registerDefaultScheme)("dns")}S.setup=ea},6633:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.setup=void 0;let O=R(1808),N=R(9238),M=R(2908),L=R(4755),U=R(4717),V=R(8200),K="ip_resolver";function $(T){V.trace(N.LogVerbosity.DEBUG,K,T)}let Q="ipv4",Y="ipv6",X=443;class Z{constructor(T,S,R){var L;this.listener=S,this.addresses=[],this.error=null,this.hasReturnedResult=!1,$("Resolver constructed for target "+(0,U.uriToString)(T));let V=[];if(!(T.scheme===Q||T.scheme===Y)){this.error={code:N.Status.UNAVAILABLE,details:`Unrecognized scheme ${T.scheme} in IP resolver`,metadata:new M.Metadata};return}let K=T.path.split(",");for(let S of K){let R=(0,U.splitHostPort)(S);if(null===R||T.scheme===Q&&!(0,O.isIPv4)(R.host)||T.scheme===Y&&!(0,O.isIPv6)(R.host)){this.error={code:N.Status.UNAVAILABLE,details:`Failed to parse ${T.scheme} address ${S}`,metadata:new M.Metadata};return}V.push({host:R.host,port:null!==(L=R.port)&&void 0!==L?L:X})}this.addresses=V,$("Parsed "+T.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(T){return T.path.split(",")[0]}}function ee(){(0,L.registerResolver)(Q,Z),(0,L.registerResolver)(Y,Z)}S.setup=ee},864:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.setup=void 0;let O=R(4755);class N{constructor(T,S,R){let O;this.listener=S,this.addresses=[],this.hasReturnedResult=!1,O=""===T.authority?"/"+T.path:T.path,this.addresses=[{path:O}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(T){return"localhost"}}function M(){(0,O.registerResolver)("unix",N)}S.setup=M},4755:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.mapUriDefaultScheme=S.getDefaultAuthority=S.createResolver=S.registerDefaultScheme=S.registerResolver=void 0;let O=R(4717),N={},M=null;function L(T,S){N[T]=S}function U(T){M=T}function V(T,S,R){if(void 0!==T.scheme&&T.scheme in N)return new N[T.scheme](T,S,R);throw Error(`No resolver could be created for target ${(0,O.uriToString)(T)}`)}function K(T){if(void 0!==T.scheme&&T.scheme in N)return N[T.scheme].getDefaultAuthority(T);throw Error(`Invalid target ${(0,O.uriToString)(T)}`)}function $(T){return void 0!==T.scheme&&T.scheme in N?T:null!==M?{scheme:M,authority:void 0,path:(0,O.uriToString)(T)}:null}S.registerResolver=L,S.registerDefaultScheme=U,S.createResolver=V,S.getDefaultAuthority=K,S.mapUriDefaultScheme=$},5700:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ResolvingCall=void 0;let O=R(9238),N=R(823),M=R(2908),L=R(8200),U=R(6614),V="resolving_call";class K{constructor(T,S,R,M,L,U){this.channel=T,this.method=S,this.filterStackFactory=M,this.credentials=L,this.callNumber=U,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=R.deadline,this.host=R.host,R.parentCall&&(R.flags&O.Propagate.CANCELLATION&&R.parentCall.on("cancelled",()=>{this.cancelWithStatus(O.Status.CANCELLED,"Cancelled by parent call")}),R.flags&O.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+R.parentCall.getDeadline()),this.deadline=(0,N.minDeadline)(this.deadline,R.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(T){L.trace(O.LogVerbosity.DEBUG,V,"["+this.callNumber+"] "+T)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,N.deadlineToString)(this.deadline));let T=(0,N.getRelativeTimeout)(this.deadline);if(T!==1/0){this.trace("Deadline will be reached in "+T+"ms");let S=()=>{this.cancelWithStatus(O.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};T<=0?process.nextTick(S):this.deadlineTimer=setTimeout(S,T)}}outputStatus(T){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let S=this.filterStack.receiveTrailers(T);this.trace("ended with status: code="+S.code+' details="'+S.details+'"'),this.statusWatchers.forEach(T=>T(S)),process.nextTick(()=>{var T;null===(T=this.listener)||void 0===T||T.onReceiveStatus(S)})}}sendMessageOnChild(T,S){if(!this.child)throw Error("sendMessageonChild called with child not populated");let R=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:S,flags:T.flags})).then(S=>{this.writeFilterPending=!1,R.sendMessageWithContext(T,S.message),this.pendingHalfClose&&R.halfClose()},T=>{this.cancelWithStatus(T.code,T.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw Error("getConfig called before start");let T=this.channel.getConfig(this.method,this.metadata);if("NONE"===T.type){this.channel.queueCallForConfig(this);return}if("ERROR"===T.type){this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(T.error);return}let S=T.config;if(S.status!==O.Status.OK){let{code:T,details:R}=(0,U.restrictControlPlaneStatusCode)(S.status,"Failed to route call to method "+this.method);this.outputStatus({code:T,details:R,metadata:new M.Metadata});return}if(S.methodConfig.timeout){let T=new Date;T.setSeconds(T.getSeconds()+S.methodConfig.timeout.seconds),T.setMilliseconds(T.getMilliseconds()+S.methodConfig.timeout.nanos/1e6),this.deadline=(0,N.minDeadline)(this.deadline,T),this.runDeadlineTimer()}this.filterStackFactory.push(S.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(T=>{this.child=this.channel.createInnerCall(S,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(T,{onReceiveMetadata:T=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(T))},onReceiveMessage:T=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(T).then(T=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(T),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},T=>{this.cancelWithStatus(T.code,T.details)})},onReceiveStatus:T=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=T:this.outputStatus(T)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},T=>{this.outputStatus(T)})}reportResolverError(T){var S;(null===(S=this.metadata)||void 0===S?void 0:S.getOptions().waitForReady)?this.channel.queueCallForConfig(this):this.outputStatus(T)}cancelWithStatus(T,S){var R;this.trace("cancelWithStatus code: "+T+' details: "'+S+'"'),null===(R=this.child)||void 0===R||R.cancelWithStatus(T,S),this.outputStatus({code:T,details:S,metadata:new M.Metadata})}getPeer(){var T,S;return null!==(S=null===(T=this.child)||void 0===T?void 0:T.getPeer())&&void 0!==S?S:this.channel.getTarget()}start(T,S){this.trace("start called"),this.metadata=T.clone(),this.listener=S,this.getConfig()}sendMessageWithContext(T,S){this.trace("write() called with message of length "+S.length),this.child?this.sendMessageOnChild(T,S):this.pendingMessage={context:T,message:S}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(T){this.credentials=this.credentials.compose(T)}addStatusWatcher(T){this.statusWatchers.push(T)}getCallNumber(){return this.callNumber}}S.ResolvingCall=K},1839:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ResolvingLoadBalancer=void 0;let O=R(7203),N=R(5914),M=R(1360),L=R(4755),U=R(2939),V=R(7257),K=R(9238),$=R(2908),Q=R(8200),Y=R(9238),X=R(4717),Z=R(8390),ee="resolving_load_balancer";function et(T){Q.trace(Y.LogVerbosity.DEBUG,ee,T)}let er=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function en(T,S,R,O){for(let N of R.name)switch(O){case"EMPTY":if(!N.service&&!N.method)return!0;break;case"SERVICE":if(N.service===T&&!N.method)return!0;break;case"SERVICE_AND_METHOD":if(N.service===T&&N.method===S)return!0}return!1}function ei(T,S,R,O){for(let N of R)if(en(T,S,N,O))return N;return null}function es(T){return function(S,R){var O,N;let M=S.split("/").filter(T=>T.length>0),L=null!==(O=M[0])&&void 0!==O?O:"",U=null!==(N=M[1])&&void 0!==N?N:"";if(T&&T.methodConfig)for(let S of er){let R=ei(L,U,T.methodConfig,S);if(R)return{methodConfig:R,pickInformation:{},status:K.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:K.Status.OK,dynamicFilterFactories:[]}}}class ea{constructor(T,S,R,Q,Y){this.target=T,this.channelControlHelper=S,this.onSuccessfulResolution=Q,this.onFailedResolution=Y,this.latestChildState=M.ConnectivityState.IDLE,this.latestChildPicker=new U.QueuePicker(this),this.currentState=M.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,R["grpc.service_config"]?this.defaultServiceConfig=(0,N.validateServiceConfig)(JSON.parse(R["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(M.ConnectivityState.IDLE,new U.QueuePicker(this)),this.childLoadBalancer=new Z.ChildLoadBalancerHandler({createSubchannel:S.createSubchannel.bind(S),requestReresolution:()=>{this.backoffTimeout.isRunning()?(et("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(T,S)=>{this.latestChildState=T,this.latestChildPicker=S,this.updateState(T,S)},addChannelzChild:S.addChannelzChild.bind(S),removeChannelzChild:S.removeChannelzChild.bind(S)}),this.innerResolver=(0,L.createResolver)(T,{onSuccessfulResolution:(T,S,R,N,M)=>{var L;this.backoffTimeout.stop(),this.backoffTimeout.reset();let U=null;null===S?null===R?(this.previousServiceConfig=null,U=this.defaultServiceConfig):null===this.previousServiceConfig?this.handleResolutionFailure(R):U=this.previousServiceConfig:(U=S,this.previousServiceConfig=S);let V=null!==(L=null==U?void 0:U.loadBalancingConfig)&&void 0!==L?L:[],Q=(0,O.getFirstUsableConfig)(V,!0);if(null===Q){this.handleResolutionFailure({code:K.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new $.Metadata});return}this.childLoadBalancer.updateAddressList(T,Q,M);let Y=null!=U?U:this.defaultServiceConfig;this.onSuccessfulResolution(Y,null!=N?N:es(Y))},onError:T=>{this.handleResolutionFailure(T)}},R);let X={initialDelay:R["grpc.initial_reconnect_backoff_ms"],maxDelay:R["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new V.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},X),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===M.ConnectivityState.IDLE&&this.updateState(M.ConnectivityState.CONNECTING,new U.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(T,S){et((0,X.uriToString)(this.target)+" "+M.ConnectivityState[this.currentState]+" -> "+M.ConnectivityState[T]),T===M.ConnectivityState.IDLE&&(S=new U.QueuePicker(this)),this.currentState=T,this.channelControlHelper.updateState(T,S)}handleResolutionFailure(T){this.latestChildState===M.ConnectivityState.IDLE&&(this.updateState(M.ConnectivityState.TRANSIENT_FAILURE,new U.UnavailablePicker(T)),this.onFailedResolution(T))}exitIdle(){(this.currentState===M.ConnectivityState.IDLE||this.currentState===M.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(T,S){throw Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=M.ConnectivityState.IDLE,this.latestChildPicker=new U.QueuePicker(this),this.currentState=M.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}}S.ResolvingLoadBalancer=ea},7564:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.RetryingCall=S.MessageBufferTracker=S.RetryThrottler=void 0;let O=R(9238),N=R(2908),M=R(8200),L="retrying_call";class U{constructor(T,S,R){this.maxTokens=T,this.tokenRatio=S,R?this.tokens=R.tokens*(T/R.maxTokens):this.tokens=T}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}}S.RetryThrottler=U;class V{constructor(T,S){this.totalLimit=T,this.limitPerCall=S,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(T,S){var R;let O=null!==(R=this.allocatedPerCall.get(S))&&void 0!==R?R:0;return!(this.limitPerCall-O<T)&&!(this.totalLimit-this.totalAllocated<T)&&(this.allocatedPerCall.set(S,O+T),this.totalAllocated+=T,!0)}free(T,S){var R;if(this.totalAllocated<T)throw Error(`Invalid buffer allocation state: call ${S} freed ${T} > total allocated ${this.totalAllocated}`);this.totalAllocated-=T;let O=null!==(R=this.allocatedPerCall.get(S))&&void 0!==R?R:0;if(O<T)throw Error(`Invalid buffer allocation state: call ${S} freed ${T} > allocated for call ${O}`);this.allocatedPerCall.set(S,O-T)}freeAll(T){var S;let R=null!==(S=this.allocatedPerCall.get(T))&&void 0!==S?S:0;if(this.totalAllocated<R)throw Error(`Invalid buffer allocation state: call ${T} allocated ${R} > total allocated ${this.totalAllocated}`);this.totalAllocated-=R,this.allocatedPerCall.delete(T)}}S.MessageBufferTracker=V;let K="grpc-previous-rpc-attempts";class ${constructor(T,S,R,O,N,M,L,U,V){if(this.channel=T,this.callConfig=S,this.methodName=R,this.host=O,this.credentials=N,this.deadline=M,this.callNumber=L,this.bufferTracker=U,this.retryThrottler=V,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,S.methodConfig.retryPolicy){this.state="RETRY";let T=S.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(T.initialBackoff.substring(0,T.initialBackoff.length-1))}else S.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(T){M.trace(O.LogVerbosity.DEBUG,L,"["+this.callNumber+"] "+T)}reportStatus(T){this.trace("ended with status: code="+T.code+' details="'+T.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var S;null===(S=this.listener)||void 0===S||S.onReceiveStatus({code:T.code,details:T.details,metadata:T.metadata})})}cancelWithStatus(T,S){for(let{call:R}of(this.trace("cancelWithStatus code: "+T+' details: "'+S+'"'),this.reportStatus({code:T,details:S,metadata:new N.Metadata}),this.underlyingCalls))R.cancelWithStatus(T,S)}getPeer(){return null!==this.committedCallIndex?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(T){var S;return null!==(S=this.writeBuffer[T-this.writeBufferOffset])&&void 0!==S?S:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if("COMMITTED"!==this.state)return;let T=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let S=this.writeBufferOffset;S<T;S++){let T=this.getBufferEntry(S);T.allocated&&this.bufferTracker.free(T.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(T-this.writeBufferOffset),this.writeBufferOffset=T}commitCall(T){if("COMMITTED"!==this.state&&"COMPLETED"!==this.underlyingCalls[T].state){this.trace("Committing call ["+this.underlyingCalls[T].call.getCallNumber()+"] at index "+T),this.state="COMMITTED",this.committedCallIndex=T;for(let S=0;S<this.underlyingCalls.length;S++)S!==T&&"COMPLETED"!==this.underlyingCalls[S].state&&(this.underlyingCalls[S].state="COMPLETED",this.underlyingCalls[S].call.cancelWithStatus(O.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if("COMMITTED"===this.state)return;let T=-1,S=-1;for(let[R,O]of this.underlyingCalls.entries())"ACTIVE"===O.state&&O.nextMessageToSend>T&&(T=O.nextMessageToSend,S=R);-1===S?this.state="TRANSPARENT_ONLY":this.commitCall(S)}isStatusCodeInList(T,S){return T.some(T=>T===S||T.toString().toLowerCase()===O.Status[S].toLowerCase())}getNextRetryBackoffMs(){var T;let S=null===(T=this.callConfig)||void 0===T?void 0:T.methodConfig.retryPolicy;if(!S)return 0;let R=Math.random()*this.nextRetryBackoffSec*1e3,O=Number(S.maxBackoff.substring(0,S.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*S.backoffMultiplier,O),R}maybeRetryCall(T,S){let R;if("RETRY"!==this.state){S(!1);return}let O=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(O.maxAttempts,5)){S(!1);return}if(null===T)R=this.getNextRetryBackoffMs();else if(T<0){this.state="TRANSPARENT_ONLY",S(!1);return}else R=T,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var T,R;if("RETRY"!==this.state){S(!1);return}(null===(R=null===(T=this.retryThrottler)||void 0===T?void 0:T.canRetryCall())||void 0===R||R)&&(S(!0),this.attempts+=1,this.startNewAttempt())},R)}countActiveCalls(){let T=0;for(let S of this.underlyingCalls)(null==S?void 0:S.state)==="ACTIVE"&&(T+=1);return T}handleProcessedStatus(T,S,R){var O,N,M;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(S),this.reportStatus(T);break;case"HEDGING":if(this.isStatusCodeInList(null!==(O=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)&&void 0!==O?O:[],T.code)){let O;if(null===(N=this.retryThrottler)||void 0===N||N.addCallFailed(),null===R)O=0;else if(R<0){this.state="TRANSPARENT_ONLY",this.commitCall(S),this.reportStatus(T);return}else O=R;setTimeout(()=>{this.maybeStartHedgingAttempt(),0===this.countActiveCalls()&&(this.commitCall(S),this.reportStatus(T))},O)}else this.commitCall(S),this.reportStatus(T);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,T.code)?(null===(M=this.retryThrottler)||void 0===M||M.addCallFailed(),this.maybeRetryCall(R,R=>{R||(this.commitCall(S),this.reportStatus(T))})):(this.commitCall(S),this.reportStatus(T))}}getPushback(T){let S=T.get("grpc-retry-pushback-ms");if(0===S.length)return null;try{return parseInt(S[0])}catch(T){return -1}}handleChildStatus(T,S){var R;if("COMPLETED"===this.underlyingCalls[S].state)return;if(this.trace("state="+this.state+" handling status with progress "+T.progress+" from child ["+this.underlyingCalls[S].call.getCallNumber()+"] in state "+this.underlyingCalls[S].state),this.underlyingCalls[S].state="COMPLETED",T.code===O.Status.OK){null===(R=this.retryThrottler)||void 0===R||R.addCallSucceeded(),this.commitCall(S),this.reportStatus(T);return}if("COMMITTED"===this.state){this.reportStatus(T);return}let N=this.getPushback(T.metadata);switch(T.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(T,S,N):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(S),this.reportStatus(T);break;case"PROCESSED":this.handleProcessedStatus(T,S,N)}}maybeStartHedgingAttempt(){if("HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let T=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(T.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var T,S,R;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),"HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let O=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(O.maxAttempts,5))return;let N=null!==(T=O.hedgingDelay)&&void 0!==T?T:"0s",M=Number(N.substring(0,N.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},1e3*M),null===(R=(S=this.hedgingTimer).unref)||void 0===R||R.call(S)}startNewAttempt(){let T=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+T.getCallNumber()+"] for attempt "+this.attempts);let S=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:T,nextMessageToSend:0});let R=this.attempts-1,O=this.initialMetadata.clone();R>0&&O.set(K,`${R}`);let N=!1;T.start(O,{onReceiveMetadata:O=>{this.trace("Received metadata from child ["+T.getCallNumber()+"]"),this.commitCall(S),N=!0,R>0&&O.set(K,`${R}`),"ACTIVE"===this.underlyingCalls[S].state&&this.listener.onReceiveMetadata(O)},onReceiveMessage:R=>{this.trace("Received message from child ["+T.getCallNumber()+"]"),this.commitCall(S),"ACTIVE"===this.underlyingCalls[S].state&&this.listener.onReceiveMessage(R)},onReceiveStatus:O=>{this.trace("Received status from child ["+T.getCallNumber()+"]"),!N&&R>0&&O.metadata.set(K,`${R}`),this.handleChildStatus(O,S)}}),this.sendNextChildMessage(S),this.readStarted&&T.startRead()}start(T,S){this.trace("start called"),this.listener=S,this.initialMetadata=T,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(T){var S,R;let O=this.underlyingCalls[T],N=O.nextMessageToSend;null===(R=(S=this.getBufferEntry(N)).callback)||void 0===R||R.call(S),this.clearSentMessages(),O.nextMessageToSend+=1,this.sendNextChildMessage(T)}sendNextChildMessage(T){let S=this.underlyingCalls[T];if("COMPLETED"!==S.state&&this.getBufferEntry(S.nextMessageToSend)){let R=this.getBufferEntry(S.nextMessageToSend);switch(R.entryType){case"MESSAGE":S.call.sendMessageWithContext({callback:S=>{this.handleChildWriteCompleted(T)}},R.message.message);break;case"HALF_CLOSE":S.nextMessageToSend+=1,S.call.halfClose()}}}sendMessageWithContext(T,S){var R;this.trace("write() called with message of length "+S.length);let O={message:S,flags:T.flags},N=this.getNextBufferIndex(),M={entryType:"MESSAGE",message:O,allocated:this.bufferTracker.allocate(S.length,this.callNumber)};if(this.writeBuffer.push(M),M.allocated)for(let[O,M]of(null===(R=T.callback)||void 0===R||R.call(T),this.underlyingCalls.entries()))"ACTIVE"===M.state&&M.nextMessageToSend===N&&M.call.sendMessageWithContext({callback:T=>{this.handleChildWriteCompleted(O)}},S);else{if(this.commitCallWithMostMessages(),null===this.committedCallIndex)return;let R=this.underlyingCalls[this.committedCallIndex];M.callback=T.callback,"ACTIVE"===R.state&&R.nextMessageToSend===N&&R.call.sendMessageWithContext({callback:T=>{this.handleChildWriteCompleted(this.committedCallIndex)}},S)}}startRead(){for(let T of(this.trace("startRead called"),this.readStarted=!0,this.underlyingCalls))(null==T?void 0:T.state)==="ACTIVE"&&T.call.startRead()}halfClose(){this.trace("halfClose called");let T=this.getNextBufferIndex();for(let S of(this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1}),this.underlyingCalls))(null==S?void 0:S.state)==="ACTIVE"&&S.nextMessageToSend===T&&(S.nextMessageToSend+=1,S.call.halfClose())}setCredentials(T){throw Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}}S.RetryingCall=$},7574:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Http2ServerCallStream=S.ServerDuplexStreamImpl=S.ServerWritableStreamImpl=S.ServerReadableStreamImpl=S.ServerUnaryCallImpl=void 0;let O=R(2361),N=R(5158),M=R(2781),L=R(9796),U=R(9238),V=R(2908),K=R(272),$=R(8200),Q=R(9006),Y="server_call";function X(T){$.trace(U.LogVerbosity.DEBUG,Y,T)}let Z="grpc-accept-encoding",ee="grpc-encoding",et="grpc-message",er="grpc-status",en="grpc-timeout",ei=/(\d{1,8})\s*([HMSmun])/,es={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},ea={[Z]:"identity,deflate,gzip",[ee]:"identity"},eo={[N.constants.HTTP2_HEADER_STATUS]:N.constants.HTTP_STATUS_OK,[N.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},eu={waitForTrailers:!0};class ec extends O.EventEmitter{constructor(T,S,R){super(),this.call=T,this.metadata=S,this.request=R,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(T){this.call.sendMetadata(T)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}S.ServerUnaryCallImpl=ec;class ed extends M.Readable{constructor(T,S,R,O){super({objectMode:!0}),this.call=T,this.metadata=S,this.deserialize=R,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,O)}_read(T){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(T){this.call.sendMetadata(T)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}S.ServerReadableStreamImpl=ed;class eh extends M.Writable{constructor(T,S,R,O){super({objectMode:!0}),this.call=T,this.metadata=S,this.serialize=R,this.request=O,this.cancelled=!1,this.trailingMetadata=new V.Metadata,this.call.setupSurfaceCall(this),this.on("error",T=>{this.call.sendError(T),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(T){this.call.sendMetadata(T)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(T,S,R){try{let S=this.call.serializeMessage(T);if(!this.call.write(S)){this.call.once("drain",R);return}}catch(T){this.emit("error",{details:(0,Q.getErrorMessage)(T),code:U.Status.INTERNAL})}R()}_final(T){this.call.sendStatus({code:U.Status.OK,details:"OK",metadata:this.trailingMetadata}),T(null)}end(T){return T&&(this.trailingMetadata=T),super.end()}}S.ServerWritableStreamImpl=eh;class ef extends M.Duplex{constructor(T,S,R,O,N){super({objectMode:!0}),this.call=T,this.metadata=S,this.serialize=R,this.deserialize=O,this.cancelled=!1,this.trailingMetadata=new V.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,N),this.on("error",T=>{this.call.sendError(T),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(T){this.call.sendMetadata(T)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(T){return T&&(this.trailingMetadata=T),super.end()}}S.ServerDuplexStreamImpl=ef,ef.prototype._read=ed.prototype._read,ef.prototype._write=eh.prototype._write,ef.prototype._final=eh.prototype._final;class ep extends O.EventEmitter{constructor(T,S,R){super(),this.stream=T,this.handler=S,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=U.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=U.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",T=>{}),this.stream.once("close",()=>{var T;X("Request to method "+(null===(T=this.handler)||void 0===T?void 0:T.path)+" stream closed with rstCode "+this.stream.rstCode),!this.statusSent&&(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:U.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in R&&(this.maxSendMessageSize=R["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in R&&(this.maxReceiveMessageSize=R["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(T,S){let R=T.subarray(5);if("identity"===S)return R;if("deflate"!==S&&"gzip"!==S)return Promise.reject({code:U.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${S}"`});{let T;return T="deflate"===S?L.createInflate():L.createGunzip(),new Promise((S,O)=>{let N=0,M=[];T.on("data",S=>{M.push(S),N+=S.byteLength,-1!==this.maxReceiveMessageSize&&N>this.maxReceiveMessageSize&&(T.destroy(),O({code:U.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxReceiveMessageSize}`}))}),T.on("end",()=>{S(Buffer.concat(M))}),T.write(R),T.end()})}}sendMetadata(T){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let S=T?T.toHttp2Headers():null,R=Object.assign(Object.assign(Object.assign({},eo),ea),S);this.stream.respond(R,eu)}receiveMetadata(T){let S=V.Metadata.fromHttp2Headers(T);$.isTracerEnabled(Y)&&X("Request to "+this.handler.path+" received headers "+JSON.stringify(S.toJSON()));let R=S.get(en);if(R.length>0){let T=R[0].toString().match(ei);if(null===T){let T=Error("Invalid deadline");return T.code=U.Status.OUT_OF_RANGE,this.sendError(T),S}let O=+T[1]*es[T[2]]|0,N=new Date;this.deadline=N.setMilliseconds(N.getMilliseconds()+O),this.deadlineTimer=setTimeout(em,O,this),S.remove(en)}return S.remove(N.constants.HTTP2_HEADER_ACCEPT_ENCODING),S.remove(N.constants.HTTP2_HEADER_TE),S.remove(N.constants.HTTP2_HEADER_CONTENT_TYPE),S.remove("grpc-accept-encoding"),S}receiveUnaryMessage(T){return new Promise((S,R)=>{let{stream:O}=this,N=0,M=this,L=[],V=this.maxReceiveMessageSize;function K(T){if(N+=T.byteLength,-1!==V&&N>V){O.removeListener("data",K),O.removeListener("end",$),O.removeListener("error",$),R({code:U.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${N} vs. ${V})`});return}L.push(T)}function $(V){if(O.removeListener("data",K),O.removeListener("end",$),O.removeListener("error",$),void 0!==V){R({code:U.Status.INTERNAL,details:V.message});return}if(0===N){R({code:U.Status.INTERNAL,details:"received empty unary message"});return}M.emit("receiveMessage");let Q=Buffer.concat(L,N),Y=1===Q.readUInt8(0),X=Y?T:"identity",Z=M.getDecompressedMessage(Q,X);if(Buffer.isBuffer(Z)){S(M.deserializeMessageWithInternalError(Z));return}Z.then(T=>S(M.deserializeMessageWithInternalError(T)),S=>R(S.code?S:{code:U.Status.INTERNAL,details:`Received "grpc-encoding" header "${T}" but ${T} decompression failed`}))}this.stream.on("data",K),this.stream.on("end",$),this.stream.on("error",$)})}async deserializeMessageWithInternalError(T){try{return this.deserializeMessage(T)}catch(T){throw{details:(0,Q.getErrorMessage)(T),code:U.Status.INTERNAL}}}serializeMessage(T){let S=this.handler.serialize(T),R=S.byteLength,O=Buffer.allocUnsafe(R+5);return O.writeUInt8(0,0),O.writeUInt32BE(R,1),S.copy(O,5),O}deserializeMessage(T){return this.handler.deserialize(T)}async sendUnaryMessage(T,S,R,O){if(!this.checkCancelled()){if(void 0===R&&(R=null),T){!Object.prototype.hasOwnProperty.call(T,"metadata")&&R&&(T.metadata=R),this.sendError(T);return}try{let T=this.serializeMessage(S);this.write(T),this.sendStatus({code:U.Status.OK,details:"OK",metadata:R})}catch(T){this.sendError({details:(0,Q.getErrorMessage)(T),code:U.Status.INTERNAL})}}}sendStatus(T){var S,R;if(this.emit("callEnd",T.code),this.emit("streamEnd",T.code===U.Status.OK),!this.checkCancelled()){if(X("Request to method "+(null===(S=this.handler)||void 0===S?void 0:S.path)+" ended with status code: "+U.Status[T.code]+" details: "+T.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var S;let R=Object.assign({[er]:T.code,[et]:encodeURI(T.details)},null===(S=T.metadata)||void 0===S?void 0:S.toHttp2Headers());this.stream.sendTrailers(R),this.statusSent=!0}),this.stream.end());else{let S=Object.assign(Object.assign({[er]:T.code,[et]:encodeURI(T.details)},eo),null===(R=T.metadata)||void 0===R?void 0:R.toHttp2Headers());this.stream.respond(S,{endStream:!0}),this.statusSent=!0}}}sendError(T){let S={code:U.Status.UNKNOWN,details:"message"in T?T.message:"Unknown Error",metadata:"metadata"in T&&void 0!==T.metadata?T.metadata:null};"code"in T&&"number"==typeof T.code&&Number.isInteger(T.code)&&(S.code=T.code,"details"in T&&"string"==typeof T.details&&(S.details=T.details)),this.sendStatus(S)}write(T){if(!this.checkCancelled()){if(-1!==this.maxSendMessageSize&&T.length>this.maxSendMessageSize){this.sendError({code:U.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${T.length} vs. ${this.maxSendMessageSize})`});return}return this.sendMetadata(),this.emit("sendMessage"),this.stream.write(T)}}resume(){this.stream.resume()}setupSurfaceCall(T){this.once("cancelled",S=>{T.cancelled=!0,T.emit("cancelled",S)}),this.once("callEnd",S=>T.emit("callEnd",S))}setupReadable(T,S){let R=new K.StreamDecoder(this.maxReceiveMessageSize),O=!1,N=!1,M=!1,L=async()=>{M||!O||N||(M=!0,await this.pushOrBufferMessage(T,null))};this.stream.on("data",async O=>{let M;try{M=R.write(O)}catch(T){this.sendError({code:U.Status.RESOURCE_EXHAUSTED,details:T.message});return}for(let R of(N=!0,this.stream.pause(),M)){let O;this.emit("receiveMessage");let N=1===R.readUInt8(0),M=N?S:"identity";try{O=await this.getDecompressedMessage(R,M)}catch(T){this.sendError(T);return}if(!O)return;await this.pushOrBufferMessage(T,O)}N=!1,this.stream.resume(),await L()}),this.stream.once("end",async()=>{O=!0,await L()})}consumeUnpushedMessages(T){for(this.canPush=!0;this.messagesToPush.length>0;){let S=this.messagesToPush.shift(),R=T.push(S);if(null===S||!1===R){this.canPush=!1;break}}return this.canPush}async pushOrBufferMessage(T,S){this.isPushPending?this.bufferedMessages.push(S):await this.pushMessage(T,S)}async pushMessage(T,S){if(null===S){X("Received end of stream"),this.canPush?T.push(null):this.messagesToPush.push(null);return}X("Received message of length "+S.length),this.isPushPending=!0;try{let R=await this.deserializeMessage(S);this.canPush?T.push(R)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(R)}catch(R){this.bufferedMessages.length=0;let S=(0,Q.getErrorCode)(R);(null===S||S<U.Status.OK||S>U.Status.UNAUTHENTICATED)&&(S=U.Status.INTERNAL),T.emit("error",{details:(0,Q.getErrorMessage)(R),code:S})}this.isPushPending=!1,this.bufferedMessages.length>0&&await this.pushMessage(T,this.bufferedMessages.shift())}getPeer(){var T;let S=null===(T=this.stream.session)||void 0===T?void 0:T.socket;return null!=S&&S.remoteAddress?S.remotePort?`${S.remoteAddress}:${S.remotePort}`:S.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}}function em(T){let S=Error("Deadline exceeded");S.code=U.Status.DEADLINE_EXCEEDED,T.sendError(S),T.cancelled=!0,T.emit("cancelled","deadline")}S.Http2ServerCallStream=ep},2501:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ServerCredentials=void 0;let O=R(6801);class N{static createInsecure(){return new M}static createSsl(T,S,R=!1){if(null!==T&&!Buffer.isBuffer(T))throw TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(S))throw TypeError("keyCertPairs must be an array");if("boolean"!=typeof R)throw TypeError("checkClientCertificate must be a boolean");let N=[],M=[];for(let T=0;T<S.length;T++){let R=S[T];if(null===R||"object"!=typeof R)throw TypeError(`keyCertPair[${T}] must be an object`);if(!Buffer.isBuffer(R.private_key))throw TypeError(`keyCertPair[${T}].private_key must be a Buffer`);if(!Buffer.isBuffer(R.cert_chain))throw TypeError(`keyCertPair[${T}].cert_chain must be a Buffer`);N.push(R.cert_chain),M.push(R.private_key)}return new L({ca:T||(0,O.getDefaultRootsData)()||void 0,cert:N,key:M,requestCert:R,ciphers:O.CIPHER_SUITES})}}S.ServerCredentials=N;class M extends N{_isSecure(){return!1}_getSettings(){return null}}class L extends N{constructor(T){super(),this.options=T}_isSecure(){return!0}_getSettings(){return this.options}}},2903:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Server=void 0;let O=R(5158),N=R(9238),M=R(7574),L=R(2501),U=R(4755),V=R(8200),K=R(2782),$=R(4717),Q=R(3316),Y=2147483647,X=2147483647,Z=2e4,{HTTP2_HEADER_PATH:ee}=O.constants,et="server";function er(){}function en(T){return{code:N.Status.UNIMPLEMENTED,details:`The server does not implement the method ${T}`}}function ei(T,S){let R=en(S);switch(T){case"unary":return(T,S)=>{S(R,null)};case"clientStream":return(T,S)=>{S(R,null)};case"serverStream":return T=>{T.emit("error",R)};case"bidi":return T=>{T.emit("error",R)};default:throw Error(`Invalid handlerType ${T}`)}}class es{constructor(T){var S,R,O,N;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new Q.ChannelzTrace,this.callTracker=new Q.ChannelzCallTracker,this.listenerChildrenTracker=new Q.ChannelzChildrenTracker,this.sessionChildrenTracker=new Q.ChannelzChildrenTracker,this.options=null!=T?T:{},0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,Q.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=null!==(S=this.options["grpc.max_connection_age_ms"])&&void 0!==S?S:Y,this.maxConnectionAgeGraceMs=null!==(R=this.options["grpc.max_connection_age_grace_ms"])&&void 0!==R?R:Y,this.keepaliveTimeMs=null!==(O=this.options["grpc.keepalive_time_ms"])&&void 0!==O?O:X,this.keepaliveTimeoutMs=null!==(N=this.options["grpc.keepalive_timeout_ms"])&&void 0!==N?N:Z,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(T){return()=>{var S,R,O;let N;let M=this.sessions.get(T),L=T.socket,U=L.remoteAddress?(0,K.stringToSubchannelAddress)(L.remoteAddress,L.remotePort):null,V=L.localAddress?(0,K.stringToSubchannelAddress)(L.localAddress,L.localPort):null;if(T.encrypted){let T=L,R=T.getCipher(),O=T.getCertificate(),M=T.getPeerCertificate();N={cipherSuiteStandardName:null!==(S=R.standardName)&&void 0!==S?S:null,cipherSuiteOtherName:R.standardName?null:R.name,localCertificate:O&&"raw"in O?O.raw:null,remoteCertificate:M&&"raw"in M?M.raw:null}}else N=null;let $={remoteAddress:U,localAddress:V,security:N,remoteName:null,streamsStarted:M.streamTracker.callsStarted,streamsSucceeded:M.streamTracker.callsSucceeded,streamsFailed:M.streamTracker.callsFailed,messagesSent:M.messagesSent,messagesReceived:M.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:M.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:M.lastMessageSentTimestamp,lastMessageReceivedTimestamp:M.lastMessageReceivedTimestamp,localFlowControlWindow:null!==(R=T.state.localWindowSize)&&void 0!==R?R:null,remoteFlowControlWindow:null!==(O=T.state.remoteWindowSize)&&void 0!==O?O:null};return $}}trace(T){V.trace(N.LogVerbosity.DEBUG,et,"("+this.channelzRef.id+") "+T)}addProtoService(){throw Error("Not implemented. Use addService() instead")}addService(T,S){if(null===T||"object"!=typeof T||null===S||"object"!=typeof S)throw Error("addService() requires two objects as arguments");let R=Object.keys(T);if(0===R.length)throw Error("Cannot add an empty service to a server");R.forEach(R=>{let O,N;let M=T[R];O=M.requestStream?M.responseStream?"bidi":"clientStream":M.responseStream?"serverStream":"unary";let L=S[R];void 0===L&&"string"==typeof M.originalName&&(L=S[M.originalName]),N=void 0!==L?L.bind(S):ei(O,R);let U=this.register(M.path,N,M.responseSerialize,M.requestDeserialize,O);if(!1===U)throw Error(`Method handler for ${M.path} already provided.`)})}removeService(T){if(null===T||"object"!=typeof T)throw Error("removeService() requires object as argument");let S=Object.keys(T);S.forEach(S=>{let R=T[S];this.unregister(R.path)})}bind(T,S){throw Error("Not implemented. Use bindAsync() instead")}bindAsync(T,S,R){if(!0===this.started)throw Error("server is already started");if(this.shutdown)throw Error("bindAsync called after shutdown");if("string"!=typeof T)throw TypeError("port must be a string");if(null===S||!(S instanceof L.ServerCredentials))throw TypeError("creds must be a ServerCredentials object");if("function"!=typeof R)throw TypeError("callback must be a function");let M=(0,$.parseUri)(T);if(null===M)throw Error(`Could not parse port "${T}"`);let Y=(0,U.mapUriDefaultScheme)(M);if(null===Y)throw Error(`Could not get a default scheme for port "${T}"`);let X={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?X.maxSessionMemory=this.options["grpc-node.max_session_memory"]:X.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(X.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let Z=(T,S)=>{process.nextTick(()=>R(T,S))},ee=()=>{let T;if(S._isSecure()){let R=Object.assign(X,S._getSettings());R.enableTrace=1===this.options["grpc-node.tls_enable_trace"],(T=O.createSecureServer(R)).on("secureConnection",T=>{T.on("error",T=>{this.trace("An incoming TLS connection closed with error: "+T.message)})})}else T=O.createServer(X);return T.setTimeout(0,er),this._setupHandlers(T),T},et=(T,S,R)=>0===T.length?Promise.resolve({port:S,count:R}):Promise.all(T.map(T=>{let R;this.trace("Attempting to bind "+(0,K.subchannelAddressToString)(T)),R=(0,K.isTcpSubchannelAddress)(T)?{host:T.host,port:S}:T;let O=ee();return new Promise((N,M)=>{let L=S=>{this.trace("Failed to bind "+(0,K.subchannelAddressToString)(T)+" with error "+S.message),N(S)};O.once("error",L),O.listen(R,()=>{let T;if(this.shutdown){O.close(),N(Error("bindAsync failed because server is shutdown"));return}let R=O.address();T="string"==typeof R?{path:R}:{host:R.address,port:R.port};let M=(0,Q.registerChannelzSocket)((0,K.subchannelAddressToString)(T),()=>({localAddress:T,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(M),this.http2ServerList.push({server:O,channelzRef:M}),this.trace("Successfully bound "+(0,K.subchannelAddressToString)(T)),N("port"in T?T.port:S),O.removeListener("error",L)})})})).then(T=>{let O=0;for(let R of T)if("number"==typeof R&&(O+=1,R!==S))throw Error("Invalid state: multiple port numbers added from single address");return{port:S,count:O+R}}),en=T=>{if(0===T.length)return Promise.resolve({port:0,count:0});let S=T[0],R=ee();return new Promise((O,N)=>{let M=R=>{this.trace("Failed to bind "+(0,K.subchannelAddressToString)(S)+" with error "+R.message),O(en(T.slice(1)))};R.once("error",M),R.listen(S,()=>{if(this.shutdown){R.close(),O({port:0,count:0});return}let S=R.address(),N={host:S.address,port:S.port},L=(0,Q.registerChannelzSocket)((0,K.subchannelAddressToString)(N),()=>({localAddress:N,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(L),this.http2ServerList.push({server:R,channelzRef:L}),this.trace("Successfully bound "+(0,K.subchannelAddressToString)(N)),O(et(T.slice(1),S.port,1)),R.removeListener("error",M)})})},ei={onSuccessfulResolution:(S,R,O)=>{let M;if(ei.onSuccessfulResolution=()=>{},this.shutdown&&Z(Error("bindAsync failed because server is shutdown"),0),0===S.length){Z(Error(`No addresses resolved for port ${T}`),0);return}(M=(0,K.isTcpSubchannelAddress)(S[0])?0===S[0].port?en(S):et(S,S[0].port,0):et(S,1,0)).then(T=>{if(0===T.count){let T=`No address added out of total ${S.length} resolved`;V.log(N.LogVerbosity.ERROR,T),Z(Error(T),0)}else T.count<S.length&&V.log(N.LogVerbosity.INFO,`WARNING Only ${T.count} addresses added out of total ${S.length} resolved`),Z(null,T.port)},T=>{let R=`No address added out of total ${S.length} resolved`;V.log(N.LogVerbosity.ERROR,R),Z(Error(R),0)})},onError:T=>{Z(Error(T.details),0)}},es=(0,U.createResolver)(Y,ei,this.options);es.updateResolution()}forceShutdown(){for(let{server:T,channelzRef:S}of this.http2ServerList)T.listening&&T.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(S),(0,Q.unregisterChannelzRef)(S))});this.started=!1,this.shutdown=!0,this.sessions.forEach((T,S)=>{S.destroy(O.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,Q.unregisterChannelzRef)(this.channelzRef)}register(T,S,R,O,N){return!this.handlers.has(T)&&(this.handlers.set(T,{func:S,serialize:R,deserialize:O,type:N,path:T}),!0)}unregister(T){return this.handlers.delete(T)}start(){if(0===this.http2ServerList.length||this.http2ServerList.every(({server:T})=>!0!==T.listening))throw Error("server must be bound in order to start");if(!0===this.started)throw Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(T){let S=S=>{this.channelzEnabled&&(0,Q.unregisterChannelzRef)(this.channelzRef),T(S)},R=0;function O(){0==--R&&S()}for(let{server:T,channelzRef:S}of(this.started=!1,this.shutdown=!0,this.http2ServerList))T.listening&&(R++,T.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(S),(0,Q.unregisterChannelzRef)(S)),O()}));this.sessions.forEach((T,S)=>{S.closed||(R+=1,S.close(O))}),0===R&&S()}addHttp2Port(){throw Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(T,S){let R=S[O.constants.HTTP2_HEADER_CONTENT_TYPE];return!!("string"==typeof R&&R.startsWith("application/grpc"))||(T.respond({[O.constants.HTTP2_HEADER_STATUS]:O.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1)}_retrieveHandler(T){this.trace("Received call to method "+T+" at address "+this.serverAddressString);let S=this.handlers.get(T);return void 0===S?(this.trace("No handler registered for method "+T+". Sending UNIMPLEMENTED status."),null):S}_respondWithError(T,S,R=null){let O=new M.Http2ServerCallStream(S,null,this.options);void 0===T.code&&(T.code=N.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),null==R||R.streamTracker.addCallFailed()),O.sendError(T)}_channelzHandler(T,S){let R=this.sessions.get(T.session);if(this.callTracker.addCallStarted(),null==R||R.streamTracker.addCallStarted(),!this._verifyContentType(T,S)){this.callTracker.addCallFailed(),null==R||R.streamTracker.addCallFailed();return}let O=S[ee],L=this._retrieveHandler(O);if(!L){this._respondWithError(en(O),T,R);return}let U=new M.Http2ServerCallStream(T,L,this.options);U.once("callEnd",T=>{T===N.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),R&&(U.once("streamEnd",T=>{T?R.streamTracker.addCallSucceeded():R.streamTracker.addCallFailed()}),U.on("sendMessage",()=>{R.messagesSent+=1,R.lastMessageSentTimestamp=new Date}),U.on("receiveMessage",()=>{R.messagesReceived+=1,R.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(U,L,S)||(this.callTracker.addCallFailed(),null==R||R.streamTracker.addCallFailed(),U.sendError({code:N.Status.INTERNAL,details:`Unknown handler type: ${L.type}`}))}_streamHandler(T,S){if(!0!==this._verifyContentType(T,S))return;let R=S[ee],O=this._retrieveHandler(R);if(!O){this._respondWithError(en(R),T,null);return}let L=new M.Http2ServerCallStream(T,O,this.options);this._runHandlerForCall(L,O,S)||L.sendError({code:N.Status.INTERNAL,details:`Unknown handler type: ${O.type}`})}_runHandlerForCall(T,S,R){var O;let N=T.receiveMetadata(R),M=null!==(O=N.get("grpc-encoding")[0])&&void 0!==O?O:"identity";N.remove("grpc-encoding");let{type:L}=S;if("unary"===L)ea(T,S,N,M);else if("clientStream"===L)eo(T,S,N,M);else if("serverStream"===L)eu(T,S,N,M);else{if("bidi"!==L)return!1;ec(T,S,N,M)}return!0}_setupHandlers(T){if(null===T)return;let S=T.address(),R="null";S&&(R="string"==typeof S?S:S.address+":"+S.port),this.serverAddressString=R;let N=this.channelzEnabled?this._channelzHandler:this._streamHandler;T.on("stream",N.bind(this)),T.on("session",T=>{var S,R,N,M,L;if(!this.started){T.destroy();return}let U=(0,Q.registerChannelzSocket)(null!==(S=T.socket.remoteAddress)&&void 0!==S?S:"unknown",this.getChannelzSessionInfoGetter(T),this.channelzEnabled),V={ref:U,streamTracker:new Q.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(T,V);let K=T.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+K),this.sessionChildrenTracker.refChild(U));let $=null,X=null,Z=!1;if(this.maxConnectionAgeMs!==Y){let S=this.maxConnectionAgeMs/10,M=Math.random()*S*2-S;$=null===(N=(R=setTimeout(()=>{var S,R;Z=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+K);try{T.goaway(O.constants.NGHTTP2_NO_ERROR,2147483647,Buffer.from("max_age"))}catch(S){T.destroy();return}T.close(),this.maxConnectionAgeGraceMs!==Y&&(X=null===(R=(S=setTimeout(()=>{T.destroy()},this.maxConnectionAgeGraceMs)).unref)||void 0===R?void 0:R.call(S))},this.maxConnectionAgeMs+M)).unref)||void 0===N?void 0:N.call(R)}let ee=null===(L=(M=setInterval(()=>{var S,R;let O=null===(R=(S=setTimeout(()=>{Z=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+K),T.close()},this.keepaliveTimeoutMs)).unref)||void 0===R?void 0:R.call(S);try{T.ping((T,S,R)=>{clearTimeout(O)})}catch(S){T.destroy()}},this.keepaliveTimeMs)).unref)||void 0===L?void 0:L.call(M);T.on("close",()=>{this.channelzEnabled&&(Z||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+K),this.sessionChildrenTracker.unrefChild(U),(0,Q.unregisterChannelzRef)(U)),$&&clearTimeout($),X&&clearTimeout(X),ee&&clearTimeout(ee),this.sessions.delete(T)})})}}async function ea(T,S,R,O){try{let N=await T.receiveUnaryMessage(O);if(void 0===N||T.cancelled)return;let L=new M.ServerUnaryCallImpl(T,R,N);S.func(L,(S,R,O,N)=>{T.sendUnaryMessage(S,R,O,N)})}catch(S){T.sendError(S)}}function eo(T,S,R,O){let N=new M.ServerReadableStreamImpl(T,R,S.deserialize,O);function L(S,R,O,M){N.destroy(),T.sendUnaryMessage(S,R,O,M)}T.cancelled||(N.on("error",L),S.func(N,L))}async function eu(T,S,R,O){try{let N=await T.receiveUnaryMessage(O);if(void 0===N||T.cancelled)return;let L=new M.ServerWritableStreamImpl(T,R,S.serialize,N);S.func(L)}catch(S){T.sendError(S)}}function ec(T,S,R,O){let N=new M.ServerDuplexStreamImpl(T,R,S.serialize,S.deserialize,O);T.cancelled||S.func(N)}S.Server=es},5914:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.extractAndSelectServiceConfig=S.validateServiceConfig=S.validateRetryThrottling=void 0;let O=R(2037),N=R(9238),M=R(7203),L=/^\d+(\.\d{1,9})?s$/,U="node";function V(T){if("service"in T&&""!==T.service){if("string"!=typeof T.service)throw Error(`Invalid method config name: invalid service: expected type string, got ${typeof T.service}`);if(!("method"in T)||""===T.method)return{service:T.service};if("string"!=typeof T.method)throw Error(`Invalid method config name: invalid method: expected type string, got ${typeof T.service}`);return{service:T.service,method:T.method}}if("method"in T&&void 0!==T.method)throw Error("Invalid method config name: method set with empty or unset service");return{}}function K(T){if(!("maxAttempts"in T)||!Number.isInteger(T.maxAttempts)||T.maxAttempts<2)throw Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in T)||"string"!=typeof T.initialBackoff||!L.test(T.initialBackoff))throw Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in T)||"string"!=typeof T.maxBackoff||!L.test(T.maxBackoff))throw Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in T)||"number"!=typeof T.backoffMultiplier||T.backoffMultiplier<=0)throw Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in T&&Array.isArray(T.retryableStatusCodes)))throw Error("Invalid method config retry policy: retryableStatusCodes is required");if(0===T.retryableStatusCodes.length)throw Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let S of T.retryableStatusCodes)if("number"==typeof S){if(!Object.values(N.Status).includes(S))throw Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if("string"==typeof S){if(!Object.values(N.Status).includes(S.toUpperCase()))throw Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:T.maxAttempts,initialBackoff:T.initialBackoff,maxBackoff:T.maxBackoff,backoffMultiplier:T.backoffMultiplier,retryableStatusCodes:T.retryableStatusCodes}}function $(T){if(!("maxAttempts"in T)||!Number.isInteger(T.maxAttempts)||T.maxAttempts<2)throw Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in T&&("string"!=typeof T.hedgingDelay||!L.test(T.hedgingDelay)))throw Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in T&&Array.isArray(T.nonFatalStatusCodes))for(let S of T.nonFatalStatusCodes)if("number"==typeof S){if(!Object.values(N.Status).includes(S))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if("string"==typeof S){if(!Object.values(N.Status).includes(S.toUpperCase()))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let S={maxAttempts:T.maxAttempts};return T.hedgingDelay&&(S.hedgingDelay=T.hedgingDelay),T.nonFatalStatusCodes&&(S.nonFatalStatusCodes=T.nonFatalStatusCodes),S}function Q(T){var S;let R={name:[]};if(!("name"in T)||!Array.isArray(T.name))throw Error("Invalid method config: invalid name array");for(let S of T.name)R.name.push(V(S));if("waitForReady"in T){if("boolean"!=typeof T.waitForReady)throw Error("Invalid method config: invalid waitForReady");R.waitForReady=T.waitForReady}if("timeout"in T){if("object"==typeof T.timeout){if(!("seconds"in T.timeout)||"number"!=typeof T.timeout.seconds)throw Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in T.timeout)||"number"!=typeof T.timeout.nanos)throw Error("Invalid method config: invalid timeout.nanos");R.timeout=T.timeout}else if("string"==typeof T.timeout&&L.test(T.timeout)){let O=T.timeout.substring(0,T.timeout.length-1).split(".");R.timeout={seconds:0|O[0],nanos:(null!==(S=O[1])&&void 0!==S?S:0)|0}}else throw Error("Invalid method config: invalid timeout")}if("maxRequestBytes"in T){if("number"!=typeof T.maxRequestBytes)throw Error("Invalid method config: invalid maxRequestBytes");R.maxRequestBytes=T.maxRequestBytes}if("maxResponseBytes"in T){if("number"!=typeof T.maxResponseBytes)throw Error("Invalid method config: invalid maxRequestBytes");R.maxResponseBytes=T.maxResponseBytes}if("retryPolicy"in T){if("hedgingPolicy"in T)throw Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");R.retryPolicy=K(T.retryPolicy)}else"hedgingPolicy"in T&&(R.hedgingPolicy=$(T.hedgingPolicy));return R}function Y(T){if(!("maxTokens"in T)||"number"!=typeof T.maxTokens||T.maxTokens<=0||T.maxTokens>1e3)throw Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in T)||"number"!=typeof T.tokenRatio||T.tokenRatio<=0)throw Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+T.maxTokens.toFixed(3),tokenRatio:+T.tokenRatio.toFixed(3)}}function X(T){let S={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in T){if("string"==typeof T.loadBalancingPolicy)S.loadBalancingPolicy=T.loadBalancingPolicy;else throw Error("Invalid service config: invalid loadBalancingPolicy")}if("loadBalancingConfig"in T){if(Array.isArray(T.loadBalancingConfig))for(let R of T.loadBalancingConfig)S.loadBalancingConfig.push((0,M.validateLoadBalancingConfig)(R));else throw Error("Invalid service config: invalid loadBalancingConfig")}if("methodConfig"in T&&Array.isArray(T.methodConfig))for(let R of T.methodConfig)S.methodConfig.push(Q(R));"retryThrottling"in T&&(S.retryThrottling=Y(T.retryThrottling));let R=[];for(let T of S.methodConfig)for(let S of T.name){for(let T of R)if(S.service===T.service&&S.method===T.method)throw Error(`Invalid service config: duplicate name ${S.service}/${S.method}`);R.push(S)}return S}function Z(T){if(!("serviceConfig"in T))throw Error("Invalid service config choice: missing service config");let S={serviceConfig:X(T.serviceConfig)};if("clientLanguage"in T){if(Array.isArray(T.clientLanguage))for(let R of(S.clientLanguage=[],T.clientLanguage))if("string"==typeof R)S.clientLanguage.push(R);else throw Error("Invalid service config choice: invalid clientLanguage");else throw Error("Invalid service config choice: invalid clientLanguage")}if("clientHostname"in T){if(Array.isArray(T.clientHostname))for(let R of(S.clientHostname=[],T.clientHostname))if("string"==typeof R)S.clientHostname.push(R);else throw Error("Invalid service config choice: invalid clientHostname");else throw Error("Invalid service config choice: invalid clientHostname")}if("percentage"in T){if("number"==typeof T.percentage&&0<=T.percentage&&T.percentage<=100)S.percentage=T.percentage;else throw Error("Invalid service config choice: invalid percentage")}let R=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let S in T)if(!R.includes(S))throw Error(`Invalid service config choice: unexpected field ${S}`);return S}function ee(T,S){if(!Array.isArray(T))throw Error("Invalid service config list");for(let R of T){let T=Z(R);if("number"!=typeof T.percentage||!(S>T.percentage)){if(Array.isArray(T.clientHostname)){let S=!1;for(let R of T.clientHostname)R===O.hostname()&&(S=!0);if(!S)continue}if(Array.isArray(T.clientLanguage)){let S=!1;for(let R of T.clientLanguage)R===U&&(S=!0);if(!S)continue}return T.serviceConfig}}throw Error("No matching service config found")}function et(T,S){for(let R of T)if(R.length>0&&R[0].startsWith("grpc_config=")){let T=R.join("").substring(12),O=JSON.parse(T);return ee(O,S)}return null}S.validateRetryThrottling=Y,S.validateServiceConfig=X,S.extractAndSelectServiceConfig=et},9929:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.StatusBuilder=void 0;class R{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(T){return this.code=T,this}withDetails(T){return this.details=T,this}withMetadata(T){return this.metadata=T,this}build(){let T={};return null!==this.code&&(T.code=this.code),null!==this.details&&(T.details=this.details),null!==this.metadata&&(T.metadata=this.metadata),T}}S.StatusBuilder=R},272:(T,S)=>{"use strict";var R;Object.defineProperty(S,"__esModule",{value:!0}),S.StreamDecoder=void 0,function(T){T[T.NO_DATA=0]="NO_DATA",T[T.READING_SIZE=1]="READING_SIZE",T[T.READING_MESSAGE=2]="READING_MESSAGE"}(R||(R={}));class O{constructor(T){this.maxReadMessageLength=T,this.readState=R.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(T){let S,O=0,N=[];for(;O<T.length;)switch(this.readState){case R.NO_DATA:this.readCompressFlag=T.slice(O,O+1),O+=1,this.readState=R.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case R.READING_SIZE:if(S=Math.min(T.length-O,this.readSizeRemaining),T.copy(this.readPartialSize,4-this.readSizeRemaining,O,O+S),this.readSizeRemaining-=S,O+=S,0===this.readSizeRemaining){if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),-1!==this.maxReadMessageLength&&this.readMessageSize>this.maxReadMessageLength)throw Error(`Received message larger than max (${this.readMessageSize} vs ${this.maxReadMessageLength})`);if(this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=R.READING_MESSAGE;else{let T=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=R.NO_DATA,N.push(T)}}break;case R.READING_MESSAGE:if(S=Math.min(T.length-O,this.readMessageRemaining),this.readPartialMessage.push(T.slice(O,O+S)),this.readMessageRemaining-=S,O+=S,0===this.readMessageRemaining){let T=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),S=Buffer.concat(T,this.readMessageSize+5);this.readState=R.NO_DATA,N.push(S)}break;default:throw Error("Unexpected read state")}return N}}S.StreamDecoder=O},2782:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.stringToSubchannelAddress=S.subchannelAddressToString=S.subchannelAddressEqual=S.isTcpSubchannelAddress=void 0;let O=R(1808);function N(T){return"port"in T}function M(T,S){return!T&&!S||!!T&&!!S&&(N(T)?N(S)&&T.host===S.host&&T.port===S.port:!N(S)&&T.path===S.path)}function L(T){return N(T)?T.host+":"+T.port:T.path}S.isTcpSubchannelAddress=N,S.subchannelAddressEqual=M,S.subchannelAddressToString=L;let U=443;function V(T,S){return(0,O.isIP)(T)?{host:T,port:null!=S?S:U}:{path:T}}S.stringToSubchannelAddress=V},2210:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Http2SubchannelCall=void 0;let O=R(5158),N=R(2037),M=R(9238),L=R(2908),U=R(272),V=R(8200),K=R(9238),$="subchannel_call";function Q(T){for(let[S,R]of Object.entries(N.constants.errno))if(R===T)return S;return"Unknown system error "+T}class Y{constructor(T,S,R,N,V){var K;this.http2Stream=T,this.callEventTracker=S,this.listener=R,this.transport=N,this.callId=V,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=M.Status.UNKNOWN,this.finalStatus=null,this.internalError=null;let $=null!==(K=N.getOptions()["grpc.max_receive_message_length"])&&void 0!==K?K:M.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.decoder=new U.StreamDecoder($),T.on("response",(T,S)=>{let R="";for(let S of Object.keys(T))R+="		"+S+": "+T[S]+"\n";switch(this.trace("Received server headers:\n"+R),T[":status"]){case 400:this.mappedStatusCode=M.Status.INTERNAL;break;case 401:this.mappedStatusCode=M.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=M.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=M.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=M.Status.UNAVAILABLE;break;default:this.mappedStatusCode=M.Status.UNKNOWN}if(S&O.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(T);else{let S;try{S=L.Metadata.fromHttp2Headers(T)}catch(T){this.endCall({code:M.Status.UNKNOWN,details:T.message,metadata:new L.Metadata});return}this.listener.onReceiveMetadata(S)}}),T.on("trailers",T=>{this.handleTrailers(T)}),T.on("data",T=>{let S;if(!this.statusOutput){this.trace("receive HTTP/2 data frame of length "+T.length);try{S=this.decoder.write(T)}catch(T){this.cancelWithStatus(M.Status.RESOURCE_EXHAUSTED,T.message);return}for(let T of S)this.trace("parsed message of length "+T.length),this.callEventTracker.addMessageReceived(),this.tryPush(T)}}),T.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),T.on("close",()=>{process.nextTick(()=>{var S;let R;if(this.trace("HTTP/2 stream closed with code "+T.rstCode),(null===(S=this.finalStatus)||void 0===S?void 0:S.code)===M.Status.OK)return;let N="";switch(T.rstCode){case O.constants.NGHTTP2_NO_ERROR:if(null!==this.finalStatus)return;R=M.Status.INTERNAL,N=`Received RST_STREAM with code ${T.rstCode}`;break;case O.constants.NGHTTP2_REFUSED_STREAM:R=M.Status.UNAVAILABLE,N="Stream refused by server";break;case O.constants.NGHTTP2_CANCEL:R=M.Status.CANCELLED,N="Call cancelled";break;case O.constants.NGHTTP2_ENHANCE_YOUR_CALM:R=M.Status.RESOURCE_EXHAUSTED,N="Bandwidth exhausted or memory limit exceeded";break;case O.constants.NGHTTP2_INADEQUATE_SECURITY:R=M.Status.PERMISSION_DENIED,N="Protocol not secure enough";break;case O.constants.NGHTTP2_INTERNAL_ERROR:R=M.Status.INTERNAL,null===this.internalError?N=`Received RST_STREAM with code ${T.rstCode} (Internal server error)`:"ECONNRESET"===this.internalError.code||"ETIMEDOUT"===this.internalError.code?(R=M.Status.UNAVAILABLE,N=this.internalError.message):N=`Received RST_STREAM with code ${T.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:R=M.Status.INTERNAL,N=`Received RST_STREAM with code ${T.rstCode}`}this.endCall({code:R,details:N,metadata:new L.Metadata,rstCode:T.rstCode})})}),T.on("error",T=>{"ERR_HTTP2_STREAM_ERROR"!==T.code&&(this.trace("Node error event: message="+T.message+" code="+T.code+" errno="+Q(T.errno)+" syscall="+T.syscall),this.internalError=T),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:M.Status.UNAVAILABLE,details:"Connection dropped",metadata:new L.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(T){V.trace(K.LogVerbosity.DEBUG,$,"["+this.callId+"] "+T)}endCall(T){(null===this.finalStatus||this.finalStatus.code===M.Status.OK)&&(this.finalStatus=T,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){null===this.finalStatus||this.finalStatus.code===M.Status.OK&&(!this.readsClosed||0!==this.unpushedReadMessages.length||this.isReadFilterPending||this.isPushPending)||this.outputStatus()}push(T){this.trace("pushing to reader message of length "+(T instanceof Buffer?T.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,this.statusOutput||(this.listener.onReceiveMessage(T),this.maybeOutputStatus())})}tryPush(T){this.canPush?(this.http2Stream.pause(),this.push(T)):(this.trace("unpushedReadMessages.push message of length "+T.length),this.unpushedReadMessages.push(T))}handleTrailers(T){let S;this.callEventTracker.onStreamEnd(!0);let R="";for(let S of Object.keys(T))R+="		"+S+": "+T[S]+"\n";this.trace("Received server trailers:\n"+R);try{S=L.Metadata.fromHttp2Headers(T)}catch(T){S=new L.Metadata}let O=S.getMap(),N=this.mappedStatusCode;if(N===M.Status.UNKNOWN&&"string"==typeof O["grpc-status"]){let T=Number(O["grpc-status"]);T in M.Status&&(N=T,this.trace("received status code "+T+" from server")),S.remove("grpc-status")}let U="";if("string"==typeof O["grpc-message"]){try{U=decodeURI(O["grpc-message"])}catch(T){U=O["grpc-message"]}S.remove("grpc-message"),this.trace('received status details string "'+U+'" from server')}let V={code:N,details:U,metadata:S};this.endCall(V)}destroyHttp2Stream(){var T;if(!this.http2Stream.destroyed){let S;S=(null===(T=this.finalStatus)||void 0===T?void 0:T.code)===M.Status.OK?O.constants.NGHTTP2_NO_ERROR:O.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+S),this.http2Stream.close(S)}}cancelWithStatus(T,S){this.trace("cancelWithStatus code: "+T+' details: "'+S+'"'),this.endCall({code:T,details:S,metadata:new L.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(null!==this.finalStatus&&this.finalStatus.code!==M.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let T=this.unpushedReadMessages.shift();this.push(T);return}this.http2Stream.resume()}sendMessageWithContext(T,S){this.trace("write() called with message of length "+S.length);let R=S=>{process.nextTick(()=>{var R;let O=M.Status.UNAVAILABLE;(null==S?void 0:S.code)==="ERR_STREAM_WRITE_AFTER_END"&&(O=M.Status.INTERNAL),S&&this.cancelWithStatus(O,`Write error: ${S.message}`),null===(R=T.callback)||void 0===R||R.call(T)})};this.trace("sending data chunk of length "+S.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(S,R)}catch(T){this.endCall({code:M.Status.UNAVAILABLE,details:`Write failed with error ${T.message}`,metadata:new L.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}}S.Http2SubchannelCall=Y},9609:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.BaseSubchannelWrapper=void 0;class R{constructor(T){this.child=T}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(T){this.child.addConnectivityStateListener(T)}removeConnectivityStateListener(T){this.child.removeConnectivityStateListener(T)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(T){this.child.throttleKeepalive(T)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(T){return this.getRealSubchannel()===T.getRealSubchannel()}}S.BaseSubchannelWrapper=R},8364:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.getSubchannelPool=S.SubchannelPool=void 0;let O=R(332),N=R(3904),M=R(2782),L=R(4717),U=R(6559),V=1e4;class K{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let T=!0;for(let S in this.pool){let R=this.pool[S],O=R.filter(T=>!T.subchannel.unrefIfOneRef());O.length>0&&(T=!1),this.pool[S]=O}T&&null!==this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var T,S;null===this.cleanupTimer&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},V),null===(S=(T=this.cleanupTimer).unref)||void 0===S||S.call(T))}getOrCreateSubchannel(T,S,R,V){this.ensureCleanupTask();let K=(0,L.uriToString)(T);if(K in this.pool){let T=this.pool[K];for(let N of T)if((0,M.subchannelAddressEqual)(S,N.subchannelAddress)&&(0,O.channelOptionsEqual)(R,N.channelArguments)&&V._equals(N.channelCredentials))return N.subchannel}let $=new N.Subchannel(T,S,R,V,new U.Http2SubchannelConnector(T));return K in this.pool||(this.pool[K]=[]),this.pool[K].push({subchannelAddress:S,channelArguments:R,channelCredentials:V,subchannel:$}),$.ref(),$}}S.SubchannelPool=K;let $=new K;function Q(T){return T?$:new K}S.getSubchannelPool=Q},3904:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Subchannel=void 0;let O=R(1360),N=R(7257),M=R(8200),L=R(9238),U=R(4717),V=R(2782),K=R(3316),$="subchannel",Q=2147483647;class Y{constructor(T,S,R,M,L){var U;this.channelTarget=T,this.subchannelAddress=S,this.options=R,this.credentials=M,this.connector=L,this.connectivityState=O.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new K.ChannelzCallTracker,this.childrenTracker=new K.ChannelzChildrenTracker,this.streamTracker=new K.ChannelzCallTracker;let $={initialDelay:R["grpc.initial_reconnect_backoff_ms"],maxDelay:R["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new N.BackoffTimeout(()=>{this.handleBackoffTimer()},$),this.backoffTimeout.unref(),this.subchannelAddressString=(0,V.subchannelAddressToString)(S),this.keepaliveTime=null!==(U=R["grpc.keepalive_time_ms"])&&void 0!==U?U:-1,0===R["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new K.ChannelzTrace,this.channelzRef=(0,K.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(R,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(T){M.trace(L.LogVerbosity.DEBUG,$,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+T)}refTrace(T){M.trace(L.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+T)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([O.ConnectivityState.TRANSIENT_FAILURE],O.ConnectivityState.CONNECTING):this.transitionToState([O.ConnectivityState.TRANSIENT_FAILURE],O.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let T=this.options;if(T["grpc.keepalive_time_ms"]){let S=Math.min(this.keepaliveTime,Q);T=Object.assign(Object.assign({},T),{"grpc.keepalive_time_ms":S})}this.connector.connect(this.subchannelAddress,this.credentials,T).then(T=>{this.transitionToState([O.ConnectivityState.CONNECTING],O.ConnectivityState.READY)?(this.transport=T,this.channelzEnabled&&this.childrenTracker.refChild(T.getChannelzRef()),T.addDisconnectListener(T=>{this.transitionToState([O.ConnectivityState.READY],O.ConnectivityState.IDLE),T&&this.keepaliveTime>0&&(this.keepaliveTime*=2,M.log(L.LogVerbosity.ERROR,`Connection to ${(0,U.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):T.shutdown()},T=>{this.transitionToState([O.ConnectivityState.CONNECTING],O.ConnectivityState.TRANSIENT_FAILURE,`${T}`)})}transitionToState(T,S,R){var N,M;if(-1===T.indexOf(this.connectivityState))return!1;this.trace(O.ConnectivityState[this.connectivityState]+" -> "+O.ConnectivityState[S]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+O.ConnectivityState[S]);let L=this.connectivityState;switch(this.connectivityState=S,S){case O.ConnectivityState.READY:this.stopBackoff();break;case O.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case O.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null===(N=this.transport)||void 0===N||N.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case O.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null===(M=this.transport)||void 0===M||M.shutdown(),this.transport=null;break;default:throw Error(`Invalid state: unknown ConnectivityState ${S}`)}for(let T of this.stateListeners)T(this,L,S,this.keepaliveTime,R);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,0===this.refcount&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,K.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([O.ConnectivityState.CONNECTING,O.ConnectivityState.READY],O.ConnectivityState.IDLE)}))}unrefIfOneRef(){return 1===this.refcount&&(this.unref(),!0)}createCall(T,S,R,O){let N;if(!this.transport)throw Error("Cannot create call, subchannel not READY");return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),N={onCallEnd:T=>{T.code===L.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):N={},this.transport.createCall(T,S,R,O,N)}startConnecting(){process.nextTick(()=>{this.transitionToState([O.ConnectivityState.IDLE],O.ConnectivityState.CONNECTING)||this.connectivityState!==O.ConnectivityState.TRANSIENT_FAILURE||(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(T){this.stateListeners.add(T)}removeConnectivityStateListener(T){this.stateListeners.delete(T)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([O.ConnectivityState.TRANSIENT_FAILURE],O.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(T){return T.getRealSubchannel()===this}throttleKeepalive(T){T>this.keepaliveTime&&(this.keepaliveTime=T)}}S.Subchannel=Y},6801:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.getDefaultRootsData=S.CIPHER_SUITES=void 0;let O=R(7147);S.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;let N=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,M=null;function L(){return N?(null===M&&(M=O.readFileSync(N)),M):null}S.getDefaultRootsData=L},6559:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Http2SubchannelConnector=void 0;let O=R(5158),N=R(4404),M=R(3316),L=R(9238),U=R(8304),V=R(8200),K=R(4755),$=R(2782),Q=R(4717),Y=R(1808),X=R(2210),Z=R(60),ee="transport",et="transport_flowctrl",er=R(1513).i8,{HTTP2_HEADER_AUTHORITY:en,HTTP2_HEADER_CONTENT_TYPE:ei,HTTP2_HEADER_METHOD:es,HTTP2_HEADER_PATH:ea,HTTP2_HEADER_TE:eo,HTTP2_HEADER_USER_AGENT:eu}=O.constants,ec=2e4,ed=Buffer.from("too_many_pings","ascii");class eh{constructor(T,S,R,N){this.session=T,this.options=R,this.remoteName=N,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=ec,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new M.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,$.subchannelAddressToString)(S),0===R["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,M.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[R["grpc.primary_user_agent"],`grpc-node-js/${er}`,R["grpc.secondary_user_agent"]].filter(T=>T).join(" "),"grpc.keepalive_time_ms"in R&&(this.keepaliveTimeMs=R["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in R&&(this.keepaliveTimeoutMs=R["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in R?this.keepaliveWithoutCalls=1===R["grpc.keepalive_permit_without_calls"]:this.keepaliveWithoutCalls=!1,T.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),T.once("goaway",(T,S,R)=>{let N=!1;T===O.constants.NGHTTP2_ENHANCE_YOUR_CALM&&R&&R.equals(ed)&&(N=!0),this.trace("connection closed by GOAWAY with code "+T+" and data "+(null==R?void 0:R.toString())),this.reportDisconnectToOwner(N)}),T.once("error",T=>{this.trace("connection closed with error "+T.message)}),V.isTracerEnabled(ee)&&(T.on("remoteSettings",S=>{this.trace("new settings received"+(this.session!==T?" on the old connection":"")+": "+JSON.stringify(S))}),T.on("localSettings",S=>{this.trace("local settings acknowledged by remote"+(this.session!==T?" on the old connection":"")+": "+JSON.stringify(S))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var T,S,R;let O;let N=this.session.socket,M=N.remoteAddress?(0,$.stringToSubchannelAddress)(N.remoteAddress,N.remotePort):null,L=N.localAddress?(0,$.stringToSubchannelAddress)(N.localAddress,N.localPort):null;if(this.session.encrypted){let S=N,R=S.getCipher(),M=S.getCertificate(),L=S.getPeerCertificate();O={cipherSuiteStandardName:null!==(T=R.standardName)&&void 0!==T?T:null,cipherSuiteOtherName:R.standardName?null:R.name,localCertificate:M&&"raw"in M?M.raw:null,remoteCertificate:L&&"raw"in L?L.raw:null}}else O=null;let U={remoteAddress:M,localAddress:L,security:O,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:null!==(S=this.session.state.localWindowSize)&&void 0!==S?S:null,remoteFlowControlWindow:null!==(R=this.session.state.remoteWindowSize)&&void 0!==R?R:null};return U}trace(T){V.trace(L.LogVerbosity.DEBUG,ee,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+T)}keepaliveTrace(T){V.trace(L.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+T)}flowControlTrace(T){V.trace(L.LogVerbosity.DEBUG,et,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+T)}internalsTrace(T){V.trace(L.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+T)}reportDisconnectToOwner(T){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(S=>S(T)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let T of this.activeCalls)T.onDisconnect()})}addDisconnectListener(T){this.disconnectListeners.push(T)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var T,S;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),null===(S=(T=this.keepaliveTimeoutId).unref)||void 0===S||S.call(T));try{this.session.ping((T,S,R)=>{T&&(this.keepaliveTrace("Ping failed with error "+T.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch(T){this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var T,S;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):this.keepaliveTimerId||this.keepaliveTimeoutId||(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=null===(S=(T=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)||void 0===S?void 0:S.call(T)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(T){this.activeCalls.delete(T),0===this.activeCalls.size&&this.session.unref()}addActiveCall(T){this.activeCalls.add(T),1!==this.activeCalls.size||(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(T,S,R,O,N){let M,L,U;let V=T.toHttp2Headers();V[en]=S,V[eu]=this.userAgent,V[ei]="application/grpc",V[es]="POST",V[ea]=R,V[eo]="trailers";try{M=this.session.request(V)}catch(T){throw this.handleDisconnect(),T}return this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed),this.channelzEnabled?(this.streamTracker.addCallStarted(),L={addMessageSent:()=>{var T;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,null===(T=N.addMessageSent)||void 0===T||T.call(N)},addMessageReceived:()=>{var T;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,null===(T=N.addMessageReceived)||void 0===T||T.call(N)},onCallEnd:T=>{var S;null===(S=N.onCallEnd)||void 0===S||S.call(N,T),this.removeActiveCall(U)},onStreamEnd:T=>{var S;T?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),null===(S=N.onStreamEnd)||void 0===S||S.call(N,T)}}):L={addMessageSent:()=>{var T;null===(T=N.addMessageSent)||void 0===T||T.call(N)},addMessageReceived:()=>{var T;null===(T=N.addMessageReceived)||void 0===T||T.call(N)},onCallEnd:T=>{var S;null===(S=N.onCallEnd)||void 0===S||S.call(N,T),this.removeActiveCall(U)},onStreamEnd:T=>{var S;null===(S=N.onStreamEnd)||void 0===S||S.call(N,T)}},U=new X.Http2SubchannelCall(M,L,O,this,(0,Z.getNextCallNumber)()),this.addActiveCall(U),U}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}getOptions(){return this.options}shutdown(){this.session.close(),(0,M.unregisterChannelzRef)(this.channelzRef)}}class ef{constructor(T){this.channelTarget=T,this.session=null,this.isShutdown=!1}trace(T){V.trace(L.LogVerbosity.DEBUG,ee,(0,Q.uriToString)(this.channelTarget)+" "+T)}createSession(T,S,R,M){return this.isShutdown?Promise.reject():new Promise((L,U)=>{var V,X,Z;let ee;M.realTarget?(ee=(0,Q.uriToString)(M.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,Q.uriToString)(M.realTarget))):(ee=null,this.trace("creating HTTP/2 session to "+(0,$.subchannelAddressToString)(T)));let et=(0,K.getDefaultAuthority)(null!==(V=M.realTarget)&&void 0!==V?V:this.channelTarget),er=S._getConnectionOptions()||{};er.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in R?er.maxSessionMemory=R["grpc-node.max_session_memory"]:er.maxSessionMemory=Number.MAX_SAFE_INTEGER;let en="http://";if("secureContext"in er){if(en="https://",R["grpc.ssl_target_name_override"]){let T=R["grpc.ssl_target_name_override"];er.checkServerIdentity=(S,R)=>(0,N.checkServerIdentity)(T,R),er.servername=T}else{let T=null!==(Z=null===(X=(0,Q.splitHostPort)(et))||void 0===X?void 0:X.host)&&void 0!==Z?Z:"localhost";er.servername=T}M.socket&&(er.createConnection=(T,S)=>M.socket)}else er.createConnection=(S,R)=>M.socket?M.socket:Y.connect(T);er=Object.assign(Object.assign(Object.assign({},er),T),{enableTrace:1===R["grpc-node.tls_enable_trace"]});let ei=O.connect(en+et,er);this.session=ei;let es="Failed to connect";ei.unref(),ei.once("connect",()=>{ei.removeAllListeners(),L(new eh(ei,T,R,ee)),this.session=null}),ei.once("close",()=>{this.session=null,setImmediate(()=>{U(`${es} (${new Date().toISOString()})`)})}),ei.once("error",T=>{es=T.message,this.trace("connection failed with error "+es)})})}connect(T,S,R){var O,M;if(this.isShutdown)return Promise.reject();let L=S._getConnectionOptions()||{};if("secureContext"in L){if(L.ALPNProtocols=["h2"],R["grpc.ssl_target_name_override"]){let T=R["grpc.ssl_target_name_override"];L.checkServerIdentity=(S,R)=>(0,N.checkServerIdentity)(T,R),L.servername=T}else if("grpc.http_connect_target"in R){let T=(0,K.getDefaultAuthority)(null!==(O=(0,Q.parseUri)(R["grpc.http_connect_target"]))&&void 0!==O?O:{path:"localhost"}),S=(0,Q.splitHostPort)(T);L.servername=null!==(M=null==S?void 0:S.host)&&void 0!==M?M:T}R["grpc-node.tls_enable_trace"]&&(L.enableTrace=!0)}return(0,U.getProxiedConnection)(T,R,L).then(O=>this.createSession(T,S,R,O))}shutdown(){var T;this.isShutdown=!0,null===(T=this.session)||void 0===T||T.close(),this.session=null}}S.Http2SubchannelConnector=ef},4717:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.uriToString=S.splitHostPort=S.parseUri=void 0;let R=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function O(T){let S=R.exec(T);return null===S?null:{scheme:S[1],authority:S[2],path:S[3]}}S.parseUri=O;let N=/^\d+$/;function M(T){if(T.startsWith("[")){let S=T.indexOf("]");if(-1===S)return null;let R=T.substring(1,S);if(-1===R.indexOf(":"))return null;if(!(T.length>S+1))return{host:R};if(":"!==T[S+1])return null;{let O=T.substring(S+2);return N.test(O)?{host:R,port:+O}:null}}{let S=T.split(":");return 2!==S.length?{host:T}:N.test(S[1])?{host:S[0],port:+S[1]}:null}}function L(T){let S="";return void 0!==T.scheme&&(S+=T.scheme+":"),void 0!==T.authority&&(S+="//"+T.authority+"/"),S+=T.path}S.splitHostPort=M,S.uriToString=L},8196:(T,S,R)=>{"use strict";var O,N;/**
 * @license
 * Copyright 2018 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */O={value:!0},O=O=S.im=S.J_=O=S.Cp=O=O=void 0;let M=R(9977),L=R(5962),U=R(5307),V=R(9234),K=R(6933);O=K,O=function(T){return"@type"in T&&"string"==typeof T["@type"]},function(T){T.IDEMPOTENCY_UNKNOWN="IDEMPOTENCY_UNKNOWN",T.NO_SIDE_EFFECTS="NO_SIDE_EFFECTS",T.IDEMPOTENT="IDEMPOTENT"}(N=S.Cp||(S.Cp={}));let $={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function Q(T,S){return""===T?S:T+"."+S}function Y(T){return T instanceof L.Service||T instanceof L.Type||T instanceof L.Enum}function X(T){return T instanceof L.Namespace||T instanceof L.Root}function Z(T,S){let R=Q(S,T.name);return Y(T)?[[R,T]]:X(T)&&void 0!==T.nested?Object.keys(T.nested).map(S=>Z(T.nested[S],R)).reduce((T,S)=>T.concat(S),[]):[]}function ee(T,S){return function(R){return T.toObject(T.decode(R),S)}}function et(T){return function(S){if(Array.isArray(S))throw Error(`Failed to serialize message: expected object with ${T.name} structure, got array instead`);let R=T.fromObject(S);return T.encode(R).finish()}}function er(T){return(T||[]).reduce((T,S)=>{for(let[R,O]of Object.entries(S))"uninterpreted_option"===R?T.uninterpreted_option.push(S.uninterpreted_option):T[R]=O;return T},{deprecated:!1,idempotency_level:N.IDEMPOTENCY_UNKNOWN,uninterpreted_option:[]})}function en(T,S,R,O){let N=T.resolvedRequestType,L=T.resolvedResponseType;return{path:"/"+S+"/"+T.name,requestStream:!!T.requestStream,responseStream:!!T.responseStream,requestSerialize:et(N),requestDeserialize:ee(N,R),responseSerialize:et(L),responseDeserialize:ee(L,R),originalName:M(T.name),requestType:es(N,O),responseType:es(L,O),options:er(T.parsedOptions)}}function ei(T,S,R,O){let N={};for(let M of T.methodsArray)N[M.name]=en(M,S,R,O);return N}function es(T,S){let R=T.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:R.$type.toObject(R,$),fileDescriptorProtos:S}}function ea(T,S){let R=T.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:R.$type.toObject(R,$),fileDescriptorProtos:S}}function eo(T,S,R,O){if(T instanceof L.Service)return ei(T,S,R,O);if(T instanceof L.Type)return es(T,O);if(T instanceof L.Enum)return ea(T,O);throw Error("Type mismatch in reflection object handling")}function eu(T,S){let R={};T.resolveAll();let O=T.toDescriptor("proto3").file,N=O.map(T=>Buffer.from(U.FileDescriptorProto.encode(T).finish()));for(let[O,M]of Z(T,""))R[O]=eo(M,O,S,N);return R}function ec(T,S){S=S||{};let R=L.Root.fromDescriptor(T);return R.resolveAll(),eu(R,S)}function ed(T,S){let R=(0,V.loadProtosWithOptionsSync)(T,S);return eu(R,S)}function eh(T,S){S=S||{};let R=L.Root.fromJSON(T);return R.resolveAll(),eu(R,S)}O=function(T,S){return(0,V.loadProtosWithOptions)(T,S).then(T=>eu(T,S))},S.J_=ed,S.im=eh,O=function(T,S){let R=U.FileDescriptorSet.decode(T);return ec(R,S)},O=function(T,S){let R=U.FileDescriptorSet.fromObject(T);return ec(R,S)},(0,V.addCommonProtos)()},9234:(T,S,R)=>{"use strict";/**
 * @license
 * Copyright 2018 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */Object.defineProperty(S,"__esModule",{value:!0}),S.addCommonProtos=S.loadProtosWithOptionsSync=S.loadProtosWithOptions=void 0;let O=R(7147),N=R(1017),M=R(5962);function L(T,S){let R=T.resolvePath;T.resolvePath=(T,M)=>{if(N.isAbsolute(M))return M;for(let T of S){let S=N.join(T,M);try{return O.accessSync(S,O.constants.R_OK),S}catch(T){continue}}return process.emitWarning(`${M} not found in any of the include paths ${S}`),R(T,M)}}async function U(T,S){let R=new M.Root;if((S=S||{}).includeDirs){if(!Array.isArray(S.includeDirs))return Promise.reject(Error("The includeDirs option must be an array"));L(R,S.includeDirs)}let O=await R.load(T,S);return O.resolveAll(),O}function V(T,S){let R=new M.Root;if((S=S||{}).includeDirs){if(!Array.isArray(S.includeDirs))throw Error("The includeDirs option must be an array");L(R,S.includeDirs)}let O=R.loadSync(T,S);return O.resolveAll(),O}function K(){let T=R(6541),S=R(9987),O=R(7674),N=R(3795);M.common("api",T.nested.google.nested.protobuf.nested),M.common("descriptor",S.nested.google.nested.protobuf.nested),M.common("source_context",O.nested.google.nested.protobuf.nested),M.common("type",N.nested.google.nested.protobuf.nested)}S.loadProtosWithOptions=U,S.loadProtosWithOptionsSync=V,S.addCommonProtos=K},8670:T=>{"use strict";function S(T,S){for(var R=Array(arguments.length-1),O=0,N=2,M=!0;N<arguments.length;)R[O++]=arguments[N++];return new Promise(function(N,L){R[O]=function(T){if(M){if(M=!1,T)L(T);else{for(var S=Array(arguments.length-1),R=0;R<S.length;)S[R++]=arguments[R];N.apply(null,S)}}};try{T.apply(S||null,R)}catch(T){M&&(M=!1,L(T))}})}T.exports=S},6009:(T,S)=>{"use strict";var R=S;R.length=function(T){var S=T.length;if(!S)return 0;for(var R=0;--S%4>1&&"="===T.charAt(S);)++R;return Math.ceil(3*T.length)/4-R};for(var O=Array(64),N=Array(123),M=0;M<64;)N[O[M]=M<26?M+65:M<52?M+71:M<62?M-4:M-59|43]=M++;R.encode=function(T,S,R){for(var N,M=null,L=[],U=0,V=0;S<R;){var K=T[S++];switch(V){case 0:L[U++]=O[K>>2],N=(3&K)<<4,V=1;break;case 1:L[U++]=O[N|K>>4],N=(15&K)<<2,V=2;break;case 2:L[U++]=O[N|K>>6],L[U++]=O[63&K],V=0}U>8191&&((M||(M=[])).push(String.fromCharCode.apply(String,L)),U=0)}return(V&&(L[U++]=O[N],L[U++]=61,1===V&&(L[U++]=61)),M)?(U&&M.push(String.fromCharCode.apply(String,L.slice(0,U))),M.join("")):String.fromCharCode.apply(String,L.slice(0,U))};var L="invalid encoding";R.decode=function(T,S,R){for(var O,M=R,U=0,V=0;V<T.length;){var K=T.charCodeAt(V++);if(61===K&&U>1)break;if(void 0===(K=N[K]))throw Error(L);switch(U){case 0:O=K,U=1;break;case 1:S[R++]=O<<2|(48&K)>>4,O=K,U=2;break;case 2:S[R++]=(15&O)<<4|(60&K)>>2,O=K,U=3;break;case 3:S[R++]=(3&O)<<6|K,U=0}}if(1===U)throw Error(L);return R-M},R.test=function(T){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(T)}},7311:T=>{"use strict";function S(T,R){"string"==typeof T&&(R=T,T=void 0);var O=[];function N(T){if("string"!=typeof T){var R=M();if(S.verbose&&console.log("codegen: "+R),R="return "+R,T){for(var L=Object.keys(T),U=Array(L.length+1),V=Array(L.length),K=0;K<L.length;)U[K]=L[K],V[K]=T[L[K++]];return U[K]=R,Function.apply(null,U).apply(null,V)}return Function(R)()}for(var $=Array(arguments.length-1),Q=0;Q<$.length;)$[Q]=arguments[++Q];if(Q=0,T=T.replace(/%([%dfijs])/g,function(T,S){var R=$[Q++];switch(S){case"d":case"f":return String(Number(R));case"i":return String(Math.floor(R));case"j":return JSON.stringify(R);case"s":return String(R)}return"%"}),Q!==$.length)throw Error("parameter count mismatch");return O.push(T),N}function M(S){return"function "+(S||R||"")+"("+(T&&T.join(",")||"")+"){\n  "+O.join("\n  ")+"\n}"}return N.toString=M,N}T.exports=S,S.verbose=!1},107:T=>{"use strict";function S(){this._listeners={}}T.exports=S,S.prototype.on=function(T,S,R){return(this._listeners[T]||(this._listeners[T]=[])).push({fn:S,ctx:R||this}),this},S.prototype.off=function(T,S){if(void 0===T)this._listeners={};else if(void 0===S)this._listeners[T]=[];else for(var R=this._listeners[T],O=0;O<R.length;)R[O].fn===S?R.splice(O,1):++O;return this},S.prototype.emit=function(T){var S=this._listeners[T];if(S){for(var R=[],O=1;O<arguments.length;)R.push(arguments[O++]);for(O=0;O<S.length;)S[O].fn.apply(S[O++].ctx,R)}return this}},2651:(T,S,R)=>{"use strict";T.exports=M;var O=R(8670),N=R(8031)("fs");function M(T,S,R){return("function"==typeof S?(R=S,S={}):S||(S={}),R)?!S.xhr&&N&&N.readFile?N.readFile(T,function(O,N){return O&&"undefined"!=typeof XMLHttpRequest?M.xhr(T,S,R):O?R(O):R(null,S.binary?N:N.toString("utf8"))}):M.xhr(T,S,R):O(M,this,T,S)}M.xhr=function(T,S,R){var O=new XMLHttpRequest;O.onreadystatechange=function(){if(4===O.readyState){if(0!==O.status&&200!==O.status)return R(Error("status "+O.status));if(S.binary){var T=O.response;if(!T){T=[];for(var N=0;N<O.responseText.length;++N)T.push(255&O.responseText.charCodeAt(N))}return R(null,"undefined"!=typeof Uint8Array?new Uint8Array(T):T)}return R(null,O.responseText)}},S.binary&&("overrideMimeType"in O&&O.overrideMimeType("text/plain; charset=x-user-defined"),O.responseType="arraybuffer"),O.open("GET",T),O.send()}},1188:T=>{"use strict";function S(T){return"undefined"!=typeof Float32Array?function(){var S=new Float32Array([-0]),R=new Uint8Array(S.buffer),O=128===R[3];function N(T,O,N){S[0]=T,O[N]=R[0],O[N+1]=R[1],O[N+2]=R[2],O[N+3]=R[3]}function M(T,O,N){S[0]=T,O[N]=R[3],O[N+1]=R[2],O[N+2]=R[1],O[N+3]=R[0]}function L(T,O){return R[0]=T[O],R[1]=T[O+1],R[2]=T[O+2],R[3]=T[O+3],S[0]}function U(T,O){return R[3]=T[O],R[2]=T[O+1],R[1]=T[O+2],R[0]=T[O+3],S[0]}T.writeFloatLE=O?N:M,T.writeFloatBE=O?M:N,T.readFloatLE=O?L:U,T.readFloatBE=O?U:L}():function(){function S(T,S,R,O){var N=S<0?1:0;if(N&&(S=-S),0===S)T(1/S>0?0:2147483648,R,O);else if(isNaN(S))T(2143289344,R,O);else if(S>34028234663852886e22)T((N<<31|2139095040)>>>0,R,O);else if(S<11754943508222875e-54)T((N<<31|Math.round(S/1401298464324817e-60))>>>0,R,O);else{var M=Math.floor(Math.log(S)/Math.LN2),L=8388607&Math.round(S*Math.pow(2,-M)*8388608);T((N<<31|M+127<<23|L)>>>0,R,O)}}function L(T,S,R){var O=T(S,R),N=(O>>31)*2+1,M=O>>>23&255,L=8388607&O;return 255===M?L?NaN:N*(1/0):0===M?1401298464324817e-60*N*L:N*Math.pow(2,M-150)*(L+8388608)}T.writeFloatLE=S.bind(null,R),T.writeFloatBE=S.bind(null,O),T.readFloatLE=L.bind(null,N),T.readFloatBE=L.bind(null,M)}(),"undefined"!=typeof Float64Array?function(){var S=new Float64Array([-0]),R=new Uint8Array(S.buffer),O=128===R[7];function N(T,O,N){S[0]=T,O[N]=R[0],O[N+1]=R[1],O[N+2]=R[2],O[N+3]=R[3],O[N+4]=R[4],O[N+5]=R[5],O[N+6]=R[6],O[N+7]=R[7]}function M(T,O,N){S[0]=T,O[N]=R[7],O[N+1]=R[6],O[N+2]=R[5],O[N+3]=R[4],O[N+4]=R[3],O[N+5]=R[2],O[N+6]=R[1],O[N+7]=R[0]}function L(T,O){return R[0]=T[O],R[1]=T[O+1],R[2]=T[O+2],R[3]=T[O+3],R[4]=T[O+4],R[5]=T[O+5],R[6]=T[O+6],R[7]=T[O+7],S[0]}function U(T,O){return R[7]=T[O],R[6]=T[O+1],R[5]=T[O+2],R[4]=T[O+3],R[3]=T[O+4],R[2]=T[O+5],R[1]=T[O+6],R[0]=T[O+7],S[0]}T.writeDoubleLE=O?N:M,T.writeDoubleBE=O?M:N,T.readDoubleLE=O?L:U,T.readDoubleBE=O?U:L}():function(){function S(T,S,R,O,N,M){var L,U=O<0?1:0;if(U&&(O=-O),0===O)T(0,N,M+S),T(1/O>0?0:2147483648,N,M+R);else if(isNaN(O))T(0,N,M+S),T(2146959360,N,M+R);else if(O>17976931348623157e292)T(0,N,M+S),T((U<<31|2146435072)>>>0,N,M+R);else if(O<22250738585072014e-324)T((L=O/5e-324)>>>0,N,M+S),T((U<<31|L/4294967296)>>>0,N,M+R);else{var V=Math.floor(Math.log(O)/Math.LN2);1024===V&&(V=1023),T(4503599627370496*(L=O*Math.pow(2,-V))>>>0,N,M+S),T((U<<31|V+1023<<20|1048576*L&1048575)>>>0,N,M+R)}}function L(T,S,R,O,N){var M=T(O,N+S),L=T(O,N+R),U=(L>>31)*2+1,V=L>>>20&2047,K=4294967296*(1048575&L)+M;return 2047===V?K?NaN:U*(1/0):0===V?5e-324*U*K:U*Math.pow(2,V-1075)*(K+4503599627370496)}T.writeDoubleLE=S.bind(null,R,0,4),T.writeDoubleBE=S.bind(null,O,4,0),T.readDoubleLE=L.bind(null,N,0,4),T.readDoubleBE=L.bind(null,M,4,0)}(),T}function R(T,S,R){S[R]=255&T,S[R+1]=T>>>8&255,S[R+2]=T>>>16&255,S[R+3]=T>>>24}function O(T,S,R){S[R]=T>>>24,S[R+1]=T>>>16&255,S[R+2]=T>>>8&255,S[R+3]=255&T}function N(T,S){return(T[S]|T[S+1]<<8|T[S+2]<<16|T[S+3]<<24)>>>0}function M(T,S){return(T[S]<<24|T[S+1]<<16|T[S+2]<<8|T[S+3])>>>0}T.exports=S(S)},8031:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},2768:(T,S)=>{"use strict";var R=S,O=R.isAbsolute=function(T){return/^(?:\/|\w+:)/.test(T)},N=R.normalize=function(T){var S=(T=T.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),R=O(T),N="";R&&(N=S.shift()+"/");for(var M=0;M<S.length;)".."===S[M]?M>0&&".."!==S[M-1]?S.splice(--M,2):R?S.splice(M,1):++M:"."===S[M]?S.splice(M,1):++M;return N+S.join("/")};R.resolve=function(T,S,R){return(R||(S=N(S)),O(S))?S:(R||(T=N(T)),(T=T.replace(/(?:\/|^)[^/]+$/,"")).length?N(T+"/"+S):S)}},4314:T=>{"use strict";function S(T,S,R){var O=R||8192,N=O>>>1,M=null,L=O;return function(R){if(R<1||R>N)return T(R);L+R>O&&(M=T(O),L=0);var U=S.call(M,L,L+=R);return 7&L&&(L=(7|L)+1),U}}T.exports=S},7148:(T,S)=>{"use strict";var R=S;R.length=function(T){for(var S=0,R=0,O=0;O<T.length;++O)(R=T.charCodeAt(O))<128?S+=1:R<2048?S+=2:(64512&R)==55296&&(64512&T.charCodeAt(O+1))==56320?(++O,S+=4):S+=3;return S},R.read=function(T,S,R){if(R-S<1)return"";for(var O,N=null,M=[],L=0;S<R;)(O=T[S++])<128?M[L++]=O:O>191&&O<224?M[L++]=(31&O)<<6|63&T[S++]:O>239&&O<365?(O=((7&O)<<18|(63&T[S++])<<12|(63&T[S++])<<6|63&T[S++])-65536,M[L++]=55296+(O>>10),M[L++]=56320+(1023&O)):M[L++]=(15&O)<<12|(63&T[S++])<<6|63&T[S++],L>8191&&((N||(N=[])).push(String.fromCharCode.apply(String,M)),L=0);return N?(L&&N.push(String.fromCharCode.apply(String,M.slice(0,L))),N.join("")):String.fromCharCode.apply(String,M.slice(0,L))},R.write=function(T,S,R){for(var O,N,M=R,L=0;L<T.length;++L)(O=T.charCodeAt(L))<128?S[R++]=O:(O<2048?S[R++]=O>>6|192:((64512&O)==55296&&(64512&(N=T.charCodeAt(L+1)))==56320?(O=65536+((1023&O)<<10)+(1023&N),++L,S[R++]=O>>18|240,S[R++]=O>>12&63|128):S[R++]=O>>12|224,S[R++]=O>>6&63|128),S[R++]=63&O|128);return R-M}},1068:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});var O=R(4831);Object.keys(O).forEach(function(T){"default"===T||S.hasOwnProperty(T)||Object.defineProperty(S,T,{enumerable:!0,get:function(){return O[T]}})})},9977:T=>{var S=1/0,R="[object Symbol]",O=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,N=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,M="\ud800-\udfff",L="\\u0300-\\u036f\\ufe20-\\ufe23",U="\\u20d0-\\u20f0",V="\\u2700-\\u27bf",K="a-z\\xdf-\\xf6\\xf8-\\xff",$="A-Z\\xc0-\\xd6\\xd8-\\xde",Q="\\ufe0e\\ufe0f",Y="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",X="['’]",Z="["+M+"]",ee="["+Y+"]",et="["+L+U+"]",er="\\d+",en="["+V+"]",ei="["+K+"]",es="[^"+M+Y+er+V+K+$+"]",ea="\ud83c[\udffb-\udfff]",eo="[^"+M+"]",eu="(?:\ud83c[\udde6-\uddff]){2}",ec="[\ud800-\udbff][\udc00-\udfff]",ed="["+$+"]",eh="\\u200d",ef="(?:"+ei+"|"+es+")",ep="(?:"+ed+"|"+es+")",em="(?:"+X+"(?:d|ll|m|re|s|t|ve))?",eg="(?:"+X+"(?:D|LL|M|RE|S|T|VE))?",ey="(?:"+et+"|"+ea+")?",ev="["+Q+"]?",eb="(?:"+eh+"(?:"+[eo,eu,ec].join("|")+")"+ev+ey+")*",e_=ev+ey+eb,eT="(?:"+[en,eu,ec].join("|")+")"+e_,eS="(?:"+[eo+et+"?",et,eu,ec,Z].join("|")+")",eE=RegExp(X,"g"),ew=RegExp(et,"g"),eC=RegExp(ea+"(?="+ea+")|"+eS+e_,"g"),eI=RegExp([ed+"?"+ei+"+"+em+"(?="+[ee,ed,"$"].join("|")+")",ep+"+"+eg+"(?="+[ee,ed+ef,"$"].join("|")+")",ed+"?"+ef+"+"+em,ed+"+"+eg,er,eT].join("|"),"g"),eR=RegExp("["+eh+M+L+U+Q+"]"),eA=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,eO={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"ss"},eN="object"==typeof global&&global&&global.Object===Object&&global,ek="object"==typeof self&&self&&self.Object===Object&&self,eP=eN||ek||Function("return this")();function eD(T,S,R,O){var N=-1,M=T?T.length:0;for(O&&M&&(R=T[++N]);++N<M;)R=S(R,T[N],N,T);return R}function eM(T){return T.split("")}function ex(T){return T.match(O)||[]}var eL=function(T){return function(S){return null==T?void 0:T[S]}}(eO);function eF(T){return eR.test(T)}function eU(T){return eA.test(T)}function ej(T){return eF(T)?eB(T):eM(T)}function eB(T){return T.match(eC)||[]}function eV(T){return T.match(eI)||[]}var ez=Object.prototype.toString,eq=eP.Symbol,eH=eq?eq.prototype:void 0,eG=eH?eH.toString:void 0;function eW(T,S,R){var O=-1,N=T.length;S<0&&(S=-S>N?0:N+S),(R=R>N?N:R)<0&&(R+=N),N=S>R?0:R-S>>>0,S>>>=0;for(var M=Array(N);++O<N;)M[O]=T[O+S];return M}function eK(T){if("string"==typeof T)return T;if(eJ(T))return eG?eG.call(T):"";var R=T+"";return"0"==R&&1/T==-S?"-0":R}function e$(T,S,R){var O=T.length;return R=void 0===R?O:R,!S&&R>=O?T:eW(T,S,R)}function eQ(T){return function(S){var R=eF(S=eX(S))?ej(S):void 0,O=R?R[0]:S.charAt(0),N=R?e$(R,1).join(""):S.slice(1);return O[T]()+N}}function eY(T){return!!T&&"object"==typeof T}function eJ(T){return"symbol"==typeof T||eY(T)&&ez.call(T)==R}function eX(T){return null==T?"":eK(T)}var eZ=function(T){return function(S){return eD(e3(e1(S).replace(eE,"")),T,"")}}(function(T,S,R){return S=S.toLowerCase(),T+(R?e0(S):S)});function e0(T){return e2(eX(T).toLowerCase())}function e1(T){return(T=eX(T))&&T.replace(N,eL).replace(ew,"")}var e2=eQ("toUpperCase");function e3(T,S,R){return(T=eX(T),void 0===(S=R?void 0:S))?eU(T)?eV(T):ex(T):T.match(S)||[]}T.exports=eZ},5384:T=>{T.exports={style:{fontFamily:"'__Inter_e8ce0c', '__Inter_Fallback_e8ce0c'",fontStyle:"normal"},className:"__className_e8ce0c"}},7488:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"addBasePath",{enumerable:!0,get:function(){return L}});let O=R(3916),N=R(1920),M="";function L(T,S){return(0,N.normalizePathTrailingSlash)((0,O.addPathPrefix)(T,M))}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},391:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"callServer",{enumerable:!0,get:function(){return N}});let O=R(9918);async function N(T,S){let R=(0,O.getServerActionDispatcher)();if(!R)throw Error("Invariant: missing action dispatcher.");return new Promise((O,N)=>{R({actionId:T,actionArgs:S,resolve:O,reject:N})})}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},7663:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"AppRouterAnnouncer",{enumerable:!0,get:function(){return V}});let O=R(9885),N=R(8908),M="next-route-announcer",L="__next-route-announcer__";function U(){var T;let S=document.getElementsByName(M)[0];if(null==S?void 0:null==(T=S.shadowRoot)?void 0:T.childNodes[0])return S.shadowRoot.childNodes[0];{let T=document.createElement(M);T.style.cssText="position:absolute";let S=document.createElement("div");S.ariaLive="assertive",S.id=L,S.role="alert",S.style.cssText="position:absolute;border:0;height:1px;margin:-1px;padding:0;width:1px;clip:rect(0 0 0 0);overflow:hidden;white-space:nowrap;word-wrap:normal";let R=T.attachShadow({mode:"open"});return R.appendChild(S),document.body.appendChild(T),S}}function V(T){let{tree:S}=T,[R,L]=(0,O.useState)(null);(0,O.useEffect)(()=>{let T=U();return L(T),()=>{let T=document.getElementsByTagName(M)[0];(null==T?void 0:T.isConnected)&&document.body.removeChild(T)}},[]);let[V,K]=(0,O.useState)(""),$=(0,O.useRef)();return(0,O.useEffect)(()=>{let T="";if(document.title)T=document.title;else{let S=document.querySelector("h1");S&&(T=S.innerText||S.textContent||"")}void 0!==$.current&&$.current!==T&&K(T),$.current=T},[S]),R?(0,N.createPortal)(V,R):null}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},2763:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{RSC:function(){return R},ACTION:function(){return O},NEXT_ROUTER_STATE_TREE:function(){return N},NEXT_ROUTER_PREFETCH:function(){return M},NEXT_URL:function(){return L},RSC_CONTENT_TYPE_HEADER:function(){return U},RSC_VARY_HEADER:function(){return V},FLIGHT_PARAMETERS:function(){return K},NEXT_RSC_UNION_QUERY:function(){return $}});let R="RSC",O="Next-Action",N="Next-Router-State-Tree",M="Next-Router-Prefetch",L="Next-Url",U="text/x-component",V=R+", "+N+", "+M+", "+L,K=[[R],[N],[M]],$="_rsc";("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},9918:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{getServerActionDispatcher:function(){return ed},urlToUrlWithoutFlightMarker:function(){return ef},default:function(){return eT}});let O=R(4009),N=O._(R(9885)),M=R(2428),L=R(4635),U=R(6165),V=R(1558),K=R(1736),$=R(7028),Q=R(2057),Y=R(6606),X=R(504),Z=R(7488),ee=R(7663),et=R(1390),er=R(7295),en=R(8897),ei=R(2763),es=R(6671),ea=R(9498),eo=!0,eu=eo?null:new Map,ec=null;function ed(){return ec}let eh={refresh:()=>{}};function ef(T){let S=new URL(T,location.origin);if(S.searchParams.delete(ei.NEXT_RSC_UNION_QUERY),S.pathname.endsWith(".txt")){let{pathname:T}=S,R=T.endsWith("/index.txt")?10:4;S.pathname=T.slice(0,-R)}return S}function ep(T){return T.origin!==window.location.origin}function em(T){let{tree:S,pushRef:R,canonicalUrl:O,sync:M}=T;return(0,N.useInsertionEffect)(()=>{let T={__NA:!0,tree:S};R.pendingPush&&(0,V.createHrefFromUrl)(new URL(window.location.href))!==O?(R.pendingPush=!1,window.history.pushState(T,"",O)):window.history.replaceState(T,"",O),M()},[S,R,O,M]),null}let eg=()=>({status:M.CacheStates.LAZY_INITIALIZED,data:null,subTreeData:null,parallelRoutes:new Map});function ey(T){let S=(0,N.useCallback)(S=>{(0,N.startTransition)(()=>{T({...S,type:U.ACTION_SERVER_ACTION,mutable:{globalMutable:eh},cache:eg()})})},[T]);ec=S}function ev(T){return(0,N.useCallback)((S,R,O)=>{(0,N.startTransition)(()=>{T({type:U.ACTION_SERVER_PATCH,flightData:R,previousTree:S,overrideCanonicalUrl:O,cache:eg(),mutable:{globalMutable:eh}})})},[T])}function eb(T){return(0,N.useCallback)((S,R,O,N)=>{let M=new URL((0,Z.addBasePath)(S),location.href);return eh.pendingNavigatePath=S,T({type:U.ACTION_NAVIGATE,url:M,isExternalUrl:ep(M),locationSearch:location.search,forceOptimisticNavigation:O,shouldScroll:null==N||N,navigateType:R,cache:eg(),mutable:{globalMutable:eh}})},[T])}function e_(T){let{buildId:S,initialHead:R,initialTree:O,initialCanonicalUrl:V,children:Q,assetPrefix:ei}=T,ec=(0,N.useMemo)(()=>(0,Y.createInitialRouterState)({buildId:S,children:Q,initialCanonicalUrl:V,initialTree:O,initialParallelRoutes:eu,isServer:eo,location:eo?null:window.location,initialHead:R}),[S,Q,V,O,R]),[{tree:ed,cache:ef,prefetchCache:e_,pushRef:eT,focusAndScrollRef:eS,canonicalUrl:eE,nextUrl:ew},eC,eI]=(0,$.useReducerWithReduxDevtools)(L.reducer,ec);(0,N.useEffect)(()=>{eu=null},[]);let{searchParams:eR,pathname:eA}=(0,N.useMemo)(()=>{let T=new URL(eE,"http://n");return{searchParams:T.searchParams,pathname:(0,ea.hasBasePath)(T.pathname)?(0,es.removeBasePath)(T.pathname):T.pathname}},[eE]),eO=ev(eC),eN=eb(eC);ey(eC);let ek=(0,N.useMemo)(()=>{let T={back:()=>window.history.back(),forward:()=>window.history.forward(),prefetch:(T,S)=>{if((0,X.isBot)(window.navigator.userAgent))return;let R=new URL((0,Z.addBasePath)(T),location.href);ep(R)||(0,N.startTransition)(()=>{var T;eC({type:U.ACTION_PREFETCH,url:R,kind:null!=(T=null==S?void 0:S.kind)?T:U.PrefetchKind.FULL})})},replace:(T,S)=>{void 0===S&&(S={}),(0,N.startTransition)(()=>{var R;eN(T,"replace",!!S.forceOptimisticNavigation,null==(R=S.scroll)||R)})},push:(T,S)=>{void 0===S&&(S={}),(0,N.startTransition)(()=>{var R;eN(T,"push",!!S.forceOptimisticNavigation,null==(R=S.scroll)||R)})},refresh:()=>{(0,N.startTransition)(()=>{eC({type:U.ACTION_REFRESH,cache:eg(),mutable:{globalMutable:eh},origin:window.location.origin})})},fastRefresh:()=>{throw Error("fastRefresh can only be used in development mode. Please use refresh instead.")}};return T},[eC,eN]);if((0,N.useEffect)(()=>{window.next&&(window.next.router=ek)},[ek]),(0,N.useEffect)(()=>{eh.refresh=ek.refresh},[ek.refresh]),(0,N.useEffect)(()=>{function T(T){var S;T.persisted&&(null==(S=window.history.state)?void 0:S.tree)&&eC({type:U.ACTION_RESTORE,url:new URL(window.location.href),tree:window.history.state.tree})}return window.addEventListener("pageshow",T),()=>{window.removeEventListener("pageshow",T)}},[eC]),eT.mpaNavigation){if(eh.pendingMpaPath!==eE){let T=window.location;eT.pendingPush?T.assign(eE):T.replace(eE),eh.pendingMpaPath=eE}(0,N.use)((0,en.createInfinitePromise)())}let eP=(0,N.useCallback)(T=>{let{state:S}=T;if(S){if(!S.__NA){window.location.reload();return}(0,N.startTransition)(()=>{eC({type:U.ACTION_RESTORE,url:new URL(window.location.href),tree:S.tree})})}},[eC]);(0,N.useEffect)(()=>(window.addEventListener("popstate",eP),()=>{window.removeEventListener("popstate",eP)}),[eP]);let eD=(0,N.useMemo)(()=>(0,er.findHeadInCache)(ef,ed[1]),[ef,ed]),eM=N.default.createElement(et.RedirectBoundary,null,eD,ef.subTreeData,N.default.createElement(ee.AppRouterAnnouncer,{tree:ed}));return N.default.createElement(N.default.Fragment,null,N.default.createElement(em,{tree:ed,pushRef:eT,canonicalUrl:eE,sync:eI}),N.default.createElement(K.PathnameContext.Provider,{value:eA},N.default.createElement(K.SearchParamsContext.Provider,{value:eR},N.default.createElement(M.GlobalLayoutRouterContext.Provider,{value:{buildId:S,changeByServerResponse:eO,tree:ed,focusAndScrollRef:eS,nextUrl:ew}},N.default.createElement(M.AppRouterContext.Provider,{value:ek},N.default.createElement(M.LayoutRouterContext.Provider,{value:{childNodes:ef.parallelRoutes,tree:ed,url:eE}},eM))))))}function eT(T){let{globalErrorComponent:S,...R}=T;return N.default.createElement(Q.ErrorBoundary,{errorComponent:S},N.default.createElement(e_,R))}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},7080:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"bailoutToClientRendering",{enumerable:!0,get:function(){return M}});let O=R(2796),N=R(4749);function M(){let T=N.staticGenerationAsyncStorage.getStore();return null!=T&&!!T.forceStatic||((null==T?void 0:T.isStaticGeneration)&&(0,O.suspense)(),!1)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},6842:(T,S,R)=>{"use strict";function O(T){}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"clientHookInServerComponentError",{enumerable:!0,get:function(){return O}}),R(2147),R(9885),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},2057:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{ErrorBoundaryHandler:function(){return U},GlobalError:function(){return V},default:function(){return K},ErrorBoundary:function(){return $}});let O=R(2147),N=O._(R(9885)),M=R(2778),L={error:{fontFamily:'system-ui,"Segoe UI",Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji"',height:"100vh",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},text:{fontSize:"14px",fontWeight:400,lineHeight:"28px",margin:"0 8px"}};class U extends N.default.Component{static getDerivedStateFromError(T){return{error:T}}static getDerivedStateFromProps(T,S){return T.pathname!==S.previousPathname&&S.error?{error:null,previousPathname:T.pathname}:{error:S.error,previousPathname:T.pathname}}render(){return this.state.error?N.default.createElement(N.default.Fragment,null,this.props.errorStyles,N.default.createElement(this.props.errorComponent,{error:this.state.error,reset:this.reset})):this.props.children}constructor(T){super(T),this.reset=()=>{this.setState({error:null})},this.state={error:null,previousPathname:this.props.pathname}}}function V(T){let{error:S}=T,R=null==S?void 0:S.digest;return N.default.createElement("html",{id:"__next_error__"},N.default.createElement("head",null),N.default.createElement("body",null,N.default.createElement("div",{style:L.error},N.default.createElement("div",null,N.default.createElement("h2",{style:L.text},"Application error: a "+(R?"server":"client")+"-side exception has occurred (see the "+(R?"server logs":"browser console")+" for more information)."),R?N.default.createElement("p",{style:L.text},"Digest: "+R):null))))}let K=V;function $(T){let{errorComponent:S,errorStyles:R,children:O}=T,L=(0,M.usePathname)();return S?N.default.createElement(U,{pathname:L,errorComponent:S,errorStyles:R},O):N.default.createElement(N.default.Fragment,null,O)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},7743:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{DYNAMIC_ERROR_CODE:function(){return R},DynamicServerError:function(){return O}});let R="DYNAMIC_SERVER_USAGE";class O extends Error{constructor(T){super("Dynamic server usage: "+T),this.digest=R}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},8897:(T,S)=>{"use strict";let R;function O(){return R||(R=new Promise(()=>{})),R}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"createInfinitePromise",{enumerable:!0,get:function(){return O}}),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},6148:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"default",{enumerable:!0,get:function(){return ed}}),R(2147);let O=R(4009),N=O._(R(9885));R(8908);let M=R(2428),L=R(6947),U=R(8897),V=R(2057),K=R(5324),$=R(1688),Q=R(1390),Y=R(8359),X=R(8546),Z=R(4235);function ee(T,S){if(T){let[R,O]=T,N=2===T.length;if((0,K.matchSegment)(S[0],R)&&S[1].hasOwnProperty(O)){if(N){let T=ee(void 0,S[1][O]);return[S[0],{...S[1],[O]:[T[0],T[1],T[2],"refetch"]}]}return[S[0],{...S[1],[O]:ee(T.slice(2),S[1][O])}]}}return S}function et(T){return null}let er=["bottom","height","left","right","top","width","x","y"];function en(T){if(["sticky","fixed"].includes(getComputedStyle(T).position))return!0;let S=T.getBoundingClientRect();return er.every(T=>0===S[T])}function ei(T,S){let R=T.getBoundingClientRect();return R.top>=0&&R.top<=S}function es(T){var S;return"top"===T?document.body:null!=(S=document.getElementById(T))?S:document.getElementsByName(T)[0]}class ea extends N.default.Component{componentDidMount(){this.handlePotentialScroll()}componentDidUpdate(){this.props.focusAndScrollRef.apply&&this.handlePotentialScroll()}render(){return this.props.children}constructor(...T){super(...T),this.handlePotentialScroll=()=>{let{focusAndScrollRef:T,segmentPath:S}=this.props;if(T.apply){if(0!==T.segmentPaths.length&&!T.segmentPaths.some(T=>S.every((S,R)=>(0,K.matchSegment)(S,T[R]))))return;let R=null,O=T.hashFragment;if(O&&(R=es(O)),R||(R=et(this)),!(R instanceof Element))return;for(;!(R instanceof HTMLElement)||en(R);){if(null===R.nextElementSibling)return;R=R.nextElementSibling}T.apply=!1,T.hashFragment=null,T.segmentPaths=[],(0,$.handleSmoothScroll)(()=>{if(O){R.scrollIntoView();return}let T=document.documentElement,S=T.clientHeight;!ei(R,S)&&(T.scrollTop=0,ei(R,S)||R.scrollIntoView())},{dontForceLayout:!0,onlyHashChange:T.onlyHashChange}),T.onlyHashChange=!1,R.focus()}}}}function eo(T){let{segmentPath:S,children:R}=T,O=(0,N.useContext)(M.GlobalLayoutRouterContext);if(!O)throw Error("invariant global layout router not mounted");return N.default.createElement(ea,{segmentPath:S,focusAndScrollRef:O.focusAndScrollRef},R)}function eu(T){let{parallelRouterKey:S,url:R,childNodes:O,childProp:V,segmentPath:K,tree:$,cacheKey:Q}=T,Y=(0,N.useContext)(M.GlobalLayoutRouterContext);if(!Y)throw Error("invariant global layout router not mounted");let{buildId:X,changeByServerResponse:Z,tree:et}=Y,er=O.get(Q);if(V&&null!==V.current&&(er?er.status===M.CacheStates.LAZY_INITIALIZED&&(er.status=M.CacheStates.READY,er.subTreeData=V.current):(er={status:M.CacheStates.READY,data:null,subTreeData:V.current,parallelRoutes:new Map},O.set(Q,er))),!er||er.status===M.CacheStates.LAZY_INITIALIZED){let T=ee(["",...K],et);er={status:M.CacheStates.DATA_FETCH,data:(0,L.fetchServerResponse)(new URL(R,location.origin),T,Y.nextUrl,X),subTreeData:null,head:er&&er.status===M.CacheStates.LAZY_INITIALIZED?er.head:void 0,parallelRoutes:er&&er.status===M.CacheStates.LAZY_INITIALIZED?er.parallelRoutes:new Map},O.set(Q,er)}if(!er)throw Error("Child node should always exist");if(er.subTreeData&&er.data)throw Error("Child node should not have both subTreeData and data");if(er.data){let[T,S]=(0,N.use)(er.data);er.data=null,setTimeout(()=>{(0,N.startTransition)(()=>{Z(et,T,S)})}),(0,N.use)((0,U.createInfinitePromise)())}er.subTreeData||(0,N.use)((0,U.createInfinitePromise)());let en=N.default.createElement(M.LayoutRouterContext.Provider,{value:{tree:$[1][S],childNodes:er.parallelRoutes,url:R}},er.subTreeData);return en}function ec(T){let{children:S,loading:R,loadingStyles:O,hasLoading:M}=T;return M?N.default.createElement(N.Suspense,{fallback:N.default.createElement(N.default.Fragment,null,O,R)},S):N.default.createElement(N.default.Fragment,null,S)}function ed(T){let{parallelRouterKey:S,segmentPath:R,childProp:O,error:L,errorStyles:U,templateStyles:$,loading:ee,loadingStyles:et,hasLoading:er,template:en,notFound:ei,notFoundStyles:es,styles:ea}=T,ed=(0,N.useContext)(M.LayoutRouterContext);if(!ed)throw Error("invariant expected layout router to be mounted");let{childNodes:eh,tree:ef,url:ep}=ed,em=eh.get(S);em||(em=new Map,eh.set(S,em));let eg=ef[1][S][0],ey=O.segment,ev=(0,X.getSegmentValue)(eg),eb=[eg];return N.default.createElement(N.default.Fragment,null,ea,eb.map(T=>{let ea=(0,K.matchSegment)(T,ey),ed=(0,X.getSegmentValue)(T),eh=(0,Z.createRouterCacheKey)(T);return N.default.createElement(M.TemplateContext.Provider,{key:(0,Z.createRouterCacheKey)(T,!0),value:N.default.createElement(eo,{segmentPath:R},N.default.createElement(V.ErrorBoundary,{errorComponent:L,errorStyles:U},N.default.createElement(ec,{hasLoading:er,loading:ee,loadingStyles:et},N.default.createElement(Y.NotFoundBoundary,{notFound:ei,notFoundStyles:es},N.default.createElement(Q.RedirectBoundary,null,N.default.createElement(eu,{parallelRouterKey:S,url:ep,tree:ef,childNodes:em,childProp:ea?O:null,segmentPath:R,cacheKey:eh,isActive:ev===ed}))))))},$,en)}))}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},5324:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{matchSegment:function(){return N},canSegmentBeOverridden:function(){return M}});let O=R(2290),N=(T,S)=>"string"==typeof T?"string"==typeof S&&T===S:"string"!=typeof S&&T[0]===S[0]&&T[1]===S[1],M=(T,S)=>{var R;return!Array.isArray(T)&&!!Array.isArray(S)&&(null==(R=(0,O.getSegmentParam)(T))?void 0:R.param)===S[0]};("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},2778:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{ReadonlyURLSearchParams:function(){return X},useSearchParams:function(){return Z},usePathname:function(){return ee},ServerInsertedHTMLContext:function(){return V.ServerInsertedHTMLContext},useServerInsertedHTML:function(){return V.useServerInsertedHTML},useRouter:function(){return et},useParams:function(){return en},useSelectedLayoutSegments:function(){return es},useSelectedLayoutSegment:function(){return ea},redirect:function(){return K.redirect},permanentRedirect:function(){return K.permanentRedirect},RedirectType:function(){return K.RedirectType},notFound:function(){return $.notFound}});let O=R(9885),N=R(2428),M=R(1736),L=R(6842),U=R(8546),V=R(5753),K=R(1942),$=R(2607),Q=Symbol("internal for urlsearchparams readonly");function Y(){return Error("ReadonlyURLSearchParams cannot be modified")}class X{[Symbol.iterator](){return this[Q][Symbol.iterator]()}append(){throw Y()}delete(){throw Y()}set(){throw Y()}sort(){throw Y()}constructor(T){this[Q]=T,this.entries=T.entries.bind(T),this.forEach=T.forEach.bind(T),this.get=T.get.bind(T),this.getAll=T.getAll.bind(T),this.has=T.has.bind(T),this.keys=T.keys.bind(T),this.values=T.values.bind(T),this.toString=T.toString.bind(T),this.size=T.size}}function Z(){(0,L.clientHookInServerComponentError)("useSearchParams");let T=(0,O.useContext)(M.SearchParamsContext),S=(0,O.useMemo)(()=>T?new X(T):null,[T]);{let{bailoutToClientRendering:T}=R(7080);T()}return S}function ee(){return(0,L.clientHookInServerComponentError)("usePathname"),(0,O.useContext)(M.PathnameContext)}function et(){(0,L.clientHookInServerComponentError)("useRouter");let T=(0,O.useContext)(N.AppRouterContext);if(null===T)throw Error("invariant expected app router to be mounted");return T}function er(T,S){void 0===S&&(S={});let R=T[1];for(let T of Object.values(R)){let R=T[0],O=Array.isArray(R),N=O?R[1]:R;if(!N||N.startsWith("__PAGE__"))continue;let M=O&&("c"===R[2]||"oc"===R[2]);M?S[R[0]]=R[1].split("/"):O&&(S[R[0]]=R[1]),S=er(T,S)}return S}function en(){(0,L.clientHookInServerComponentError)("useParams");let T=(0,O.useContext)(N.GlobalLayoutRouterContext),S=(0,O.useContext)(M.PathParamsContext);return T?er(T.tree):S}function ei(T,S,R,O){let N;if(void 0===R&&(R=!0),void 0===O&&(O=[]),R)N=T[1][S];else{var M;let S=T[1];N=null!=(M=S.children)?M:Object.values(S)[0]}if(!N)return O;let L=N[0],V=(0,U.getSegmentValue)(L);return!V||V.startsWith("__PAGE__")?O:(O.push(V),ei(N,S,!1,O))}function es(T){void 0===T&&(T="children"),(0,L.clientHookInServerComponentError)("useSelectedLayoutSegments");let{tree:S}=(0,O.useContext)(N.LayoutRouterContext);return ei(S,T)}function ea(T){void 0===T&&(T="children"),(0,L.clientHookInServerComponentError)("useSelectedLayoutSegment");let S=es(T);return 0===S.length?null:S[0]}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},8359:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"NotFoundBoundary",{enumerable:!0,get:function(){return U}});let O=R(2147),N=O._(R(9885)),M=R(2778);class L extends N.default.Component{static getDerivedStateFromError(T){if((null==T?void 0:T.digest)==="NEXT_NOT_FOUND")return{notFoundTriggered:!0};throw T}static getDerivedStateFromProps(T,S){return T.pathname!==S.previousPathname&&S.notFoundTriggered?{notFoundTriggered:!1,previousPathname:T.pathname}:{notFoundTriggered:S.notFoundTriggered,previousPathname:T.pathname}}render(){return this.state.notFoundTriggered?N.default.createElement(N.default.Fragment,null,N.default.createElement("meta",{name:"robots",content:"noindex"}),!1,this.props.notFoundStyles,this.props.notFound):this.props.children}constructor(T){super(T),this.state={notFoundTriggered:!!T.asNotFound,previousPathname:T.pathname}}}function U(T){let{notFound:S,notFoundStyles:R,asNotFound:O,children:U}=T,V=(0,M.usePathname)();return S?N.default.createElement(L,{pathname:V,notFound:S,notFoundStyles:R,asNotFound:O},U):N.default.createElement(N.default.Fragment,null,U)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},2607:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{notFound:function(){return O},isNotFoundError:function(){return N}});let R="NEXT_NOT_FOUND";function O(){let T=Error(R);throw T.digest=R,T}function N(T){return(null==T?void 0:T.digest)===R}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},339:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"PromiseQueue",{enumerable:!0,get:function(){return K}});let O=R(8324),N=R(4567);var M=N._("_maxConcurrency"),L=N._("_runningCount"),U=N._("_queue"),V=N._("_processNext");class K{enqueue(T){let S,R;let N=new Promise((T,O)=>{S=T,R=O}),M=async()=>{try{O._(this,L)[L]++;let R=await T();S(R)}catch(T){R(T)}finally{O._(this,L)[L]--,O._(this,V)[V]()}},K={promiseFn:N,task:M};return O._(this,U)[U].push(K),O._(this,V)[V](),N}bump(T){let S=O._(this,U)[U].findIndex(S=>S.promiseFn===T);if(S>-1){let T=O._(this,U)[U].splice(S,1)[0];O._(this,U)[U].unshift(T),O._(this,V)[V](!0)}}constructor(T=5){Object.defineProperty(this,V,{value:$}),Object.defineProperty(this,M,{writable:!0,value:void 0}),Object.defineProperty(this,L,{writable:!0,value:void 0}),Object.defineProperty(this,U,{writable:!0,value:void 0}),O._(this,M)[M]=T,O._(this,L)[L]=0,O._(this,U)[U]=[]}}function $(T){if(void 0===T&&(T=!1),(O._(this,L)[L]<O._(this,M)[M]||T)&&O._(this,U)[U].length>0){var S;null==(S=O._(this,U)[U].shift())||S.task()}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},1390:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{RedirectErrorBoundary:function(){return V},RedirectBoundary:function(){return K}});let O=R(4009),N=O._(R(9885)),M=R(2778),L=R(1942);function U(T){let{redirect:S,reset:R,redirectType:O}=T,U=(0,M.useRouter)();return(0,N.useEffect)(()=>{N.default.startTransition(()=>{O===L.RedirectType.push?U.push(S,{}):U.replace(S,{}),R()})},[S,O,R,U]),null}class V extends N.default.Component{static getDerivedStateFromError(T){if((0,L.isRedirectError)(T)){let S=(0,L.getURLFromRedirectError)(T),R=(0,L.getRedirectTypeFromError)(T);return{redirect:S,redirectType:R}}throw T}render(){let{redirect:T,redirectType:S}=this.state;return null!==T&&null!==S?N.default.createElement(U,{redirect:T,redirectType:S,reset:()=>this.setState({redirect:null})}):this.props.children}constructor(T){super(T),this.state={redirect:null,redirectType:null}}}function K(T){let{children:S}=T,R=(0,M.useRouter)();return N.default.createElement(V,{router:R},S)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},1942:(T,S,R)=>{"use strict";var O;Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{RedirectType:function(){return O},getRedirectError:function(){return L},redirect:function(){return U},permanentRedirect:function(){return V},isRedirectError:function(){return K},getURLFromRedirectError:function(){return $},getRedirectTypeFromError:function(){return Q}});let N=R(5403),M="NEXT_REDIRECT";function L(T,S,R){void 0===R&&(R=!1);let O=Error(M);O.digest=M+";"+S+";"+T+";"+R;let L=N.requestAsyncStorage.getStore();return L&&(O.mutableCookies=L.mutableCookies),O}function U(T,S){throw void 0===S&&(S="replace"),L(T,S,!1)}function V(T,S){throw void 0===S&&(S="replace"),L(T,S,!0)}function K(T){if("string"!=typeof(null==T?void 0:T.digest))return!1;let[S,R,O,N]=T.digest.split(";",4);return S===M&&("replace"===R||"push"===R)&&"string"==typeof O&&("true"===N||"false"===N)}function $(T){return K(T)?T.digest.split(";",3)[2]:null}function Q(T){if(!K(T))throw Error("Not a redirect error");return T.digest.split(";",3)[1]}(function(T){T.push="push",T.replace="replace"})(O||(O={})),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},1860:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"default",{enumerable:!0,get:function(){return L}});let O=R(4009),N=O._(R(9885)),M=R(2428);function L(){let T=(0,N.useContext)(M.TemplateContext);return N.default.createElement(N.default.Fragment,null,T)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},8510:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"applyFlightData",{enumerable:!0,get:function(){return L}});let O=R(2428),N=R(9069),M=R(7512);function L(T,S,R,L){void 0===L&&(L=!1);let[U,V,K]=R.slice(-3);return null!==V&&(3===R.length?(S.status=O.CacheStates.READY,S.subTreeData=V,(0,N.fillLazyItemsTillLeafWithHead)(S,T,U,K,L)):(S.status=O.CacheStates.READY,S.subTreeData=T.subTreeData,S.parallelRoutes=new Map(T.parallelRoutes),(0,M.fillCacheWithNewSubTreeData)(S,T,R,L)),!0)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},5849:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"applyRouterStatePatchToTree",{enumerable:!0,get:function(){return M}});let O=R(5324);function N(T,S){let[R,M]=T,[L,U]=S;if("__DEFAULT__"===L&&"__DEFAULT__"!==R)return T;if((0,O.matchSegment)(R,L)){let S={};for(let T in M){let R=void 0!==U[T];R?S[T]=N(M[T],U[T]):S[T]=M[T]}for(let T in U)S[T]||(S[T]=U[T]);let O=[R,S];return T[2]&&(O[2]=T[2]),T[3]&&(O[3]=T[3]),T[4]&&(O[4]=T[4]),O}return S}function M(T,S,R){let L;let[U,V,,,K]=S;if(1===T.length){let T=N(S,R);return T}let[$,Q]=T;if(!(0,O.matchSegment)($,U))return null;let Y=2===T.length;if(Y)L=N(V[Q],R);else if(null===(L=M(T.slice(2),V[Q],R)))return null;let X=[T[0],{...V,[Q]:L}];return K&&(X[4]=!0),X}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},735:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{extractPathFromFlightRouterState:function(){return K},computeChangedPath:function(){return Q}});let O=R(4265),N=R(8882),M=R(5324),L=T=>"/"===T[0]?T.slice(1):T,U=T=>"string"==typeof T?T:T[1];function V(T){return T.reduce((T,S)=>""===(S=L(S))||(0,N.isGroupSegment)(S)?T:T+"/"+S,"")||"/"}function K(T){var S;let R=Array.isArray(T[0])?T[0][1]:T[0];if("__DEFAULT__"===R||O.INTERCEPTION_ROUTE_MARKERS.some(T=>R.startsWith(T)))return;if(R.startsWith("__PAGE__"))return"";let N=[R],M=null!=(S=T[1])?S:{},L=M.children?K(M.children):void 0;if(void 0!==L)N.push(L);else for(let[T,S]of Object.entries(M)){if("children"===T)continue;let R=K(S);void 0!==R&&N.push(R)}return V(N)}function $(T,S){let[R,N]=T,[L,V]=S,Q=U(R),Y=U(L);if(O.INTERCEPTION_ROUTE_MARKERS.some(T=>Q.startsWith(T)||Y.startsWith(T)))return"";if(!(0,M.matchSegment)(R,L)){var X;return null!=(X=K(S))?X:""}for(let T in N)if(V[T]){let S=$(N[T],V[T]);if(null!==S)return U(L)+"/"+S}return null}function Q(T,S){let R=$(T,S);return null==R||"/"===R?R:V(R.split("/"))}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},1558:(T,S)=>{"use strict";function R(T,S){return void 0===S&&(S=!0),T.pathname+T.search+(S?T.hash:"")}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"createHrefFromUrl",{enumerable:!0,get:function(){return R}}),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},6606:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"createInitialRouterState",{enumerable:!0,get:function(){return U}});let O=R(2428),N=R(1558),M=R(9069),L=R(735);function U(T){var S;let{buildId:R,initialTree:U,children:V,initialCanonicalUrl:K,initialParallelRoutes:$,isServer:Q,location:Y,initialHead:X}=T,Z={status:O.CacheStates.READY,data:null,subTreeData:V,parallelRoutes:Q?new Map:$};return(null===$||0===$.size)&&(0,M.fillLazyItemsTillLeafWithHead)(Z,void 0,U,X),{buildId:R,tree:U,cache:Z,prefetchCache:new Map,pushRef:{pendingPush:!1,mpaNavigation:!1},focusAndScrollRef:{apply:!1,onlyHashChange:!1,hashFragment:null,segmentPaths:[]},canonicalUrl:Y?(0,N.createHrefFromUrl)(Y):K,nextUrl:null!=(S=(0,L.extractPathFromFlightRouterState)(U)||(null==Y?void 0:Y.pathname))?S:null}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},3897:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"createOptimisticTree",{enumerable:!0,get:function(){return N}});let O=R(5324);function N(T,S,R){let M;let[L,U,V,K,$]=S||[null,{}],Q=T[0],Y=1===T.length,X=null!==L&&(0,O.matchSegment)(L,Q),Z=Object.keys(U).length>1,ee=!S||!X||Z,et={};if(null!==L&&X&&(et=U),!Y&&!Z){let S=N(T.slice(1),et?et.children:null,R||ee);M=S}let er=[Q,{...et,...M?{children:M}:{}}];return V&&(er[2]=V),!R&&ee?er[3]="refetch":X&&K&&(er[3]=K),X&&$&&(er[4]=$),er}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},9654:(T,S)=>{"use strict";function R(T){return T.status="pending",T.then(S=>{"pending"===T.status&&(T.status="fulfilled",T.value=S)},S=>{"pending"===T.status&&(T.status="rejected",T.value=S)}),T}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"createRecordFromThenable",{enumerable:!0,get:function(){return R}}),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},4235:(T,S)=>{"use strict";function R(T,S){return void 0===S&&(S=!1),Array.isArray(T)?T[0]+"|"+T[1]+"|"+T[2]:S&&T.startsWith("__PAGE__")?"__PAGE__":T}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"createRouterCacheKey",{enumerable:!0,get:function(){return R}}),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},6947:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"fetchServerResponse",{enumerable:!0,get:function(){return $}});let O=R(2763),N=R(9918),M=R(391),L=R(6165),U=R(4035),{createFromFetch:V}=R(2623);function K(T){return[(0,N.urlToUrlWithoutFlightMarker)(T).toString(),void 0]}async function $(T,S,R,$,Q){let Y={[O.RSC]:"1",[O.NEXT_ROUTER_STATE_TREE]:encodeURIComponent(JSON.stringify(S))};Q===L.PrefetchKind.AUTO&&(Y[O.NEXT_ROUTER_PREFETCH]="1"),R&&(Y[O.NEXT_URL]=R);let X=(0,U.hexHash)([Y[O.NEXT_ROUTER_PREFETCH]||"0",Y[O.NEXT_ROUTER_STATE_TREE],Y[O.NEXT_URL]].join(","));try{let S=new URL(T);S.pathname.endsWith("/")?S.pathname+="index.txt":S.pathname+=".txt",S.searchParams.set(O.NEXT_RSC_UNION_QUERY,X);let R=await fetch(S,{credentials:"same-origin",headers:Y}),L=(0,N.urlToUrlWithoutFlightMarker)(R.url),U=R.redirected?L:void 0,Q=R.headers.get("content-type")||"",Z=Q===O.RSC_CONTENT_TYPE_HEADER;if(Z||(Z=Q.startsWith("text/plain")),!Z||!R.ok)return K(L.toString());let[ee,et]=await V(Promise.resolve(R),{callServer:M.callServer});if($!==ee)return K(R.url);return[et,U]}catch(S){return console.error("Failed to fetch RSC payload. Falling back to browser navigation.",S),[T.toString(),void 0]}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},276:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"fillCacheWithDataProperty",{enumerable:!0,get:function(){return M}});let O=R(2428),N=R(4235);function M(T,S,R,L,U){void 0===U&&(U=!1);let V=R.length<=2,[K,$]=R,Q=(0,N.createRouterCacheKey)($),Y=S.parallelRoutes.get(K);if(!Y||U&&S.parallelRoutes.size>1)return{bailOptimistic:!0};let X=T.parallelRoutes.get(K);X&&X!==Y||(X=new Map(Y),T.parallelRoutes.set(K,X));let Z=Y.get(Q),ee=X.get(Q);if(V){ee&&ee.data&&ee!==Z||X.set(Q,{status:O.CacheStates.DATA_FETCH,data:L(),subTreeData:null,parallelRoutes:new Map});return}if(!ee||!Z){ee||X.set(Q,{status:O.CacheStates.DATA_FETCH,data:L(),subTreeData:null,parallelRoutes:new Map});return}return ee===Z&&(ee={status:ee.status,data:ee.data,subTreeData:ee.subTreeData,parallelRoutes:new Map(ee.parallelRoutes)},X.set(Q,ee)),M(ee,Z,R.slice(2),L)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},7512:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"fillCacheWithNewSubTreeData",{enumerable:!0,get:function(){return U}});let O=R(2428),N=R(8098),M=R(9069),L=R(4235);function U(T,S,R,V){let K=R.length<=5,[$,Q]=R,Y=(0,L.createRouterCacheKey)(Q),X=S.parallelRoutes.get($);if(!X)return;let Z=T.parallelRoutes.get($);Z&&Z!==X||(Z=new Map(X),T.parallelRoutes.set($,Z));let ee=X.get(Y),et=Z.get(Y);if(K){et&&et.data&&et!==ee||(et={status:O.CacheStates.READY,data:null,subTreeData:R[3],parallelRoutes:ee?new Map(ee.parallelRoutes):new Map},ee&&(0,N.invalidateCacheByRouterState)(et,ee,R[2]),(0,M.fillLazyItemsTillLeafWithHead)(et,ee,R[2],R[4],V),Z.set(Y,et));return}et&&ee&&(et===ee&&(et={status:et.status,data:et.data,subTreeData:et.subTreeData,parallelRoutes:new Map(et.parallelRoutes)},Z.set(Y,et)),U(et,ee,R.slice(2),V))}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},9069:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"fillLazyItemsTillLeafWithHead",{enumerable:!0,get:function(){return M}});let O=R(2428),N=R(4235);function M(T,S,R,L,U){let V=0===Object.keys(R[1]).length;if(V){T.head=L;return}for(let V in R[1]){let K=R[1][V],$=K[0],Q=(0,N.createRouterCacheKey)($);if(S){let R=S.parallelRoutes.get(V);if(R){let S=new Map(R),N=S.get(Q),$=U&&N?{status:N.status,data:N.data,subTreeData:N.subTreeData,parallelRoutes:new Map(N.parallelRoutes)}:{status:O.CacheStates.LAZY_INITIALIZED,data:null,subTreeData:null,parallelRoutes:new Map(null==N?void 0:N.parallelRoutes)};S.set(Q,$),M($,N,K,L,U),T.parallelRoutes.set(V,S);continue}}let Y={status:O.CacheStates.LAZY_INITIALIZED,data:null,subTreeData:null,parallelRoutes:new Map},X=T.parallelRoutes.get(V);X?X.set(Q,Y):T.parallelRoutes.set(V,new Map([[Q,Y]])),M(Y,void 0,K,L,U)}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},7456:(T,S)=>{"use strict";var R;Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{PrefetchCacheEntryStatus:function(){return R},getPrefetchEntryCacheStatus:function(){return M}});let O=3e5,N=3e4;function M(T){let{kind:S,prefetchTime:R,lastUsedTime:M}=T;return Date.now()<(null!=M?M:R)+N?M?"reusable":"fresh":"auto"===S&&Date.now()<R+O?"stale":"full"===S&&Date.now()<R+O?"reusable":"expired"}(function(T){T.fresh="fresh",T.reusable="reusable",T.expired="expired",T.stale="stale"})(R||(R={})),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},6940:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"handleMutable",{enumerable:!0,get:function(){return N}});let O=R(735);function N(T,S){var R,N,M,L;let U=null==(N=S.shouldScroll)||N;return{buildId:T.buildId,canonicalUrl:null!=S.canonicalUrl?S.canonicalUrl===T.canonicalUrl?T.canonicalUrl:S.canonicalUrl:T.canonicalUrl,pushRef:{pendingPush:null!=S.pendingPush?S.pendingPush:T.pushRef.pendingPush,mpaNavigation:null!=S.mpaNavigation?S.mpaNavigation:T.pushRef.mpaNavigation},focusAndScrollRef:{apply:!!U&&((null==S?void 0:S.scrollableSegments)!==void 0||T.focusAndScrollRef.apply),onlyHashChange:!!S.hashFragment&&T.canonicalUrl.split("#")[0]===(null==(R=S.canonicalUrl)?void 0:R.split("#")[0]),hashFragment:U?S.hashFragment&&""!==S.hashFragment?decodeURIComponent(S.hashFragment.slice(1)):T.focusAndScrollRef.hashFragment:null,segmentPaths:U?null!=(M=null==S?void 0:S.scrollableSegments)?M:T.focusAndScrollRef.segmentPaths:[]},cache:S.cache?S.cache:T.cache,prefetchCache:S.prefetchCache?S.prefetchCache:T.prefetchCache,tree:void 0!==S.patchedTree?S.patchedTree:T.tree,nextUrl:void 0!==S.patchedTree?null!=(L=(0,O.computeChangedPath)(T.tree,S.patchedTree))?L:T.canonicalUrl:T.nextUrl}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},1260:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"invalidateCacheBelowFlightSegmentPath",{enumerable:!0,get:function(){return N}});let O=R(4235);function N(T,S,R){let M=R.length<=2,[L,U]=R,V=(0,O.createRouterCacheKey)(U),K=S.parallelRoutes.get(L);if(!K)return;let $=T.parallelRoutes.get(L);if($&&$!==K||($=new Map(K),T.parallelRoutes.set(L,$)),M){$.delete(V);return}let Q=K.get(V),Y=$.get(V);Y&&Q&&(Y===Q&&(Y={status:Y.status,data:Y.data,subTreeData:Y.subTreeData,parallelRoutes:new Map(Y.parallelRoutes)},$.set(V,Y)),N(Y,Q,R.slice(2)))}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},8098:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"invalidateCacheByRouterState",{enumerable:!0,get:function(){return N}});let O=R(4235);function N(T,S,R){for(let N in R[1]){let M=R[1][N][0],L=(0,O.createRouterCacheKey)(M),U=S.parallelRoutes.get(N);if(U){let S=new Map(U);S.delete(L),T.parallelRoutes.set(N,S)}}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},850:(T,S)=>{"use strict";function R(T,S){let O=T[0],N=S[0];if(Array.isArray(O)&&Array.isArray(N)){if(O[0]!==N[0]||O[2]!==N[2])return!0}else if(O!==N)return!0;if(T[4])return!S[4];if(S[4])return!0;let M=Object.values(T[1])[0],L=Object.values(S[1])[0];return!M||!L||R(M,L)}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"isNavigatingToNewRootLayout",{enumerable:!0,get:function(){return R}}),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},3354:(T,S)=>{"use strict";function R(T){if("fulfilled"===T.status)return T.value;throw T}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"readRecordValue",{enumerable:!0,get:function(){return R}}),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},7892:(T,S,R)=>{"use strict";function O(T,S){return T}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"fastRefreshReducer",{enumerable:!0,get:function(){return N}}),R(6947),R(9654),R(3354),R(1558),R(5849),R(850),R(5913),R(6940),R(8510);let N=O;("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},7295:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"findHeadInCache",{enumerable:!0,get:function(){return N}});let O=R(4235);function N(T,S){let R=0===Object.keys(S).length;if(R)return T.head;for(let R in S){let[M,L]=S[R],U=T.parallelRoutes.get(R);if(!U)continue;let V=(0,O.createRouterCacheKey)(M),K=U.get(V);if(!K)continue;let $=N(K,L);if($)return $}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},8546:(T,S)=>{"use strict";function R(T){return Array.isArray(T)?T[1]:T}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"getSegmentValue",{enumerable:!0,get:function(){return R}}),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},5913:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{handleExternalUrl:function(){return es},navigateReducer:function(){return eu}});let O=R(2428),N=R(6947),M=R(9654),L=R(3354),U=R(1558),V=R(1260),K=R(276),$=R(3897),Q=R(5849),Y=R(4505),X=R(850),Z=R(6165),ee=R(6940),et=R(8510),er=R(7456),en=R(6293),ei=R(2392);function es(T,S,R,O){return S.previousTree=T.tree,S.mpaNavigation=!0,S.canonicalUrl=R,S.pendingPush=O,S.scrollableSegments=void 0,(0,ee.handleMutable)(T,S)}function ea(T){let S=[],[R,O]=T;if(0===Object.keys(O).length)return[[R]];for(let[T,N]of Object.entries(O))for(let O of ea(N))""===R?S.push([T,...O]):S.push([R,T,...O]);return S}function eo(T,S,R,N,M){let L=!1;T.status=O.CacheStates.READY,T.subTreeData=S.subTreeData,T.parallelRoutes=new Map(S.parallelRoutes);let U=ea(N).map(T=>[...R,...T]);for(let R of U){let O=(0,K.fillCacheWithDataProperty)(T,S,R,M);(null==O?void 0:O.bailOptimistic)||(L=!0)}return L}function eu(T,S){let{url:R,isExternalUrl:eu,navigateType:ec,cache:ed,mutable:eh,forceOptimisticNavigation:ef,shouldScroll:ep}=S,{pathname:em,hash:eg}=R,ey=(0,U.createHrefFromUrl)(R),ev="push"===ec;(0,en.prunePrefetchCache)(T.prefetchCache);let eb=JSON.stringify(eh.previousTree)===JSON.stringify(T.tree);if(eb)return(0,ee.handleMutable)(T,eh);if(eu)return es(T,eh,R.toString(),ev);let e_=T.prefetchCache.get((0,U.createHrefFromUrl)(R,!1));if(ef&&(null==e_?void 0:e_.kind)!==Z.PrefetchKind.TEMPORARY){let S;let L=em.split("/");L.push("__PAGE__");let V=(0,$.createOptimisticTree)(L,T.tree,!1),Q={...ed};Q.status=O.CacheStates.READY,Q.subTreeData=T.cache.subTreeData,Q.parallelRoutes=new Map(T.cache.parallelRoutes);let Y=()=>(S||(S=(0,M.createRecordFromThenable)((0,N.fetchServerResponse)(R,V,T.nextUrl,T.buildId))),S),X=L.slice(1).map(T=>["children",T]).flat(),et=(0,K.fillCacheWithDataProperty)(Q,T.cache,X,Y,!0);if(!(null==et?void 0:et.bailOptimistic))return eh.previousTree=T.tree,eh.patchedTree=V,eh.pendingPush=ev,eh.hashFragment=eg,eh.shouldScroll=ep,eh.scrollableSegments=[],eh.cache=Q,eh.canonicalUrl=ey,T.prefetchCache.set((0,U.createHrefFromUrl)(R,!1),{data:(0,M.createRecordFromThenable)(Promise.resolve(S)),kind:Z.PrefetchKind.TEMPORARY,prefetchTime:Date.now(),treeAtTimeOfPrefetch:T.tree,lastUsedTime:Date.now()}),(0,ee.handleMutable)(T,eh)}if(!e_){let S=(0,M.createRecordFromThenable)((0,N.fetchServerResponse)(R,T.tree,T.nextUrl,T.buildId,void 0)),O={data:(0,M.createRecordFromThenable)(Promise.resolve(S)),kind:Z.PrefetchKind.TEMPORARY,prefetchTime:Date.now(),treeAtTimeOfPrefetch:T.tree,lastUsedTime:null};T.prefetchCache.set((0,U.createHrefFromUrl)(R,!1),O),e_=O}let eT=(0,er.getPrefetchEntryCacheStatus)(e_),{treeAtTimeOfPrefetch:eS,data:eE}=e_;ei.prefetchQueue.bump(eE);let[ew,eC]=(0,L.readRecordValue)(eE);if(e_.lastUsedTime||(e_.lastUsedTime=Date.now()),"string"==typeof ew)return es(T,eh,ew,ev);let eI=T.tree,eR=T.cache,eA=[];for(let S of ew){let M=S.slice(0,-4),L=S.slice(-3)[0],U=["",...M],K=(0,Q.applyRouterStatePatchToTree)(U,eI,L);if(null===K&&(K=(0,Q.applyRouterStatePatchToTree)(U,eS,L)),null!==K){if((0,X.isNavigatingToNewRootLayout)(eI,K))return es(T,eh,ey,ev);let $=(0,et.applyFlightData)(eR,ed,S,"auto"===e_.kind&&eT===er.PrefetchCacheEntryStatus.reusable);$||eT!==er.PrefetchCacheEntryStatus.stale||($=eo(ed,eR,M,L,()=>(0,N.fetchServerResponse)(R,eI,T.nextUrl,T.buildId)));let Q=(0,Y.shouldHardNavigate)(U,eI);for(let T of(Q?(ed.status=O.CacheStates.READY,ed.subTreeData=eR.subTreeData,(0,V.invalidateCacheBelowFlightSegmentPath)(ed,eR,M),eh.cache=ed):$&&(eh.cache=ed),eR=ed,eI=K,ea(L))){let S=[...M,...T];"__DEFAULT__"!==S[S.length-1]&&eA.push(S)}}}return eh.previousTree=T.tree,eh.patchedTree=eI,eh.canonicalUrl=eC?(0,U.createHrefFromUrl)(eC):ey,eh.pendingPush=ev,eh.scrollableSegments=eA,eh.hashFragment=eg,eh.shouldScroll=ep,(0,ee.handleMutable)(T,eh)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},2392:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{prefetchQueue:function(){return $},prefetchReducer:function(){return Q}});let O=R(1558),N=R(6947),M=R(6165),L=R(9654),U=R(6293),V=R(2763),K=R(339),$=new K.PromiseQueue(5);function Q(T,S){(0,U.prunePrefetchCache)(T.prefetchCache);let{url:R}=S;R.searchParams.delete(V.NEXT_RSC_UNION_QUERY);let K=(0,O.createHrefFromUrl)(R,!1),Q=T.prefetchCache.get(K);if(Q&&(Q.kind===M.PrefetchKind.TEMPORARY&&T.prefetchCache.set(K,{...Q,kind:S.kind}),!(Q.kind===M.PrefetchKind.AUTO&&S.kind===M.PrefetchKind.FULL)))return T;let Y=(0,L.createRecordFromThenable)($.enqueue(()=>(0,N.fetchServerResponse)(R,T.tree,T.nextUrl,T.buildId,S.kind)));return T.prefetchCache.set(K,{treeAtTimeOfPrefetch:T.tree,data:Y,kind:S.kind,prefetchTime:Date.now(),lastUsedTime:null}),T}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},6293:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"prunePrefetchCache",{enumerable:!0,get:function(){return N}});let O=R(7456);function N(T){for(let[S,R]of T)(0,O.getPrefetchEntryCacheStatus)(R)===O.PrefetchCacheEntryStatus.expired&&T.delete(S)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},1236:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"refreshReducer",{enumerable:!0,get:function(){return X}});let O=R(6947),N=R(9654),M=R(3354),L=R(1558),U=R(5849),V=R(850),K=R(5913),$=R(6940),Q=R(2428),Y=R(9069);function X(T,S){let{cache:R,mutable:X,origin:Z}=S,ee=T.canonicalUrl,et=T.tree,er=JSON.stringify(X.previousTree)===JSON.stringify(et);if(er)return(0,$.handleMutable)(T,X);R.data||(R.data=(0,N.createRecordFromThenable)((0,O.fetchServerResponse)(new URL(ee,Z),[et[0],et[1],et[2],"refetch"],T.nextUrl,T.buildId)));let[en,ei]=(0,M.readRecordValue)(R.data);if("string"==typeof en)return(0,K.handleExternalUrl)(T,X,en,T.pushRef.pendingPush);for(let S of(R.data=null,en)){if(3!==S.length)return console.log("REFRESH FAILED"),T;let[O]=S,N=(0,U.applyRouterStatePatchToTree)([""],et,O);if(null===N)throw Error("SEGMENT MISMATCH");if((0,V.isNavigatingToNewRootLayout)(et,N))return(0,K.handleExternalUrl)(T,X,ee,T.pushRef.pendingPush);let M=ei?(0,L.createHrefFromUrl)(ei):void 0;ei&&(X.canonicalUrl=M);let[$,Z]=S.slice(-2);null!==$&&(R.status=Q.CacheStates.READY,R.subTreeData=$,(0,Y.fillLazyItemsTillLeafWithHead)(R,void 0,O,Z),X.cache=R,X.prefetchCache=new Map),X.previousTree=et,X.patchedTree=N,X.canonicalUrl=ee,et=N}return(0,$.handleMutable)(T,X)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},3913:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"restoreReducer",{enumerable:!0,get:function(){return N}});let O=R(1558);function N(T,S){let{url:R,tree:N}=S,M=(0,O.createHrefFromUrl)(R);return{buildId:T.buildId,canonicalUrl:M,pushRef:T.pushRef,focusAndScrollRef:T.focusAndScrollRef,cache:T.cache,prefetchCache:T.prefetchCache,tree:N,nextUrl:R.pathname}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},318:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"serverActionReducer",{enumerable:!0,get:function(){return en}});let O=R(391),N=R(2763),M=R(9654),L=R(3354),U=R(7488),V=R(1558),K=R(5913),$=R(5849),Q=R(850),Y=R(2428),X=R(6940),Z=R(9069),{createFromFetch:ee,encodeReply:et}=R(2623);async function er(T,S){let R,{actionId:M,actionArgs:L}=S,V=await et(L),K=await fetch("",{method:"POST",headers:{Accept:N.RSC_CONTENT_TYPE_HEADER,[N.ACTION]:M,[N.NEXT_ROUTER_STATE_TREE]:encodeURIComponent(JSON.stringify(T.tree)),...T.nextUrl?{[N.NEXT_URL]:T.nextUrl}:{}},body:V}),$=K.headers.get("x-action-redirect");try{let T=JSON.parse(K.headers.get("x-action-revalidated")||"[[],0,0]");R={paths:T[0]||[],tag:!!T[1],cookie:T[2]}}catch(T){R={paths:[],tag:!1,cookie:!1}}let Q=$?new URL((0,U.addBasePath)($),new URL(T.canonicalUrl,window.location.href)):void 0;if(K.headers.get("content-type")===N.RSC_CONTENT_TYPE_HEADER){let T=await ee(Promise.resolve(K),{callServer:O.callServer});if($){let[,S]=null!=T?T:[];return{actionFlightData:S,redirectLocation:Q,revalidatedParts:R}}let[S,[,N]]=null!=T?T:[];return{actionResult:S,actionFlightData:N,redirectLocation:Q,revalidatedParts:R}}return{redirectLocation:Q,revalidatedParts:R}}function en(T,S){let{mutable:R,cache:O,resolve:N,reject:U}=S,ee=T.canonicalUrl,et=T.tree,en=JSON.stringify(R.previousTree)===JSON.stringify(et);if(en)return(0,X.handleMutable)(T,R);if(R.inFlightServerAction){if(R.globalMutable.pendingNavigatePath&&R.globalMutable.pendingNavigatePath!==ee)return R.inFlightServerAction.then(()=>{R.actionResultResolved||(R.inFlightServerAction=null,R.globalMutable.pendingNavigatePath=void 0,R.globalMutable.refresh(),R.actionResultResolved=!0)}),T}else R.inFlightServerAction=(0,M.createRecordFromThenable)(er(T,S));try{let{actionResult:S,actionFlightData:M,redirectLocation:U}=(0,L.readRecordValue)(R.inFlightServerAction);if(U&&(T.pushRef.pendingPush=!0,R.pendingPush=!0),R.previousTree=T.tree,!M){if(R.actionResultResolved||(N(S),R.actionResultResolved=!0),U)return(0,K.handleExternalUrl)(T,R,U.href,T.pushRef.pendingPush);return T}if("string"==typeof M)return(0,K.handleExternalUrl)(T,R,M,T.pushRef.pendingPush);for(let S of(R.inFlightServerAction=null,M)){if(3!==S.length)return console.log("SERVER ACTION APPLY FAILED"),T;let[N]=S,M=(0,$.applyRouterStatePatchToTree)([""],et,N);if(null===M)throw Error("SEGMENT MISMATCH");if((0,Q.isNavigatingToNewRootLayout)(et,M))return(0,K.handleExternalUrl)(T,R,ee,T.pushRef.pendingPush);let[L,U]=S.slice(-2);null!==L&&(O.status=Y.CacheStates.READY,O.subTreeData=L,(0,Z.fillLazyItemsTillLeafWithHead)(O,void 0,N,U),R.cache=O,R.prefetchCache=new Map),R.previousTree=et,R.patchedTree=M,R.canonicalUrl=ee,et=M}if(U){let T=(0,V.createHrefFromUrl)(U,!1);R.canonicalUrl=T}return R.actionResultResolved||(N(S),R.actionResultResolved=!0),(0,X.handleMutable)(T,R)}catch(S){if("rejected"===S.status)return R.actionResultResolved||(U(S.value),R.actionResultResolved=!0),T;throw S}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},4258:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"serverPatchReducer",{enumerable:!0,get:function(){return K}});let O=R(1558),N=R(5849),M=R(850),L=R(5913),U=R(8510),V=R(6940);function K(T,S){let{flightData:R,previousTree:K,overrideCanonicalUrl:$,cache:Q,mutable:Y}=S,X=JSON.stringify(K)===JSON.stringify(T.tree);if(!X)return console.log("TREE MISMATCH"),T;if(Y.previousTree)return(0,V.handleMutable)(T,Y);if("string"==typeof R)return(0,L.handleExternalUrl)(T,Y,R,T.pushRef.pendingPush);let Z=T.tree,ee=T.cache;for(let S of R){let R=S.slice(0,-4),[V]=S.slice(-3,-2),K=(0,N.applyRouterStatePatchToTree)(["",...R],Z,V);if(null===K)throw Error("SEGMENT MISMATCH");if((0,M.isNavigatingToNewRootLayout)(Z,K))return(0,L.handleExternalUrl)(T,Y,T.canonicalUrl,T.pushRef.pendingPush);let X=$?(0,O.createHrefFromUrl)($):void 0;X&&(Y.canonicalUrl=X),(0,U.applyFlightData)(ee,Q,S),Y.previousTree=Z,Y.patchedTree=K,Y.cache=Q,ee=Q,Z=K}return(0,V.handleMutable)(T,Y)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},6165:(T,S)=>{"use strict";var R;Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{PrefetchKind:function(){return R},ACTION_REFRESH:function(){return O},ACTION_NAVIGATE:function(){return N},ACTION_RESTORE:function(){return M},ACTION_SERVER_PATCH:function(){return L},ACTION_PREFETCH:function(){return U},ACTION_FAST_REFRESH:function(){return V},ACTION_SERVER_ACTION:function(){return K}});let O="refresh",N="navigate",M="restore",L="server-patch",U="prefetch",V="fast-refresh",K="server-action";(function(T){T.AUTO="auto",T.FULL="full",T.TEMPORARY="temporary"})(R||(R={})),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},4635:(T,S,R)=>{"use strict";function O(T,S){return T}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"reducer",{enumerable:!0,get:function(){return N}}),R(6165),R(5913),R(4258),R(3913),R(1236),R(2392),R(7892),R(318);let N=O;("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},4505:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"shouldHardNavigate",{enumerable:!0,get:function(){return N}});let O=R(5324);function N(T,S){let[R,M]=S,[L,U]=T;if(!(0,O.matchSegment)(L,R))return!!Array.isArray(L);let V=T.length<=2;return!V&&N(T.slice(2),M[U])}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},4249:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"createSearchParamsBailoutProxy",{enumerable:!0,get:function(){return N}});let O=R(9420);function N(){return new Proxy({},{get(T,S){"string"==typeof S&&(0,O.staticGenerationBailout)("searchParams."+S)}})}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},9420:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"staticGenerationBailout",{enumerable:!0,get:function(){return U}});let O=R(7743),N=R(4749);class M extends Error{constructor(...T){super(...T),this.code="NEXT_STATIC_GEN_BAILOUT"}}function L(T,S){let{dynamic:R,link:O}=S||{},N=O?" See more info here: "+O:"";return"Page"+(R?' with `dynamic = "'+R+'"`':"")+" couldn't be rendered statically because it used `"+T+"`."+N}let U=(T,S)=>{let R=N.staticGenerationAsyncStorage.getStore();if(null==R?void 0:R.forceStatic)return!0;if(null==R?void 0:R.dynamicShouldError){var U;throw new M(L(T,{...S,dynamic:null!=(U=null==S?void 0:S.dynamic)?U:"error"}))}if(R&&(R.revalidate=0),null==R?void 0:R.isStaticGeneration){let N=new O.DynamicServerError(L(T,{...S,link:"https://nextjs.org/docs/messages/dynamic-server-error"}));throw R.dynamicUsageDescription=T,R.dynamicUsageStack=N.stack,N}return!1};("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},2427:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"default",{enumerable:!0,get:function(){return L}});let O=R(2147),N=O._(R(9885)),M=R(4249);function L(T){let{Component:S,propsForComponent:R}=T,O=(0,M.createSearchParamsBailoutProxy)();return N.default.createElement(S,{searchParams:O,...R})}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},7028:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"useReducerWithReduxDevtools",{enumerable:!0,get:function(){return M}});let O=R(9885);function N(T,S){let[R,N]=(0,O.useReducer)(T,S);return[R,N,()=>{}]}let M=N;("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},9498:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"hasBasePath",{enumerable:!0,get:function(){return M}});let O=R(6896),N="";function M(T){return(0,O.pathHasPrefix)(T,N)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},1920:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"normalizePathTrailingSlash",{enumerable:!0,get:function(){return M}});let O=R(3383),N=R(2125),M=T=>{if(!T.startsWith("/"))return T;let{pathname:S,query:R,hash:M}=(0,N.parsePath)(T);return""+(0,O.removeTrailingSlash)(S)+R+M};("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},6671:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"removeBasePath",{enumerable:!0,get:function(){return N}}),R(9498);let O="";function N(T){return 0===O.length||(T=T.slice(O.length)).startsWith("/")||(T="/"+T),T}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},4035:(T,S)=>{"use strict";function R(T){let S=5381;for(let R=0;R<T.length;R++){let O=T.charCodeAt(R);S=(S<<5)+S+O}return Math.abs(S)}function O(T){return R(T).toString(36).slice(0,5)}Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{djb2Hash:function(){return R},hexHash:function(){return O}})},2796:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{suspense:function(){return N},NoSSR:function(){return M}}),R(2147),R(9885);let O=R(2943);function N(){let T=Error(O.NEXT_DYNAMIC_NO_SSR_CODE);throw T.digest=O.NEXT_DYNAMIC_NO_SSR_CODE,T}function M(T){let{children:S}=T;return N(),S}},2943:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"NEXT_DYNAMIC_NO_SSR_CODE",{enumerable:!0,get:function(){return R}});let R="NEXT_DYNAMIC_NO_SSR_CODE"},2883:(T,S)=>{"use strict";function R(T){return T.startsWith("/")?T:"/"+T}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"ensureLeadingSlash",{enumerable:!0,get:function(){return R}})},3916:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"addPathPrefix",{enumerable:!0,get:function(){return N}});let O=R(2125);function N(T,S){if(!T.startsWith("/")||!S)return T;let{pathname:R,query:N,hash:M}=(0,O.parsePath)(T);return""+S+R+N+M}},3663:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{normalizeAppPath:function(){return M},normalizeRscPath:function(){return L}});let O=R(2883),N=R(8882);function M(T){return(0,O.ensureLeadingSlash)(T.split("/").reduce((T,S,R,O)=>!S||(0,N.isGroupSegment)(S)||"@"===S[0]||("page"===S||"route"===S)&&R===O.length-1?T:T+"/"+S,""))}function L(T,S){return S?T.replace(/\.rsc($|\?)/,"$1"):T}},1688:(T,S)=>{"use strict";function R(T,S){if(void 0===S&&(S={}),S.onlyHashChange){T();return}let R=document.documentElement,O=R.style.scrollBehavior;R.style.scrollBehavior="auto",S.dontForceLayout||R.getClientRects(),T(),R.style.scrollBehavior=O}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"handleSmoothScroll",{enumerable:!0,get:function(){return R}})},504:(T,S)=>{"use strict";function R(T){return/Googlebot|Mediapartners-Google|AdsBot-Google|googleweblight|Storebot-Google|Google-PageRenderer|Bingbot|BingPreview|Slurp|DuckDuckBot|baiduspider|yandex|sogou|LinkedInBot|bitlybot|tumblr|vkShare|quora link preview|facebookexternalhit|facebookcatalog|Twitterbot|applebot|redditbot|Slackbot|Discordbot|WhatsApp|SkypeUriPreview|ia_archiver/i.test(T)}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"isBot",{enumerable:!0,get:function(){return R}})},2125:(T,S)=>{"use strict";function R(T){let S=T.indexOf("#"),R=T.indexOf("?"),O=R>-1&&(S<0||R<S);return O||S>-1?{pathname:T.substring(0,O?R:S),query:O?T.substring(R,S>-1?S:void 0):"",hash:S>-1?T.slice(S):""}:{pathname:T,query:"",hash:""}}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"parsePath",{enumerable:!0,get:function(){return R}})},6896:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"pathHasPrefix",{enumerable:!0,get:function(){return N}});let O=R(2125);function N(T,S){if("string"!=typeof T)return!1;let{pathname:R}=(0,O.parsePath)(T);return R===S||R.startsWith(S+"/")}},3383:(T,S)=>{"use strict";function R(T){return T.replace(/\/$/,"")||"/"}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"removeTrailingSlash",{enumerable:!0,get:function(){return R}})},8882:(T,S)=>{"use strict";function R(T){return"("===T[0]&&T.endsWith(")")}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"isGroupSegment",{enumerable:!0,get:function(){return R}})},7536:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"createProxy",{enumerable:!0,get:function(){return N}});let O=R(1447),N=O.createClientModuleProxy},3329:(T,S,R)=>{"use strict";let{createProxy:O}=R(7536);T.exports=O("/Users/mullamabusubhani/Desktop/Sateesh proj/project/node_modules/next/dist/client/components/app-router.js")},4183:(T,S,R)=>{"use strict";let{createProxy:O}=R(7536);T.exports=O("/Users/mullamabusubhani/Desktop/Sateesh proj/project/node_modules/next/dist/client/components/error-boundary.js")},5439:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{DYNAMIC_ERROR_CODE:function(){return R},DynamicServerError:function(){return O}});let R="DYNAMIC_SERVER_USAGE";class O extends Error{constructor(T){super("Dynamic server usage: "+T),this.digest=R}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},3701:(T,S,R)=>{"use strict";let{createProxy:O}=R(7536);T.exports=O("/Users/mullamabusubhani/Desktop/Sateesh proj/project/node_modules/next/dist/client/components/layout-router.js")},672:(T,S,R)=>{"use strict";let{createProxy:O}=R(7536);T.exports=O("/Users/mullamabusubhani/Desktop/Sateesh proj/project/node_modules/next/dist/client/components/not-found-boundary.js")},1918:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"default",{enumerable:!0,get:function(){return L}});let O=R(1974),N=O._(R(3830)),M={error:{fontFamily:'system-ui,"Segoe UI",Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji"',height:"100vh",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},desc:{display:"inline-block"},h1:{display:"inline-block",margin:"0 20px 0 0",padding:"0 23px 0 0",fontSize:24,fontWeight:500,verticalAlign:"top",lineHeight:"49px"},h2:{fontSize:14,fontWeight:400,lineHeight:"49px",margin:0}};function L(){return N.default.createElement(N.default.Fragment,null,N.default.createElement("title",null,"404: This page could not be found."),N.default.createElement("div",{style:M.error},N.default.createElement("div",null,N.default.createElement("style",{dangerouslySetInnerHTML:{__html:"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}),N.default.createElement("h1",{className:"next-error-h1",style:M.h1},"404"),N.default.createElement("div",{style:M.desc},N.default.createElement("h2",{style:M.h2},"This page could not be found.")))))}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},9902:(T,S,R)=>{"use strict";let{createProxy:O}=R(7536);T.exports=O("/Users/mullamabusubhani/Desktop/Sateesh proj/project/node_modules/next/dist/client/components/render-from-template-context.js")},4284:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"createSearchParamsBailoutProxy",{enumerable:!0,get:function(){return N}});let O=R(5020);function N(){return new Proxy({},{get(T,S){"string"==typeof S&&(0,O.staticGenerationBailout)("searchParams."+S)}})}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},5020:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"staticGenerationBailout",{enumerable:!0,get:function(){return U}});let O=R(5439),N=R(5869);class M extends Error{constructor(...T){super(...T),this.code="NEXT_STATIC_GEN_BAILOUT"}}function L(T,S){let{dynamic:R,link:O}=S||{},N=O?" See more info here: "+O:"";return"Page"+(R?' with `dynamic = "'+R+'"`':"")+" couldn't be rendered statically because it used `"+T+"`."+N}let U=(T,S)=>{let R=N.staticGenerationAsyncStorage.getStore();if(null==R?void 0:R.forceStatic)return!0;if(null==R?void 0:R.dynamicShouldError){var U;throw new M(L(T,{...S,dynamic:null!=(U=null==S?void 0:S.dynamic)?U:"error"}))}if(R&&(R.revalidate=0),null==R?void 0:R.isStaticGeneration){let N=new O.DynamicServerError(L(T,{...S,link:"https://nextjs.org/docs/messages/dynamic-server-error"}));throw R.dynamicUsageDescription=T,R.dynamicUsageStack=N.stack,N}return!1};("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},8816:(T,S,R)=>{"use strict";let{createProxy:O}=R(7536);T.exports=O("/Users/mullamabusubhani/Desktop/Sateesh proj/project/node_modules/next/dist/client/components/static-generation-searchparams-bailout-provider.js")},1775:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{AppRouter:function(){return O.default},LayoutRouter:function(){return N.default},RenderFromTemplateContext:function(){return M.default},staticGenerationAsyncStorage:function(){return L.staticGenerationAsyncStorage},requestAsyncStorage:function(){return U.requestAsyncStorage},actionAsyncStorage:function(){return V.actionAsyncStorage},staticGenerationBailout:function(){return K.staticGenerationBailout},createSearchParamsBailoutProxy:function(){return Q.createSearchParamsBailoutProxy},serverHooks:function(){return Y},renderToReadableStream:function(){return er},decodeReply:function(){return en},decodeAction:function(){return ei},preloadStyle:function(){return X.preloadStyle},preloadFont:function(){return X.preloadFont},preconnect:function(){return X.preconnect},StaticGenerationSearchParamsBailoutProvider:function(){return $.default},NotFoundBoundary:function(){return es}});let O=Z(R(3329)),N=Z(R(3701)),M=Z(R(9902)),L=R(5869),U=R(4580),V=R(2934),K=R(5020),$=Z(R(8816)),Q=R(4284),Y=et(R(5439)),X=R(1073);function Z(T){return T&&T.__esModule?T:{default:T}}function ee(T){if("function"!=typeof WeakMap)return null;var S=new WeakMap,R=new WeakMap;return(ee=function(T){return T?R:S})(T)}function et(T,S){if(!S&&T&&T.__esModule)return T;if(null===T||"object"!=typeof T&&"function"!=typeof T)return{default:T};var R=ee(S);if(R&&R.has(T))return R.get(T);var O={},N=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var M in T)if("default"!==M&&Object.prototype.hasOwnProperty.call(T,M)){var L=N?Object.getOwnPropertyDescriptor(T,M):null;L&&(L.get||L.set)?Object.defineProperty(O,M,L):O[M]=T[M]}return O.default=T,R&&R.set(T,O),O}let{renderToReadableStream:er,decodeReply:en,decodeAction:ei}=R(1447),{NotFoundBoundary:es}=R(672)},1073:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{preloadStyle:function(){return M},preloadFont:function(){return L},preconnect:function(){return U}});let O=N(R(7379));function N(T){return T&&T.__esModule?T:{default:T}}function M(T){O.default.preload(T,{as:"style"})}function L(T,S){O.default.preload(T,{as:"font",type:S})}function U(T,S){"string"==typeof S?O.default.preconnect(T,{crossOrigin:S}):O.default.preconnect(T)}},4647:(T,S)=>{"use strict";var R,O;R={value:!0},Object.defineProperty(S,"x",{enumerable:!0,get:function(){return O}}),function(T){T.PAGES="PAGES",T.PAGES_API="PAGES_API",T.APP_PAGE="APP_PAGE",T.APP_ROUTE="APP_ROUTE"}(O||(O={}))},3137:(T,S,R)=>{"use strict";T.exports=R(399)},7379:(T,S,R)=>{"use strict";T.exports=R(3137).vendored["react-rsc"].ReactDOM},1447:(T,S,R)=>{"use strict";T.exports=R(3137).vendored["react-rsc"].ReactServerDOMWebpackServerEdge},3830:(T,S,R)=>{"use strict";T.exports=R(3137).vendored["react-rsc"].React},8144:(T,S,R)=>{"use strict";T.exports=R(3137).vendored["react-shared"].ReactJsxRuntime},2290:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"getSegmentParam",{enumerable:!0,get:function(){return N}});let O=R(4265);function N(T){let S=O.INTERCEPTION_ROUTE_MARKERS.find(S=>T.startsWith(S));return(S&&(T=T.slice(S.length)),T.startsWith("[[...")&&T.endsWith("]]"))?{type:"optional-catchall",param:T.slice(5,-2)}:T.startsWith("[...")&&T.endsWith("]")?{type:"catchall",param:T.slice(4,-1)}:T.startsWith("[")&&T.endsWith("]")?{type:"dynamic",param:T.slice(1,-1)}:null}},4265:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{INTERCEPTION_ROUTE_MARKERS:function(){return N},isInterceptionRouteAppPath:function(){return M},extractInterceptionRouteInformation:function(){return L}});let O=R(3663),N=["(..)(..)","(.)","(..)","(...)"];function M(T){return void 0!==T.split("/").find(T=>N.find(S=>T.startsWith(S)))}function L(T){let S,R,M;for(let O of T.split("/"))if(R=N.find(T=>O.startsWith(T))){[S,M]=T.split(R,2);break}if(!S||!R||!M)throw Error(`Invalid interception route: ${T}. Must be in the format /<intercepting route>/(..|...|..)(..)/<intercepted route>`);switch(S=(0,O.normalizeAppPath)(S),R){case"(.)":M="/"===S?`/${M}`:S+"/"+M;break;case"(..)":if("/"===S)throw Error(`Invalid interception route: ${T}. Cannot use (..) marker at the root level, use (.) instead.`);M=S.split("/").slice(0,-1).concat(M).join("/");break;case"(...)":M="/"+M;break;case"(..)(..)":let L=S.split("/");if(L.length<=2)throw Error(`Invalid interception route: ${T}. Cannot use (..)(..) marker at the root level or one level up.`);M=L.slice(0,-2).concat(M).join("/");break;default:throw Error("Invariant: unexpected marker")}return{interceptingRoute:S,interceptedRoute:M}}},316:(T,S,R)=>{"use strict";T.exports=R(399)},2428:(T,S,R)=>{"use strict";T.exports=R(316).vendored.contexts.AppRouterContext},1736:(T,S,R)=>{"use strict";T.exports=R(316).vendored.contexts.HooksClientContext},5753:(T,S,R)=>{"use strict";T.exports=R(316).vendored.contexts.ServerInsertedHtml},80:(T,S,R)=>{"use strict";T.exports=R(316).vendored["react-shared"].ReactJsxRuntime},8908:(T,S,R)=>{"use strict";T.exports=R(316).vendored["react-ssr"].ReactDOM},2623:(T,S,R)=>{"use strict";T.exports=R(316).vendored["react-ssr"].ReactServerDOMWebpackClientEdge},9885:(T,S,R)=>{"use strict";T.exports=R(316).vendored["react-ssr"].React},5307:(T,S,R)=>{"use strict";var O=R(5962);T.exports=S=O.descriptor=O.Root.fromJSON(R(9987)).lookup(".google.protobuf");var N=O.Namespace,M=O.Root,L=O.Enum,U=O.Type,V=O.Field,K=O.MapField,$=O.OneOf,Q=O.Service,Y=O.Method;function X(T,R,O){var K=S.FileDescriptorProto.create({name:T.filename||(T.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});eg(O,K),T instanceof M||(K.package=T.fullName.substring(1));for(var $,Y=0;Y<T.nestedArray.length;++Y)($=T._nestedArray[Y])instanceof U?K.messageType.push($.toDescriptor(O)):$ instanceof L?K.enumType.push($.toDescriptor()):$ instanceof V?K.extension.push($.toDescriptor(O)):$ instanceof Q?K.service.push($.toDescriptor()):$ instanceof N&&X($,R,O);K.options=eh(T.options,S.FileOptions),K.messageType.length+K.enumType.length+K.extension.length+K.service.length&&R.push(K)}M.fromDescriptor=function(T){"number"==typeof T.length&&(T=S.FileDescriptorSet.decode(T));var R=new M;if(T.file)for(var O,N,K,$=0;$<T.file.length;++$){N=R,(O=T.file[$]).package&&O.package.length&&(N=R.define(O.package));var Y=em(O);if(O.name&&O.name.length&&R.files.push(N.filename=O.name),O.messageType)for(K=0;K<O.messageType.length;++K)N.add(U.fromDescriptor(O.messageType[K],Y));if(O.enumType)for(K=0;K<O.enumType.length;++K)N.add(L.fromDescriptor(O.enumType[K],Y));if(O.extension)for(K=0;K<O.extension.length;++K)N.add(V.fromDescriptor(O.extension[K],Y));if(O.service)for(K=0;K<O.service.length;++K)N.add(Q.fromDescriptor(O.service[K],Y));var X=ec(O.options,S.FileOptions);if(X){var Z=Object.keys(X);for(K=0;K<Z.length;++K)N.setOption(Z[K],X[Z[K]])}}return R.resolveAll()},M.prototype.toDescriptor=function(T){var R=S.FileDescriptorSet.create();return X(this,R.file,T),R};var Z=0;U.fromDescriptor=function(T,R,O){"number"==typeof T.length&&(T=S.DescriptorProto.decode(T));var N,M=new U(T.name.length?T.name:"Type"+Z++,ec(T.options,S.MessageOptions));if(O||(M._edition=R),T.oneofDecl)for(N=0;N<T.oneofDecl.length;++N)M.add($.fromDescriptor(T.oneofDecl[N]));if(T.field)for(N=0;N<T.field.length;++N){var K=V.fromDescriptor(T.field[N],R,!0);M.add(K),T.field[N].hasOwnProperty("oneofIndex")&&M.oneofsArray[T.field[N].oneofIndex].add(K)}if(T.extension)for(N=0;N<T.extension.length;++N)M.add(V.fromDescriptor(T.extension[N],R,!0));if(T.nestedType)for(N=0;N<T.nestedType.length;++N)M.add(U.fromDescriptor(T.nestedType[N],R,!0)),T.nestedType[N].options&&T.nestedType[N].options.mapEntry&&M.setOption("map_entry",!0);if(T.enumType)for(N=0;N<T.enumType.length;++N)M.add(L.fromDescriptor(T.enumType[N],R,!0));if(T.extensionRange&&T.extensionRange.length)for(N=0,M.extensions=[];N<T.extensionRange.length;++N)M.extensions.push([T.extensionRange[N].start,T.extensionRange[N].end]);if(T.reservedRange&&T.reservedRange.length||T.reservedName&&T.reservedName.length){if(M.reserved=[],T.reservedRange)for(N=0;N<T.reservedRange.length;++N)M.reserved.push([T.reservedRange[N].start,T.reservedRange[N].end]);if(T.reservedName)for(N=0;N<T.reservedName.length;++N)M.reserved.push(T.reservedName[N])}return M},U.prototype.toDescriptor=function(T){var R,O,N=S.DescriptorProto.create({name:this.name});for(O=0;O<this.fieldsArray.length;++O)if(N.field.push(R=this._fieldsArray[O].toDescriptor(T)),this._fieldsArray[O]instanceof K){var M=eo(this._fieldsArray[O].keyType,this._fieldsArray[O].resolvedKeyType,!1),$=eo(this._fieldsArray[O].type,this._fieldsArray[O].resolvedType,!1),Q=11===$||14===$?this._fieldsArray[O].resolvedType&&ef(this.parent,this._fieldsArray[O].resolvedType)||this._fieldsArray[O].type:void 0;N.nestedType.push(S.DescriptorProto.create({name:R.typeName,field:[S.FieldDescriptorProto.create({name:"key",number:1,label:1,type:M}),S.FieldDescriptorProto.create({name:"value",number:2,label:1,type:$,typeName:Q})],options:S.MessageOptions.create({mapEntry:!0})}))}for(O=0;O<this.oneofsArray.length;++O)N.oneofDecl.push(this._oneofsArray[O].toDescriptor());for(O=0;O<this.nestedArray.length;++O)this._nestedArray[O]instanceof V?N.field.push(this._nestedArray[O].toDescriptor(T)):this._nestedArray[O]instanceof U?N.nestedType.push(this._nestedArray[O].toDescriptor(T)):this._nestedArray[O]instanceof L&&N.enumType.push(this._nestedArray[O].toDescriptor());if(this.extensions)for(O=0;O<this.extensions.length;++O)N.extensionRange.push(S.DescriptorProto.ExtensionRange.create({start:this.extensions[O][0],end:this.extensions[O][1]}));if(this.reserved)for(O=0;O<this.reserved.length;++O)"string"==typeof this.reserved[O]?N.reservedName.push(this.reserved[O]):N.reservedRange.push(S.DescriptorProto.ReservedRange.create({start:this.reserved[O][0],end:this.reserved[O][1]}));return N.options=eh(this.options,S.MessageOptions),N};var ee=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;V.fromDescriptor=function(T,R,O){if("number"==typeof T.length&&(T=S.DescriptorProto.decode(T)),"number"!=typeof T.number)throw Error("missing field id");switch(N=T.typeName&&T.typeName.length?T.typeName:es(T.type),T.label){case 1:M=void 0;break;case 2:M="required";break;case 3:M="repeated";break;default:throw Error("illegal label: "+T.label)}var N,M,L=T.extendee;void 0!==T.extendee&&(L=L.length?L:void 0);var U=new V(T.name.length?T.name:"field"+T.number,T.number,N,M,L);if(O||(U._edition=R),U.options=ec(T.options,S.FieldOptions),T.proto3_optional&&(U.options.proto3_optional=!0),T.defaultValue&&T.defaultValue.length){var K=T.defaultValue;switch(K){case"true":case"TRUE":K=!0;break;case"false":case"FALSE":K=!1;break;default:ee.exec(K)&&(K=parseInt(K))}U.setOption("default",K)}return ea(T.type)&&("proto3"===R?T.options&&!T.options.packed&&U.setOption("packed",!1):(!R||"proto2"===R)&&T.options&&T.options.packed&&U.setOption("packed",!0)),U},V.prototype.toDescriptor=function(T){var R=S.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)R.type=11,R.typeName=O.util.ucFirst(this.name),R.label=3;else{switch(R.type=eo(this.type,this.resolve().resolvedType,this.delimited)){case 10:case 11:case 14:R.typeName=this.resolvedType?ef(this.parent,this.resolvedType):this.type}"repeated"===this.rule?R.label=3:this.required&&"proto2"===T?R.label=2:R.label=1}if(R.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(R.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(R.options=eh(this.options,S.FieldOptions),null!=this.options.default&&(R.defaultValue=String(this.options.default)),this.options.proto3_optional&&(R.proto3_optional=!0)),"proto3"===T?this.packed||((R.options||(R.options=S.FieldOptions.create())).packed=!1):(!T||"proto2"===T)&&this.packed&&((R.options||(R.options=S.FieldOptions.create())).packed=!0),R};var et=0;L.fromDescriptor=function(T,R,O){"number"==typeof T.length&&(T=S.EnumDescriptorProto.decode(T));var N={};if(T.value)for(var M=0;M<T.value.length;++M){var U=T.value[M].name,V=T.value[M].number||0;N[U&&U.length?U:"NAME"+V]=V}var K=new L(T.name&&T.name.length?T.name:"Enum"+et++,N,ec(T.options,S.EnumOptions));return O||(K._edition=R),K},L.prototype.toDescriptor=function(){for(var T=[],R=0,O=Object.keys(this.values);R<O.length;++R)T.push(S.EnumValueDescriptorProto.create({name:O[R],number:this.values[O[R]]}));return S.EnumDescriptorProto.create({name:this.name,value:T,options:eh(this.options,S.EnumOptions)})};var er=0;$.fromDescriptor=function(T){return"number"==typeof T.length&&(T=S.OneofDescriptorProto.decode(T)),new $(T.name&&T.name.length?T.name:"oneof"+er++)},$.prototype.toDescriptor=function(){return S.OneofDescriptorProto.create({name:this.name})};var en=0;Q.fromDescriptor=function(T,R,O){"number"==typeof T.length&&(T=S.ServiceDescriptorProto.decode(T));var N=new Q(T.name&&T.name.length?T.name:"Service"+en++,ec(T.options,S.ServiceOptions));if(O||(N._edition=R),T.method)for(var M=0;M<T.method.length;++M)N.add(Y.fromDescriptor(T.method[M]));return N},Q.prototype.toDescriptor=function(){for(var T=[],R=0;R<this.methodsArray.length;++R)T.push(this._methodsArray[R].toDescriptor());return S.ServiceDescriptorProto.create({name:this.name,method:T,options:eh(this.options,S.ServiceOptions)})};var ei=0;function es(T){switch(T){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+T)}function ea(T){switch(T){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function eo(T,S,R){switch(T){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(S instanceof L)return 14;if(S instanceof U)return R?10:11;throw Error("illegal type: "+T)}function eu(T,S){for(var R,O,N={},M=0;M<S.fieldsArray.length;++M)if("uninterpretedOption"!==(O=(R=S._fieldsArray[M]).name)&&Object.prototype.hasOwnProperty.call(T,O)){var V=ep(O);R.resolvedType instanceof U?N[V]=eu(T[O],R.resolvedType):R.resolvedType instanceof L?N[V]=R.resolvedType.valuesById[T[O]]:N[V]=T[O]}return N}function ec(T,S){if(T)return eu(S.toObject(T),S)}function ed(T,S){for(var R={},N=Object.keys(T),M=0;M<N.length;++M){var L=N[M],V=O.util.camelCase(L);if(Object.prototype.hasOwnProperty.call(S.fields,V)){var K=S.fields[V];K.resolvedType instanceof U?R[V]=ed(T[L],K.resolvedType):R[V]=T[L],K.repeated&&!Array.isArray(R[V])&&(R[V]=[R[V]])}}return R}function eh(T,S){if(T)return S.fromObject(ed(T,S))}function ef(T,S){var R=T.fullName.split("."),O=S.fullName.split("."),L=0,U=0,V=O.length-1;if(!(T instanceof M)&&S instanceof N)for(;L<R.length&&U<V&&R[L]===O[U];){var K=S.lookup(R[L++],!0);if(null!==K&&K!==S)break;++U}else for(;L<R.length&&U<V&&R[L]===O[U];++L,++U);return O.slice(U).join(".")}function ep(T){return T.substring(0,1)+T.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(T,S){return"_"+S.toLowerCase()})}function em(T){if("editions"===T.syntax){if(T.edition===S.Edition.EDITION_2023)return"2023";throw Error("Unsupported edition "+T.edition)}return"proto3"===T.syntax?"proto3":"proto2"}function eg(T,R){if(T){if("proto2"===T||"proto3"===T)R.syntax=T;else if(R.syntax="editions","2023"===T)R.edition=S.Edition.EDITION_2023;else throw Error("Unsupported edition "+T)}}Y.fromDescriptor=function(T){return"number"==typeof T.length&&(T=S.MethodDescriptorProto.decode(T)),new Y(T.name&&T.name.length?T.name:"Method"+ei++,"rpc",T.inputType,T.outputType,!!T.clientStreaming,!!T.serverStreaming,ec(T.options,S.MethodOptions))},Y.prototype.toDescriptor=function(){return S.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:eh(this.options,S.MethodOptions)})}},5962:(T,S,R)=>{"use strict";T.exports=R(3517)},9760:T=>{"use strict";T.exports=O;var S,R=/\/|\./;function O(T,S){R.test(T)||(T="google/protobuf/"+T+".proto",S={nested:{google:{nested:{protobuf:{nested:S}}}}}),O[T]=S}O("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),O("duration",{Duration:S={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),O("timestamp",{Timestamp:S}),O("empty",{Empty:{fields:{}}}),O("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),O("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),O("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),O.get=function(T){return O[T]||null}},4144:(T,S,R)=>{"use strict";var O=S,N=R(9246),M=R(6738);function L(T,S,R,O){var M=!1;if(S.resolvedType){if(S.resolvedType instanceof N){T("switch(d%s){",O);for(var L=S.resolvedType.values,U=Object.keys(L),V=0;V<U.length;++V)L[U[V]]!==S.typeDefault||M||(T("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',O,O,O),S.repeated||T("break"),M=!0),T("case%j:",U[V])("case %i:",L[U[V]])("m%s=%j",O,L[U[V]])("break");T("}")}else T('if(typeof d%s!=="object")',O)("throw TypeError(%j)",S.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",O,R,O)}else{var K=!1;switch(S.type){case"double":case"float":T("m%s=Number(d%s)",O,O);break;case"uint32":case"fixed32":T("m%s=d%s>>>0",O,O);break;case"int32":case"sint32":case"sfixed32":T("m%s=d%s|0",O,O);break;case"uint64":K=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":T("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",O,O,K)('else if(typeof d%s==="string")',O)("m%s=parseInt(d%s,10)",O,O)('else if(typeof d%s==="number")',O)("m%s=d%s",O,O)('else if(typeof d%s==="object")',O)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",O,O,O,K?"true":"");break;case"bytes":T('if(typeof d%s==="string")',O)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",O,O,O)("else if(d%s.length >= 0)",O)("m%s=d%s",O,O);break;case"string":T("m%s=String(d%s)",O,O);break;case"bool":T("m%s=Boolean(d%s)",O,O)}}return T}function U(T,S,R,O){if(S.resolvedType)S.resolvedType instanceof N?T("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",O,R,O,O,R,O,O):T("d%s=types[%i].toObject(m%s,o)",O,R,O);else{var M=!1;switch(S.type){case"double":case"float":T("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",O,O,O,O);break;case"uint64":M=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":T('if(typeof m%s==="number")',O)("d%s=o.longs===String?String(m%s):m%s",O,O,O)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",O,O,O,O,M?"true":"",O);break;case"bytes":T("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",O,O,O,O,O);break;default:T("d%s=m%s",O,O)}}return T}O.fromObject=function(T){var S=T.fieldsArray,R=M.codegen(["d"],T.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!S.length)return R("return new this.ctor");R("var m=new this.ctor");for(var O=0;O<S.length;++O){var U=S[O].resolve(),V=M.safeProp(U.name);U.map?(R("if(d%s){",V)('if(typeof d%s!=="object")',V)("throw TypeError(%j)",U.fullName+": object expected")("m%s={}",V)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",V),L(R,U,O,V+"[ks[i]]")("}")("}")):U.repeated?(R("if(d%s){",V)("if(!Array.isArray(d%s))",V)("throw TypeError(%j)",U.fullName+": array expected")("m%s=[]",V)("for(var i=0;i<d%s.length;++i){",V),L(R,U,O,V+"[i]")("}")("}")):(U.resolvedType instanceof N||R("if(d%s!=null){",V),L(R,U,O,V),U.resolvedType instanceof N||R("}"))}return R("return m")},O.toObject=function(T){var S=T.fieldsArray.slice().sort(M.compareFieldsById);if(!S.length)return M.codegen()("return {}");for(var R=M.codegen(["m","o"],T.name+"$toObject")("if(!o)")("o={}")("var d={}"),O=[],L=[],V=[],K=0;K<S.length;++K)S[K].partOf||(S[K].resolve().repeated?O:S[K].map?L:V).push(S[K]);if(O.length){for(R("if(o.arrays||o.defaults){"),K=0;K<O.length;++K)R("d%s=[]",M.safeProp(O[K].name));R("}")}if(L.length){for(R("if(o.objects||o.defaults){"),K=0;K<L.length;++K)R("d%s={}",M.safeProp(L[K].name));R("}")}if(V.length){for(R("if(o.defaults){"),K=0;K<V.length;++K){var $=V[K],Q=M.safeProp($.name);if($.resolvedType instanceof N)R("d%s=o.enums===String?%j:%j",Q,$.resolvedType.valuesById[$.typeDefault],$.typeDefault);else if($.long)R("if(util.Long){")("var n=new util.Long(%i,%i,%j)",$.typeDefault.low,$.typeDefault.high,$.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",Q)("}else")("d%s=o.longs===String?%j:%i",Q,$.typeDefault.toString(),$.typeDefault.toNumber());else if($.bytes){var Y="["+Array.prototype.slice.call($.typeDefault).join(",")+"]";R("if(o.bytes===String)d%s=%j",Q,String.fromCharCode.apply(String,$.typeDefault))("else{")("d%s=%s",Q,Y)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",Q,Q)("}")}else R("d%s=%j",Q,$.typeDefault)}R("}")}var X=!1;for(K=0;K<S.length;++K){var $=S[K],Z=T._fieldsArray.indexOf($),Q=M.safeProp($.name);$.map?(X||(X=!0,R("var ks2")),R("if(m%s&&(ks2=Object.keys(m%s)).length){",Q,Q)("d%s={}",Q)("for(var j=0;j<ks2.length;++j){"),U(R,$,Z,Q+"[ks2[j]]")("}")):$.repeated?(R("if(m%s&&m%s.length){",Q,Q)("d%s=[]",Q)("for(var j=0;j<m%s.length;++j){",Q),U(R,$,Z,Q+"[j]")("}")):(R("if(m%s!=null&&m.hasOwnProperty(%j)){",Q,$.name),U(R,$,Z,Q),$.partOf&&R("if(o.oneofs)")("d%s=%j",M.safeProp($.partOf.name),$.name)),R("}")}return R("return d")}},7317:(T,S,R)=>{"use strict";T.exports=U;var O=R(9246),N=R(1708),M=R(6738);function L(T){return"missing required '"+T.name+"'"}function U(T){for(var S=M.codegen(["r","l","e"],T.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(T.fieldsArray.filter(function(T){return T.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()")("if(t===e)")("break")("switch(t>>>3){"),R=0;R<T.fieldsArray.length;++R){var U=T._fieldsArray[R].resolve(),V=U.resolvedType instanceof O?"int32":U.type,K="m"+M.safeProp(U.name);S("case %i: {",U.id),U.map?(S("if(%s===util.emptyObject)",K)("%s={}",K)("var c2 = r.uint32()+r.pos"),void 0!==N.defaults[U.keyType]?S("k=%j",N.defaults[U.keyType]):S("k=null"),void 0!==N.defaults[V]?S("value=%j",N.defaults[V]):S("value=null"),S("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",U.keyType)("case 2:"),void 0===N.basic[V]?S("value=types[%i].decode(r,r.uint32())",R):S("value=r.%s()",V),S("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),S(void 0!==N.long[U.keyType]?'%s[typeof k==="object"?util.longToHash(k):k]=value':"%s[k]=value",K)):U.repeated?(S("if(!(%s&&%s.length))",K,K)("%s=[]",K),void 0!==N.packed[V]&&S("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",K,V)("}else"),void 0===N.basic[V]?S(U.delimited?"%s.push(types[%i].decode(r,undefined,((t&~7)|4)))":"%s.push(types[%i].decode(r,r.uint32()))",K,R):S("%s.push(r.%s())",K,V)):void 0===N.basic[V]?S(U.delimited?"%s=types[%i].decode(r,undefined,((t&~7)|4))":"%s=types[%i].decode(r,r.uint32())",K,R):S("%s=r.%s()",K,V),S("break")("}")}for(S("default:")("r.skipType(t&7)")("break")("}")("}"),R=0;R<T._fieldsArray.length;++R){var $=T._fieldsArray[R];$.required&&S("if(!m.hasOwnProperty(%j))",$.name)("throw util.ProtocolError(%j,{instance:m})",L($))}return S("return m")}},9561:(T,S,R)=>{"use strict";T.exports=U;var O=R(9246),N=R(1708),M=R(6738);function L(T,S,R,O){return S.delimited?T("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",R,O,(S.id<<3|3)>>>0,(S.id<<3|4)>>>0):T("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",R,O,(S.id<<3|2)>>>0)}function U(T){for(var S,R,U=M.codegen(["m","w"],T.name+"$encode")("if(!w)")("w=Writer.create()"),V=T.fieldsArray.slice().sort(M.compareFieldsById),S=0;S<V.length;++S){var K=V[S].resolve(),$=T._fieldsArray.indexOf(K),Q=K.resolvedType instanceof O?"int32":K.type,Y=N.basic[Q];R="m"+M.safeProp(K.name),K.map?(U("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",R,K.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",R)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(K.id<<3|2)>>>0,8|N.mapKey[K.keyType],K.keyType),void 0===Y?U("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",$,R):U(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|Y,Q,R),U("}")("}")):K.repeated?(U("if(%s!=null&&%s.length){",R,R),K.packed&&void 0!==N.packed[Q]?U("w.uint32(%i).fork()",(K.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",R)("w.%s(%s[i])",Q,R)("w.ldelim()"):(U("for(var i=0;i<%s.length;++i)",R),void 0===Y?L(U,K,$,R+"[i]"):U("w.uint32(%i).%s(%s[i])",(K.id<<3|Y)>>>0,Q,R)),U("}")):(K.optional&&U("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",R,K.name),void 0===Y?L(U,K,$,R):U("w.uint32(%i).%s(%s)",(K.id<<3|Y)>>>0,Q,R))}return U("return w")}},9246:(T,S,R)=>{"use strict";T.exports=L;var O=R(1862);((L.prototype=Object.create(O.prototype)).constructor=L).className="Enum";var N=R(7540),M=R(6738);function L(T,S,R,N,M,L){if(O.call(this,T,R),S&&"object"!=typeof S)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=N,this.comments=M||{},this.valuesOptions=L,this._valuesFeatures={},this.reserved=void 0,S)for(var U=Object.keys(S),V=0;V<U.length;++V)"number"==typeof S[U[V]]&&(this.valuesById[this.values[U[V]]=S[U[V]]]=U[V])}L.prototype._resolveFeatures=function(T){return T=this._edition||T,O.prototype._resolveFeatures.call(this,T),Object.keys(this.values).forEach(T=>{var S=Object.assign({},this._features);this._valuesFeatures[T]=Object.assign(S,this.valuesOptions&&this.valuesOptions[T]&&this.valuesOptions[T].features)}),this},L.fromJSON=function(T,S){var R=new L(T,S.values,S.options,S.comment,S.comments);return R.reserved=S.reserved,S.edition&&(R._edition=S.edition),R._defaultEdition="proto3",R},L.prototype.toJSON=function(T){var S=!!T&&!!T.keepComments;return M.toObject(["edition",this._editionToJSON(),"options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",S?this.comment:void 0,"comments",S?this.comments:void 0])},L.prototype.add=function(T,S,R,O){if(!M.isString(T))throw TypeError("name must be a string");if(!M.isInteger(S))throw TypeError("id must be an integer");if(void 0!==this.values[T])throw Error("duplicate name '"+T+"' in "+this);if(this.isReservedId(S))throw Error("id "+S+" is reserved in "+this);if(this.isReservedName(T))throw Error("name '"+T+"' is reserved in "+this);if(void 0!==this.valuesById[S]){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+S+" in "+this);this.values[T]=S}else this.valuesById[this.values[T]=S]=T;return O&&(void 0===this.valuesOptions&&(this.valuesOptions={}),this.valuesOptions[T]=O||null),this.comments[T]=R||null,this},L.prototype.remove=function(T){if(!M.isString(T))throw TypeError("name must be a string");var S=this.values[T];if(null==S)throw Error("name '"+T+"' does not exist in "+this);return delete this.valuesById[S],delete this.values[T],delete this.comments[T],this.valuesOptions&&delete this.valuesOptions[T],this},L.prototype.isReservedId=function(T){return N.isReservedId(this.reserved,T)},L.prototype.isReservedName=function(T){return N.isReservedName(this.reserved,T)}},3980:(T,S,R)=>{"use strict";T.exports=K;var O,N=R(1862);((K.prototype=Object.create(N.prototype)).constructor=K).className="Field";var M=R(9246),L=R(1708),U=R(6738),V=/^required|optional|repeated$/;function K(T,S,R,O,M,K,$){if(U.isObject(O)?($=M,K=O,O=M=void 0):U.isObject(M)&&($=K,K=M,M=void 0),N.call(this,T,K),!U.isInteger(S)||S<0)throw TypeError("id must be a non-negative integer");if(!U.isString(R))throw TypeError("type must be a string");if(void 0!==O&&!V.test(O=O.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==M&&!U.isString(M))throw TypeError("extend must be a string");"proto3_optional"===O&&(O="optional"),this.rule=O&&"optional"!==O?O:void 0,this.type=R,this.id=S,this.extend=M||void 0,this.repeated="repeated"===O,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!U.Long&&void 0!==L.long[R],this.bytes="bytes"===R,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this.comment=$}K.fromJSON=function(T,S){var R=new K(T,S.id,S.type,S.rule,S.extend,S.options,S.comment);return S.edition&&(R._edition=S.edition),R._defaultEdition="proto3",R},Object.defineProperty(K.prototype,"required",{get:function(){return"LEGACY_REQUIRED"===this._features.field_presence}}),Object.defineProperty(K.prototype,"optional",{get:function(){return!this.required}}),Object.defineProperty(K.prototype,"delimited",{get:function(){return this.resolvedType instanceof O&&"DELIMITED"===this._features.message_encoding}}),Object.defineProperty(K.prototype,"packed",{get:function(){return"PACKED"===this._features.repeated_field_encoding}}),Object.defineProperty(K.prototype,"hasPresence",{get:function(){return!this.repeated&&!this.map&&(this.partOf||this.declaringField||this.extensionField||"IMPLICIT"!==this._features.field_presence)}}),K.prototype.setOption=function(T,S,R){return N.prototype.setOption.call(this,T,S,R)},K.prototype.toJSON=function(T){var S=!!T&&!!T.keepComments;return U.toObject(["edition",this._editionToJSON(),"rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",S?this.comment:void 0])},K.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=L.defaults[this.type])?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof O?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof M&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof M||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=U.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var T;U.base64.test(this.typeDefault)?U.base64.decode(this.typeDefault,T=U.newBuffer(U.base64.length(this.typeDefault)),0):U.utf8.write(this.typeDefault,T=U.newBuffer(U.utf8.length(this.typeDefault)),0),this.typeDefault=T}return this.map?this.defaultValue=U.emptyObject:this.repeated?this.defaultValue=U.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof O&&(this.parent.ctor.prototype[this.name]=this.defaultValue),N.prototype.resolve.call(this)},K.prototype._inferLegacyProtoFeatures=function(T){if("proto2"!==T&&"proto3"!==T)return{};var S={};if("required"===this.rule&&(S.field_presence="LEGACY_REQUIRED"),this.parent&&void 0===L.defaults[this.type]){var R=this.parent.get(this.type.split(".").pop());R&&R instanceof O&&R.group&&(S.message_encoding="DELIMITED")}return!0===this.getOption("packed")?S.repeated_field_encoding="PACKED":!1===this.getOption("packed")&&(S.repeated_field_encoding="EXPANDED"),S},K.prototype._resolveFeatures=function(T){return N.prototype._resolveFeatures.call(this,this._edition||T)},K.d=function(T,S,R,O){return"function"==typeof S?S=U.decorateType(S).name:S&&"object"==typeof S&&(S=U.decorateEnum(S).name),function(N,M){U.decorateType(N.constructor).add(new K(M,T,S,R,{default:O}))}},K._configure=function(T){O=T}},2982:(T,S,R)=>{"use strict";var O=T.exports=R(2985);function N(T,S,R){return"function"==typeof S?(R=S,S=new O.Root):S||(S=new O.Root),S.load(T,R)}function M(T,S){return S||(S=new O.Root),S.loadSync(T)}O.build="light",O.load=N,O.loadSync=M,O.encoder=R(9561),O.decoder=R(7317),O.verifier=R(7585),O.converter=R(4144),O.ReflectionObject=R(1862),O.Namespace=R(7540),O.Root=R(8373),O.Enum=R(9246),O.Type=R(9340),O.Field=R(3980),O.OneOf=R(2866),O.MapField=R(7597),O.Service=R(2791),O.Method=R(8909),O.Message=R(4294),O.wrappers=R(4038),O.types=R(1708),O.util=R(6738),O.ReflectionObject._configure(O.Root),O.Namespace._configure(O.Type,O.Service,O.Enum),O.Root._configure(O.Type),O.Field._configure(O.Type)},2985:(T,S,R)=>{"use strict";var O=S;function N(){O.util._configure(),O.Writer._configure(O.BufferWriter),O.Reader._configure(O.BufferReader)}O.build="minimal",O.Writer=R(4353),O.BufferWriter=R(1978),O.Reader=R(5199),O.BufferReader=R(5213),O.util=R(8932),O.rpc=R(9226),O.roots=R(182),O.configure=N,N()},3517:(T,S,R)=>{"use strict";var O=T.exports=R(2982);O.build="full",O.tokenize=R(6116),O.parse=R(7897),O.common=R(9760),O.Root._configure(O.Type,O.parse,O.common)},7597:(T,S,R)=>{"use strict";T.exports=L;var O=R(3980);((L.prototype=Object.create(O.prototype)).constructor=L).className="MapField";var N=R(1708),M=R(6738);function L(T,S,R,N,L,U){if(O.call(this,T,S,N,void 0,void 0,L,U),!M.isString(R))throw TypeError("keyType must be a string");this.keyType=R,this.resolvedKeyType=null,this.map=!0}L.fromJSON=function(T,S){return new L(T,S.id,S.keyType,S.type,S.options,S.comment)},L.prototype.toJSON=function(T){var S=!!T&&!!T.keepComments;return M.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",S?this.comment:void 0])},L.prototype.resolve=function(){if(this.resolved)return this;if(void 0===N.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return O.prototype.resolve.call(this)},L.d=function(T,S,R){return"function"==typeof R?R=M.decorateType(R).name:R&&"object"==typeof R&&(R=M.decorateEnum(R).name),function(O,N){M.decorateType(O.constructor).add(new L(N,T,S,R))}}},4294:(T,S,R)=>{"use strict";T.exports=N;var O=R(8932);function N(T){if(T)for(var S=Object.keys(T),R=0;R<S.length;++R)this[S[R]]=T[S[R]]}N.create=function(T){return this.$type.create(T)},N.encode=function(T,S){return this.$type.encode(T,S)},N.encodeDelimited=function(T,S){return this.$type.encodeDelimited(T,S)},N.decode=function(T){return this.$type.decode(T)},N.decodeDelimited=function(T){return this.$type.decodeDelimited(T)},N.verify=function(T){return this.$type.verify(T)},N.fromObject=function(T){return this.$type.fromObject(T)},N.toObject=function(T,S){return this.$type.toObject(T,S)},N.prototype.toJSON=function(){return this.$type.toObject(this,O.toJSONOptions)}},8909:(T,S,R)=>{"use strict";T.exports=M;var O=R(1862);((M.prototype=Object.create(O.prototype)).constructor=M).className="Method";var N=R(6738);function M(T,S,R,M,L,U,V,K,$){if(N.isObject(L)?(V=L,L=U=void 0):N.isObject(U)&&(V=U,U=void 0),!(void 0===S||N.isString(S)))throw TypeError("type must be a string");if(!N.isString(R))throw TypeError("requestType must be a string");if(!N.isString(M))throw TypeError("responseType must be a string");O.call(this,T,V),this.type=S||"rpc",this.requestType=R,this.requestStream=!!L||void 0,this.responseType=M,this.responseStream=!!U||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=K,this.parsedOptions=$}M.fromJSON=function(T,S){return new M(T,S.type,S.requestType,S.responseType,S.requestStream,S.responseStream,S.options,S.comment,S.parsedOptions)},M.prototype.toJSON=function(T){var S=!!T&&!!T.keepComments;return N.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",S?this.comment:void 0,"parsedOptions",this.parsedOptions])},M.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),O.prototype.resolve.call(this))}},7540:(T,S,R)=>{"use strict";T.exports=Q;var O,N,M,L=R(1862);((Q.prototype=Object.create(L.prototype)).constructor=Q).className="Namespace";var U=R(3980),V=R(6738),K=R(2866);function $(T,S){if(T&&T.length){for(var R={},O=0;O<T.length;++O)R[T[O].name]=T[O].toJSON(S);return R}}function Q(T,S){L.call(this,T,S),this.nested=void 0,this._nestedArray=null,this._lookupCache={},this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0}function Y(T){T._nestedArray=null,T._lookupCache={};for(var S=T;S=S.parent;)S._lookupCache={};return T}Q.fromJSON=function(T,S){return new Q(T,S.options).addJSON(S.nested)},Q.arrayToJSON=$,Q.isReservedId=function(T,S){if(T){for(var R=0;R<T.length;++R)if("string"!=typeof T[R]&&T[R][0]<=S&&T[R][1]>S)return!0}return!1},Q.isReservedName=function(T,S){if(T){for(var R=0;R<T.length;++R)if(T[R]===S)return!0}return!1},Object.defineProperty(Q.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=V.toArray(this.nested))}}),Q.prototype.toJSON=function(T){return V.toObject(["options",this.options,"nested",$(this.nestedArray,T)])},Q.prototype.addJSON=function(T){var S=this;if(T)for(var R,L=Object.keys(T),V=0;V<L.length;++V)R=T[L[V]],S.add((void 0!==R.fields?O.fromJSON:void 0!==R.values?M.fromJSON:void 0!==R.methods?N.fromJSON:void 0!==R.id?U.fromJSON:Q.fromJSON)(L[V],R));return this},Q.prototype.get=function(T){return this.nested&&this.nested[T]||null},Q.prototype.getEnum=function(T){if(this.nested&&this.nested[T]instanceof M)return this.nested[T].values;throw Error("no such enum: "+T)},Q.prototype.add=function(T){if(!(T instanceof U&&void 0!==T.extend||T instanceof O||T instanceof K||T instanceof M||T instanceof N||T instanceof Q))throw TypeError("object must be a valid nested object");if(this.nested){var S=this.get(T.name);if(S){if(S instanceof Q&&T instanceof Q&&!(S instanceof O||S instanceof N)){for(var R=S.nestedArray,L=0;L<R.length;++L)T.add(R[L]);this.remove(S),this.nested||(this.nested={}),T.setOptions(S.options,!0)}else throw Error("duplicate name '"+T.name+"' in "+this)}}else this.nested={};this.nested[T.name]=T,this instanceof O||this instanceof N||this instanceof M||this instanceof U||T._edition||(T._edition=T._defaultEdition),this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0;for(var V=this;V=V.parent;)V._needsRecursiveFeatureResolution=!0,V._needsRecursiveResolve=!0;return T.onAdd(this),Y(this)},Q.prototype.remove=function(T){if(!(T instanceof L))throw TypeError("object must be a ReflectionObject");if(T.parent!==this)throw Error(T+" is not a member of "+this);return delete this.nested[T.name],Object.keys(this.nested).length||(this.nested=void 0),T.onRemove(this),Y(this)},Q.prototype.define=function(T,S){if(V.isString(T))T=T.split(".");else if(!Array.isArray(T))throw TypeError("illegal path");if(T&&T.length&&""===T[0])throw Error("path must be relative");for(var R=this;T.length>0;){var O=T.shift();if(R.nested&&R.nested[O]){if(!((R=R.nested[O])instanceof Q))throw Error("path conflicts with non-namespace objects")}else R.add(R=new Q(O))}return S&&R.addJSON(S),R},Q.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;this._resolveFeaturesRecursive(this._edition);var T=this.nestedArray,S=0;for(this.resolve();S<T.length;)T[S]instanceof Q?T[S++].resolveAll():T[S++].resolve();return this._needsRecursiveResolve=!1,this},Q.prototype._resolveFeaturesRecursive=function(T){return this._needsRecursiveFeatureResolution&&(this._needsRecursiveFeatureResolution=!1,T=this._edition||T,L.prototype._resolveFeaturesRecursive.call(this,T),this.nestedArray.forEach(S=>{S._resolveFeaturesRecursive(T)})),this},Q.prototype.lookup=function(T,S,R){if("boolean"==typeof S?(R=S,S=void 0):S&&!Array.isArray(S)&&(S=[S]),V.isString(T)&&T.length){if("."===T)return this.root;T=T.split(".")}else if(!T.length)return this;var O=T.join(".");if(""===T[0])return this.root.lookup(T.slice(1),S);var N=this.root._fullyQualifiedObjects&&this.root._fullyQualifiedObjects["."+O];if(N&&(!S||S.indexOf(N.constructor)>-1)||(N=this._lookupImpl(T,O))&&(!S||S.indexOf(N.constructor)>-1))return N;if(R)return null;for(var M=this;M.parent;){if((N=M.parent._lookupImpl(T,O))&&(!S||S.indexOf(N.constructor)>-1))return N;M=M.parent}return null},Q.prototype._lookupImpl=function(T,S){if(Object.prototype.hasOwnProperty.call(this._lookupCache,S))return this._lookupCache[S];var R=this.get(T[0]),O=null;if(R)1===T.length?O=R:R instanceof Q&&(T=T.slice(1),O=R._lookupImpl(T,T.join(".")));else for(var N=0;N<this.nestedArray.length;++N)this._nestedArray[N]instanceof Q&&(R=this._nestedArray[N]._lookupImpl(T,S))&&(O=R);return this._lookupCache[S]=O,O},Q.prototype.lookupType=function(T){var S=this.lookup(T,[O]);if(!S)throw Error("no such type: "+T);return S},Q.prototype.lookupEnum=function(T){var S=this.lookup(T,[M]);if(!S)throw Error("no such Enum '"+T+"' in "+this);return S},Q.prototype.lookupTypeOrEnum=function(T){var S=this.lookup(T,[O,M]);if(!S)throw Error("no such Type or Enum '"+T+"' in "+this);return S},Q.prototype.lookupService=function(T){var S=this.lookup(T,[N]);if(!S)throw Error("no such Service '"+T+"' in "+this);return S},Q._configure=function(T,S,R){O=T,N=S,M=R}},1862:(T,S,R)=>{"use strict";T.exports=K,K.className="ReflectionObject";let O=R(2866);var N,M=R(6738),L={enum_type:"OPEN",field_presence:"EXPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"},U={enum_type:"CLOSED",field_presence:"EXPLICIT",json_format:"LEGACY_BEST_EFFORT",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"EXPANDED",utf8_validation:"NONE"},V={enum_type:"OPEN",field_presence:"IMPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"};function K(T,S){if(!M.isString(T))throw TypeError("name must be a string");if(S&&!M.isObject(S))throw TypeError("options must be an object");this.options=S,this.parsedOptions=null,this.name=T,this._edition=null,this._defaultEdition="proto2",this._features={},this._featuresResolved=!1,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(K.prototype,{root:{get:function(){for(var T=this;null!==T.parent;)T=T.parent;return T}},fullName:{get:function(){for(var T=[this.name],S=this.parent;S;)T.unshift(S.name),S=S.parent;return T.join(".")}}}),K.prototype.toJSON=function(){throw Error()},K.prototype.onAdd=function(T){this.parent&&this.parent!==T&&this.parent.remove(this),this.parent=T,this.resolved=!1;var S=T.root;S instanceof N&&S._handleAdd(this)},K.prototype.onRemove=function(T){var S=T.root;S instanceof N&&S._handleRemove(this),this.parent=null,this.resolved=!1},K.prototype.resolve=function(){return this.resolved||this.root instanceof N&&(this.resolved=!0),this},K.prototype._resolveFeaturesRecursive=function(T){return this._resolveFeatures(this._edition||T)},K.prototype._resolveFeatures=function(T){if(!this._featuresResolved){var S={};if(!T)throw Error("Unknown edition for "+this.fullName);var R=Object.assign(this.options?Object.assign({},this.options.features):{},this._inferLegacyProtoFeatures(T));if(this._edition){if("proto2"===T)S=Object.assign({},U);else if("proto3"===T)S=Object.assign({},V);else if("2023"===T)S=Object.assign({},L);else throw Error("Unknown edition: "+T);this._features=Object.assign(S,R||{}),this._featuresResolved=!0;return}if(this.partOf instanceof O){var N=Object.assign({},this.partOf._features);this._features=Object.assign(N,R||{})}else if(this.declaringField);else if(this.parent){var M=Object.assign({},this.parent._features);this._features=Object.assign(M,R||{})}else throw Error("Unable to find a parent for "+this.fullName);this.extensionField&&(this.extensionField._features=this._features),this._featuresResolved=!0}},K.prototype._inferLegacyProtoFeatures=function(){return{}},K.prototype.getOption=function(T){if(this.options)return this.options[T]},K.prototype.setOption=function(T,S,R){return this.options||(this.options={}),/^features\./.test(T)?M.setProperty(this.options,T,S,R):R&&void 0!==this.options[T]||(this.getOption(T)!==S&&(this.resolved=!1),this.options[T]=S),this},K.prototype.setParsedOption=function(T,S,R){this.parsedOptions||(this.parsedOptions=[]);var O=this.parsedOptions;if(R){var N=O.find(function(S){return Object.prototype.hasOwnProperty.call(S,T)});if(N){var L=N[T];M.setProperty(L,R,S)}else(N={})[T]=M.setProperty({},R,S),O.push(N)}else{var U={};U[T]=S,O.push(U)}return this},K.prototype.setOptions=function(T,S){if(T)for(var R=Object.keys(T),O=0;O<R.length;++O)this.setOption(R[O],T[R[O]],S);return this},K.prototype.toString=function(){var T=this.constructor.className,S=this.fullName;return S.length?T+" "+S:T},K.prototype._editionToJSON=function(){if(this._edition&&"proto3"!==this._edition)return this._edition},K._configure=function(T){N=T}},2866:(T,S,R)=>{"use strict";T.exports=L;var O=R(1862);((L.prototype=Object.create(O.prototype)).constructor=L).className="OneOf";var N=R(3980),M=R(6738);function L(T,S,R,N){if(Array.isArray(S)||(R=S,S=void 0),O.call(this,T,R),!(void 0===S||Array.isArray(S)))throw TypeError("fieldNames must be an Array");this.oneof=S||[],this.fieldsArray=[],this.comment=N}function U(T){if(T.parent)for(var S=0;S<T.fieldsArray.length;++S)T.fieldsArray[S].parent||T.parent.add(T.fieldsArray[S])}L.fromJSON=function(T,S){return new L(T,S.oneof,S.options,S.comment)},L.prototype.toJSON=function(T){var S=!!T&&!!T.keepComments;return M.toObject(["options",this.options,"oneof",this.oneof,"comment",S?this.comment:void 0])},L.prototype.add=function(T){if(!(T instanceof N))throw TypeError("field must be a Field");return T.parent&&T.parent!==this.parent&&T.parent.remove(T),this.oneof.push(T.name),this.fieldsArray.push(T),T.partOf=this,U(this),this},L.prototype.remove=function(T){if(!(T instanceof N))throw TypeError("field must be a Field");var S=this.fieldsArray.indexOf(T);if(S<0)throw Error(T+" is not a member of "+this);return this.fieldsArray.splice(S,1),(S=this.oneof.indexOf(T.name))>-1&&this.oneof.splice(S,1),T.partOf=null,this},L.prototype.onAdd=function(T){O.prototype.onAdd.call(this,T);for(var S=this,R=0;R<this.oneof.length;++R){var N=T.get(this.oneof[R]);N&&!N.partOf&&(N.partOf=S,S.fieldsArray.push(N))}U(this)},L.prototype.onRemove=function(T){for(var S,R=0;R<this.fieldsArray.length;++R)(S=this.fieldsArray[R]).parent&&S.parent.remove(S);O.prototype.onRemove.call(this,T)},Object.defineProperty(L.prototype,"isProto3Optional",{get:function(){if(null==this.fieldsArray||1!==this.fieldsArray.length)return!1;var T=this.fieldsArray[0];return null!=T.options&&!0===T.options.proto3_optional}}),L.d=function(){for(var T=Array(arguments.length),S=0;S<arguments.length;)T[S]=arguments[S++];return function(S,R){M.decorateType(S.constructor).add(new L(R,T)),Object.defineProperty(S,R,{get:M.oneOfGetter(T),set:M.oneOfSetter(T)})}}},7897:(T,S,R)=>{"use strict";T.exports=ec,ec.filename=null,ec.defaults={keepCase:!1};var O=R(6116),N=R(8373),M=R(9340),L=R(3980),U=R(7597),V=R(2866),K=R(9246),$=R(2791),Q=R(8909),Y=R(1862),X=R(1708),Z=R(6738),ee=/^[1-9][0-9]*$/,et=/^-?[1-9][0-9]*$/,er=/^0[x][0-9a-fA-F]+$/,en=/^-?0[x][0-9a-fA-F]+$/,ei=/^0[0-7]+$/,es=/^-?0[0-7]+$/,ea=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,eo=/^[a-zA-Z_][a-zA-Z_0-9]*$/,eu=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/;function ec(T,S,R){S instanceof N||(R=S,S=new N),R||(R=ec.defaults);var ed,eh,ef,ep,em=R.preferTrailingComment||!1,eg=O(T,R.alternateCommentMode||!1),ey=eg.next,ev=eg.push,eb=eg.peek,e_=eg.skip,eT=eg.cmnt,eS=!0,eE="proto2",ew=S,eC=[],eI={},eR=R.keepCase?function(T){return T}:Z.camelCase;function eA(){eC.forEach(T=>{T._edition=eE,Object.keys(eI).forEach(S=>{void 0===T.getOption(S)&&T.setOption(S,eI[S],!0)})})}function eO(T,S,R){var O=ec.filename;return R||(ec.filename=null),Error("illegal "+(S||"token")+" '"+T+"' ("+(O?O+", ":"")+"line "+eg.line+")")}function eN(){var T,S=[];do{if('"'!==(T=ey())&&"'"!==T)throw eO(T);S.push(ey()),e_(T),T=eb()}while('"'===T||"'"===T);return S.join("")}function ek(T){var S=ey();switch(S){case"'":case'"':return ev(S),eN();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return eD(S,!0)}catch(R){if(T&&eu.test(S))return S;throw eO(S,"value")}}function eP(T,S){do if(S&&('"'===(R=eb())||"'"===R)){var R,O,N=eN();if(T.push(N),eE>=2023)throw eO(N,"id")}else try{T.push([O=eM(ey()),e_("to",!0)?eM(ey()):O])}catch(O){if(S&&eu.test(R)&&eE>=2023)T.push(R);else throw O}while(e_(",",!0));var M={options:void 0};M.setOption=function(T,S){void 0===this.options&&(this.options={}),this.options[T]=S},eB(M,function(T){if("option"===T)e$(M,T),e_(";");else throw eO(T)},function(){eX(M)})}function eD(T,S){var R=1;switch("-"===T.charAt(0)&&(R=-1,T=T.substring(1)),T){case"inf":case"INF":case"Inf":return R*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(ee.test(T))return R*parseInt(T,10);if(er.test(T))return R*parseInt(T,16);if(ei.test(T))return R*parseInt(T,8);if(ea.test(T))return R*parseFloat(T);throw eO(T,"number",S)}function eM(T,S){switch(T){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!S&&"-"===T.charAt(0))throw eO(T,"id");if(et.test(T))return parseInt(T,10);if(en.test(T))return parseInt(T,16);if(es.test(T))return parseInt(T,8);throw eO(T,"id")}function ex(){if(void 0!==eh)throw eO("package");if(eh=ey(),!eu.test(eh))throw eO(eh,"name");ew=ew.define(eh),e_(";")}function eL(){var T,S=eb();switch(S){case"weak":T=ep||(ep=[]),ey();break;case"public":ey();default:T=ef||(ef=[])}S=eN(),e_(";"),T.push(S)}function eF(){if(e_("="),(eE=eN())<2023)throw eO(eE,"syntax");e_(";")}function eU(){e_("="),eE=eN();let T=["2023"];if(!T.includes(eE))throw eO(eE,"edition");e_(";")}function ej(T,S){switch(S){case"option":return e$(T,S),e_(";"),!0;case"message":return eV(T,S),!0;case"enum":return eW(T,S),!0;case"service":return eZ(T,S),!0;case"extend":return e1(T,S),!0}return!1}function eB(T,S,R){var O,N=eg.line;if(T&&("string"!=typeof T.comment&&(T.comment=eT()),T.filename=ec.filename),e_("{",!0)){for(;"}"!==(O=ey());)S(O);e_(";",!0)}else R&&R(),e_(";"),T&&("string"!=typeof T.comment||em)&&(T.comment=eT(N)||T.comment)}function eV(T,S){if(!eo.test(S=ey()))throw eO(S,"type name");var R=new M(S);eB(R,function(T){if(!ej(R,T))switch(T){case"map":eH(R,T);break;case"required":if("proto2"!==eE)throw eO(T);case"repeated":ez(R,T);break;case"optional":if("proto3"===eE)ez(R,"proto3_optional");else if("proto2"!==eE)throw eO(T);else ez(R,"optional");break;case"oneof":eG(R,T);break;case"extensions":eP(R.extensions||(R.extensions=[]));break;case"reserved":eP(R.reserved||(R.reserved=[]),!0);break;default:if("proto2"===eE||!eu.test(T))throw eO(T);ev(T),ez(R,"optional")}}),T.add(R),T===ew&&eC.push(R)}function ez(T,S,R){var O=ey();if("group"===O){eq(T,S);return}for(;O.endsWith(".")||eb().startsWith(".");)O+=ey();if(!eu.test(O))throw eO(O,"type");var N=ey();if(!eo.test(N))throw eO(N,"name");N=eR(N),e_("=");var M=new L(N,eM(ey()),O,S,R);if(eB(M,function(T){if("option"===T)e$(M,T),e_(";");else throw eO(T)},function(){eX(M)}),"proto3_optional"===S){var U=new V("_"+N);M.setOption("proto3_optional",!0),U.add(M),T.add(U)}else T.add(M);T===ew&&eC.push(M)}function eq(T,S){if(eE>=2023)throw eO("group");var R=ey();if(!eo.test(R))throw eO(R,"name");var O=Z.lcFirst(R);R===O&&(R=Z.ucFirst(R)),e_("=");var N=eM(ey()),U=new M(R);U.group=!0;var V=new L(O,N,R,S);V.filename=ec.filename,eB(U,function(T){switch(T){case"option":e$(U,T),e_(";");break;case"required":case"repeated":ez(U,T);break;case"optional":"proto3"===eE?ez(U,"proto3_optional"):ez(U,"optional");break;case"message":eV(U,T);break;case"enum":eW(U,T);break;case"reserved":eP(U.reserved||(U.reserved=[]),!0);break;default:throw eO(T)}}),T.add(U).add(V)}function eH(T){e_("<");var S=ey();if(void 0===X.mapKey[S])throw eO(S,"type");e_(",");var R=ey();if(!eu.test(R))throw eO(R,"type");e_(">");var O=ey();if(!eo.test(O))throw eO(O,"name");e_("=");var N=new U(eR(O),eM(ey()),S,R);eB(N,function(T){if("option"===T)e$(N,T),e_(";");else throw eO(T)},function(){eX(N)}),T.add(N)}function eG(T,S){if(!eo.test(S=ey()))throw eO(S,"name");var R=new V(eR(S));eB(R,function(T){"option"===T?(e$(R,T),e_(";")):(ev(T),ez(R,"optional"))}),T.add(R)}function eW(T,S){if(!eo.test(S=ey()))throw eO(S,"name");var R=new K(S);eB(R,function(T){switch(T){case"option":e$(R,T),e_(";");break;case"reserved":eP(R.reserved||(R.reserved=[]),!0),void 0===R.reserved&&(R.reserved=[]);break;default:eK(R,T)}}),T.add(R),T===ew&&eC.push(R)}function eK(T,S){if(!eo.test(S))throw eO(S,"name");e_("=");var R=eM(ey(),!0),O={options:void 0};O.getOption=function(T){return this.options[T]},O.setOption=function(T,S){Y.prototype.setOption.call(O,T,S)},O.setParsedOption=function(){},eB(O,function(T){if("option"===T)e$(O,T),e_(";");else throw eO(T)},function(){eX(O)}),T.add(S,R,O.comment,O.parsedOptions||O.options)}function e$(T,S){var R,O,N=!0;for("option"===S&&(S=ey());"="!==S;){if("("===S){var M=ey();e_(")"),S="("+M+")"}if(N){if(N=!1,S.includes(".")&&!S.includes("(")){var L=S.split(".");R=L[0]+".",S=L[1];continue}R=S}else O=O?O+=S:S;S=ey()}var U=eQ(T,O?R.concat(O):R);O=O&&"."===O[0]?O.slice(1):O,eJ(T,R=R&&"."===R[R.length-1]?R.slice(0,-1):R,U,O)}function eQ(T,S){if(e_("{",!0)){for(var R={};!e_("}",!0);){if(!eo.test(ed=ey()))throw eO(ed,"name");if(null===ed)throw eO(ed,"end of input");var O,N,M=ed;if(e_(":",!0),"{"===eb())O=eQ(T,S+"."+ed);else if("["===eb()){if(O=[],e_("[",!0)){do N=ek(!0),O.push(N);while(e_(",",!0));e_("]"),void 0!==N&&eY(T,S+"."+ed,N)}}else O=ek(!0),eY(T,S+"."+ed,O);var L=R[M];L&&(O=[].concat(L).concat(O)),R[M]=O,e_(",",!0),e_(";",!0)}return R}var U=ek(!0);return eY(T,S,U),U}function eY(T,S,R){if(ew===T&&/^features\./.test(S)){eI[S]=R;return}T.setOption&&T.setOption(S,R)}function eJ(T,S,R,O){T.setParsedOption&&T.setParsedOption(S,R,O)}function eX(T){if(e_("[",!0)){do e$(T,"option");while(e_(",",!0));e_("]")}return T}function eZ(T,S){if(!eo.test(S=ey()))throw eO(S,"service name");var R=new $(S);eB(R,function(T){if(!ej(R,T)){if("rpc"===T)e0(R,T);else throw eO(T)}}),T.add(R),T===ew&&eC.push(R)}function e0(T,S){var R=eT(),O=S;if(!eo.test(S=ey()))throw eO(S,"name");var N,M,L,U,V=S;if(e_("("),e_("stream",!0)&&(M=!0),!eu.test(S=ey())||(N=S,e_(")"),e_("returns"),e_("("),e_("stream",!0)&&(U=!0),!eu.test(S=ey())))throw eO(S);L=S,e_(")");var K=new Q(V,O,N,L,M,U);K.comment=R,eB(K,function(T){if("option"===T)e$(K,T),e_(";");else throw eO(T)}),T.add(K)}function e1(T,S){if(!eu.test(S=ey()))throw eO(S,"reference");var R=S;eB(null,function(S){switch(S){case"required":case"repeated":ez(T,S,R);break;case"optional":"proto3"===eE?ez(T,"proto3_optional",R):ez(T,"optional",R);break;default:if("proto2"===eE||!eu.test(S))throw eO(S);ev(S),ez(T,"optional",R)}})}for(;null!==(ed=ey());)switch(ed){case"package":if(!eS)throw eO(ed);ex();break;case"import":if(!eS)throw eO(ed);eL();break;case"syntax":if(!eS)throw eO(ed);eF();break;case"edition":if(!eS)throw eO(ed);eU();break;case"option":e$(ew,ed),e_(";",!0);break;default:if(ej(ew,ed)){eS=!1;continue}throw eO(ed)}return eA(),ec.filename=null,{package:eh,imports:ef,weakImports:ep,root:S}}},5199:(T,S,R)=>{"use strict";T.exports=V;var O,N=R(8932),M=N.LongBits,L=N.utf8;function U(T,S){return RangeError("index out of range: "+T.pos+" + "+(S||1)+" > "+T.len)}function V(T){this.buf=T,this.pos=0,this.len=T.length}var K="undefined"!=typeof Uint8Array?function(T){if(T instanceof Uint8Array||Array.isArray(T))return new V(T);throw Error("illegal buffer")}:function(T){if(Array.isArray(T))return new V(T);throw Error("illegal buffer")},$=function(){return N.Buffer?function(T){return(V.create=function(T){return N.Buffer.isBuffer(T)?new O(T):K(T)})(T)}:K};function Q(){var T=new M(0,0),S=0;if(this.len-this.pos>4){for(;S<4;++S)if(T.lo=(T.lo|(127&this.buf[this.pos])<<7*S)>>>0,this.buf[this.pos++]<128)return T;if(T.lo=(T.lo|(127&this.buf[this.pos])<<28)>>>0,T.hi=(T.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return T;S=0}else{for(;S<3;++S){if(this.pos>=this.len)throw U(this);if(T.lo=(T.lo|(127&this.buf[this.pos])<<7*S)>>>0,this.buf[this.pos++]<128)return T}return T.lo=(T.lo|(127&this.buf[this.pos++])<<7*S)>>>0,T}if(this.len-this.pos>4){for(;S<5;++S)if(T.hi=(T.hi|(127&this.buf[this.pos])<<7*S+3)>>>0,this.buf[this.pos++]<128)return T}else for(;S<5;++S){if(this.pos>=this.len)throw U(this);if(T.hi=(T.hi|(127&this.buf[this.pos])<<7*S+3)>>>0,this.buf[this.pos++]<128)return T}throw Error("invalid varint encoding")}function Y(T,S){return(T[S-4]|T[S-3]<<8|T[S-2]<<16|T[S-1]<<24)>>>0}function X(){if(this.pos+8>this.len)throw U(this,8);return new M(Y(this.buf,this.pos+=4),Y(this.buf,this.pos+=4))}V.create=$(),V.prototype._slice=N.Array.prototype.subarray||N.Array.prototype.slice,V.prototype.uint32=function(){var T=4294967295;return function(){if(T=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(T=(T|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(T=(T|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(T=(T|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(T=(T|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return T;if((this.pos+=5)>this.len)throw this.pos=this.len,U(this,10);return T}}(),V.prototype.int32=function(){return 0|this.uint32()},V.prototype.sint32=function(){var T=this.uint32();return T>>>1^-(1&T)|0},V.prototype.bool=function(){return 0!==this.uint32()},V.prototype.fixed32=function(){if(this.pos+4>this.len)throw U(this,4);return Y(this.buf,this.pos+=4)},V.prototype.sfixed32=function(){if(this.pos+4>this.len)throw U(this,4);return 0|Y(this.buf,this.pos+=4)},V.prototype.float=function(){if(this.pos+4>this.len)throw U(this,4);var T=N.float.readFloatLE(this.buf,this.pos);return this.pos+=4,T},V.prototype.double=function(){if(this.pos+8>this.len)throw U(this,4);var T=N.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,T},V.prototype.bytes=function(){var T=this.uint32(),S=this.pos,R=this.pos+T;if(R>this.len)throw U(this,T);if(this.pos+=T,Array.isArray(this.buf))return this.buf.slice(S,R);if(S===R){var O=N.Buffer;return O?O.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,S,R)},V.prototype.string=function(){var T=this.bytes();return L.read(T,0,T.length)},V.prototype.skip=function(T){if("number"==typeof T){if(this.pos+T>this.len)throw U(this,T);this.pos+=T}else do if(this.pos>=this.len)throw U(this);while(128&this.buf[this.pos++]);return this},V.prototype.skipType=function(T){switch(T){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(T=7&this.uint32());)this.skipType(T);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+T+" at offset "+this.pos)}return this},V._configure=function(T){O=T,V.create=$(),O._configure();var S=N.Long?"toLong":"toNumber";N.merge(V.prototype,{int64:function(){return Q.call(this)[S](!1)},uint64:function(){return Q.call(this)[S](!0)},sint64:function(){return Q.call(this).zzDecode()[S](!1)},fixed64:function(){return X.call(this)[S](!0)},sfixed64:function(){return X.call(this)[S](!1)}})}},5213:(T,S,R)=>{"use strict";T.exports=M;var O=R(5199);(M.prototype=Object.create(O.prototype)).constructor=M;var N=R(8932);function M(T){O.call(this,T)}M._configure=function(){N.Buffer&&(M.prototype._slice=N.Buffer.prototype.slice)},M.prototype.string=function(){var T=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+T,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+T,this.len))},M._configure()},8373:(T,S,R)=>{"use strict";T.exports=Q;var O,N,M,L=R(7540);((Q.prototype=Object.create(L.prototype)).constructor=Q).className="Root";var U=R(3980),V=R(9246),K=R(2866),$=R(6738);function Q(T){L.call(this,"",T),this.deferred=[],this.files=[],this._edition="proto2",this._fullyQualifiedObjects={}}function Y(){}Q.fromJSON=function(T,S){return S||(S=new Q),T.options&&S.setOptions(T.options),S.addJSON(T.nested).resolveAll()},Q.prototype.resolvePath=$.path.resolve,Q.prototype.fetch=$.fetch,Q.prototype.load=function T(S,R,O){"function"==typeof R&&(O=R,R=void 0);var L=this;if(!O)return $.asPromise(T,L,S,R);var U=O===Y;function V(T,S){if(O){if(U)throw T;S&&S.resolveAll();var R=O;O=null,R(T,S)}}function K(T){var S=T.lastIndexOf("google/protobuf/");if(S>-1){var R=T.substring(S);if(R in M)return R}return null}function Q(T,S){try{if($.isString(S)&&"{"===S.charAt(0)&&(S=JSON.parse(S)),$.isString(S)){N.filename=T;var O,M=N(S,L,R),Q=0;if(M.imports)for(;Q<M.imports.length;++Q)(O=K(M.imports[Q])||L.resolvePath(T,M.imports[Q]))&&X(O);if(M.weakImports)for(Q=0;Q<M.weakImports.length;++Q)(O=K(M.weakImports[Q])||L.resolvePath(T,M.weakImports[Q]))&&X(O,!0)}else L.setOptions(S.options).addJSON(S.nested)}catch(T){V(T)}U||Z||V(null,L)}function X(T,S){if(T=K(T)||T,!(L.files.indexOf(T)>-1)){if(L.files.push(T),T in M){U?Q(T,M[T]):(++Z,setTimeout(function(){--Z,Q(T,M[T])}));return}if(U){var R;try{R=$.fs.readFileSync(T).toString("utf8")}catch(T){S||V(T);return}Q(T,R)}else++Z,L.fetch(T,function(R,N){if(--Z,O){if(R){S?Z||V(null,L):V(R);return}Q(T,N)}})}}var Z=0;$.isString(S)&&(S=[S]);for(var ee,et=0;et<S.length;++et)(ee=L.resolvePath("",S[et]))&&X(ee);return U?L.resolveAll():Z||V(null,L),L},Q.prototype.loadSync=function(T,S){if(!$.isNode)throw Error("not supported");return this.load(T,S,Y)},Q.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(T){return"'extend "+T.extend+"' in "+T.parent.fullName}).join(", "));return L.prototype.resolveAll.call(this)};var X=/^[A-Z]/;function Z(T,S){var R=S.parent.lookup(S.extend);if(R){var O=new U(S.fullName,S.id,S.type,S.rule,void 0,S.options);return!!R.get(O.name)||(O.declaringField=S,S.extensionField=O,R.add(O),!0)}return!1}Q.prototype._handleAdd=function(T){if(T instanceof U)void 0===T.extend||T.extensionField||Z(this,T)||this.deferred.push(T);else if(T instanceof V)X.test(T.name)&&(T.parent[T.name]=T.values);else if(!(T instanceof K)){if(T instanceof O)for(var S=0;S<this.deferred.length;)Z(this,this.deferred[S])?this.deferred.splice(S,1):++S;for(var R=0;R<T.nestedArray.length;++R)this._handleAdd(T._nestedArray[R]);X.test(T.name)&&(T.parent[T.name]=T)}(T instanceof O||T instanceof V||T instanceof U)&&(this._fullyQualifiedObjects[T.fullName]=T)},Q.prototype._handleRemove=function(T){if(T instanceof U){if(void 0!==T.extend){if(T.extensionField)T.extensionField.parent.remove(T.extensionField),T.extensionField=null;else{var S=this.deferred.indexOf(T);S>-1&&this.deferred.splice(S,1)}}}else if(T instanceof V)X.test(T.name)&&delete T.parent[T.name];else if(T instanceof L){for(var R=0;R<T.nestedArray.length;++R)this._handleRemove(T._nestedArray[R]);X.test(T.name)&&delete T.parent[T.name]}delete this._fullyQualifiedObjects[T.fullName]},Q._configure=function(T,S,R){O=T,N=S,M=R}},182:T=>{"use strict";T.exports={}},9226:(T,S,R)=>{"use strict";S.Service=R(2741)},2741:(T,S,R)=>{"use strict";T.exports=N;var O=R(8932);function N(T,S,R){if("function"!=typeof T)throw TypeError("rpcImpl must be a function");O.EventEmitter.call(this),this.rpcImpl=T,this.requestDelimited=!!S,this.responseDelimited=!!R}(N.prototype=Object.create(O.EventEmitter.prototype)).constructor=N,N.prototype.rpcCall=function T(S,R,N,M,L){if(!M)throw TypeError("request must be specified");var U=this;if(!L)return O.asPromise(T,U,S,R,N,M);if(!U.rpcImpl){setTimeout(function(){L(Error("already ended"))},0);return}try{return U.rpcImpl(S,R[U.requestDelimited?"encodeDelimited":"encode"](M).finish(),function(T,R){if(T)return U.emit("error",T,S),L(T);if(null===R){U.end(!0);return}if(!(R instanceof N))try{R=N[U.responseDelimited?"decodeDelimited":"decode"](R)}catch(T){return U.emit("error",T,S),L(T)}return U.emit("data",R,S),L(null,R)})}catch(T){U.emit("error",T,S),setTimeout(function(){L(T)},0);return}},N.prototype.end=function(T){return this.rpcImpl&&(T||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},2791:(T,S,R)=>{"use strict";T.exports=U;var O=R(7540);((U.prototype=Object.create(O.prototype)).constructor=U).className="Service";var N=R(8909),M=R(6738),L=R(9226);function U(T,S){O.call(this,T,S),this.methods={},this._methodsArray=null}function V(T){return T._methodsArray=null,T}U.fromJSON=function(T,S){var R=new U(T,S.options);if(S.methods)for(var O=Object.keys(S.methods),M=0;M<O.length;++M)R.add(N.fromJSON(O[M],S.methods[O[M]]));return S.nested&&R.addJSON(S.nested),S.edition&&(R._edition=S.edition),R.comment=S.comment,R._defaultEdition="proto3",R},U.prototype.toJSON=function(T){var S=O.prototype.toJSON.call(this,T),R=!!T&&!!T.keepComments;return M.toObject(["edition",this._editionToJSON(),"options",S&&S.options||void 0,"methods",O.arrayToJSON(this.methodsArray,T)||{},"nested",S&&S.nested||void 0,"comment",R?this.comment:void 0])},Object.defineProperty(U.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=M.toArray(this.methods))}}),U.prototype.get=function(T){return this.methods[T]||O.prototype.get.call(this,T)},U.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;O.prototype.resolve.call(this);for(var T=this.methodsArray,S=0;S<T.length;++S)T[S].resolve();return this},U.prototype._resolveFeaturesRecursive=function(T){return this._needsRecursiveFeatureResolution&&(T=this._edition||T,O.prototype._resolveFeaturesRecursive.call(this,T),this.methodsArray.forEach(S=>{S._resolveFeaturesRecursive(T)})),this},U.prototype.add=function(T){if(this.get(T.name))throw Error("duplicate name '"+T.name+"' in "+this);return T instanceof N?(this.methods[T.name]=T,T.parent=this,V(this)):O.prototype.add.call(this,T)},U.prototype.remove=function(T){if(T instanceof N){if(this.methods[T.name]!==T)throw Error(T+" is not a member of "+this);return delete this.methods[T.name],T.parent=null,V(this)}return O.prototype.remove.call(this,T)},U.prototype.create=function(T,S,R){for(var O,N=new L.Service(T,S,R),U=0;U<this.methodsArray.length;++U){var V=M.lcFirst((O=this._methodsArray[U]).resolve().name).replace(/[^$\w_]/g,"");N[V]=M.codegen(["r","c"],M.isReserved(V)?V+"_":V)("return this.rpcCall(m,q,s,r,c)")({m:O,q:O.resolvedRequestType.ctor,s:O.resolvedResponseType.ctor})}return N}},6116:T=>{"use strict";T.exports=Q;var S=/[\s{}=;:[\],'"()<>]/g,R=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,O=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,N=/^ *[*/]+ */,M=/^\s*\*?\/*/,L=/\n/g,U=/\s/,V=/\\(.?)/g,K={0:"\x00",r:"\r",n:"\n",t:"	"};function $(T){return T.replace(V,function(T,S){switch(S){case"\\":case"":return S;default:return K[S]||""}})}function Q(T,V){T=T.toString();var K=0,Q=T.length,Y=1,X=0,Z={},ee=[],et=null;function er(T){return Error("illegal "+T+" (line "+Y+")")}function en(){var S="'"===et?O:R;S.lastIndex=K-1;var N=S.exec(T);if(!N)throw er("string");return K=S.lastIndex,ec(et),et=null,$(N[1])}function ei(S){return T.charAt(S)}function es(S,R,O){var U,K,$={type:T.charAt(S++),lineEmpty:!1,leading:O},Q=S-(U=V?2:3);do if(--Q<0||"\n"===(K=T.charAt(Q))){$.lineEmpty=!0;break}while(" "===K||"	"===K);for(var ee=T.substring(S,R).split(L),et=0;et<ee.length;++et)ee[et]=ee[et].replace(V?M:N,"").trim();$.text=ee.join("\n").trim(),Z[Y]=$,X=Y}function ea(S){var R=eo(S),O=T.substring(S,R);return/^\s*\/\//.test(O)}function eo(T){for(var S=T;S<Q&&"\n"!==ei(S);)S++;return S}function eu(){if(ee.length>0)return ee.shift();if(et)return en();var R,O,N,M,L,$=0===K;do{if(K===Q)return null;for(R=!1;U.test(N=ei(K));)if("\n"===N&&($=!0,++Y),++K===Q)return null;if("/"===ei(K)){if(++K===Q)throw er("comment");if("/"===ei(K)){if(V){if(M=K,L=!1,ea(K-1)){L=!0;do if((K=eo(K))===Q||(K++,!$))break;while(ea(K))}else K=Math.min(Q,eo(K)+1);L&&(es(M,K,$),$=!0),Y++,R=!0}else{for(L="/"===ei(M=K+1);"\n"!==ei(++K);)if(K===Q)return null;++K,L&&(es(M,K-1,$),$=!0),++Y,R=!0}}else{if("*"!==(N=ei(K)))return"/";M=K+1,L=V||"*"===ei(M);do{if("\n"===N&&++Y,++K===Q)throw er("comment");O=N,N=ei(K)}while("*"!==O||"/"!==N);++K,L&&(es(M,K-2,$),$=!0),R=!0}}}while(R);var X=K;if(S.lastIndex=0,!S.test(ei(X++)))for(;X<Q&&!S.test(ei(X));)++X;var Z=T.substring(K,K=X);return('"'===Z||"'"===Z)&&(et=Z),Z}function ec(T){ee.push(T)}function ed(){if(!ee.length){var T=eu();if(null===T)return null;ec(T)}return ee[0]}function eh(T,S){var R=ed();if(R===T)return eu(),!0;if(!S)throw er("token '"+R+"', '"+T+"' expected");return!1}function ef(T){var S,R=null;return void 0===T?(S=Z[Y-1],delete Z[Y-1],S&&(V||"*"===S.type||S.lineEmpty)&&(R=S.leading?S.text:null)):(X<T&&ed(),S=Z[T],delete Z[T],S&&!S.lineEmpty&&(V||"/"===S.type)&&(R=S.leading?null:S.text)),R}return Object.defineProperty({next:eu,peek:ed,push:ec,skip:eh,cmnt:ef},"line",{get:function(){return Y}})}Q.unescape=$},9340:(T,S,R)=>{"use strict";T.exports=en;var O=R(7540);((en.prototype=Object.create(O.prototype)).constructor=en).className="Type";var N=R(9246),M=R(2866),L=R(3980),U=R(7597),V=R(2791),K=R(4294),$=R(5199),Q=R(4353),Y=R(6738),X=R(9561),Z=R(7317),ee=R(7585),et=R(4144),er=R(4038);function en(T,S){O.call(this,T,S),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function ei(T){return T._fieldsById=T._fieldsArray=T._oneofsArray=null,delete T.encode,delete T.decode,delete T.verify,T}Object.defineProperties(en.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var T=Object.keys(this.fields),S=0;S<T.length;++S){var R=this.fields[T[S]],O=R.id;if(this._fieldsById[O])throw Error("duplicate id "+O+" in "+this);this._fieldsById[O]=R}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=Y.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=Y.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=en.generateConstructor(this)())},set:function(T){var S=T.prototype;S instanceof K||((T.prototype=new K).constructor=T,Y.merge(T.prototype,S)),T.$type=T.prototype.$type=this,Y.merge(T,K,!0),this._ctor=T;for(var R=0;R<this.fieldsArray.length;++R)this._fieldsArray[R].resolve();var O={};for(R=0;R<this.oneofsArray.length;++R)O[this._oneofsArray[R].resolve().name]={get:Y.oneOfGetter(this._oneofsArray[R].oneof),set:Y.oneOfSetter(this._oneofsArray[R].oneof)};R&&Object.defineProperties(T.prototype,O)}}}),en.generateConstructor=function(T){for(var S,R=Y.codegen(["p"],T.name),O=0;O<T.fieldsArray.length;++O)(S=T._fieldsArray[O]).map?R("this%s={}",Y.safeProp(S.name)):S.repeated&&R("this%s=[]",Y.safeProp(S.name));return R("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},en.fromJSON=function(T,S){var R=new en(T,S.options);R.extensions=S.extensions,R.reserved=S.reserved;for(var K=Object.keys(S.fields),$=0;$<K.length;++$)R.add((void 0!==S.fields[K[$]].keyType?U.fromJSON:L.fromJSON)(K[$],S.fields[K[$]]));if(S.oneofs)for(K=Object.keys(S.oneofs),$=0;$<K.length;++$)R.add(M.fromJSON(K[$],S.oneofs[K[$]]));if(S.nested)for(K=Object.keys(S.nested),$=0;$<K.length;++$){var Q=S.nested[K[$]];R.add((void 0!==Q.id?L.fromJSON:void 0!==Q.fields?en.fromJSON:void 0!==Q.values?N.fromJSON:void 0!==Q.methods?V.fromJSON:O.fromJSON)(K[$],Q))}return S.extensions&&S.extensions.length&&(R.extensions=S.extensions),S.reserved&&S.reserved.length&&(R.reserved=S.reserved),S.group&&(R.group=!0),S.comment&&(R.comment=S.comment),S.edition&&(R._edition=S.edition),R._defaultEdition="proto3",R},en.prototype.toJSON=function(T){var S=O.prototype.toJSON.call(this,T),R=!!T&&!!T.keepComments;return Y.toObject(["edition",this._editionToJSON(),"options",S&&S.options||void 0,"oneofs",O.arrayToJSON(this.oneofsArray,T),"fields",O.arrayToJSON(this.fieldsArray.filter(function(T){return!T.declaringField}),T)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",S&&S.nested||void 0,"comment",R?this.comment:void 0])},en.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;O.prototype.resolveAll.call(this);var T=this.oneofsArray;for(R=0;R<T.length;)T[R++].resolve();for(var S=this.fieldsArray,R=0;R<S.length;)S[R++].resolve();return this},en.prototype._resolveFeaturesRecursive=function(T){return this._needsRecursiveFeatureResolution&&(T=this._edition||T,O.prototype._resolveFeaturesRecursive.call(this,T),this.oneofsArray.forEach(S=>{S._resolveFeatures(T)}),this.fieldsArray.forEach(S=>{S._resolveFeatures(T)})),this},en.prototype.get=function(T){return this.fields[T]||this.oneofs&&this.oneofs[T]||this.nested&&this.nested[T]||null},en.prototype.add=function(T){if(this.get(T.name))throw Error("duplicate name '"+T.name+"' in "+this);if(T instanceof L&&void 0===T.extend){if(this._fieldsById?this._fieldsById[T.id]:this.fieldsById[T.id])throw Error("duplicate id "+T.id+" in "+this);if(this.isReservedId(T.id))throw Error("id "+T.id+" is reserved in "+this);if(this.isReservedName(T.name))throw Error("name '"+T.name+"' is reserved in "+this);return T.parent&&T.parent.remove(T),this.fields[T.name]=T,T.message=this,T.onAdd(this),ei(this)}return T instanceof M?(this.oneofs||(this.oneofs={}),this.oneofs[T.name]=T,T.onAdd(this),ei(this)):O.prototype.add.call(this,T)},en.prototype.remove=function(T){if(T instanceof L&&void 0===T.extend){if(!this.fields||this.fields[T.name]!==T)throw Error(T+" is not a member of "+this);return delete this.fields[T.name],T.parent=null,T.onRemove(this),ei(this)}if(T instanceof M){if(!this.oneofs||this.oneofs[T.name]!==T)throw Error(T+" is not a member of "+this);return delete this.oneofs[T.name],T.parent=null,T.onRemove(this),ei(this)}return O.prototype.remove.call(this,T)},en.prototype.isReservedId=function(T){return O.isReservedId(this.reserved,T)},en.prototype.isReservedName=function(T){return O.isReservedName(this.reserved,T)},en.prototype.create=function(T){return new this.ctor(T)},en.prototype.setup=function(){for(var T=this.fullName,S=[],R=0;R<this.fieldsArray.length;++R)S.push(this._fieldsArray[R].resolve().resolvedType);this.encode=X(this)({Writer:Q,types:S,util:Y}),this.decode=Z(this)({Reader:$,types:S,util:Y}),this.verify=ee(this)({types:S,util:Y}),this.fromObject=et.fromObject(this)({types:S,util:Y}),this.toObject=et.toObject(this)({types:S,util:Y});var O=er[T];if(O){var N=Object.create(this);N.fromObject=this.fromObject,this.fromObject=O.fromObject.bind(N),N.toObject=this.toObject,this.toObject=O.toObject.bind(N)}return this},en.prototype.encode=function(T,S){return this.setup().encode(T,S)},en.prototype.encodeDelimited=function(T,S){return this.encode(T,S&&S.len?S.fork():S).ldelim()},en.prototype.decode=function(T,S){return this.setup().decode(T,S)},en.prototype.decodeDelimited=function(T){return T instanceof $||(T=$.create(T)),this.decode(T,T.uint32())},en.prototype.verify=function(T){return this.setup().verify(T)},en.prototype.fromObject=function(T){return this.setup().fromObject(T)},en.prototype.toObject=function(T,S){return this.setup().toObject(T,S)},en.d=function(T){return function(S){Y.decorateType(S,T)}}},1708:(T,S,R)=>{"use strict";var O=S,N=R(6738),M=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function L(T,S){var R=0,O={};for(S|=0;R<T.length;)O[M[R+S]]=T[R++];return O}O.basic=L([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),O.defaults=L([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",N.emptyArray,null]),O.long=L([0,0,0,1,1],7),O.mapKey=L([0,0,0,5,5,0,0,0,1,1,0,2],2),O.packed=L([1,5,0,0,0,5,5,0,0,0,1,1,0])},6738:(T,S,R)=>{"use strict";var O,N,M=T.exports=R(8932),L=R(182);M.codegen=R(7311),M.fetch=R(2651),M.path=R(2768),M.fs=M.inquire("fs"),M.toArray=function(T){if(T){for(var S=Object.keys(T),R=Array(S.length),O=0;O<S.length;)R[O]=T[S[O++]];return R}return[]},M.toObject=function(T){for(var S={},R=0;R<T.length;){var O=T[R++],N=T[R++];void 0!==N&&(S[O]=N)}return S};var U=/\\/g,V=/"/g;M.isReserved=function(T){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(T)},M.safeProp=function(T){return!/^[$\w_]+$/.test(T)||M.isReserved(T)?'["'+T.replace(U,"\\\\").replace(V,'\\"')+'"]':"."+T},M.ucFirst=function(T){return T.charAt(0).toUpperCase()+T.substring(1)};var K=/_([a-z])/g;M.camelCase=function(T){return T.substring(0,1)+T.substring(1).replace(K,function(T,S){return S.toUpperCase()})},M.compareFieldsById=function(T,S){return T.id-S.id},M.decorateType=function(T,S){if(T.$type)return S&&T.$type.name!==S&&(M.decorateRoot.remove(T.$type),T.$type.name=S,M.decorateRoot.add(T.$type)),T.$type;O||(O=R(9340));var N=new O(S||T.name);return M.decorateRoot.add(N),N.ctor=T,Object.defineProperty(T,"$type",{value:N,enumerable:!1}),Object.defineProperty(T.prototype,"$type",{value:N,enumerable:!1}),N};var $=0;M.decorateEnum=function(T){if(T.$type)return T.$type;N||(N=R(9246));var S=new N("Enum"+$++,T);return M.decorateRoot.add(S),Object.defineProperty(T,"$type",{value:S,enumerable:!1}),S},M.setProperty=function(T,S,R,O){function N(T,S,R){var M=S.shift();if("__proto__"===M||"prototype"===M)return T;if(S.length>0)T[M]=N(T[M]||{},S,R);else{var L=T[M];if(L&&O)return T;L&&(R=[].concat(L).concat(R)),T[M]=R}return T}if("object"!=typeof T)throw TypeError("dst must be an object");if(!S)throw TypeError("path must be specified");return N(T,S=S.split("."),R)},Object.defineProperty(M,"decorateRoot",{get:function(){return L.decorated||(L.decorated=new(R(8373)))}})},1168:(T,S,R)=>{"use strict";T.exports=N;var O=R(8932);function N(T,S){this.lo=T>>>0,this.hi=S>>>0}var M=N.zero=new N(0,0);M.toNumber=function(){return 0},M.zzEncode=M.zzDecode=function(){return this},M.length=function(){return 1};var L=N.zeroHash="\x00\x00\x00\x00\x00\x00\x00\x00";N.fromNumber=function(T){if(0===T)return M;var S=T<0;S&&(T=-T);var R=T>>>0,O=(T-R)/4294967296>>>0;return S&&(O=~O>>>0,R=~R>>>0,++R>4294967295&&(R=0,++O>4294967295&&(O=0))),new N(R,O)},N.from=function(T){if("number"==typeof T)return N.fromNumber(T);if(O.isString(T)){if(!O.Long)return N.fromNumber(parseInt(T,10));T=O.Long.fromString(T)}return T.low||T.high?new N(T.low>>>0,T.high>>>0):M},N.prototype.toNumber=function(T){if(!T&&this.hi>>>31){var S=~this.lo+1>>>0,R=~this.hi>>>0;return S||(R=R+1>>>0),-(S+4294967296*R)}return this.lo+4294967296*this.hi},N.prototype.toLong=function(T){return O.Long?new O.Long(0|this.lo,0|this.hi,!!T):{low:0|this.lo,high:0|this.hi,unsigned:!!T}};var U=String.prototype.charCodeAt;N.fromHash=function(T){return T===L?M:new N((U.call(T,0)|U.call(T,1)<<8|U.call(T,2)<<16|U.call(T,3)<<24)>>>0,(U.call(T,4)|U.call(T,5)<<8|U.call(T,6)<<16|U.call(T,7)<<24)>>>0)},N.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},N.prototype.zzEncode=function(){var T=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^T)>>>0,this.lo=(this.lo<<1^T)>>>0,this},N.prototype.zzDecode=function(){var T=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^T)>>>0,this.hi=(this.hi>>>1^T)>>>0,this},N.prototype.length=function(){var T=this.lo,S=(this.lo>>>28|this.hi<<4)>>>0,R=this.hi>>>24;return 0===R?0===S?T<16384?T<128?1:2:T<2097152?3:4:S<16384?S<128?5:6:S<2097152?7:8:R<128?9:10}},8932:function(T,S,R){"use strict";var O=S;function N(T,S,R){for(var O=Object.keys(S),N=0;N<O.length;++N)void 0!==T[O[N]]&&R||(T[O[N]]=S[O[N]]);return T}function M(T){function S(T,R){if(!(this instanceof S))return new S(T,R);Object.defineProperty(this,"message",{get:function(){return T}}),Error.captureStackTrace?Error.captureStackTrace(this,S):Object.defineProperty(this,"stack",{value:Error().stack||""}),R&&N(this,R)}return S.prototype=Object.create(Error.prototype,{constructor:{value:S,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return T},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),S}O.asPromise=R(8670),O.base64=R(6009),O.EventEmitter=R(107),O.float=R(1188),O.inquire=R(8031),O.utf8=R(7148),O.pool=R(4314),O.LongBits=R(1168),O.isNode=!!("undefined"!=typeof global&&global&&global.process&&global.process.versions&&global.process.versions.node),O.global=O.isNode&&global||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,O.emptyArray=Object.freeze?Object.freeze([]):[],O.emptyObject=Object.freeze?Object.freeze({}):{},O.isInteger=Number.isInteger||function(T){return"number"==typeof T&&isFinite(T)&&Math.floor(T)===T},O.isString=function(T){return"string"==typeof T||T instanceof String},O.isObject=function(T){return T&&"object"==typeof T},O.isset=O.isSet=function(T,S){var R=T[S];return!!(null!=R&&T.hasOwnProperty(S))&&("object"!=typeof R||(Array.isArray(R)?R.length:Object.keys(R).length)>0)},O.Buffer=function(){try{var T=O.inquire("buffer").Buffer;return T.prototype.utf8Write?T:null}catch(T){return null}}(),O._Buffer_from=null,O._Buffer_allocUnsafe=null,O.newBuffer=function(T){return"number"==typeof T?O.Buffer?O._Buffer_allocUnsafe(T):new O.Array(T):O.Buffer?O._Buffer_from(T):"undefined"==typeof Uint8Array?T:new Uint8Array(T)},O.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,O.Long=O.global.dcodeIO&&O.global.dcodeIO.Long||O.global.Long||O.inquire("long"),O.key2Re=/^true|false|0|1$/,O.key32Re=/^-?(?:0|[1-9][0-9]*)$/,O.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,O.longToHash=function(T){return T?O.LongBits.from(T).toHash():O.LongBits.zeroHash},O.longFromHash=function(T,S){var R=O.LongBits.fromHash(T);return O.Long?O.Long.fromBits(R.lo,R.hi,S):R.toNumber(!!S)},O.merge=N,O.lcFirst=function(T){return T.charAt(0).toLowerCase()+T.substring(1)},O.newError=M,O.ProtocolError=M("ProtocolError"),O.oneOfGetter=function(T){for(var S={},R=0;R<T.length;++R)S[T[R]]=1;return function(){for(var T=Object.keys(this),R=T.length-1;R>-1;--R)if(1===S[T[R]]&&void 0!==this[T[R]]&&null!==this[T[R]])return T[R]}},O.oneOfSetter=function(T){return function(S){for(var R=0;R<T.length;++R)T[R]!==S&&delete this[T[R]]}},O.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},O._configure=function(){var T=O.Buffer;if(!T){O._Buffer_from=O._Buffer_allocUnsafe=null;return}O._Buffer_from=T.from!==Uint8Array.from&&T.from||function(S,R){return new T(S,R)},O._Buffer_allocUnsafe=T.allocUnsafe||function(S){return new T(S)}}},7585:(T,S,R)=>{"use strict";T.exports=V;var O=R(9246),N=R(6738);function M(T,S){return T.name+": "+S+(T.repeated&&"array"!==S?"[]":T.map&&"object"!==S?"{k:"+T.keyType+"}":"")+" expected"}function L(T,S,R,N){if(S.resolvedType){if(S.resolvedType instanceof O){T("switch(%s){",N)("default:")("return%j",M(S,"enum value"));for(var L=Object.keys(S.resolvedType.values),U=0;U<L.length;++U)T("case %i:",S.resolvedType.values[L[U]]);T("break")("}")}else T("{")("var e=types[%i].verify(%s);",R,N)("if(e)")("return%j+e",S.name+".")("}")}else switch(S.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":T("if(!util.isInteger(%s))",N)("return%j",M(S,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":T("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",N,N,N,N)("return%j",M(S,"integer|Long"));break;case"float":case"double":T('if(typeof %s!=="number")',N)("return%j",M(S,"number"));break;case"bool":T('if(typeof %s!=="boolean")',N)("return%j",M(S,"boolean"));break;case"string":T("if(!util.isString(%s))",N)("return%j",M(S,"string"));break;case"bytes":T('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',N,N,N)("return%j",M(S,"buffer"))}return T}function U(T,S,R){switch(S.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":T("if(!util.key32Re.test(%s))",R)("return%j",M(S,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":T("if(!util.key64Re.test(%s))",R)("return%j",M(S,"integer|Long key"));break;case"bool":T("if(!util.key2Re.test(%s))",R)("return%j",M(S,"boolean key"))}return T}function V(T){var S=N.codegen(["m"],T.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),R=T.oneofsArray,O={};R.length&&S("var p={}");for(var V=0;V<T.fieldsArray.length;++V){var K=T._fieldsArray[V].resolve(),$="m"+N.safeProp(K.name);if(K.optional&&S("if(%s!=null&&m.hasOwnProperty(%j)){",$,K.name),K.map)S("if(!util.isObject(%s))",$)("return%j",M(K,"object"))("var k=Object.keys(%s)",$)("for(var i=0;i<k.length;++i){"),U(S,K,"k[i]"),L(S,K,V,$+"[k[i]]")("}");else if(K.repeated)S("if(!Array.isArray(%s))",$)("return%j",M(K,"array"))("for(var i=0;i<%s.length;++i){",$),L(S,K,V,$+"[i]")("}");else{if(K.partOf){var Q=N.safeProp(K.partOf.name);1===O[K.partOf.name]&&S("if(p%s===1)",Q)("return%j",K.partOf.name+": multiple values"),O[K.partOf.name]=1,S("p%s=1",Q)}L(S,K,V,$)}K.optional&&S("}")}return S("return null")}},4038:(T,S,R)=>{"use strict";var O=S,N=R(4294);O[".google.protobuf.Any"]={fromObject:function(T){if(T&&T["@type"]){var S=T["@type"].substring(T["@type"].lastIndexOf("/")+1),R=this.lookup(S);if(R){var O="."===T["@type"].charAt(0)?T["@type"].slice(1):T["@type"];return -1===O.indexOf("/")&&(O="/"+O),this.create({type_url:O,value:R.encode(R.fromObject(T)).finish()})}}return this.fromObject(T)},toObject:function(T,S){var R="type.googleapis.com/",O="",M="";if(S&&S.json&&T.type_url&&T.value){M=T.type_url.substring(T.type_url.lastIndexOf("/")+1),O=T.type_url.substring(0,T.type_url.lastIndexOf("/")+1);var L=this.lookup(M);L&&(T=L.decode(T.value))}if(!(T instanceof this.ctor)&&T instanceof N){var U=T.$type.toObject(T,S),V="."===T.$type.fullName[0]?T.$type.fullName.slice(1):T.$type.fullName;return""===O&&(O=R),M=O+V,U["@type"]=M,U}return this.toObject(T,S)}}},4353:(T,S,R)=>{"use strict";T.exports=Q;var O,N=R(8932),M=N.LongBits,L=N.base64,U=N.utf8;function V(T,S,R){this.fn=T,this.len=S,this.next=void 0,this.val=R}function K(){}function $(T){this.head=T.head,this.tail=T.tail,this.len=T.len,this.next=T.states}function Q(){this.len=0,this.head=new V(K,0,0),this.tail=this.head,this.states=null}var Y=function(){return N.Buffer?function(){return(Q.create=function(){return new O})()}:function(){return new Q}};function X(T,S,R){S[R]=255&T}function Z(T,S,R){for(;T>127;)S[R++]=127&T|128,T>>>=7;S[R]=T}function ee(T,S){this.len=T,this.next=void 0,this.val=S}function et(T,S,R){for(;T.hi;)S[R++]=127&T.lo|128,T.lo=(T.lo>>>7|T.hi<<25)>>>0,T.hi>>>=7;for(;T.lo>127;)S[R++]=127&T.lo|128,T.lo=T.lo>>>7;S[R++]=T.lo}function er(T,S,R){S[R]=255&T,S[R+1]=T>>>8&255,S[R+2]=T>>>16&255,S[R+3]=T>>>24}Q.create=Y(),Q.alloc=function(T){return new N.Array(T)},N.Array!==Array&&(Q.alloc=N.pool(Q.alloc,N.Array.prototype.subarray)),Q.prototype._push=function(T,S,R){return this.tail=this.tail.next=new V(T,S,R),this.len+=S,this},ee.prototype=Object.create(V.prototype),ee.prototype.fn=Z,Q.prototype.uint32=function(T){return this.len+=(this.tail=this.tail.next=new ee((T>>>=0)<128?1:T<16384?2:T<2097152?3:T<268435456?4:5,T)).len,this},Q.prototype.int32=function(T){return T<0?this._push(et,10,M.fromNumber(T)):this.uint32(T)},Q.prototype.sint32=function(T){return this.uint32((T<<1^T>>31)>>>0)},Q.prototype.uint64=function(T){var S=M.from(T);return this._push(et,S.length(),S)},Q.prototype.int64=Q.prototype.uint64,Q.prototype.sint64=function(T){var S=M.from(T).zzEncode();return this._push(et,S.length(),S)},Q.prototype.bool=function(T){return this._push(X,1,T?1:0)},Q.prototype.fixed32=function(T){return this._push(er,4,T>>>0)},Q.prototype.sfixed32=Q.prototype.fixed32,Q.prototype.fixed64=function(T){var S=M.from(T);return this._push(er,4,S.lo)._push(er,4,S.hi)},Q.prototype.sfixed64=Q.prototype.fixed64,Q.prototype.float=function(T){return this._push(N.float.writeFloatLE,4,T)},Q.prototype.double=function(T){return this._push(N.float.writeDoubleLE,8,T)};var en=N.Array.prototype.set?function(T,S,R){S.set(T,R)}:function(T,S,R){for(var O=0;O<T.length;++O)S[R+O]=T[O]};Q.prototype.bytes=function(T){var S=T.length>>>0;if(!S)return this._push(X,1,0);if(N.isString(T)){var R=Q.alloc(S=L.length(T));L.decode(T,R,0),T=R}return this.uint32(S)._push(en,S,T)},Q.prototype.string=function(T){var S=U.length(T);return S?this.uint32(S)._push(U.write,S,T):this._push(X,1,0)},Q.prototype.fork=function(){return this.states=new $(this),this.head=this.tail=new V(K,0,0),this.len=0,this},Q.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new V(K,0,0),this.len=0),this},Q.prototype.ldelim=function(){var T=this.head,S=this.tail,R=this.len;return this.reset().uint32(R),R&&(this.tail.next=T.next,this.tail=S,this.len+=R),this},Q.prototype.finish=function(){for(var T=this.head.next,S=this.constructor.alloc(this.len),R=0;T;)T.fn(T.val,S,R),R+=T.len,T=T.next;return S},Q._configure=function(T){O=T,Q.create=Y(),O._configure()}},1978:(T,S,R)=>{"use strict";T.exports=M;var O=R(4353);(M.prototype=Object.create(O.prototype)).constructor=M;var N=R(8932);function M(){O.call(this)}function L(T,S,R){T.length<40?N.utf8.write(T,S,R):S.utf8Write?S.utf8Write(T,R):S.write(T,R)}M._configure=function(){M.alloc=N._Buffer_allocUnsafe,M.writeBytesBuffer=N.Buffer&&N.Buffer.prototype instanceof Uint8Array&&"set"===N.Buffer.prototype.set.name?function(T,S,R){S.set(T,R)}:function(T,S,R){if(T.copy)T.copy(S,R,0,T.length);else for(var O=0;O<T.length;)S[R++]=T[O++]}},M.prototype.bytes=function(T){N.isString(T)&&(T=N._Buffer_from(T,"base64"));var S=T.length>>>0;return this.uint32(S),S&&this._push(M.writeBytesBuffer,S,T),this},M.prototype.string=function(T){var S=N.Buffer.byteLength(T);return this.uint32(S),S&&this._push(L,S,T),this},M._configure()},8045:(T,S,R)=>{"use strict";O={value:!0};var O,N=R(1068),M=R(9885);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function L(T,S,R,O){function N(T){return T instanceof R?T:new R(function(S){S(T)})}return new(R||(R=Promise))(function(R,M){function L(T){try{V(O.next(T))}catch(T){M(T)}}function U(T){try{V(O.throw(T))}catch(T){M(T)}}function V(T){T.done?R(T.value):N(T.value).then(L,U)}V((O=O.apply(T,S||[])).next())})}function U(T,S){var R,O,N,M,L={label:0,sent:function(){if(1&N[0])throw N[1];return N[1]},trys:[],ops:[]};return M={next:U(0),throw:U(1),return:U(2)},"function"==typeof Symbol&&(M[Symbol.iterator]=function(){return this}),M;function U(T){return function(S){return V([T,S])}}function V(M){if(R)throw TypeError("Generator is already executing.");for(;L;)try{if(R=1,O&&(N=2&M[0]?O.return:M[0]?O.throw||((N=O.return)&&N.call(O),0):O.next)&&!(N=N.call(O,M[1])).done)return N;switch(O=0,N&&(M=[2&M[0],N.value]),M[0]){case 0:case 1:N=M;break;case 4:return L.label++,{value:M[1],done:!1};case 5:L.label++,O=M[1],M=[0];continue;case 7:M=L.ops.pop(),L.trys.pop();continue;default:if(!(N=(N=L.trys).length>0&&N[N.length-1])&&(6===M[0]||2===M[0])){L=0;continue}if(3===M[0]&&(!N||M[1]>N[0]&&M[1]<N[3])){L.label=M[1];break}if(6===M[0]&&L.label<N[1]){L.label=N[1],N=M;break}if(N&&L.label<N[2]){L.label=N[2],L.ops.push(M);break}N[2]&&L.ops.pop(),L.trys.pop();continue}M=S.call(T,L)}catch(T){M=[6,T],O=0}finally{R=N=0}if(5&M[0])throw M[1];return{value:M[0]?M[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var V=function(){return(V=Object.assign||function(T){for(var S,R=1,O=arguments.length;R<O;R++)for(var N in S=arguments[R])Object.prototype.hasOwnProperty.call(S,N)&&(T[N]=S[N]);return T}).apply(this,arguments)},K=function(T){return{loading:null==T,value:T}},$=function(){return function(T,S){switch(S.type){case"error":return V(V({},T),{error:S.error,loading:!1,value:void 0});case"reset":return K(S.defaultValue);case"value":return V(V({},T),{error:void 0,loading:!1,value:S.value});default:return T}}},Q=function(T){var S=T?T():void 0,R=M.useReducer($(),K(S)),O=R[0],N=R[1],L=M.useCallback(function(){N({type:"reset",defaultValue:T?T():void 0})},[T]),U=M.useCallback(function(T){N({type:"error",error:T})},[]),V=M.useCallback(function(T){N({type:"value",value:T})},[]);return M.useMemo(function(){return{error:O.error,loading:O.loading,reset:L,setError:U,setValue:V,value:O.value}},[O.error,O.loading,L,U,V,O.value])},Y=function(T,S){var R=Q(function(){return T.currentUser}),O=R.error,V=R.loading,K=R.setError,$=R.setValue,Y=R.value;return M.useEffect(function(){var R=N.onAuthStateChanged(T,function(T){return L(void 0,void 0,void 0,function(){return U(this,function(R){switch(R.label){case 0:if(!(null==S?void 0:S.onUserChanged))return[3,4];R.label=1;case 1:return R.trys.push([1,3,,4]),[4,S.onUserChanged(T)];case 2:return R.sent(),[3,4];case 3:return K(R.sent()),[3,4];case 4:return $(T),[2]}})})},K);return function(){R()}},[T]),[Y,V,O]},X=function(T,S){var R=M.useState(),O=R[0],V=R[1],K=M.useState(),$=K[0],Q=K[1],Y=M.useState(!1),X=Y[0],Z=Y[1];return[M.useCallback(function(R,O){return L(void 0,void 0,void 0,function(){var M;return U(this,function(L){switch(L.label){case 0:Z(!0),V(void 0),L.label=1;case 1:return L.trys.push([1,5,6,7]),[4,N.createUserWithEmailAndPassword(T,R,O)];case 2:if(M=L.sent(),!(S&&S.sendEmailVerification&&M.user))return[3,4];return[4,N.sendEmailVerification(M.user,S.emailVerificationOptions)];case 3:L.sent(),L.label=4;case 4:return Q(M),[2,M];case 5:return V(L.sent()),[3,7];case 6:return Z(!1),[7];case 7:return[2]}})})},[T,S]),$,X,O]},Z=function(T){var S=M.useState(),R=S[0],O=S[1],N=M.useState(!1),V=N[0],K=N[1];return[M.useCallback(function(){return L(void 0,void 0,void 0,function(){return U(this,function(S){switch(S.label){case 0:K(!0),O(void 0),S.label=1;case 1:if(S.trys.push([1,5,6,7]),!T.currentUser)return[3,3];return[4,T.currentUser.delete()];case 2:return S.sent(),[2,!0];case 3:throw Error("No user is logged in");case 4:return[3,7];case 5:return O(S.sent()),[2,!1];case 6:return K(!1),[7];case 7:return[2]}})})},[T]),V,R]},ee=function(T){var S=M.useState(),R=S[0],O=S[1],V=M.useState(!1),K=V[0],$=V[1];return[M.useCallback(function(){return L(void 0,void 0,void 0,function(){return U(this,function(S){switch(S.label){case 0:$(!0),O(void 0),S.label=1;case 1:if(S.trys.push([1,5,6,7]),!T.currentUser)return[3,3];return[4,N.sendEmailVerification(T.currentUser)];case 2:return S.sent(),[2,!0];case 3:throw Error("No user is logged in");case 4:return[3,7];case 5:return O(S.sent()),[2,!1];case 6:return $(!1),[7];case 7:return[2]}})})},[T]),K,R]},et=function(T){var S=M.useState(),R=S[0],O=S[1],V=M.useState(!1),K=V[0],$=V[1];return[M.useCallback(function(S,R){return L(void 0,void 0,void 0,function(){return U(this,function(M){switch(M.label){case 0:$(!0),O(void 0),M.label=1;case 1:return M.trys.push([1,3,4,5]),[4,N.sendPasswordResetEmail(T,S,R)];case 2:return M.sent(),[2,!0];case 3:return O(M.sent()),[2,!1];case 4:return $(!1),[7];case 5:return[2]}})})},[T]),K,R]},er=function(T){var S=M.useState(),R=S[0],O=S[1],V=M.useState(!1),K=V[0],$=V[1];return[M.useCallback(function(S,R){return L(void 0,void 0,void 0,function(){return U(this,function(M){switch(M.label){case 0:$(!0),O(void 0),M.label=1;case 1:return M.trys.push([1,3,4,5]),[4,N.sendSignInLinkToEmail(T,S,R)];case 2:return M.sent(),[2,!0];case 3:return O(M.sent()),[2,!1];case 4:return $(!1),[7];case 5:return[2]}})})},[T]),K,R]},en=function(T){var S=M.useState(),R=S[0],O=S[1],V=M.useState(),K=V[0],$=V[1],Q=M.useState(!1),Y=Q[0],X=Q[1];return[M.useCallback(function(S,R){return L(void 0,void 0,void 0,function(){var M;return U(this,function(L){switch(L.label){case 0:X(!0),O(void 0),L.label=1;case 1:return L.trys.push([1,3,4,5]),[4,N.signInWithEmailAndPassword(T,S,R)];case 2:return $(M=L.sent()),[2,M];case 3:return O(L.sent()),[3,5];case 4:return X(!1),[7];case 5:return[2]}})})},[T]),K,Y,R]},ei=function(T){var S=M.useState(),R=S[0],O=S[1],V=M.useState(),K=V[0],$=V[1],Q=M.useState(!1),Y=Q[0],X=Q[1];return[M.useCallback(function(S,R){return L(void 0,void 0,void 0,function(){var M;return U(this,function(L){switch(L.label){case 0:X(!0),O(void 0),L.label=1;case 1:return L.trys.push([1,3,4,5]),[4,N.signInWithEmailLink(T,S,R)];case 2:return $(M=L.sent()),[2,M];case 3:return O(L.sent()),[3,5];case 4:return X(!1),[7];case 5:return[2]}})})},[T]),K,Y,R]},es=function(T){return ef(T,"apple.com")},ea=function(T){return ep(T,M.useCallback(function(T,S){var R=new N.FacebookAuthProvider;return T&&T.forEach(function(T){return R.addScope(T)}),S&&R.setCustomParameters(S),R},[]))},eo=function(T){return ep(T,M.useCallback(function(T,S){var R=new N.GithubAuthProvider;return T&&T.forEach(function(T){return R.addScope(T)}),S&&R.setCustomParameters(S),R},[]))},eu=function(T){return ep(T,M.useCallback(function(T,S){var R=new N.GoogleAuthProvider;return T&&T.forEach(function(T){return R.addScope(T)}),S&&R.setCustomParameters(S),R},[]))},ec=function(T){return ef(T,"microsoft.com")},ed=function(T){return ep(T,M.useCallback(function(T,S){var R=new N.TwitterAuthProvider;return T&&T.forEach(function(T){return R.addScope(T)}),S&&R.setCustomParameters(S),R},[]))},eh=function(T){return ef(T,"yahoo.com")},ef=function(T,S){return ep(T,M.useCallback(function(T,R){var O=new N.OAuthProvider(S);return T&&T.forEach(function(T){return O.addScope(T)}),R&&O.setCustomParameters(R),O},[S]))},ep=function(T,S){var R=M.useState(),O=R[0],V=R[1],K=M.useState(),$=K[0],Q=K[1],Y=M.useState(!1),X=Y[0],Z=Y[1];return[M.useCallback(function(R,O){return L(void 0,void 0,void 0,function(){var M,L;return U(this,function(U){switch(U.label){case 0:Z(!0),V(void 0),U.label=1;case 1:return U.trys.push([1,3,4,5]),M=S(R,O),[4,N.signInWithPopup(T,M)];case 2:return Q(L=U.sent()),[2,L];case 3:return V(U.sent()),[3,5];case 4:return Z(!1),[7];case 5:return[2]}})})},[T,S]),$,X,O]},em=function(T){var S=M.useState(),R=S[0],O=S[1],N=M.useState(!1),V=N[0],K=N[1];return[M.useCallback(function(){return L(void 0,void 0,void 0,function(){return U(this,function(S){switch(S.label){case 0:K(!0),O(void 0),S.label=1;case 1:return S.trys.push([1,3,4,5]),[4,T.signOut()];case 2:return S.sent(),[2,!0];case 3:return O(S.sent()),[2,!1];case 4:return K(!1),[7];case 5:return[2]}})})},[T]),V,R]},eg=function(T){var S=M.useState(),R=S[0],O=S[1],V=M.useState(!1),K=V[0],$=V[1];return[M.useCallback(function(S){return L(void 0,void 0,void 0,function(){return U(this,function(R){switch(R.label){case 0:$(!0),O(void 0),R.label=1;case 1:if(R.trys.push([1,5,6,7]),!T.currentUser)return[3,3];return[4,N.updateEmail(T.currentUser,S)];case 2:return R.sent(),[2,!0];case 3:throw Error("No user is logged in");case 4:return[3,7];case 5:return O(R.sent()),[2,!1];case 6:return $(!1),[7];case 7:return[2]}})})},[T]),K,R]},ey=function(T){var S=M.useState(),R=S[0],O=S[1],V=M.useState(!1),K=V[0],$=V[1];return[M.useCallback(function(S){return L(void 0,void 0,void 0,function(){return U(this,function(R){switch(R.label){case 0:$(!0),O(void 0),R.label=1;case 1:if(R.trys.push([1,5,6,7]),!T.currentUser)return[3,3];return[4,N.updatePassword(T.currentUser,S)];case 2:return R.sent(),[2,!0];case 3:throw Error("No user is logged in");case 4:return[3,7];case 5:return O(R.sent()),[2,!1];case 6:return $(!1),[7];case 7:return[2]}})})},[T]),K,R]},ev=function(T){var S=M.useState(),R=S[0],O=S[1],V=M.useState(!1),K=V[0],$=V[1];return[M.useCallback(function(S){return L(void 0,void 0,void 0,function(){return U(this,function(R){switch(R.label){case 0:$(!0),O(void 0),R.label=1;case 1:if(R.trys.push([1,5,6,7]),!T.currentUser)return[3,3];return[4,N.updateProfile(T.currentUser,S)];case 2:return R.sent(),[2,!0];case 3:throw Error("No user is logged in");case 4:return[3,7];case 5:return O(R.sent()),[2,!1];case 6:return $(!1),[7];case 7:return[2]}})})},[T]),K,R]},eb=function(T){var S=M.useState(),R=S[0],O=S[1],V=M.useState(!1),K=V[0],$=V[1];return[M.useCallback(function(S,R){return L(void 0,void 0,void 0,function(){return U(this,function(M){switch(M.label){case 0:$(!0),O(void 0),M.label=1;case 1:if(M.trys.push([1,5,6,7]),!T.currentUser)return[3,3];return[4,N.verifyBeforeUpdateEmail(T.currentUser,S,R)];case 2:return M.sent(),[2,!0];case 3:throw Error("No user is logged in");case 4:return[3,7];case 5:return O(M.sent()),[2,!1];case 6:return $(!1),[7];case 7:return[2]}})})},[T]),K,R]},e_=function(T,S){var R=Q(function(){return T.currentUser}),O=R.error,V=R.loading,K=R.setError,$=R.setValue,Y=R.value;return M.useEffect(function(){var R=N.onIdTokenChanged(T,function(T){return L(void 0,void 0,void 0,function(){return U(this,function(R){switch(R.label){case 0:if(!(null==S?void 0:S.onUserChanged))return[3,4];R.label=1;case 1:return R.trys.push([1,3,,4]),[4,S.onUserChanged(T)];case 2:return R.sent(),[3,4];case 3:return K(R.sent()),[3,4];case 4:return $(T),[2]}})})},K);return function(){R()}},[T]),[Y,V,O]};S.F_=Y,O=X,O=Z,O=e_,O=ee,O=et,O=er,O=es,O=en,O=ei,O=ea,O=eo,O=eu,O=ec,O=ed,O=eh,O=em,O=eg,O=ey,O=ev,O=eb},8324:(T,S)=>{"use strict";function R(T,S){if(!Object.prototype.hasOwnProperty.call(T,S))throw TypeError("attempted to use private field on non-instance");return T}S._=S._class_private_field_loose_base=R},4567:(T,S)=>{"use strict";var R=0;function O(T){return"__private_"+R+++"_"+T}S._=S._class_private_field_loose_key=O},2147:(T,S)=>{"use strict";function R(T){return T&&T.__esModule?T:{default:T}}S._=S._interop_require_default=R},4009:(T,S)=>{"use strict";function R(T){if("function"!=typeof WeakMap)return null;var S=new WeakMap,O=new WeakMap;return(R=function(T){return T?O:S})(T)}function O(T,S){if(!S&&T&&T.__esModule)return T;if(null===T||"object"!=typeof T&&"function"!=typeof T)return{default:T};var O=R(S);if(O&&O.has(T))return O.get(T);var N={},M=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var L in T)if("default"!==L&&Object.prototype.hasOwnProperty.call(T,L)){var U=M?Object.getOwnPropertyDescriptor(T,L):null;U&&(U.get||U.set)?Object.defineProperty(N,L,U):N[L]=T[L]}return N.default=T,O&&O.set(T,N),N}S._=S._interop_require_wildcard=O},6933:function(T,S){var R;!function(O,N){function M(T){return T.default||T}void 0!==(R=(function(){var T={};return N(T),M(T)}).apply(S,[]))&&(T.exports=R)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,function(T){"use strict";Object.defineProperty(T,"__esModule",{value:!0}),T.default=void 0;/**
     * @license
     * Copyright 2009 The Closure Library Authors
     * Copyright 2020 Daniel Wirtz / The long.js Authors.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *     http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     *
     * SPDX-License-Identifier: Apache-2.0
     */var S=null;try{S=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function R(T,S,R){this.low=0|T,this.high=0|S,this.unsigned=!!R}function O(T){return!0===(T&&T.__isLong__)}function N(T){var S=Math.clz32(T&-T);return T?31-S:S}R.prototype.__isLong__,Object.defineProperty(R.prototype,"__isLong__",{value:!0}),R.isLong=O;var M={},L={};function U(T,S){var R,O,N;return S?(T>>>=0,(N=0<=T&&T<256)&&(O=L[T]))?O:(R=K(T,0,!0),N&&(L[T]=R),R):(T|=0,(N=-128<=T&&T<128)&&(O=M[T]))?O:(R=K(T,T<0?-1:0,!1),N&&(M[T]=R),R)}function V(T,S){if(isNaN(T))return S?en:er;if(S){if(T<0)return en;if(T>=Z)return eu}else{if(T<=-ee)return ec;if(T+1>=ee)return eo}return T<0?V(-T,S).neg():K(T%X|0,T/X|0,S)}function K(T,S,O){return new R(T,S,O)}R.fromInt=U,R.fromNumber=V,R.fromBits=K;var $=Math.pow;function Q(T,S,R){if(0===T.length)throw Error("empty string");if("number"==typeof S?(R=S,S=!1):S=!!S,"NaN"===T||"Infinity"===T||"+Infinity"===T||"-Infinity"===T)return S?en:er;if((R=R||10)<2||36<R)throw RangeError("radix");if((O=T.indexOf("-"))>0)throw Error("interior hyphen");if(0===O)return Q(T.substring(1),S,R).neg();for(var O,N=V($(R,8)),M=er,L=0;L<T.length;L+=8){var U=Math.min(8,T.length-L),K=parseInt(T.substring(L,L+U),R);if(U<8){var Y=V($(R,U));M=M.mul(Y).add(V(K))}else M=(M=M.mul(N)).add(V(K))}return M.unsigned=S,M}function Y(T,S){return"number"==typeof T?V(T,S):"string"==typeof T?Q(T,S):K(T.low,T.high,"boolean"==typeof S?S:T.unsigned)}R.fromString=Q,R.fromValue=Y;var X=4294967296,Z=18446744073709552e3,ee=0x7fffffffffffffff,et=U(16777216),er=U(0);R.ZERO=er;var en=U(0,!0);R.UZERO=en;var ei=U(1);R.ONE=ei;var es=U(1,!0);R.UONE=es;var ea=U(-1);R.NEG_ONE=ea;var eo=K(-1,2147483647,!1);R.MAX_VALUE=eo;var eu=K(-1,-1,!0);R.MAX_UNSIGNED_VALUE=eu;var ec=K(0,-2147483648,!1);R.MIN_VALUE=ec;var ed=R.prototype;ed.toInt=function(){return this.unsigned?this.low>>>0:this.low},ed.toNumber=function(){return this.unsigned?(this.high>>>0)*X+(this.low>>>0):this.high*X+(this.low>>>0)},ed.toString=function(T){if((T=T||10)<2||36<T)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(!this.eq(ec))return"-"+this.neg().toString(T);var S=V(T),R=this.div(S),O=R.mul(S).sub(this);return R.toString(T)+O.toInt().toString(T)}for(var N=V($(T,6),this.unsigned),M=this,L="";;){var U=M.div(N),K=(M.sub(U.mul(N)).toInt()>>>0).toString(T);if((M=U).isZero())return K+L;for(;K.length<6;)K="0"+K;L=""+K+L}},ed.getHighBits=function(){return this.high},ed.getHighBitsUnsigned=function(){return this.high>>>0},ed.getLowBits=function(){return this.low},ed.getLowBitsUnsigned=function(){return this.low>>>0},ed.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ec)?64:this.neg().getNumBitsAbs();for(var T=0!=this.high?this.high:this.low,S=31;S>0&&(T&1<<S)==0;S--);return 0!=this.high?S+33:S+1},ed.isSafeInteger=function(){var T=this.high>>21;return!T||!this.unsigned&&-1===T&&!(0===this.low&&-2097152===this.high)},ed.isZero=function(){return 0===this.high&&0===this.low},ed.eqz=ed.isZero,ed.isNegative=function(){return!this.unsigned&&this.high<0},ed.isPositive=function(){return this.unsigned||this.high>=0},ed.isOdd=function(){return(1&this.low)==1},ed.isEven=function(){return(1&this.low)==0},ed.equals=function(T){return O(T)||(T=Y(T)),(this.unsigned===T.unsigned||this.high>>>31!=1||T.high>>>31!=1)&&this.high===T.high&&this.low===T.low},ed.eq=ed.equals,ed.notEquals=function(T){return!this.eq(T)},ed.neq=ed.notEquals,ed.ne=ed.notEquals,ed.lessThan=function(T){return 0>this.comp(T)},ed.lt=ed.lessThan,ed.lessThanOrEqual=function(T){return 0>=this.comp(T)},ed.lte=ed.lessThanOrEqual,ed.le=ed.lessThanOrEqual,ed.greaterThan=function(T){return this.comp(T)>0},ed.gt=ed.greaterThan,ed.greaterThanOrEqual=function(T){return this.comp(T)>=0},ed.gte=ed.greaterThanOrEqual,ed.ge=ed.greaterThanOrEqual,ed.compare=function(T){if(O(T)||(T=Y(T)),this.eq(T))return 0;var S=this.isNegative(),R=T.isNegative();return S&&!R?-1:!S&&R?1:this.unsigned?T.high>>>0>this.high>>>0||T.high===this.high&&T.low>>>0>this.low>>>0?-1:1:this.sub(T).isNegative()?-1:1},ed.comp=ed.compare,ed.negate=function(){return!this.unsigned&&this.eq(ec)?ec:this.not().add(ei)},ed.neg=ed.negate,ed.add=function(T){O(T)||(T=Y(T));var S,R,N=this.high>>>16,M=65535&this.high,L=this.low>>>16,U=65535&this.low,V=T.high>>>16,$=65535&T.high,Q=T.low>>>16,X=65535&T.low,Z=0,ee=0;return S=0+((R=0+(U+X))>>>16),R&=65535,S+=L+Q,ee+=S>>>16,S&=65535,ee+=M+$,Z+=ee>>>16,ee&=65535,Z+=N+V,K(S<<16|R,(Z&=65535)<<16|ee,this.unsigned)},ed.subtract=function(T){return O(T)||(T=Y(T)),this.add(T.neg())},ed.sub=ed.subtract,ed.multiply=function(T){if(this.isZero())return this;if(O(T)||(T=Y(T)),S)return K(S.mul(this.low,this.high,T.low,T.high),S.get_high(),this.unsigned);if(T.isZero())return this.unsigned?en:er;if(this.eq(ec))return T.isOdd()?ec:er;if(T.eq(ec))return this.isOdd()?ec:er;if(this.isNegative())return T.isNegative()?this.neg().mul(T.neg()):this.neg().mul(T).neg();if(T.isNegative())return this.mul(T.neg()).neg();if(this.lt(et)&&T.lt(et))return V(this.toNumber()*T.toNumber(),this.unsigned);var R,N,M=this.high>>>16,L=65535&this.high,U=this.low>>>16,$=65535&this.low,Q=T.high>>>16,X=65535&T.high,Z=T.low>>>16,ee=65535&T.low,ei=0,es=0;return R=0+((N=0+$*ee)>>>16),N&=65535,R+=U*ee,es+=R>>>16,R&=65535,R+=$*Z,es+=R>>>16,R&=65535,es+=L*ee,ei+=es>>>16,es&=65535,es+=U*Z,ei+=es>>>16,es&=65535,es+=$*X,ei+=es>>>16,es&=65535,ei+=M*ee+L*Z+U*X+$*Q,K(R<<16|N,(ei&=65535)<<16|es,this.unsigned)},ed.mul=ed.multiply,ed.divide=function(T){if(O(T)||(T=Y(T)),T.isZero())throw Error("division by zero");if(S){var R,N,M;return this.unsigned||-2147483648!==this.high||-1!==T.low||-1!==T.high?K((this.unsigned?S.div_u:S.div_s)(this.low,this.high,T.low,T.high),S.get_high(),this.unsigned):this}if(this.isZero())return this.unsigned?en:er;if(this.unsigned){if(T.unsigned||(T=T.toUnsigned()),T.gt(this))return en;if(T.gt(this.shru(1)))return es;M=en}else{if(this.eq(ec))return T.eq(ei)||T.eq(ea)?ec:T.eq(ec)?ei:(R=this.shr(1).div(T).shl(1)).eq(er)?T.isNegative()?ei:ea:(N=this.sub(T.mul(R)),M=R.add(N.div(T)));if(T.eq(ec))return this.unsigned?en:er;if(this.isNegative())return T.isNegative()?this.neg().div(T.neg()):this.neg().div(T).neg();if(T.isNegative())return this.div(T.neg()).neg();M=er}for(N=this;N.gte(T);){for(var L=Math.ceil(Math.log(R=Math.max(1,Math.floor(N.toNumber()/T.toNumber())))/Math.LN2),U=L<=48?1:$(2,L-48),Q=V(R),X=Q.mul(T);X.isNegative()||X.gt(N);)R-=U,X=(Q=V(R,this.unsigned)).mul(T);Q.isZero()&&(Q=ei),M=M.add(Q),N=N.sub(X)}return M},ed.div=ed.divide,ed.modulo=function(T){return(O(T)||(T=Y(T)),S)?K((this.unsigned?S.rem_u:S.rem_s)(this.low,this.high,T.low,T.high),S.get_high(),this.unsigned):this.sub(this.div(T).mul(T))},ed.mod=ed.modulo,ed.rem=ed.modulo,ed.not=function(){return K(~this.low,~this.high,this.unsigned)},ed.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},ed.clz=ed.countLeadingZeros,ed.countTrailingZeros=function(){return this.low?N(this.low):N(this.high)+32},ed.ctz=ed.countTrailingZeros,ed.and=function(T){return O(T)||(T=Y(T)),K(this.low&T.low,this.high&T.high,this.unsigned)},ed.or=function(T){return O(T)||(T=Y(T)),K(this.low|T.low,this.high|T.high,this.unsigned)},ed.xor=function(T){return O(T)||(T=Y(T)),K(this.low^T.low,this.high^T.high,this.unsigned)},ed.shiftLeft=function(T){return(O(T)&&(T=T.toInt()),0==(T&=63))?this:T<32?K(this.low<<T,this.high<<T|this.low>>>32-T,this.unsigned):K(0,this.low<<T-32,this.unsigned)},ed.shl=ed.shiftLeft,ed.shiftRight=function(T){return(O(T)&&(T=T.toInt()),0==(T&=63))?this:T<32?K(this.low>>>T|this.high<<32-T,this.high>>T,this.unsigned):K(this.high>>T-32,this.high>=0?0:-1,this.unsigned)},ed.shr=ed.shiftRight,ed.shiftRightUnsigned=function(T){return(O(T)&&(T=T.toInt()),0==(T&=63))?this:T<32?K(this.low>>>T|this.high<<32-T,this.high>>>T,this.unsigned):32===T?K(this.high,0,this.unsigned):K(this.high>>>T-32,0,this.unsigned)},ed.shru=ed.shiftRightUnsigned,ed.shr_u=ed.shiftRightUnsigned,ed.rotateLeft=function(T){var S;return(O(T)&&(T=T.toInt()),0==(T&=63))?this:32===T?K(this.high,this.low,this.unsigned):T<32?(S=32-T,K(this.low<<T|this.high>>>S,this.high<<T|this.low>>>S,this.unsigned)):(T-=32,S=32-T,K(this.high<<T|this.low>>>S,this.low<<T|this.high>>>S,this.unsigned))},ed.rotl=ed.rotateLeft,ed.rotateRight=function(T){var S;return(O(T)&&(T=T.toInt()),0==(T&=63))?this:32===T?K(this.high,this.low,this.unsigned):T<32?(S=32-T,K(this.high<<S|this.low>>>T,this.low<<S|this.high>>>T,this.unsigned)):(T-=32,S=32-T,K(this.low<<S|this.high>>>T,this.high<<S|this.low>>>T,this.unsigned))},ed.rotr=ed.rotateRight,ed.toSigned=function(){return this.unsigned?K(this.low,this.high,!1):this},ed.toUnsigned=function(){return this.unsigned?this:K(this.low,this.high,!0)},ed.toBytes=function(T){return T?this.toBytesLE():this.toBytesBE()},ed.toBytesLE=function(){var T=this.high,S=this.low;return[255&S,S>>>8&255,S>>>16&255,S>>>24,255&T,T>>>8&255,T>>>16&255,T>>>24]},ed.toBytesBE=function(){var T=this.high,S=this.low;return[T>>>24,T>>>16&255,T>>>8&255,255&T,S>>>24,S>>>16&255,S>>>8&255,255&S]},R.fromBytes=function(T,S,O){return O?R.fromBytesLE(T,S):R.fromBytesBE(T,S)},R.fromBytesLE=function(T,S){return new R(T[0]|T[1]<<8|T[2]<<16|T[3]<<24,T[4]|T[5]<<8|T[6]<<16|T[7]<<24,S)},R.fromBytesBE=function(T,S){return new R(T[4]<<24|T[5]<<16|T[6]<<8|T[7],T[0]<<24|T[1]<<16|T[2]<<8|T[3],S)},"function"==typeof BigInt&&(R.fromBigInt=function(T,S){return K(Number(BigInt.asIntN(32,T)),Number(BigInt.asIntN(32,T>>BigInt(32))),S)},R.fromValue=function(T,S){return"bigint"==typeof T?R.fromBigInt(T,S):Y(T,S)},ed.toBigInt=function(){var T=BigInt(this.low>>>0);return BigInt(this.unsigned?this.high>>>0:this.high)<<BigInt(32)|T}),T.default=R})},1974:(T,S)=>{"use strict";function R(T){return T&&T.__esModule?T:{default:T}}S._=S._interop_require_default=R},2339:(T,S,R)=>{"use strict";R.d(S,{Jn:()=>eM,KN:()=>ex,Xd:()=>eN,rh:()=>ek});var O=R(5880),N=R(9824),M=R(4738),L=R(2643);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(T){this.container=T}getPlatformInfoString(){let T=this.container.getProviders();return T.map(T=>{if(!V(T))return null;{let S=T.getImmediate();return`${S.library}/${S.version}`}}).filter(T=>T).join(" ")}}function V(T){let S=T.getComponent();return S?.type==="VERSION"}let K="@firebase/app",$="0.14.1",Q=new N.Yd("@firebase/app"),Y="@firebase/app-compat",X="@firebase/analytics-compat",Z="@firebase/analytics",ee="@firebase/app-check-compat",et="@firebase/app-check",er="@firebase/auth",en="@firebase/auth-compat",ei="@firebase/database",es="@firebase/data-connect",ea="@firebase/database-compat",eo="@firebase/functions",eu="@firebase/functions-compat",ec="@firebase/installations",ed="@firebase/installations-compat",eh="@firebase/messaging",ef="@firebase/messaging-compat",ep="@firebase/performance",em="@firebase/performance-compat",eg="@firebase/remote-config",ey="@firebase/remote-config-compat",ev="@firebase/storage",eb="@firebase/storage-compat",e_="@firebase/firestore",eT="@firebase/ai",eS="@firebase/firestore-compat",eE="firebase",ew="12.1.0",eC={[K]:"fire-core",[Y]:"fire-core-compat",[Z]:"fire-analytics",[X]:"fire-analytics-compat",[et]:"fire-app-check",[ee]:"fire-app-check-compat",[er]:"fire-auth",[en]:"fire-auth-compat",[ei]:"fire-rtdb",[es]:"fire-data-connect",[ea]:"fire-rtdb-compat",[eo]:"fire-fn",[eu]:"fire-fn-compat",[ec]:"fire-iid",[ed]:"fire-iid-compat",[eh]:"fire-fcm",[ef]:"fire-fcm-compat",[ep]:"fire-perf",[em]:"fire-perf-compat",[eg]:"fire-rc",[ey]:"fire-rc-compat",[ev]:"fire-gcs",[eb]:"fire-gcs-compat",[e_]:"fire-fst",[eS]:"fire-fst-compat",[eT]:"fire-vertex","fire-js":"fire-js",[eE]:"fire-js-all"},eI=new Map,eR=new Map,eA=new Map;function eO(T,S){try{T.container.addComponent(S)}catch(R){Q.debug(`Component ${S.name} failed to register with FirebaseApp ${T.name}`,R)}}function eN(T){let S=T.name;if(eA.has(S))return Q.debug(`There were multiple attempts to register component ${S}.`),!1;for(let R of(eA.set(S,T),eI.values()))eO(R,T);for(let S of eR.values())eO(S,T);return!0}function ek(T){return null!=T&&void 0!==T.settings}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},eD=new M.LL("app","Firebase",eP),eM=ew;function ex(T,S,R){let N=eC[T]??T;R&&(N+=`-${R}`);let M=N.match(/\s|\//),L=S.match(/\s|\//);if(M||L){let T=[`Unable to register library "${N}" with version "${S}":`];M&&T.push(`library name "${N}" contains illegal characters (whitespace or "/")`),M&&L&&T.push("and"),L&&T.push(`version name "${S}" contains illegal characters (whitespace or "/")`),Q.warn(T.join(" "));return}eN(new O.wA(`${N}-version`,()=>({library:N,version:S}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eL="firebase-heartbeat-database",eF=1,eU="firebase-heartbeat-store",ej=null;function eB(){return ej||(ej=(0,L.openDB)(eL,eF,{upgrade:(T,S)=>{if(0===S)try{T.createObjectStore(eU)}catch(T){console.warn(T)}}}).catch(T=>{throw eD.create("idb-open",{originalErrorMessage:T.message})})),ej}async function eV(T){try{let S=await eB(),R=S.transaction(eU),O=await R.objectStore(eU).get(eq(T));return await R.done,O}catch(T){if(T instanceof M.ZR)Q.warn(T.message);else{let S=eD.create("idb-get",{originalErrorMessage:T?.message});Q.warn(S.message)}}}async function ez(T,S){try{let R=await eB(),O=R.transaction(eU,"readwrite"),N=O.objectStore(eU);await N.put(S,eq(T)),await O.done}catch(T){if(T instanceof M.ZR)Q.warn(T.message);else{let S=eD.create("idb-set",{originalErrorMessage:T?.message});Q.warn(S.message)}}}function eq(T){return`${T.name}!${T.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eH=1024,eG=30;class eW{constructor(T){this.container=T,this._heartbeatsCache=null;let S=this.container.getProvider("app").getImmediate();this._storage=new eQ(S),this._heartbeatsCachePromise=this._storage.read().then(T=>(this._heartbeatsCache=T,T))}async triggerHeartbeat(){try{let T=this.container.getProvider("platform-logger").getImmediate(),S=T.getPlatformInfoString(),R=eK();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===R||this._heartbeatsCache.heartbeats.some(T=>T.date===R))return;if(this._heartbeatsCache.heartbeats.push({date:R,agent:S}),this._heartbeatsCache.heartbeats.length>eG){let T=eJ(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(T,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(T){Q.warn(T)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||0===this._heartbeatsCache.heartbeats.length)return"";let T=eK(),{heartbeatsToSend:S,unsentEntries:R}=e$(this._heartbeatsCache.heartbeats),O=(0,M.L)(JSON.stringify({version:2,heartbeats:S}));return this._heartbeatsCache.lastSentHeartbeatDate=T,R.length>0?(this._heartbeatsCache.heartbeats=R,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),O}catch(T){return Q.warn(T),""}}}function eK(){let T=new Date;return T.toISOString().substring(0,10)}function e$(T,S=eH){let R=[],O=T.slice();for(let N of T){let T=R.find(T=>T.agent===N.agent);if(T){if(T.dates.push(N.date),eY(R)>S){T.dates.pop();break}}else if(R.push({agent:N.agent,dates:[N.date]}),eY(R)>S){R.pop();break}O=O.slice(1)}return{heartbeatsToSend:R,unsentEntries:O}}class eQ{constructor(T){this.app=T,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,M.hl)()&&(0,M.eu)().then(()=>!0).catch(()=>!1)}async read(){let T=await this._canUseIndexedDBPromise;if(!T)return{heartbeats:[]};{let T=await eV(this.app);return T?.heartbeats?T:{heartbeats:[]}}}async overwrite(T){let S=await this._canUseIndexedDBPromise;if(S){let S=await this.read();return ez(this.app,{lastSentHeartbeatDate:T.lastSentHeartbeatDate??S.lastSentHeartbeatDate,heartbeats:T.heartbeats})}}async add(T){let S=await this._canUseIndexedDBPromise;if(S){let S=await this.read();return ez(this.app,{lastSentHeartbeatDate:T.lastSentHeartbeatDate??S.lastSentHeartbeatDate,heartbeats:[...S.heartbeats,...T.heartbeats]})}}}function eY(T){return(0,M.L)(JSON.stringify({version:2,heartbeats:T})).length}function eJ(T){if(0===T.length)return -1;let S=0,R=T[0].date;for(let O=1;O<T.length;O++)T[O].date<R&&(R=T[O].date,S=O);return S}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(T){eN(new O.wA("platform-logger",T=>new U(T),"PRIVATE")),eN(new O.wA("heartbeat",T=>new eW(T),"PRIVATE")),ex(K,$,""),ex(K,$,"esm2020"),ex("fire-js","")})(0)},5880:(T,S,R)=>{"use strict";R.d(S,{wA:()=>O}),R(4738);class O{constructor(T,S,R){this.name=T,this.instanceFactory=S,this.type=R,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(T){return this.instantiationMode=T,this}setMultipleInstances(T){return this.multipleInstances=T,this}setServiceProps(T){return this.serviceProps=T,this}setInstanceCreatedCallback(T){return this.onInstanceCreated=T,this}}},9824:(T,S,R)=>{"use strict";var O;R.d(S,{Yd:()=>K,in:()=>O});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let N=[];!function(T){T[T.DEBUG=0]="DEBUG",T[T.VERBOSE=1]="VERBOSE",T[T.INFO=2]="INFO",T[T.WARN=3]="WARN",T[T.ERROR=4]="ERROR",T[T.SILENT=5]="SILENT"}(O||(O={}));let M={debug:O.DEBUG,verbose:O.VERBOSE,info:O.INFO,warn:O.WARN,error:O.ERROR,silent:O.SILENT},L=O.INFO,U={[O.DEBUG]:"log",[O.VERBOSE]:"log",[O.INFO]:"info",[O.WARN]:"warn",[O.ERROR]:"error"},V=(T,S,...R)=>{if(S<T.logLevel)return;let O=new Date().toISOString(),N=U[S];if(N)console[N](`[${O}]  ${T.name}:`,...R);else throw Error(`Attempted to log a message with an invalid logType (value: ${S})`)};class K{constructor(T){this.name=T,this._logLevel=L,this._logHandler=V,this._userLogHandler=null,N.push(this)}get logLevel(){return this._logLevel}set logLevel(T){if(!(T in O))throw TypeError(`Invalid value "${T}" assigned to \`logLevel\``);this._logLevel=T}setLogLevel(T){this._logLevel="string"==typeof T?M[T]:T}get logHandler(){return this._logHandler}set logHandler(T){if("function"!=typeof T)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=T}get userLogHandler(){return this._userLogHandler}set userLogHandler(T){this._userLogHandler=T}debug(...T){this._userLogHandler&&this._userLogHandler(this,O.DEBUG,...T),this._logHandler(this,O.DEBUG,...T)}log(...T){this._userLogHandler&&this._userLogHandler(this,O.VERBOSE,...T),this._logHandler(this,O.VERBOSE,...T)}info(...T){this._userLogHandler&&this._userLogHandler(this,O.INFO,...T),this._logHandler(this,O.INFO,...T)}warn(...T){this._userLogHandler&&this._userLogHandler(this,O.WARN,...T),this._logHandler(this,O.WARN,...T)}error(...T){this._userLogHandler&&this._userLogHandler(this,O.ERROR,...T),this._logHandler(this,O.ERROR,...T)}}},4738:(T,S,R)=>{"use strict";R.d(S,{LL:()=>em,ZR:()=>ep,tV:()=>Q,L:()=>$,ne:()=>eT,pd:()=>e_,m9:()=>eC,z$:()=>en,ru:()=>eo,Xx:()=>er,L_:()=>ea,hl:()=>ed,uI:()=>ei,b$:()=>eu,G6:()=>ec,xO:()=>ev,zd:()=>eb,eu:()=>eh});let O=()=>void 0,N={NODE_CLIENT:!1},M=function(T){let S=[],R=0;for(let O=0;O<T.length;O++){let N=T.charCodeAt(O);N<128?S[R++]=N:(N<2048?S[R++]=N>>6|192:((64512&N)==55296&&O+1<T.length&&(64512&T.charCodeAt(O+1))==56320?(N=65536+((1023&N)<<10)+(1023&T.charCodeAt(++O)),S[R++]=N>>18|240,S[R++]=N>>12&63|128):S[R++]=N>>12|224,S[R++]=N>>6&63|128),S[R++]=63&N|128)}return S},L=function(T){let S=[],R=0,O=0;for(;R<T.length;){let N=T[R++];if(N<128)S[O++]=String.fromCharCode(N);else if(N>191&&N<224){let M=T[R++];S[O++]=String.fromCharCode((31&N)<<6|63&M)}else if(N>239&&N<365){let M=T[R++],L=T[R++],U=T[R++],V=((7&N)<<18|(63&M)<<12|(63&L)<<6|63&U)-65536;S[O++]=String.fromCharCode(55296+(V>>10)),S[O++]=String.fromCharCode(56320+(1023&V))}else{let M=T[R++],L=T[R++];S[O++]=String.fromCharCode((15&N)<<12|(63&M)<<6|63&L)}}return S.join("")},U={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(T,S){if(!Array.isArray(T))throw Error("encodeByteArray takes an array as a parameter");this.init_();let R=S?this.byteToCharMapWebSafe_:this.byteToCharMap_,O=[];for(let S=0;S<T.length;S+=3){let N=T[S],M=S+1<T.length,L=M?T[S+1]:0,U=S+2<T.length,V=U?T[S+2]:0,K=N>>2,$=(3&N)<<4|L>>4,Q=(15&L)<<2|V>>6,Y=63&V;U||(Y=64,M||(Q=64)),O.push(R[K],R[$],R[Q],R[Y])}return O.join("")},encodeString(T,S){return this.HAS_NATIVE_SUPPORT&&!S?btoa(T):this.encodeByteArray(M(T),S)},decodeString(T,S){return this.HAS_NATIVE_SUPPORT&&!S?atob(T):L(this.decodeStringToByteArray(T,S))},decodeStringToByteArray(T,S){this.init_();let R=S?this.charToByteMapWebSafe_:this.charToByteMap_,O=[];for(let S=0;S<T.length;){let N=R[T.charAt(S++)],M=S<T.length,L=M?R[T.charAt(S)]:0;++S;let U=S<T.length,K=U?R[T.charAt(S)]:64;++S;let $=S<T.length,Q=$?R[T.charAt(S)]:64;if(++S,null==N||null==L||null==K||null==Q)throw new V;let Y=N<<2|L>>4;if(O.push(Y),64!==K){let T=L<<4&240|K>>2;if(O.push(T),64!==Q){let T=K<<6&192|Q;O.push(T)}}}return O},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let T=0;T<this.ENCODED_VALS.length;T++)this.byteToCharMap_[T]=this.ENCODED_VALS.charAt(T),this.charToByteMap_[this.byteToCharMap_[T]]=T,this.byteToCharMapWebSafe_[T]=this.ENCODED_VALS_WEBSAFE.charAt(T),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[T]]=T,T>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(T)]=T,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(T)]=T)}}};class V extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let K=function(T){let S=M(T);return U.encodeByteArray(S,!0)},$=function(T){return K(T).replace(/\./g,"")},Q=function(T){try{return U.decodeString(T,!0)}catch(T){console.error("base64Decode failed: ",T)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let X=()=>Y().__FIREBASE_DEFAULTS__,Z=()=>{if("undefined"==typeof process||void 0===process.env)return;let T=process.env.__FIREBASE_DEFAULTS__;if(T)return JSON.parse(T)},ee=()=>{let T;if("undefined"==typeof document)return;try{T=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(T){return}let S=T&&Q(T[1]);return S&&JSON.parse(S)},et=()=>{try{return O()||X()||Z()||ee()}catch(T){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${T}`);return}};/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function er(T){try{let S=T.startsWith("http://")||T.startsWith("https://")?new URL(T).hostname:T;return S.endsWith(".cloudworkstations.dev")}catch{return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function ei(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(en())}function es(){let T=et()?.forceEnvironment;if("node"===T)return!0;if("browser"===T)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(T){return!1}}function ea(){return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function eo(){let T="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof T&&void 0!==T.id}function eu(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function ec(){return!es()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ed(){try{return"object"==typeof indexedDB}catch(T){return!1}}function eh(){return new Promise((T,S)=>{try{let R=!0,O="validate-browser-context-for-indexeddb-analytics-module",N=self.indexedDB.open(O);N.onsuccess=()=>{N.result.close(),R||self.indexedDB.deleteDatabase(O),T(!0)},N.onupgradeneeded=()=>{R=!1},N.onerror=()=>{S(N.error?.message||"")}}catch(T){S(T)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ef="FirebaseError";class ep extends Error{constructor(T,S,R){super(S),this.code=T,this.customData=R,this.name=ef,Object.setPrototypeOf(this,ep.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,em.prototype.create)}}class em{constructor(T,S,R){this.service=T,this.serviceName=S,this.errors=R}create(T,...S){let R=S[0]||{},O=`${this.service}/${T}`,N=this.errors[T],M=N?eg(N,R):"Error",L=`${this.serviceName}: ${M} (${O}).`,U=new ep(O,L,R);return U}}function eg(T,S){return T.replace(ey,(T,R)=>{let O=S[R];return null!=O?String(O):`<${R}?>`})}let ey=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ev(T){let S=[];for(let[R,O]of Object.entries(T))Array.isArray(O)?O.forEach(T=>{S.push(encodeURIComponent(R)+"="+encodeURIComponent(T))}):S.push(encodeURIComponent(R)+"="+encodeURIComponent(O));return S.length?"&"+S.join("&"):""}function eb(T){let S={},R=T.replace(/^\?/,"").split("&");return R.forEach(T=>{if(T){let[R,O]=T.split("=");S[decodeURIComponent(R)]=decodeURIComponent(O)}}),S}function e_(T){let S=T.indexOf("?");if(!S)return"";let R=T.indexOf("#",S);return T.substring(S,R>0?R:void 0)}function eT(T,S){let R=new eS(T,S);return R.subscribe.bind(R)}class eS{constructor(T,S){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=S,this.task.then(()=>{T(this)}).catch(T=>{this.error(T)})}next(T){this.forEachObserver(S=>{S.next(T)})}error(T){this.forEachObserver(S=>{S.error(T)}),this.close(T)}complete(){this.forEachObserver(T=>{T.complete()}),this.close()}subscribe(T,S,R){let O;if(void 0===T&&void 0===S&&void 0===R)throw Error("Missing Observer.");void 0===(O=eE(T,["next","error","complete"])?T:{next:T,error:S,complete:R}).next&&(O.next=ew),void 0===O.error&&(O.error=ew),void 0===O.complete&&(O.complete=ew);let N=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?O.error(this.finalError):O.complete()}catch(T){}}),this.observers.push(O),N}unsubscribeOne(T){void 0!==this.observers&&void 0!==this.observers[T]&&(delete this.observers[T],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(T){if(!this.finalized)for(let S=0;S<this.observers.length;S++)this.sendOne(S,T)}sendOne(T,S){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[T])try{S(this.observers[T])}catch(T){"undefined"!=typeof console&&console.error&&console.error(T)}})}close(T){this.finalized||(this.finalized=!0,void 0!==T&&(this.finalError=T),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function eE(T,S){if("object"!=typeof T||null===T)return!1;for(let R of S)if(R in T&&"function"==typeof T[R])return!0;return!1}function ew(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eC(T){return T&&T._delegate?T._delegate:T}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */N.NODE_CLIENT=!0},2856:(T,S,R)=>{"use strict";var O=R(2339),N="firebase",M="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(0,O.KN)(N,M,"app")},1176:(T,S,R)=>{"use strict";R.d(S,{Xb:()=>tX,e5:()=>tZ,rh:()=>rs,w7:()=>t0});var O=R(2339),N=R(4738),M=R(5880),L=R(9824);function U(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}let V=U,K=new N.LL("auth","Firebase",U()),$=new L.Yd("@firebase/auth");function Q(T,...S){$.logLevel<=L.in.WARN&&$.warn(`Auth (${O.Jn}): ${T}`,...S)}function Y(T,...S){$.logLevel<=L.in.ERROR&&$.error(`Auth (${O.Jn}): ${T}`,...S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X(T,...S){throw er(T,...S)}function Z(T,...S){return er(T,...S)}function ee(T,S,R){let O={...V(),[S]:R},M=new N.LL("auth","Firebase",O);return M.create(S,{appName:T.name})}function et(T){return ee(T,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function er(T,...S){if("string"!=typeof T){let R=S[0],O=[...S.slice(1)];return O[0]&&(O[0].appName=T.name),T._errorFactory.create(R,...O)}return K.create(T,...S)}function en(T,S,...R){if(!T)throw er(S,...R)}function ei(T){let S="INTERNAL ASSERTION FAILED: "+T;throw Y(S),Error(S)}function es(T,S){T||ei(S)}function ea(){return"http:"===eo()||"https:"===eo()}function eo(){return"undefined"!=typeof self&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eu(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(ea()||(0,N.ru)()||"connection"in navigator))||navigator.onLine}function ec(){if("undefined"==typeof navigator)return null;let T=navigator;return T.languages&&T.languages[0]||T.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(T,S){this.shortDelay=T,this.longDelay=S,es(S>T,"Short delay should be less than long delay!"),this.isMobile=(0,N.uI)()||(0,N.b$)()}get(){return eu()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eh(T,S){es(T.emulator,"Emulator should always be set here");let{url:R}=T.emulator;return S?`${R}${S.startsWith("/")?S.slice(1):S}`:R}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{static initialize(T,S,R){this.fetchImpl=T,S&&(this.headersImpl=S),R&&(this.responseImpl=R)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void ei("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void ei("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void ei("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ep={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},em=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],eg=new ed(3e4,6e4);function ey(T,S){return T.tenantId&&!S.tenantId?{...S,tenantId:T.tenantId}:S}async function ev(T,S,R,O,M={}){return eb(T,M,async()=>{let M={},L={};O&&("GET"===S?L=O:M={body:JSON.stringify(O)});let U=(0,N.xO)({key:T.config.apiKey,...L}).slice(1),V=await T._getAdditionalHeaders();V["Content-Type"]="application/json",T.languageCode&&(V["X-Firebase-Locale"]=T.languageCode);let K={method:S,headers:V,...M};return(0,N.L_)()||(K.referrerPolicy="no-referrer"),T.emulatorConfig&&(0,N.Xx)(T.emulatorConfig.host)&&(K.credentials="include"),ef.fetch()(await eT(T,T.config.apiHost,R,U),K)})}async function eb(T,S,R){T._canInitEmulator=!1;let O={...ep,...S};try{let S=new eE(T),N=await Promise.race([R(),S.promise]);S.clearNetworkTimeout();let M=await N.json();if("needConfirmation"in M)throw ew(T,"account-exists-with-different-credential",M);if(N.ok&&!("errorMessage"in M))return M;{let S=N.ok?M.errorMessage:M.error.message,[R,L]=S.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===R)throw ew(T,"credential-already-in-use",M);if("EMAIL_EXISTS"===R)throw ew(T,"email-already-in-use",M);if("USER_DISABLED"===R)throw ew(T,"user-disabled",M);let U=O[R]||R.toLowerCase().replace(/[_\s]+/g,"-");if(L)throw ee(T,U,L);X(T,U)}}catch(S){if(S instanceof N.ZR)throw S;X(T,"network-request-failed",{message:String(S)})}}async function e_(T,S,R,O,N={}){let M=await ev(T,S,R,O,N);return"mfaPendingCredential"in M&&X(T,"multi-factor-auth-required",{_serverResponse:M}),M}async function eT(T,S,R,O){let N=`${S}${R}?${O}`,M=T,L=M.config.emulator?eh(T.config,N):`${T.config.apiScheme}://${N}`;if(em.includes(R)&&(await M._persistenceManagerAvailable,"COOKIE"===M._getPersistenceType())){let T=M._getPersistence();return T._getFinalTarget(L).toString()}return L}function eS(T){switch(T){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class eE{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(T){this.auth=T,this.timer=null,this.promise=new Promise((T,S)=>{this.timer=setTimeout(()=>S(Z(this.auth,"network-request-failed")),eg.get())})}}function ew(T,S,R){let O={appName:T.name};R.email&&(O.email=R.email),R.phoneNumber&&(O.phoneNumber=R.phoneNumber);let N=Z(T,S,O);return N.customData._tokenResponse=R,N}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eC(T){return void 0!==T&&void 0!==T.enterprise}class eI{constructor(T){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===T.recaptchaKey)throw Error("recaptchaKey undefined");this.siteKey=T.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=T.recaptchaEnforcementState}getProviderEnforcementState(T){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(let S of this.recaptchaEnforcementState)if(S.provider&&S.provider===T)return eS(S.enforcementState);return null}isProviderEnabled(T){return"ENFORCE"===this.getProviderEnforcementState(T)||"AUDIT"===this.getProviderEnforcementState(T)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eR(T,S){return ev(T,"GET","/v2/recaptchaConfig",ey(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eA(T,S){return ev(T,"POST","/v1/accounts:delete",S)}async function eO(T,S){return ev(T,"POST","/v1/accounts:lookup",S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eN(T){if(T)try{let S=new Date(Number(T));if(!isNaN(S.getTime()))return S.toUTCString()}catch(T){}}async function ek(T,S=!1){let R=(0,N.m9)(T),O=await R.getIdToken(S),M=eD(O);en(M&&M.exp&&M.auth_time&&M.iat,R.auth,"internal-error");let L="object"==typeof M.firebase?M.firebase:void 0,U=L?.sign_in_provider;return{claims:M,token:O,authTime:eN(eP(M.auth_time)),issuedAtTime:eN(eP(M.iat)),expirationTime:eN(eP(M.exp)),signInProvider:U||null,signInSecondFactor:L?.sign_in_second_factor||null}}function eP(T){return 1e3*Number(T)}function eD(T){let[S,R,O]=T.split(".");if(void 0===S||void 0===R||void 0===O)return Y("JWT malformed, contained fewer than 3 sections"),null;try{let T=(0,N.tV)(R);if(!T)return Y("Failed to decode base64 JWT payload"),null;return JSON.parse(T)}catch(T){return Y("Caught error parsing JWT payload as JSON",T?.toString()),null}}function eM(T){let S=eD(T);return en(S,"internal-error"),en(void 0!==S.exp,"internal-error"),en(void 0!==S.iat,"internal-error"),Number(S.exp)-Number(S.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ex(T,S,R=!1){if(R)return S;try{return await S}catch(S){throw S instanceof N.ZR&&eL(S)&&T.auth.currentUser===T&&await T.auth.signOut(),S}}function eL({code:T}){return"auth/user-disabled"===T||"auth/user-token-expired"===T}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eF{constructor(T){this.user=T,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(T){if(T){let T=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),T}{this.errorBackoff=3e4;let T=this.user.stsTokenManager.expirationTime??0,S=T-Date.now()-3e5;return Math.max(0,S)}}schedule(T=!1){if(!this.isRunning)return;let S=this.getInterval(T);this.timerId=setTimeout(async()=>{await this.iteration()},S)}async iteration(){try{await this.user.getIdToken(!0)}catch(T){T?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eU{constructor(T,S){this.createdAt=T,this.lastLoginAt=S,this._initializeTime()}_initializeTime(){this.lastSignInTime=eN(this.lastLoginAt),this.creationTime=eN(this.createdAt)}_copy(T){this.createdAt=T.createdAt,this.lastLoginAt=T.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ej(T){let S=T.auth,R=await T.getIdToken(),O=await ex(T,eO(S,{idToken:R}));en(O?.users.length,S,"internal-error");let N=O.users[0];T._notifyReloadListener(N);let M=N.providerUserInfo?.length?ez(N.providerUserInfo):[],L=eV(T.providerData,M),U=T.isAnonymous,V=!(T.email&&N.passwordHash)&&!L?.length,K=!!U&&V,$={uid:N.localId,displayName:N.displayName||null,photoURL:N.photoUrl||null,email:N.email||null,emailVerified:N.emailVerified||!1,phoneNumber:N.phoneNumber||null,tenantId:N.tenantId||null,providerData:L,metadata:new eU(N.createdAt,N.lastLoginAt),isAnonymous:K};Object.assign(T,$)}async function eB(T){let S=(0,N.m9)(T);await ej(S),await S.auth._persistUserIfCurrent(S),S.auth._notifyListenersIfCurrent(S)}function eV(T,S){let R=T.filter(T=>!S.some(S=>S.providerId===T.providerId));return[...R,...S]}function ez(T){return T.map(({providerId:T,...S})=>({providerId:T,uid:S.rawId||"",displayName:S.displayName||null,email:S.email||null,phoneNumber:S.phoneNumber||null,photoURL:S.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eq(T,S){let R=await eb(T,{},async()=>{let R=(0,N.xO)({grant_type:"refresh_token",refresh_token:S}).slice(1),{tokenApiHost:O,apiKey:M}=T.config,L=await eT(T,O,"/v1/token",`key=${M}`),U=await T._getAdditionalHeaders();U["Content-Type"]="application/x-www-form-urlencoded";let V={method:"POST",headers:U,body:R};return T.emulatorConfig&&(0,N.Xx)(T.emulatorConfig.host)&&(V.credentials="include"),ef.fetch()(L,V)});return{accessToken:R.access_token,expiresIn:R.expires_in,refreshToken:R.refresh_token}}async function eH(T,S){return ev(T,"POST","/v2/accounts:revokeToken",ey(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eG{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(T){en(T.idToken,"internal-error"),en(void 0!==T.idToken,"internal-error"),en(void 0!==T.refreshToken,"internal-error");let S="expiresIn"in T&&void 0!==T.expiresIn?Number(T.expiresIn):eM(T.idToken);this.updateTokensAndExpiration(T.idToken,T.refreshToken,S)}updateFromIdToken(T){en(0!==T.length,"internal-error");let S=eM(T);this.updateTokensAndExpiration(T,null,S)}async getToken(T,S=!1){return S||!this.accessToken||this.isExpired?(en(this.refreshToken,T,"user-token-expired"),this.refreshToken)?(await this.refresh(T,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(T,S){let{accessToken:R,refreshToken:O,expiresIn:N}=await eq(T,S);this.updateTokensAndExpiration(R,O,Number(N))}updateTokensAndExpiration(T,S,R){this.refreshToken=S||null,this.accessToken=T||null,this.expirationTime=Date.now()+1e3*R}static fromJSON(T,S){let{refreshToken:R,accessToken:O,expirationTime:N}=S,M=new eG;return R&&(en("string"==typeof R,"internal-error",{appName:T}),M.refreshToken=R),O&&(en("string"==typeof O,"internal-error",{appName:T}),M.accessToken=O),N&&(en("number"==typeof N,"internal-error",{appName:T}),M.expirationTime=N),M}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(T){this.accessToken=T.accessToken,this.refreshToken=T.refreshToken,this.expirationTime=T.expirationTime}_clone(){return Object.assign(new eG,this.toJSON())}_performRefresh(){return ei("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eW(T,S){en("string"==typeof T||void 0===T,"internal-error",{appName:S})}class eK{constructor({uid:T,auth:S,stsTokenManager:R,...O}){this.providerId="firebase",this.proactiveRefresh=new eF(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=T,this.auth=S,this.stsTokenManager=R,this.accessToken=R.accessToken,this.displayName=O.displayName||null,this.email=O.email||null,this.emailVerified=O.emailVerified||!1,this.phoneNumber=O.phoneNumber||null,this.photoURL=O.photoURL||null,this.isAnonymous=O.isAnonymous||!1,this.tenantId=O.tenantId||null,this.providerData=O.providerData?[...O.providerData]:[],this.metadata=new eU(O.createdAt||void 0,O.lastLoginAt||void 0)}async getIdToken(T){let S=await ex(this,this.stsTokenManager.getToken(this.auth,T));return en(S,this.auth,"internal-error"),this.accessToken!==S&&(this.accessToken=S,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),S}getIdTokenResult(T){return ek(this,T)}reload(){return eB(this)}_assign(T){this!==T&&(en(this.uid===T.uid,this.auth,"internal-error"),this.displayName=T.displayName,this.photoURL=T.photoURL,this.email=T.email,this.emailVerified=T.emailVerified,this.phoneNumber=T.phoneNumber,this.isAnonymous=T.isAnonymous,this.tenantId=T.tenantId,this.providerData=T.providerData.map(T=>({...T})),this.metadata._copy(T.metadata),this.stsTokenManager._assign(T.stsTokenManager))}_clone(T){let S=new eK({...this,auth:T,stsTokenManager:this.stsTokenManager._clone()});return S.metadata._copy(this.metadata),S}_onReload(T){en(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=T,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(T){this.reloadListener?this.reloadListener(T):this.reloadUserInfo=T}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(T,S=!1){let R=!1;T.idToken&&T.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(T),R=!0),S&&await ej(this),await this.auth._persistUserIfCurrent(this),R&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,O.rh)(this.auth.app))return Promise.reject(et(this.auth));let T=await this.getIdToken();return await ex(this,eA(this.auth,{idToken:T})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(T=>({...T})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(T,S){let R=S.displayName??void 0,O=S.email??void 0,N=S.phoneNumber??void 0,M=S.photoURL??void 0,L=S.tenantId??void 0,U=S._redirectEventId??void 0,V=S.createdAt??void 0,K=S.lastLoginAt??void 0,{uid:$,emailVerified:Q,isAnonymous:Y,providerData:X,stsTokenManager:Z}=S;en($&&Z,T,"internal-error");let ee=eG.fromJSON(this.name,Z);en("string"==typeof $,T,"internal-error"),eW(R,T.name),eW(O,T.name),en("boolean"==typeof Q,T,"internal-error"),en("boolean"==typeof Y,T,"internal-error"),eW(N,T.name),eW(M,T.name),eW(L,T.name),eW(U,T.name),eW(V,T.name),eW(K,T.name);let et=new eK({uid:$,auth:T,email:O,emailVerified:Q,displayName:R,isAnonymous:Y,photoURL:M,phoneNumber:N,tenantId:L,stsTokenManager:ee,createdAt:V,lastLoginAt:K});return X&&Array.isArray(X)&&(et.providerData=X.map(T=>({...T}))),U&&(et._redirectEventId=U),et}static async _fromIdTokenResponse(T,S,R=!1){let O=new eG;O.updateFromServerResponse(S);let N=new eK({uid:S.localId,auth:T,stsTokenManager:O,isAnonymous:R});return await ej(N),N}static async _fromGetAccountInfoResponse(T,S,R){let O=S.users[0];en(void 0!==O.localId,"internal-error");let N=void 0!==O.providerUserInfo?ez(O.providerUserInfo):[],M=!(O.email&&O.passwordHash)&&!N?.length,L=new eG;L.updateFromIdToken(R);let U=new eK({uid:O.localId,auth:T,stsTokenManager:L,isAnonymous:M}),V={uid:O.localId,displayName:O.displayName||null,photoURL:O.photoUrl||null,email:O.email||null,emailVerified:O.emailVerified||!1,phoneNumber:O.phoneNumber||null,tenantId:O.tenantId||null,providerData:N,metadata:new eU(O.createdAt,O.lastLoginAt),isAnonymous:!(O.email&&O.passwordHash)&&!N?.length};return Object.assign(U,V),U}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e$=new Map;function eQ(T){es(T instanceof Function,"Expected a class definition");let S=e$.get(T);return S?es(S instanceof T,"Instance stored in cache mismatched with class"):(S=new T,e$.set(T,S)),S}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eY{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(T,S){this.storage[T]=S}async _get(T){let S=this.storage[T];return void 0===S?null:S}async _remove(T){delete this.storage[T]}_addListener(T,S){}_removeListener(T,S){}}eY.type="NONE";let eJ=eY;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eX(T,S,R){return`firebase:${T}:${S}:${R}`}class eZ{constructor(T,S,R){this.persistence=T,this.auth=S,this.userKey=R;let{config:O,name:N}=this.auth;this.fullUserKey=eX(this.userKey,O.apiKey,N),this.fullPersistenceKey=eX("persistence",O.apiKey,N),this.boundEventHandler=S._onStorageEvent.bind(S),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(T){return this.persistence._set(this.fullUserKey,T.toJSON())}async getCurrentUser(){let T=await this.persistence._get(this.fullUserKey);if(!T)return null;if("string"==typeof T){let S=await eO(this.auth,{idToken:T}).catch(()=>void 0);return S?eK._fromGetAccountInfoResponse(this.auth,S,T):null}return eK._fromJSON(this.auth,T)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(T){if(this.persistence===T)return;let S=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=T,S)return this.setCurrentUser(S)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(T,S,R="authUser"){if(!S.length)return new eZ(eQ(eJ),T,R);let O=(await Promise.all(S.map(async T=>{if(await T._isAvailable())return T}))).filter(T=>T),N=O[0]||eQ(eJ),M=eX(R,T.config.apiKey,T.name),L=null;for(let R of S)try{let S=await R._get(M);if(S){let O;if("string"==typeof S){let R=await eO(T,{idToken:S}).catch(()=>void 0);if(!R)break;O=await eK._fromGetAccountInfoResponse(T,R,S)}else O=eK._fromJSON(T,S);R!==N&&(L=O),N=R;break}}catch{}let U=O.filter(T=>T._shouldAllowMigration);return N._shouldAllowMigration&&U.length&&(N=U[0],L&&await N._set(M,L.toJSON()),await Promise.all(S.map(async T=>{if(T!==N)try{await T._remove(M)}catch{}}))),new eZ(N,T,R)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e0(T){let S=T.toLowerCase();if(S.includes("opera/")||S.includes("opr/")||S.includes("opios/"))return"Opera";if(e4(S))return"IEMobile";if(S.includes("msie")||S.includes("trident/"))return"IE";{if(S.includes("edge/"))return"Edge";if(e1(S))return"Firefox";if(S.includes("silk/"))return"Silk";if(e9(S))return"Blackberry";if(e5(S))return"Webos";if(e2(S))return"Safari";if((S.includes("chrome/")||e3(S))&&!S.includes("edge/"))return"Chrome";if(e6(S))return"Android";let R=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,O=T.match(R);if(O?.length===2)return O[1]}return"Other"}function e1(T=(0,N.z$)()){return/firefox\//i.test(T)}function e2(T=(0,N.z$)()){let S=T.toLowerCase();return S.includes("safari/")&&!S.includes("chrome/")&&!S.includes("crios/")&&!S.includes("android")}function e3(T=(0,N.z$)()){return/crios\//i.test(T)}function e4(T=(0,N.z$)()){return/iemobile/i.test(T)}function e6(T=(0,N.z$)()){return/android/i.test(T)}function e9(T=(0,N.z$)()){return/blackberry/i.test(T)}function e5(T=(0,N.z$)()){return/webos/i.test(T)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e8(T,S=[]){let R;switch(T){case"Browser":R=e0((0,N.z$)());break;case"Worker":R=`${e0((0,N.z$)())}-${T}`;break;default:R=T}let M=S.length?S.join(","):"FirebaseCore-web";return`${R}/JsCore/${O.Jn}/${M}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e7{constructor(T){this.auth=T,this.queue=[]}pushCallback(T,S){let R=S=>new Promise((R,O)=>{try{let O=T(S);R(O)}catch(T){O(T)}});R.onAbort=S,this.queue.push(R);let O=this.queue.length-1;return()=>{this.queue[O]=()=>Promise.resolve()}}async runMiddleware(T){if(this.auth.currentUser===T)return;let S=[];try{for(let R of this.queue)await R(T),R.onAbort&&S.push(R.onAbort)}catch(T){for(let T of(S.reverse(),S))try{T()}catch(T){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:T?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function te(T,S={}){return ev(T,"GET","/v2/passwordPolicy",ey(T,S))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tt=6;class tr{constructor(T){let S=T.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=S.minPasswordLength??tt,S.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=S.maxPasswordLength),void 0!==S.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=S.containsLowercaseCharacter),void 0!==S.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=S.containsUppercaseCharacter),void 0!==S.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=S.containsNumericCharacter),void 0!==S.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=S.containsNonAlphanumericCharacter),this.enforcementState=T.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=T.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=T.forceUpgradeOnSignin??!1,this.schemaVersion=T.schemaVersion}validatePassword(T){let S={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(T,S),this.validatePasswordCharacterOptions(T,S),S.isValid&&(S.isValid=S.meetsMinPasswordLength??!0),S.isValid&&(S.isValid=S.meetsMaxPasswordLength??!0),S.isValid&&(S.isValid=S.containsLowercaseLetter??!0),S.isValid&&(S.isValid=S.containsUppercaseLetter??!0),S.isValid&&(S.isValid=S.containsNumericCharacter??!0),S.isValid&&(S.isValid=S.containsNonAlphanumericCharacter??!0),S}validatePasswordLengthOptions(T,S){let R=this.customStrengthOptions.minPasswordLength,O=this.customStrengthOptions.maxPasswordLength;R&&(S.meetsMinPasswordLength=T.length>=R),O&&(S.meetsMaxPasswordLength=T.length<=O)}validatePasswordCharacterOptions(T,S){let R;this.updatePasswordCharacterOptionsStatuses(S,!1,!1,!1,!1);for(let O=0;O<T.length;O++)R=T.charAt(O),this.updatePasswordCharacterOptionsStatuses(S,R>="a"&&R<="z",R>="A"&&R<="Z",R>="0"&&R<="9",this.allowedNonAlphanumericCharacters.includes(R))}updatePasswordCharacterOptionsStatuses(T,S,R,O,N){this.customStrengthOptions.containsLowercaseLetter&&(T.containsLowercaseLetter||(T.containsLowercaseLetter=S)),this.customStrengthOptions.containsUppercaseLetter&&(T.containsUppercaseLetter||(T.containsUppercaseLetter=R)),this.customStrengthOptions.containsNumericCharacter&&(T.containsNumericCharacter||(T.containsNumericCharacter=O)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(T.containsNonAlphanumericCharacter||(T.containsNonAlphanumericCharacter=N))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(T,S,R,O){this.app=T,this.heartbeatServiceProvider=S,this.appCheckServiceProvider=R,this.config=O,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ta(this),this.idTokenSubscription=new ta(this),this.beforeStateQueue=new e7(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=K,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=T.name,this.clientVersion=O.sdkClientVersion,this._persistenceManagerAvailable=new Promise(T=>this._resolvePersistenceManagerAvailable=T)}_initializeWithPersistence(T,S){return S&&(this._popupRedirectResolver=eQ(S)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await eZ.create(this,T),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(T){}await this.initializeCurrentUser(S),this.lastNotifiedUid=this.currentUser?.uid||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let T=await this.assertedPersistence.getCurrentUser();if(this.currentUser||T){if(this.currentUser&&T&&this.currentUser.uid===T.uid){this._currentUser._assign(T),await this.currentUser.getIdToken();return}await this._updateCurrentUser(T,!0)}}async initializeCurrentUserFromIdToken(T){try{let S=await eO(this,{idToken:T}),R=await eK._fromGetAccountInfoResponse(this,S,T);await this.directlySetCurrentUser(R)}catch(T){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",T),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(T){if((0,O.rh)(this.app)){let T=this.app.settings.authIdToken;return T?new Promise(S=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(T).then(S,S))}):this.directlySetCurrentUser(null)}let S=await this.assertedPersistence.getCurrentUser(),R=S,N=!1;if(T&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let S=this.redirectUser?._redirectEventId,O=R?._redirectEventId,M=await this.tryRedirectSignIn(T);(!S||S===O)&&M?.user&&(R=M.user,N=!0)}if(!R)return this.directlySetCurrentUser(null);if(!R._redirectEventId){if(N)try{await this.beforeStateQueue.runMiddleware(R)}catch(T){R=S,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(T))}return R?this.reloadAndSetCurrentUserOrClear(R):this.directlySetCurrentUser(null)}return(en(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===R._redirectEventId)?this.directlySetCurrentUser(R):this.reloadAndSetCurrentUserOrClear(R)}async tryRedirectSignIn(T){let S=null;try{S=await this._popupRedirectResolver._completeRedirectFn(this,T,!0)}catch(T){await this._setRedirectUser(null)}return S}async reloadAndSetCurrentUserOrClear(T){try{await ej(T)}catch(T){if(T?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(T)}useDeviceLanguage(){this.languageCode=ec()}async _delete(){this._deleted=!0}async updateCurrentUser(T){if((0,O.rh)(this.app))return Promise.reject(et(this));let S=T?(0,N.m9)(T):null;return S&&en(S.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(S&&S._clone(this))}async _updateCurrentUser(T,S=!1){if(!this._deleted)return T&&en(this.tenantId===T.tenantId,this,"tenant-id-mismatch"),S||await this.beforeStateQueue.runMiddleware(T),this.queue(async()=>{await this.directlySetCurrentUser(T),this.notifyAuthListeners()})}async signOut(){return(0,O.rh)(this.app)?Promise.reject(et(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(T){return(0,O.rh)(this.app)?Promise.reject(et(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(eQ(T))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(T){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let S=this._getPasswordPolicyInternal();return S.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):S.validatePassword(T)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let T=await te(this),S=new tr(T);null===this.tenantId?this._projectPasswordPolicy=S:this._tenantPasswordPolicies[this.tenantId]=S}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(T){this._errorFactory=new N.LL("auth","Firebase",T())}onAuthStateChanged(T,S,R){return this.registerStateListener(this.authStateSubscription,T,S,R)}beforeAuthStateChanged(T,S){return this.beforeStateQueue.pushCallback(T,S)}onIdTokenChanged(T,S,R){return this.registerStateListener(this.idTokenSubscription,T,S,R)}authStateReady(){return new Promise((T,S)=>{if(this.currentUser)T();else{let R=this.onAuthStateChanged(()=>{R(),T()},S)}})}async revokeAccessToken(T){if(this.currentUser){let S=await this.currentUser.getIdToken(),R={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:T,idToken:S};null!=this.tenantId&&(R.tenantId=this.tenantId),await eH(this,R)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(T,S){let R=await this.getOrInitRedirectPersistenceManager(S);return null===T?R.removeCurrentUser():R.setCurrentUser(T)}async getOrInitRedirectPersistenceManager(T){if(!this.redirectPersistenceManager){let S=T&&eQ(T)||this._popupRedirectResolver;en(S,this,"argument-error"),this.redirectPersistenceManager=await eZ.create(this,[eQ(S._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(T){return(this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===T)?this._currentUser:this.redirectUser?._redirectEventId===T?this.redirectUser:null}async _persistUserIfCurrent(T){if(T===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(T))}_notifyListenersIfCurrent(T){T===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let T=this.currentUser?.uid??null;this.lastNotifiedUid!==T&&(this.lastNotifiedUid=T,this.authStateSubscription.next(this.currentUser))}registerStateListener(T,S,R,O){if(this._deleted)return()=>{};let N="function"==typeof S?S:S.next.bind(S),M=!1,L=this._isInitialized?Promise.resolve():this._initializationPromise;if(en(L,this,"internal-error"),L.then(()=>{M||N(this.currentUser)}),"function"==typeof S){let N=T.addObserver(S,R,O);return()=>{M=!0,N()}}{let R=T.addObserver(S);return()=>{M=!0,R()}}}async directlySetCurrentUser(T){this.currentUser&&this.currentUser!==T&&this._currentUser._stopProactiveRefresh(),T&&this.isProactiveRefreshEnabled&&T._startProactiveRefresh(),this.currentUser=T,T?await this.assertedPersistence.setCurrentUser(T):await this.assertedPersistence.removeCurrentUser()}queue(T){return this.operations=this.operations.then(T,T),this.operations}get assertedPersistence(){return en(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(T){!T||this.frameworks.includes(T)||(this.frameworks.push(T),this.frameworks.sort(),this.clientVersion=e8(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let T={"X-Client-Version":this.clientVersion};this.app.options.appId&&(T["X-Firebase-gmpid"]=this.app.options.appId);let S=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();S&&(T["X-Firebase-Client"]=S);let R=await this._getAppCheckToken();return R&&(T["X-Firebase-AppCheck"]=R),T}async _getAppCheckToken(){if((0,O.rh)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let T=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return T?.error&&Q(`Error while retrieving App Check token: ${T.error}`),T?.token}}function ts(T){return(0,N.m9)(T)}class ta{constructor(T){this.auth=T,this.observer=null,this.addObserver=(0,N.ne)(T=>this.observer=T)}get next(){return en(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tl={async loadJS(){throw Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function tu(T){return tl.loadJS(T)}function tc(){return tl.recaptchaEnterpriseScript}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(){this.enterprise=new th}ready(T){T()}execute(T,S){return Promise.resolve("token")}render(T,S){return""}}class th{ready(T){T()}execute(T,S){return Promise.resolve("token")}render(T,S){return""}}let tf="recaptcha-enterprise",tp="NO_RECAPTCHA";class tm{constructor(T){this.type=tf,this.auth=ts(T)}async verify(T="verify",S=!1){async function R(T){if(!S){if(null==T.tenantId&&null!=T._agentRecaptchaConfig)return T._agentRecaptchaConfig.siteKey;if(null!=T.tenantId&&void 0!==T._tenantRecaptchaConfigs[T.tenantId])return T._tenantRecaptchaConfigs[T.tenantId].siteKey}return new Promise(async(S,R)=>{eR(T,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(O=>{if(void 0===O.recaptchaKey)R(Error("recaptcha Enterprise site key undefined"));else{let R=new eI(O);return null==T.tenantId?T._agentRecaptchaConfig=R:T._tenantRecaptchaConfigs[T.tenantId]=R,S(R.siteKey)}}).catch(T=>{R(T)})})}function O(S,R,O){let N=window.grecaptcha;eC(N)?N.enterprise.ready(()=>{N.enterprise.execute(S,{action:T}).then(T=>{R(T)}).catch(()=>{R(tp)})}):O(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){let T=new td;return T.execute("siteKey",{action:"verify"})}return new Promise((T,N)=>{R(this.auth).then(R=>{if(!S&&eC(window.grecaptcha))O(R,T,N);else{if("undefined"==typeof window){N(Error("RecaptchaVerifier is only supported in browser"));return}let S=tc();0!==S.length&&(S+=R),tu(S).then(()=>{O(R,T,N)}).catch(T=>{N(T)})}}).catch(T=>{N(T)})})}}async function tg(T,S,R,O=!1,N=!1){let M;let L=new tm(T);if(N)M=tp;else try{M=await L.verify(R)}catch(T){M=await L.verify(R,!0)}let U={...S};if("mfaSmsEnrollment"===R||"mfaSmsSignIn"===R){if("phoneEnrollmentInfo"in U){let T=U.phoneEnrollmentInfo.phoneNumber,S=U.phoneEnrollmentInfo.recaptchaToken;Object.assign(U,{phoneEnrollmentInfo:{phoneNumber:T,recaptchaToken:S,captchaResponse:M,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in U){let T=U.phoneSignInInfo.recaptchaToken;Object.assign(U,{phoneSignInInfo:{recaptchaToken:T,captchaResponse:M,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return U}return O?Object.assign(U,{captchaResp:M}):Object.assign(U,{captchaResponse:M}),Object.assign(U,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(U,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),U}async function ty(T,S,R,O,N){if("EMAIL_PASSWORD_PROVIDER"===N){if(!T._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER"))return O(T,S).catch(async N=>{if("auth/missing-recaptcha-token"!==N.code)return Promise.reject(N);{console.log(`${R} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let N=await tg(T,S,R,"getOobCode"===R);return O(T,N)}});{let N=await tg(T,S,R,"getOobCode"===R);return O(T,N)}}if("PHONE_PROVIDER"!==N)return Promise.reject(N+" provider is not supported.");if(T._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){let N=await tg(T,S,R);return O(T,N).catch(async N=>{if(T._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&("auth/missing-recaptcha-token"===N.code||"auth/invalid-app-credential"===N.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${R} flow.`);let N=await tg(T,S,R,!1,!0);return O(T,N)}return Promise.reject(N)})}{let N=await tg(T,S,R,!1,!0);return O(T,N)}}function tv(T,S){let R=S?.persistence||[],O=(Array.isArray(R)?R:[R]).map(eQ);S?.errorMap&&T._updateErrorMap(S.errorMap),T._initializeWithPersistence(O,S?.popupRedirectResolver)}function tb(T){let S=T.indexOf(":");return S<0?"":T.substr(0,S+1)}function t_(T){if(!T)return null;let S=Number(T);return isNaN(S)?null:S}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT{constructor(T,S){this.providerId=T,this.signInMethod=S}toJSON(){return ei("not implemented")}_getIdTokenResponse(T){return ei("not implemented")}_linkToIdToken(T,S){return ei("not implemented")}_getReauthenticationResolver(T){return ei("not implemented")}}async function tS(T,S){return ev(T,"POST","/v1/accounts:signUp",S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tE(T,S){return e_(T,"POST","/v1/accounts:signInWithPassword",ey(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tw(T,S){return e_(T,"POST","/v1/accounts:signInWithEmailLink",ey(T,S))}async function tC(T,S){return e_(T,"POST","/v1/accounts:signInWithEmailLink",ey(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI extends tT{constructor(T,S,R,O=null){super("password",R),this._email=T,this._password=S,this._tenantId=O}static _fromEmailAndPassword(T,S){return new tI(T,S,"password")}static _fromEmailAndCode(T,S,R=null){return new tI(T,S,"emailLink",R)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(T){let S="string"==typeof T?JSON.parse(T):T;if(S?.email&&S?.password){if("password"===S.signInMethod)return this._fromEmailAndPassword(S.email,S.password);if("emailLink"===S.signInMethod)return this._fromEmailAndCode(S.email,S.password,S.tenantId)}return null}async _getIdTokenResponse(T){switch(this.signInMethod){case"password":let S={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ty(T,S,"signInWithPassword",tE,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return tw(T,{email:this._email,oobCode:this._password});default:X(T,"internal-error")}}async _linkToIdToken(T,S){switch(this.signInMethod){case"password":let R={idToken:S,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ty(T,R,"signUpPassword",tS,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return tC(T,{idToken:S,email:this._email,oobCode:this._password});default:X(T,"internal-error")}}_getReauthenticationResolver(T){return this._getIdTokenResponse(T)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tR(T,S){return e_(T,"POST","/v1/accounts:signInWithIdp",ey(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tA="http://localhost";class tO extends tT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(T){let S=new tO(T.providerId,T.signInMethod);return T.idToken||T.accessToken?(T.idToken&&(S.idToken=T.idToken),T.accessToken&&(S.accessToken=T.accessToken),T.nonce&&!T.pendingToken&&(S.nonce=T.nonce),T.pendingToken&&(S.pendingToken=T.pendingToken)):T.oauthToken&&T.oauthTokenSecret?(S.accessToken=T.oauthToken,S.secret=T.oauthTokenSecret):X("argument-error"),S}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(T){let S="string"==typeof T?JSON.parse(T):T,{providerId:R,signInMethod:O,...N}=S;if(!R||!O)return null;let M=new tO(R,O);return M.idToken=N.idToken||void 0,M.accessToken=N.accessToken||void 0,M.secret=N.secret,M.nonce=N.nonce,M.pendingToken=N.pendingToken||null,M}_getIdTokenResponse(T){let S=this.buildRequest();return tR(T,S)}_linkToIdToken(T,S){let R=this.buildRequest();return R.idToken=S,tR(T,R)}_getReauthenticationResolver(T){let S=this.buildRequest();return S.autoCreate=!1,tR(T,S)}buildRequest(){let T={requestUri:tA,returnSecureToken:!0};if(this.pendingToken)T.pendingToken=this.pendingToken;else{let S={};this.idToken&&(S.id_token=this.idToken),this.accessToken&&(S.access_token=this.accessToken),this.secret&&(S.oauth_token_secret=this.secret),S.providerId=this.providerId,this.nonce&&!this.pendingToken&&(S.nonce=this.nonce),T.postBody=(0,N.xO)(S)}return T}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tN(T){switch(T){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function tk(T){let S=(0,N.zd)((0,N.pd)(T)).link,R=S?(0,N.zd)((0,N.pd)(S)).deep_link_id:null,O=(0,N.zd)((0,N.pd)(T)).deep_link_id,M=O?(0,N.zd)((0,N.pd)(O)).link:null;return M||O||R||S||T}class tP{constructor(T){let S=(0,N.zd)((0,N.pd)(T)),R=S.apiKey??null,O=S.oobCode??null,M=tN(S.mode??null);en(R&&O&&M,"argument-error"),this.apiKey=R,this.operation=M,this.code=O,this.continueUrl=S.continueUrl??null,this.languageCode=S.lang??null,this.tenantId=S.tenantId??null}static parseLink(T){let S=tk(T);try{return new tP(S)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD{constructor(){this.providerId=tD.PROVIDER_ID}static credential(T,S){return tI._fromEmailAndPassword(T,S)}static credentialWithLink(T,S){let R=tP.parseLink(S);return en(R,"argument-error"),tI._fromEmailAndCode(T,R.code,R.tenantId)}}tD.PROVIDER_ID="password",tD.EMAIL_PASSWORD_SIGN_IN_METHOD="password",tD.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tM{constructor(T){this.providerId=T,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(T){this.defaultLanguageCode=T}setCustomParameters(T){return this.customParameters=T,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL extends tM{constructor(){super(...arguments),this.scopes=[]}addScope(T){return this.scopes.includes(T)||this.scopes.push(T),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tF extends tL{constructor(){super("facebook.com")}static credential(T){return tO._fromParams({providerId:tF.PROVIDER_ID,signInMethod:tF.FACEBOOK_SIGN_IN_METHOD,accessToken:T})}static credentialFromResult(T){return tF.credentialFromTaggedObject(T)}static credentialFromError(T){return tF.credentialFromTaggedObject(T.customData||{})}static credentialFromTaggedObject({_tokenResponse:T}){if(!T||!("oauthAccessToken"in T)||!T.oauthAccessToken)return null;try{return tF.credential(T.oauthAccessToken)}catch{return null}}}tF.FACEBOOK_SIGN_IN_METHOD="facebook.com",tF.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tU extends tL{constructor(){super("google.com"),this.addScope("profile")}static credential(T,S){return tO._fromParams({providerId:tU.PROVIDER_ID,signInMethod:tU.GOOGLE_SIGN_IN_METHOD,idToken:T,accessToken:S})}static credentialFromResult(T){return tU.credentialFromTaggedObject(T)}static credentialFromError(T){return tU.credentialFromTaggedObject(T.customData||{})}static credentialFromTaggedObject({_tokenResponse:T}){if(!T)return null;let{oauthIdToken:S,oauthAccessToken:R}=T;if(!S&&!R)return null;try{return tU.credential(S,R)}catch{return null}}}tU.GOOGLE_SIGN_IN_METHOD="google.com",tU.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tj extends tL{constructor(){super("github.com")}static credential(T){return tO._fromParams({providerId:tj.PROVIDER_ID,signInMethod:tj.GITHUB_SIGN_IN_METHOD,accessToken:T})}static credentialFromResult(T){return tj.credentialFromTaggedObject(T)}static credentialFromError(T){return tj.credentialFromTaggedObject(T.customData||{})}static credentialFromTaggedObject({_tokenResponse:T}){if(!T||!("oauthAccessToken"in T)||!T.oauthAccessToken)return null;try{return tj.credential(T.oauthAccessToken)}catch{return null}}}tj.GITHUB_SIGN_IN_METHOD="github.com",tj.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tB extends tL{constructor(){super("twitter.com")}static credential(T,S){return tO._fromParams({providerId:tB.PROVIDER_ID,signInMethod:tB.TWITTER_SIGN_IN_METHOD,oauthToken:T,oauthTokenSecret:S})}static credentialFromResult(T){return tB.credentialFromTaggedObject(T)}static credentialFromError(T){return tB.credentialFromTaggedObject(T.customData||{})}static credentialFromTaggedObject({_tokenResponse:T}){if(!T)return null;let{oauthAccessToken:S,oauthTokenSecret:R}=T;if(!S||!R)return null;try{return tB.credential(S,R)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tV(T,S){return e_(T,"POST","/v1/accounts:signUp",ey(T,S))}tB.TWITTER_SIGN_IN_METHOD="twitter.com",tB.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tz{constructor(T){this.user=T.user,this.providerId=T.providerId,this._tokenResponse=T._tokenResponse,this.operationType=T.operationType}static async _fromIdTokenResponse(T,S,R,O=!1){let N=await eK._fromIdTokenResponse(T,R,O),M=tq(R),L=new tz({user:N,providerId:M,_tokenResponse:R,operationType:S});return L}static async _forOperation(T,S,R){await T._updateTokensIfNecessary(R,!0);let O=tq(R);return new tz({user:T,providerId:O,_tokenResponse:R,operationType:S})}}function tq(T){return T.providerId?T.providerId:"phoneNumber"in T?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tH extends N.ZR{constructor(T,S,R,O){super(S.code,S.message),this.operationType=R,this.user=O,Object.setPrototypeOf(this,tH.prototype),this.customData={appName:T.name,tenantId:T.tenantId??void 0,_serverResponse:S.customData._serverResponse,operationType:R}}static _fromErrorAndOperation(T,S,R,O){return new tH(T,S,R,O)}}function tG(T,S,R,O){let N="reauthenticate"===S?R._getReauthenticationResolver(T):R._getIdTokenResponse(T);return N.catch(R=>{if("auth/multi-factor-auth-required"===R.code)throw tH._fromErrorAndOperation(T,R,S,O);throw R})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tW(T,S,R=!1){if((0,O.rh)(T.app))return Promise.reject(et(T));let N="signIn",M=await tG(T,N,S),L=await tz._fromIdTokenResponse(T,N,M);return R||await T._updateCurrentUser(L.user),L}async function tK(T,S){return tW(ts(T),S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t${constructor(T,S){this.factorId=T,this.uid=S.mfaEnrollmentId,this.enrollmentTime=new Date(S.enrolledAt).toUTCString(),this.displayName=S.displayName}static _fromServerResponse(T,S){return"phoneInfo"in S?tQ._fromServerResponse(T,S):"totpInfo"in S?tY._fromServerResponse(T,S):X(T,"internal-error")}}class tQ extends null{constructor(T){super("phone",T),this.phoneNumber=T.phoneInfo}static _fromServerResponse(T,S){return new tQ(S)}}class tY extends null{constructor(T){super("totp",T)}static _fromServerResponse(T,S){return new tY(S)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tJ(T){let S=ts(T);S._getPasswordPolicyInternal()&&await S._updatePasswordPolicy()}async function tX(T,S,R){if((0,O.rh)(T.app))return Promise.reject(et(T));let N=ts(T),M={returnSecureToken:!0,email:S,password:R,clientType:"CLIENT_TYPE_WEB"},L=ty(N,M,"signUpPassword",tV,"EMAIL_PASSWORD_PROVIDER"),U=await L.catch(S=>{throw"auth/password-does-not-meet-requirements"===S.code&&tJ(T),S}),V=await tz._fromIdTokenResponse(N,"signIn",U);return await N._updateCurrentUser(V.user),V}function tZ(T,S,R){return(0,O.rh)(T.app)?Promise.reject(et(T)):tK((0,N.m9)(T),tD.credential(S,R)).catch(async S=>{throw"auth/password-does-not-meet-requirements"===S.code&&tJ(T),S})}function t0(T){return(0,N.m9)(T).signOut()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1{constructor(T,S,R){this.type=T,this.credential=S,this.user=R}static _fromIdtoken(T,S){return new t1("enroll",T,S)}static _fromMfaPendingCredential(T){return new t1("signin",T)}toJSON(){let T="enroll"===this.type?"idToken":"pendingCredential";return{multiFactorSession:{[T]:this.credential}}}static fromJSON(T){if(T?.multiFactorSession){if(T.multiFactorSession?.pendingCredential)return t1._fromMfaPendingCredential(T.multiFactorSession.pendingCredential);if(T.multiFactorSession?.idToken)return t1._fromIdtoken(T.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t2{constructor(T,S,R){this.session=T,this.hints=S,this.signInResolver=R}static _fromError(T,S){let R=ts(T),O=S.customData._serverResponse,N=(O.mfaInfo||[]).map(T=>t$._fromServerResponse(R,T));en(O.mfaPendingCredential,R,"internal-error");let M=t1._fromMfaPendingCredential(O.mfaPendingCredential);return new t2(M,N,async T=>{let N=await T._process(R,M);delete O.mfaInfo,delete O.mfaPendingCredential;let L={...O,idToken:N.idToken,refreshToken:N.refreshToken};switch(S.operationType){case"signIn":let U=await tz._fromIdTokenResponse(R,S.operationType,L);return await R._updateCurrentUser(U.user),U;case"reauthenticate":return en(S.user,R,"internal-error"),tz._forOperation(S.user,S.operationType,L);default:X(R,"internal-error")}})}async resolveSignIn(T){let S=T;return this.signInResolver(S)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t3(T,S){return ev(T,"POST","/v2/accounts/mfaEnrollment:start",ey(T,S))}function t4(T,S){return ev(T,"POST","/v2/accounts/mfaEnrollment:finalize",ey(T,S))}function t6(T,S){return ev(T,"POST","/v2/accounts/mfaEnrollment:withdraw",ey(T,S))}class t9{constructor(T){this.user=T,this.enrolledFactors=[],T._onReload(S=>{S.mfaInfo&&(this.enrolledFactors=S.mfaInfo.map(S=>t$._fromServerResponse(T.auth,S)))})}static _fromUser(T){return new t9(T)}async getSession(){return t1._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(T,S){let R=T,O=await this.getSession(),N=await ex(this.user,R._process(this.user.auth,O,S));return await this.user._updateTokensIfNecessary(N),this.user.reload()}async unenroll(T){let S="string"==typeof T?T:T.uid,R=await this.user.getIdToken();try{let T=await ex(this.user,t6(this.user.auth,{idToken:R,mfaEnrollmentId:S}));this.enrolledFactors=this.enrolledFactors.filter(({uid:T})=>T!==S),await this.user._updateTokensIfNecessary(T),await this.user.reload()}catch(T){throw T}}}new WeakMap;var t5="@firebase/auth",t8="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t7{constructor(T){this.auth=T,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(T){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;let S=await this.auth.currentUser.getIdToken(T);return{accessToken:S}}addAuthTokenListener(T){if(this.assertAuthConfigured(),this.internalListeners.has(T))return;let S=this.auth.onIdTokenChanged(S=>{T(S?.stsTokenManager.accessToken||null)});this.internalListeners.set(T,S),this.updateProactiveRefresh()}removeAuthTokenListener(T){this.assertAuthConfigured();let S=this.internalListeners.get(T);S&&(this.internalListeners.delete(T),S(),this.updateProactiveRefresh())}assertAuthConfigured(){en(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rt(T){switch(T){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function rr(T){(0,O.Xd)(new M.wA("auth",(S,{options:R})=>{let O=S.getProvider("app").getImmediate(),N=S.getProvider("heartbeat"),M=S.getProvider("app-check-internal"),{apiKey:L,authDomain:U}=O.options;en(L&&!L.includes(":"),"invalid-api-key",{appName:O.name});let V={apiKey:L,authDomain:U,clientPlatform:T,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:e8(T)},K=new ti(O,N,M,V);return tv(K,R),K},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((T,S,R)=>{let O=T.getProvider("auth-internal");O.initialize()})),(0,O.Xd)(new M.wA("auth-internal",T=>{var S;let R=ts(T.getProvider("auth").getImmediate());return S=R,new t7(S)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,O.KN)(t5,t8,rt(T)),(0,O.KN)(t5,t8,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ef.initialize(fetch,Headers,Response),rr("Node");let rn=Z("operation-not-supported-in-this-environment");async function ri(){throw rn}let rs=ri;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ra(T,S){return ev(T,"POST","/v2/accounts/mfaSignIn:finalize",ey(T,S))}ti.prototype.setPersistence=async()=>{};class ro{constructor(T){this.factorId=T}_process(T,S,R){switch(S.type){case"enroll":return this._finalizeEnroll(T,S.credential,R);case"signin":return this._finalizeSignIn(T,S.credential);default:return ei("unexpected MultiFactorSessionType")}}}class rl{static assertionForEnrollment(T,S){return ru._fromSecret(T,S)}static assertionForSignIn(T,S){return ru._fromEnrollmentId(T,S)}static async generateSecret(T){let S=T;en(void 0!==S.user?.auth,"internal-error");let R=await t3(S.user.auth,{idToken:S.credential,totpEnrollmentInfo:{}});return rc._fromStartTotpMfaEnrollmentResponse(R,S.user.auth)}}rl.FACTOR_ID="totp";class ru extends ro{constructor(T,S,R){super("totp"),this.otp=T,this.enrollmentId=S,this.secret=R}static _fromSecret(T,S){return new ru(S,void 0,T)}static _fromEnrollmentId(T,S){return new ru(S,T)}async _finalizeEnroll(T,S,R){return en(void 0!==this.secret,T,"argument-error"),t4(T,{idToken:S,displayName:R,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(T,S){en(void 0!==this.enrollmentId&&void 0!==this.otp,T,"argument-error");let R={verificationCode:this.otp};return ra(T,{mfaPendingCredential:S,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:R})}}class rc{constructor(T,S,R,O,N,M,L){this.sessionInfo=M,this.auth=L,this.secretKey=T,this.hashingAlgorithm=S,this.codeLength=R,this.codeIntervalSeconds=O,this.enrollmentCompletionDeadline=N}static _fromStartTotpMfaEnrollmentResponse(T,S){return new rc(T.totpSessionInfo.sharedSecretKey,T.totpSessionInfo.hashingAlgorithm,T.totpSessionInfo.verificationCodeLength,T.totpSessionInfo.periodSec,new Date(T.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),T.totpSessionInfo.sessionInfo,S)}_makeTotpVerificationInfo(T){return{sessionInfo:this.sessionInfo,verificationCode:T}}generateQrCodeUrl(T,S){let R=!1;return(rd(T)||rd(S))&&(R=!0),R&&(rd(T)&&(T=this.auth.currentUser?.email||"unknownuser"),rd(S)&&(S=this.auth.name)),`otpauth://totp/${S}:${T}?secret=${this.secretKey}&issuer=${S}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function rd(T){return void 0===T||T?.length===0}},9904:(T,S,R)=>{"use strict";var O,N,M,L,U=R(2339),V=R(5880),K=R(9824),$=R(3837),Q=R(4738),Y="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},X={};(function(){function T(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function S(T,S,R){R||(R=0);var O=Array(16);if("string"==typeof S)for(var N=0;16>N;++N)O[N]=S.charCodeAt(R++)|S.charCodeAt(R++)<<8|S.charCodeAt(R++)<<16|S.charCodeAt(R++)<<24;else for(N=0;16>N;++N)O[N]=S[R++]|S[R++]<<8|S[R++]<<16|S[R++]<<24;S=T.g[0],R=T.g[1],N=T.g[2];var M=T.g[3],L=S+(M^R&(N^M))+O[0]+3614090360&4294967295;L=M+(N^(S=R+(L<<7&4294967295|L>>>25))&(R^N))+O[1]+3905402710&4294967295,L=N+(R^(M=S+(L<<12&4294967295|L>>>20))&(S^R))+O[2]+606105819&4294967295,L=R+(S^(N=M+(L<<17&4294967295|L>>>15))&(M^S))+O[3]+3250441966&4294967295,L=S+(M^(R=N+(L<<22&4294967295|L>>>10))&(N^M))+O[4]+4118548399&4294967295,L=M+(N^(S=R+(L<<7&4294967295|L>>>25))&(R^N))+O[5]+1200080426&4294967295,L=N+(R^(M=S+(L<<12&4294967295|L>>>20))&(S^R))+O[6]+2821735955&4294967295,L=R+(S^(N=M+(L<<17&4294967295|L>>>15))&(M^S))+O[7]+4249261313&4294967295,L=S+(M^(R=N+(L<<22&4294967295|L>>>10))&(N^M))+O[8]+1770035416&4294967295,L=M+(N^(S=R+(L<<7&4294967295|L>>>25))&(R^N))+O[9]+2336552879&4294967295,L=N+(R^(M=S+(L<<12&4294967295|L>>>20))&(S^R))+O[10]+4294925233&4294967295,L=R+(S^(N=M+(L<<17&4294967295|L>>>15))&(M^S))+O[11]+2304563134&4294967295,L=S+(M^(R=N+(L<<22&4294967295|L>>>10))&(N^M))+O[12]+1804603682&4294967295,L=M+(N^(S=R+(L<<7&4294967295|L>>>25))&(R^N))+O[13]+4254626195&4294967295,L=N+(R^(M=S+(L<<12&4294967295|L>>>20))&(S^R))+O[14]+2792965006&4294967295,L=R+(S^(N=M+(L<<17&4294967295|L>>>15))&(M^S))+O[15]+1236535329&4294967295,R=N+(L<<22&4294967295|L>>>10),L=S+(N^M&(R^N))+O[1]+4129170786&4294967295,S=R+(L<<5&4294967295|L>>>27),L=M+(R^N&(S^R))+O[6]+3225465664&4294967295,M=S+(L<<9&4294967295|L>>>23),L=N+(S^R&(M^S))+O[11]+643717713&4294967295,N=M+(L<<14&4294967295|L>>>18),L=R+(M^S&(N^M))+O[0]+3921069994&4294967295,R=N+(L<<20&4294967295|L>>>12),L=S+(N^M&(R^N))+O[5]+3593408605&4294967295,S=R+(L<<5&4294967295|L>>>27),L=M+(R^N&(S^R))+O[10]+38016083&4294967295,M=S+(L<<9&4294967295|L>>>23),L=N+(S^R&(M^S))+O[15]+3634488961&4294967295,N=M+(L<<14&4294967295|L>>>18),L=R+(M^S&(N^M))+O[4]+3889429448&4294967295,R=N+(L<<20&4294967295|L>>>12),L=S+(N^M&(R^N))+O[9]+568446438&4294967295,S=R+(L<<5&4294967295|L>>>27),L=M+(R^N&(S^R))+O[14]+3275163606&4294967295,M=S+(L<<9&4294967295|L>>>23),L=N+(S^R&(M^S))+O[3]+4107603335&4294967295,N=M+(L<<14&4294967295|L>>>18),L=R+(M^S&(N^M))+O[8]+1163531501&4294967295,R=N+(L<<20&4294967295|L>>>12),L=S+(N^M&(R^N))+O[13]+2850285829&4294967295,S=R+(L<<5&4294967295|L>>>27),L=M+(R^N&(S^R))+O[2]+4243563512&4294967295,M=S+(L<<9&4294967295|L>>>23),L=N+(S^R&(M^S))+O[7]+1735328473&4294967295,N=M+(L<<14&4294967295|L>>>18),L=R+(M^S&(N^M))+O[12]+2368359562&4294967295,L=S+((R=N+(L<<20&4294967295|L>>>12))^N^M)+O[5]+4294588738&4294967295,L=M+((S=R+(L<<4&4294967295|L>>>28))^R^N)+O[8]+2272392833&4294967295,L=N+((M=S+(L<<11&4294967295|L>>>21))^S^R)+O[11]+1839030562&4294967295,L=R+((N=M+(L<<16&4294967295|L>>>16))^M^S)+O[14]+4259657740&4294967295,L=S+((R=N+(L<<23&4294967295|L>>>9))^N^M)+O[1]+2763975236&4294967295,L=M+((S=R+(L<<4&4294967295|L>>>28))^R^N)+O[4]+1272893353&4294967295,L=N+((M=S+(L<<11&4294967295|L>>>21))^S^R)+O[7]+4139469664&4294967295,L=R+((N=M+(L<<16&4294967295|L>>>16))^M^S)+O[10]+3200236656&4294967295,L=S+((R=N+(L<<23&4294967295|L>>>9))^N^M)+O[13]+681279174&4294967295,L=M+((S=R+(L<<4&4294967295|L>>>28))^R^N)+O[0]+3936430074&4294967295,L=N+((M=S+(L<<11&4294967295|L>>>21))^S^R)+O[3]+3572445317&4294967295,L=R+((N=M+(L<<16&4294967295|L>>>16))^M^S)+O[6]+76029189&4294967295,L=S+((R=N+(L<<23&4294967295|L>>>9))^N^M)+O[9]+3654602809&4294967295,L=M+((S=R+(L<<4&4294967295|L>>>28))^R^N)+O[12]+3873151461&4294967295,L=N+((M=S+(L<<11&4294967295|L>>>21))^S^R)+O[15]+530742520&4294967295,L=R+((N=M+(L<<16&4294967295|L>>>16))^M^S)+O[2]+3299628645&4294967295,R=N+(L<<23&4294967295|L>>>9),L=S+(N^(R|~M))+O[0]+4096336452&4294967295,S=R+(L<<6&4294967295|L>>>26),L=M+(R^(S|~N))+O[7]+1126891415&4294967295,M=S+(L<<10&4294967295|L>>>22),L=N+(S^(M|~R))+O[14]+2878612391&4294967295,N=M+(L<<15&4294967295|L>>>17),L=R+(M^(N|~S))+O[5]+4237533241&4294967295,R=N+(L<<21&4294967295|L>>>11),L=S+(N^(R|~M))+O[12]+1700485571&4294967295,S=R+(L<<6&4294967295|L>>>26),L=M+(R^(S|~N))+O[3]+2399980690&4294967295,M=S+(L<<10&4294967295|L>>>22),L=N+(S^(M|~R))+O[10]+4293915773&4294967295,N=M+(L<<15&4294967295|L>>>17),L=R+(M^(N|~S))+O[1]+2240044497&4294967295,R=N+(L<<21&4294967295|L>>>11),L=S+(N^(R|~M))+O[8]+1873313359&4294967295,S=R+(L<<6&4294967295|L>>>26),L=M+(R^(S|~N))+O[15]+4264355552&4294967295,M=S+(L<<10&4294967295|L>>>22),L=N+(S^(M|~R))+O[6]+2734768916&4294967295,N=M+(L<<15&4294967295|L>>>17),L=R+(M^(N|~S))+O[13]+1309151649&4294967295,R=N+(L<<21&4294967295|L>>>11),L=S+(N^(R|~M))+O[4]+4149444226&4294967295,S=R+(L<<6&4294967295|L>>>26),L=M+(R^(S|~N))+O[11]+3174756917&4294967295,M=S+(L<<10&4294967295|L>>>22),L=N+(S^(M|~R))+O[2]+718787259&4294967295,N=M+(L<<15&4294967295|L>>>17),L=R+(M^(N|~S))+O[9]+3951481745&4294967295,T.g[0]=T.g[0]+S&4294967295,T.g[1]=T.g[1]+(N+(L<<21&4294967295|L>>>11))&4294967295,T.g[2]=T.g[2]+N&4294967295,T.g[3]=T.g[3]+M&4294967295}function R(T,S){var R=U;return Object.prototype.hasOwnProperty.call(R,T)?R[T]:R[T]=S(T)}function M(T,S){this.h=S;for(var R=[],O=!0,N=T.length-1;0<=N;N--){var M=0|T[N];O&&M==S||(R[N]=M,O=!1)}this.g=R}(function(T,S){function R(){}R.prototype=S.prototype,T.D=S.prototype,T.prototype=new R,T.prototype.constructor=T,T.C=function(T,R,O){for(var N=Array(arguments.length-2),M=2;M<arguments.length;M++)N[M-2]=arguments[M];return S.prototype[R].apply(T,N)}})(T,function(){this.blockSize=-1}),T.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},T.prototype.u=function(T,R){void 0===R&&(R=T.length);for(var O=R-this.blockSize,N=this.B,M=this.h,L=0;L<R;){if(0==M)for(;L<=O;)S(this,T,L),L+=this.blockSize;if("string"==typeof T){for(;L<R;)if(N[M++]=T.charCodeAt(L++),M==this.blockSize){S(this,N),M=0;break}}else for(;L<R;)if(N[M++]=T[L++],M==this.blockSize){S(this,N),M=0;break}}this.h=M,this.o+=R},T.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var S=1;S<T.length-8;++S)T[S]=0;var R=8*this.o;for(S=T.length-8;S<T.length;++S)T[S]=255&R,R/=256;for(this.u(T),T=Array(16),S=R=0;4>S;++S)for(var O=0;32>O;O+=8)T[R++]=this.g[S]>>>O&255;return T};var L,U={};function V(T){return -128<=T&&128>T?R(T,function(T){return new M([0|T],0>T?-1:0)}):new M([0|T],0>T?-1:0)}function K(T){if(isNaN(T)||!isFinite(T))return Q;if(0>T)return er(K(-T));for(var S=[],R=1,O=0;T>=R;O++)S[O]=T/R|0,R*=4294967296;return new M(S,0)}function $(T,S){if(0==T.length)throw Error("number format error: empty string");if(2>(S=S||10)||36<S)throw Error("radix out of range: "+S);if("-"==T.charAt(0))return er($(T.substring(1),S));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=K(Math.pow(S,8)),O=Q,N=0;N<T.length;N+=8){var M=Math.min(8,T.length-N),L=parseInt(T.substring(N,N+M),S);8>M?(M=K(Math.pow(S,M)),O=O.j(M).add(K(L))):O=(O=O.j(R)).add(K(L))}return O}var Q=V(0),Y=V(1),Z=V(16777216);function ee(T){if(0!=T.h)return!1;for(var S=0;S<T.g.length;S++)if(0!=T.g[S])return!1;return!0}function et(T){return -1==T.h}function er(T){for(var S=T.g.length,R=[],O=0;O<S;O++)R[O]=~T.g[O];return new M(R,~T.h).add(Y)}function en(T,S){return T.add(er(S))}function ei(T,S){for(;(65535&T[S])!=T[S];)T[S+1]+=T[S]>>>16,T[S]&=65535,S++}function es(T,S){this.g=T,this.h=S}function ea(T,S){if(ee(S))throw Error("division by zero");if(ee(T))return new es(Q,Q);if(et(T))return S=ea(er(T),S),new es(er(S.g),er(S.h));if(et(S))return S=ea(T,er(S)),new es(er(S.g),S.h);if(30<T.g.length){if(et(T)||et(S))throw Error("slowDivide_ only works with positive integers.");for(var R=Y,O=S;0>=O.l(T);)R=eo(R),O=eo(O);var N=eu(R,1),M=eu(O,1);for(O=eu(O,2),R=eu(R,2);!ee(O);){var L=M.add(O);0>=L.l(T)&&(N=N.add(R),M=L),O=eu(O,1),R=eu(R,1)}return S=en(T,N.j(S)),new es(N,S)}for(N=Q;0<=T.l(S);){for(O=48>=(O=Math.ceil(Math.log(R=Math.max(1,Math.floor(T.m()/S.m())))/Math.LN2))?1:Math.pow(2,O-48),L=(M=K(R)).j(S);et(L)||0<L.l(T);)R-=O,L=(M=K(R)).j(S);ee(M)&&(M=Y),N=N.add(M),T=en(T,L)}return new es(N,T)}function eo(T){for(var S=T.g.length+1,R=[],O=0;O<S;O++)R[O]=T.i(O)<<1|T.i(O-1)>>>31;return new M(R,T.h)}function eu(T,S){var R=S>>5;S%=32;for(var O=T.g.length-R,N=[],L=0;L<O;L++)N[L]=0<S?T.i(L+R)>>>S|T.i(L+R+1)<<32-S:T.i(L+R);return new M(N,T.h)}(L=M.prototype).m=function(){if(et(this))return-er(this).m();for(var T=0,S=1,R=0;R<this.g.length;R++){var O=this.i(R);T+=(0<=O?O:4294967296+O)*S,S*=4294967296}return T},L.toString=function(T){if(2>(T=T||10)||36<T)throw Error("radix out of range: "+T);if(ee(this))return"0";if(et(this))return"-"+er(this).toString(T);for(var S=K(Math.pow(T,6)),R=this,O="";;){var N=ea(R,S).g,M=((0<(R=en(R,N.j(S))).g.length?R.g[0]:R.h)>>>0).toString(T);if(ee(R=N))return M+O;for(;6>M.length;)M="0"+M;O=M+O}},L.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h},L.l=function(T){return et(T=en(this,T))?-1:ee(T)?0:1},L.abs=function(){return et(this)?er(this):this},L.add=function(T){for(var S=Math.max(this.g.length,T.g.length),R=[],O=0,N=0;N<=S;N++){var L=O+(65535&this.i(N))+(65535&T.i(N)),U=(L>>>16)+(this.i(N)>>>16)+(T.i(N)>>>16);O=U>>>16,L&=65535,U&=65535,R[N]=U<<16|L}return new M(R,-2147483648&R[R.length-1]?-1:0)},L.j=function(T){if(ee(this)||ee(T))return Q;if(et(this))return et(T)?er(this).j(er(T)):er(er(this).j(T));if(et(T))return er(this.j(er(T)));if(0>this.l(Z)&&0>T.l(Z))return K(this.m()*T.m());for(var S=this.g.length+T.g.length,R=[],O=0;O<2*S;O++)R[O]=0;for(O=0;O<this.g.length;O++)for(var N=0;N<T.g.length;N++){var L=this.i(O)>>>16,U=65535&this.i(O),V=T.i(N)>>>16,$=65535&T.i(N);R[2*O+2*N]+=U*$,ei(R,2*O+2*N),R[2*O+2*N+1]+=L*$,ei(R,2*O+2*N+1),R[2*O+2*N+1]+=U*V,ei(R,2*O+2*N+1),R[2*O+2*N+2]+=L*V,ei(R,2*O+2*N+2)}for(O=0;O<S;O++)R[O]=R[2*O+1]<<16|R[2*O];for(O=S;O<2*S;O++)R[O]=0;return new M(R,0)},L.A=function(T){return ea(this,T).h},L.and=function(T){for(var S=Math.max(this.g.length,T.g.length),R=[],O=0;O<S;O++)R[O]=this.i(O)&T.i(O);return new M(R,this.h&T.h)},L.or=function(T){for(var S=Math.max(this.g.length,T.g.length),R=[],O=0;O<S;O++)R[O]=this.i(O)|T.i(O);return new M(R,this.h|T.h)},L.xor=function(T){for(var S=Math.max(this.g.length,T.g.length),R=[],O=0;O<S;O++)R[O]=this.i(O)^T.i(O);return new M(R,this.h^T.h)},T.prototype.digest=T.prototype.v,T.prototype.reset=T.prototype.s,T.prototype.update=T.prototype.u,N=X.Md5=T,M.prototype.add=M.prototype.add,M.prototype.multiply=M.prototype.j,M.prototype.modulo=M.prototype.A,M.prototype.compare=M.prototype.l,M.prototype.toNumber=M.prototype.m,M.prototype.toString=M.prototype.toString,M.prototype.getBits=M.prototype.i,M.fromNumber=K,M.fromString=$,O=X.Integer=M}).apply(void 0!==Y?Y:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Z=R(6113),ee=R(6063),et=R(8196);let er="@firebase/firestore",en="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(T){this.uid=T}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(T){return T.uid===this.uid}}ei.UNAUTHENTICATED=new ei(null),ei.GOOGLE_CREDENTIALS=new ei("google-credentials-uid"),ei.FIRST_PARTY=new ei("first-party-uid"),ei.MOCK_USER=new ei("mock-user");let es="12.0.0",ea=es;function eo(T){ea=T}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eu(T){return(0,$.inspect)(T,{depth:100})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ec=new K.Yd("@firebase/firestore");function ed(){return ec.logLevel}function eh(T,...S){if(ec.logLevel<=K.in.DEBUG){let R=S.map(em);ec.debug(`Firestore (${ea}): ${T}`,...R)}}function ef(T,...S){if(ec.logLevel<=K.in.ERROR){let R=S.map(em);ec.error(`Firestore (${ea}): ${T}`,...R)}}function ep(T,...S){if(ec.logLevel<=K.in.WARN){let R=S.map(em);ec.warn(`Firestore (${ea}): ${T}`,...R)}}function em(T){if("string"==typeof T)return T;try{return eu(T)}catch(S){return T}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eg(T,S,R){let O="Unexpected state";"string"==typeof S?O=S:R=S,ey(T,O,R)}function ey(T,S,R){let O=`FIRESTORE (${ea}) INTERNAL ASSERTION FAILED: ${S} (ID: ${T.toString(16)})`;if(void 0!==R)try{let T=JSON.stringify(R);O+=" CONTEXT: "+T}catch(T){O+=" CONTEXT: "+R}throw ef(O),Error(O)}function ev(T,S,R,O){let N="Unexpected state";"string"==typeof R?N=R:O=R,T||ey(S,N,O)}function eb(T,S){return T}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e_={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class eT extends Q.ZR{constructor(T,S){super(T,S),this.code=T,this.message=S,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(){this.promise=new Promise((T,S)=>{this.resolve=T,this.reject=S})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE{constructor(T,S){this.user=S,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${T}`)}}class ew{getToken(){return Promise.resolve(null)}invalidateToken(){}start(T,S){T.enqueueRetryable(()=>S(ei.UNAUTHENTICATED))}shutdown(){}}class eC{constructor(T){this.authProvider=T,this.currentUser=ei.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(T,S){ev(void 0===this.tokenListener,42304);let R=this.tokenCounter,O=T=>this.tokenCounter!==R?(R=this.tokenCounter,S(T)):Promise.resolve(),N=new eS;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),N.resolve(),N=new eS,T.enqueueRetryable(()=>O(this.currentUser))};let M=()=>{let S=N;T.enqueueRetryable(async()=>{await S.promise,await O(this.currentUser)})},L=T=>{eh("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=T,this.tokenListener&&(this.auth.addAuthTokenListener(this.tokenListener),M())};this.authProvider.onInit(T=>L(T)),setTimeout(()=>{if(!this.auth){let T=this.authProvider.getImmediate({optional:!0});T?L(T):(eh("FirebaseAuthCredentialsProvider","Auth not yet detected"),N.resolve(),N=new eS)}},0),M()}getToken(){let T=this.tokenCounter,S=this.forceRefresh;return(this.forceRefresh=!1,this.auth)?this.auth.getToken(S).then(S=>this.tokenCounter!==T?(eh("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):S?(ev("string"==typeof S.accessToken,31837,{tokenData:S}),new eE(S.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.tokenListener&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=void 0}getUser(){let T=this.auth&&this.auth.getUid();return ev(null===T||"string"==typeof T,2055,{currentUid:T}),new ei(T)}}class eI{constructor(T,S,R){this.sessionIndex=T,this.iamToken=S,this.authTokenFactory=R,this.type="FirstParty",this.user=ei.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let T=this.getAuthToken();return T&&this._headers.set("Authorization",T),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}}class eR{constructor(T,S,R){this.sessionIndex=T,this.iamToken=S,this.authTokenFactory=R}getToken(){return Promise.resolve(new eI(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(T,S){T.enqueueRetryable(()=>S(ei.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class eA{constructor(T){this.value=T,this.type="AppCheck",this.headers=new Map,T&&T.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class eO{constructor(T,S){this.appCheckProvider=S,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null,this.serverAppAppCheckToken=null,(0,U.rh)(T)&&T.settings.appCheckToken&&(this.serverAppAppCheckToken=T.settings.appCheckToken)}start(T,S){ev(void 0===this.tokenListener,3512);let R=T=>{null!=T.error&&eh("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${T.error.message}`);let R=T.token!==this.latestAppCheckToken;return this.latestAppCheckToken=T.token,eh("FirebaseAppCheckTokenProvider",`Received ${R?"new":"existing"} token.`),R?S(T.token):Promise.resolve()};this.tokenListener=S=>{T.enqueueRetryable(()=>R(S))};let O=T=>{eh("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=T,this.tokenListener&&this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(T=>O(T)),setTimeout(()=>{if(!this.appCheck){let T=this.appCheckProvider.getImmediate({optional:!0});T?O(T):eh("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.serverAppAppCheckToken)return Promise.resolve(new eA(this.serverAppAppCheckToken));let T=this.forceRefresh;return(this.forceRefresh=!1,this.appCheck)?this.appCheck.getToken(T).then(T=>T?(ev("string"==typeof T.token,44558,{tokenResult:T}),this.latestAppCheckToken=T.token,new eA(T.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.tokenListener&&this.appCheck.removeTokenListener(this.tokenListener),this.tokenListener=void 0}}function eN(T){if(!T)return new ew;switch(T.type){case"firstParty":return new eR(T.sessionIndex||"0",T.iamToken||null,T.authTokenFactory||null);case"provider":return T.client;default:throw new eT(e_.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ek(T){return(0,Z.randomBytes)(T)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{static newId(){let T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",S=Math.floor(256/T.length)*T.length,R="",O=20;for(;R.length<O;){let N=ek(40);for(let M=0;M<N.length;++M)R.length<O&&N[M]<S&&(R+=T.charAt(N[M]%T.length))}return R}}function eD(T,S){return T<S?-1:T>S?1:0}function eM(T,S){let R=Math.min(T.length,S.length);for(let O=0;O<R;O++){let R=T.charAt(O),N=S.charAt(O);if(R!==N)return eF(R)===eF(N)?eD(R,N):eF(R)?1:-1}return eD(T.length,S.length)}let ex=55296,eL=57343;function eF(T){let S=T.charCodeAt(0);return S>=ex&&S<=eL}function eU(T,S,R){return T.length===S.length&&T.every((T,O)=>R(T,S[O]))}function ej(T){return T+"\x00"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eB="__name__";class eV{constructor(T,S,R){void 0===S?S=0:S>T.length&&eg(637,{offset:S,range:T.length}),void 0===R?R=T.length-S:R>T.length-S&&eg(1746,{length:R,range:T.length-S}),this.segments=T,this.offset=S,this.len=R}get length(){return this.len}isEqual(T){return 0===eV.comparator(this,T)}child(T){let S=this.segments.slice(this.offset,this.limit());return T instanceof eV?T.forEach(T=>{S.push(T)}):S.push(T),this.construct(S)}limit(){return this.offset+this.length}popFirst(T){return T=void 0===T?1:T,this.construct(this.segments,this.offset+T,this.length-T)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(T){return this.segments[this.offset+T]}isEmpty(){return 0===this.length}isPrefixOf(T){if(T.length<this.length)return!1;for(let S=0;S<this.length;S++)if(this.get(S)!==T.get(S))return!1;return!0}isImmediateParentOf(T){if(this.length+1!==T.length)return!1;for(let S=0;S<this.length;S++)if(this.get(S)!==T.get(S))return!1;return!0}forEach(T){for(let S=this.offset,R=this.limit();S<R;S++)T(this.segments[S])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(T,S){let R=Math.min(T.length,S.length);for(let O=0;O<R;O++){let R=eV.compareSegments(T.get(O),S.get(O));if(0!==R)return R}return eD(T.length,S.length)}static compareSegments(T,S){let R=eV.isNumericId(T),O=eV.isNumericId(S);return R&&!O?-1:!R&&O?1:R&&O?eV.extractNumericId(T).compare(eV.extractNumericId(S)):eM(T,S)}static isNumericId(T){return T.startsWith("__id")&&T.endsWith("__")}static extractNumericId(T){return O.fromString(T.substring(4,T.length-2))}}class ez extends eV{construct(T,S,R){return new ez(T,S,R)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...T){let S=[];for(let R of T){if(R.indexOf("//")>=0)throw new eT(e_.INVALID_ARGUMENT,`Invalid segment (${R}). Paths must not contain // in them.`);S.push(...R.split("/").filter(T=>T.length>0))}return new ez(S)}static emptyPath(){return new ez([])}}let eq=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class eH extends eV{construct(T,S,R){return new eH(T,S,R)}static isValidIdentifier(T){return eq.test(T)}canonicalString(){return this.toArray().map(T=>(T=T.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),eH.isValidIdentifier(T)||(T="`"+T+"`"),T)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===eB}static keyField(){return new eH([eB])}static fromServerFormat(T){let S=[],R="",O=0,N=()=>{if(0===R.length)throw new eT(e_.INVALID_ARGUMENT,`Invalid field path (${T}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);S.push(R),R=""},M=!1;for(;O<T.length;){let S=T[O];if("\\"===S){if(O+1===T.length)throw new eT(e_.INVALID_ARGUMENT,"Path has trailing escape character: "+T);let S=T[O+1];if(!("\\"===S||"."===S||"`"===S))throw new eT(e_.INVALID_ARGUMENT,"Path has invalid escape sequence: "+T);R+=S,O+=2}else"`"===S?M=!M:"."!==S||M?R+=S:N(),O++}if(N(),M)throw new eT(e_.INVALID_ARGUMENT,"Unterminated ` in path: "+T);return new eH(S)}static emptyPath(){return new eH([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eG{constructor(T){this.path=T}static fromPath(T){return new eG(ez.fromString(T))}static fromName(T){return new eG(ez.fromString(T).popFirst(5))}static empty(){return new eG(ez.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(T){return this.path.length>=2&&this.path.get(this.path.length-2)===T}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(T){return null!==T&&0===ez.comparator(this.path,T.path)}toString(){return this.path.toString()}static comparator(T,S){return ez.comparator(T.path,S.path)}static isDocumentKey(T){return T.length%2==0}static fromSegments(T){return new eG(new ez(T.slice()))}}function eW(T,S,R,O){if(!0===S&&!0===O)throw new eT(e_.INVALID_ARGUMENT,`${T} and ${R} cannot be used together.`)}function eK(T){return"object"==typeof T&&null!==T&&(Object.getPrototypeOf(T)===Object.prototype||null===Object.getPrototypeOf(T))}function e$(T){if(void 0===T)return"undefined";if(null===T)return"null";if("string"==typeof T)return T.length>20&&(T=`${T.substring(0,20)}...`),JSON.stringify(T);if("number"==typeof T||"boolean"==typeof T)return""+T;if("object"==typeof T){if(T instanceof Array)return"an array";{let S=eQ(T);return S?`a custom ${S} object`:"an object"}}if("function"==typeof T)return"a function";return eg(12329,{type:typeof T})}function eQ(T){return T.constructor?T.constructor.name:null}function eY(T,S){if("_delegate"in T&&(T=T._delegate),!(T instanceof S)){if(S.name===T.constructor.name)throw new eT(e_.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let R=e$(T);throw new eT(e_.INVALID_ARGUMENT,`Expected type '${S.name}', but it was: ${R}`)}}return T}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eJ(T,S){let R={typeString:T};return S&&(R.value=S),R}function eX(T,S){let R;if(!eK(T))throw new eT(e_.INVALID_ARGUMENT,"JSON must be an object");for(let O in S)if(S[O]){let N=S[O].typeString,M="value"in S[O]?{value:S[O].value}:void 0;if(!(O in T)){R=`JSON missing required field: '${O}'`;break}let L=T[O];if(N&&typeof L!==N){R=`JSON field '${O}' must be a ${N}.`;break}if(void 0!==M&&L!==M.value){R=`Expected '${O}' field to equal '${M.value}'`;break}}if(R)throw new eT(e_.INVALID_ARGUMENT,R);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eZ=-62135596800,e0=1e6;class e1{static now(){return e1.fromMillis(Date.now())}static fromDate(T){return e1.fromMillis(T.getTime())}static fromMillis(T){let S=Math.floor(T/1e3),R=Math.floor((T-1e3*S)*e0);return new e1(S,R)}constructor(T,S){if(this.seconds=T,this.nanoseconds=S,S<0||S>=1e9)throw new eT(e_.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+S);if(T<eZ||T>=253402300800)throw new eT(e_.INVALID_ARGUMENT,"Timestamp seconds out of range: "+T)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/e0}_compareTo(T){return this.seconds===T.seconds?eD(this.nanoseconds,T.nanoseconds):eD(this.seconds,T.seconds)}isEqual(T){return T.seconds===this.seconds&&T.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:e1._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(T){if(eX(T,e1._jsonSchema))return new e1(T.seconds,T.nanoseconds)}valueOf(){let T=this.seconds-eZ,S=String(T).padStart(12,"0"),R=String(this.nanoseconds).padStart(9,"0");return S+"."+R}}e1._jsonSchemaVersion="firestore/timestamp/1.0",e1._jsonSchema={type:eJ("string",e1._jsonSchemaVersion),seconds:eJ("number"),nanoseconds:eJ("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{static fromTimestamp(T){return new e2(T)}static min(){return new e2(new e1(0,0))}static max(){return new e2(new e1(253402300799,1e9-1))}constructor(T){this.timestamp=T}compareTo(T){return this.timestamp._compareTo(T.timestamp)}isEqual(T){return this.timestamp.isEqual(T.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e3=-1,e4=0;class e6{constructor(T,S,R,O){this.indexId=T,this.collectionGroup=S,this.fields=R,this.indexState=O}}function e9(T){return T.fields.find(T=>2===T.kind)}function e5(T){return T.fields.filter(T=>2!==T.kind)}function e8(T){let S=e5(T);return 0===S.length?0:S[S.length-1].kind}function e7(T,S){let R=eD(T.collectionGroup,S.collectionGroup);if(0!==R)return R;for(let O=0;O<Math.min(T.fields.length,S.fields.length);++O)if(0!==(R=tr(T.fields[O],S.fields[O])))return R;return eD(T.fields.length,S.fields.length)}function te(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(T=>`${T.fieldPath}:${T.kind}`).join(",")}`}e6.UNKNOWN_ID=-1;class tt{constructor(T,S){this.fieldPath=T,this.kind=S}}function tr(T,S){let R=eH.comparator(T.fieldPath,S.fieldPath);return 0!==R?R:eD(T.kind,S.kind)}class ti{constructor(T,S){this.sequenceNumber=T,this.offset=S}static empty(){return new ti(e4,tl.min())}}function ts(T,S){let R=T.toTimestamp().seconds,O=T.toTimestamp().nanoseconds+1,N=e2.fromTimestamp(1e9===O?new e1(R+1,0):new e1(R,O));return new tl(N,eG.empty(),S)}function ta(T){return new tl(T.readTime,T.key,e3)}class tl{constructor(T,S,R){this.readTime=T,this.documentKey=S,this.largestBatchId=R}static min(){return new tl(e2.min(),eG.empty(),e3)}static max(){return new tl(e2.max(),eG.empty(),e3)}}function tu(T,S){let R=T.readTime.compareTo(S.readTime);return 0!==R||0!==(R=eG.comparator(T.documentKey,S.documentKey))?R:eD(T.largestBatchId,S.largestBatchId)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tc=null;class td{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(T){this.onCommittedListeners.push(T)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(T=>T())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function th(T){if(T.code===e_.FAILED_PRECONDITION&&T.message===tc)eh("LocalStore","Unexpectedly lost primary lease");else throw T}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(T){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,T(T=>{this.isDone=!0,this.result=T,this.nextCallback&&this.nextCallback(T)},T=>{this.isDone=!0,this.error=T,this.catchCallback&&this.catchCallback(T)})}catch(T){return this.next(void 0,T)}next(T,S){return(this.callbackAttached&&eg(59440),this.callbackAttached=!0,this.isDone)?this.error?this.wrapFailure(S,this.error):this.wrapSuccess(T,this.result):new tf((R,O)=>{this.nextCallback=S=>{this.wrapSuccess(T,S).next(R,O)},this.catchCallback=T=>{this.wrapFailure(S,T).next(R,O)}})}toPromise(){return new Promise((T,S)=>{this.next(T,S)})}wrapUserFunction(T){try{let S=T();if(S instanceof tf)return S;return tf.resolve(S)}catch(T){return tf.reject(T)}}wrapSuccess(T,S){return T?this.wrapUserFunction(()=>T(S)):tf.resolve(S)}wrapFailure(T,S){return T?this.wrapUserFunction(()=>T(S)):tf.reject(S)}static resolve(T){return new tf((S,R)=>{S(T)})}static reject(T){return new tf((S,R)=>{R(T)})}static waitFor(T){return new tf((S,R)=>{let O=0,N=0,M=!1;T.forEach(T=>{++O,T.next(()=>{++N,M&&N===O&&S()},T=>R(T))}),M=!0,N===O&&S()})}static or(T){let S=tf.resolve(!1);for(let R of T)S=S.next(T=>T?tf.resolve(T):R());return S}static forEach(T,S){let R=[];return T.forEach((T,O)=>{R.push(S.call(this,T,O))}),this.waitFor(R)}static mapArray(T,S){return new tf((R,O)=>{let N=T.length,M=Array(N),L=0;for(let U=0;U<N;U++){let V=U;S(T[V]).next(T=>{M[V]=T,++L===N&&R(M)},T=>O(T))}})}static doWhile(T,S){return new tf((R,O)=>{let N=()=>{!0===T()?S().next(()=>{N()},O):R()};N()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tp="SimpleDb",tm=3;class tg{static open(T,S,R,O){try{return new tg(S,T.transaction(O,R))}catch(T){throw new t_(S,T)}}constructor(T,S){this.action=T,this.transaction=S,this.aborted=!1,this.completionDeferred=new eS,this.transaction.oncomplete=()=>{this.completionDeferred.resolve()},this.transaction.onabort=()=>{S.error?this.completionDeferred.reject(new t_(T,S.error)):this.completionDeferred.resolve()},this.transaction.onerror=S=>{let R=tC(S.target.error);this.completionDeferred.reject(new t_(T,R))}}get completionPromise(){return this.completionDeferred.promise}abort(T){T&&this.completionDeferred.reject(T),this.aborted||(eh(tp,"Aborting transaction:",T?T.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}maybeCommit(){let T=this.transaction;this.aborted||"function"!=typeof T.commit||T.commit()}store(T){let S=this.transaction.objectStore(T);return new tS(S)}}class ty{static delete(T){eh(tp,"Removing database:",T);let S=getGlobal();return tE(S.indexedDB.deleteDatabase(T)).toPromise()}static isAvailable(){if(!isIndexedDBAvailable())return!1;if(ty.isMockPersistence())return!0;let T=getUA(),S=ty.getIOSVersion(T),R=0<S&&S<10,O=tv(T),N=0<O&&O<4.5;return!(T.indexOf("MSIE ")>0||T.indexOf("Trident/")>0||T.indexOf("Edge/")>0)&&!R&&!N}static isMockPersistence(){return"undefined"!=typeof process&&process.env?.USE_MOCK_PERSISTENCE==="YES"}static getStore(T,S){return T.store(S)}static getIOSVersion(T){let S=T.match(/i(?:phone|pad|pod) os ([\d_]+)/i),R=S?S[1].split("_").slice(0,2).join("."):"-1";return Number(R)}constructor(T,S,R){this.name=T,this.version=S,this.schemaConverter=R,this.lastClosedDbVersion=null;let O=ty.getIOSVersion(getUA());12.2===O&&ef("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async ensureDb(T){return this.db||(eh(tp,"Opening database:",this.name),this.db=await new Promise((S,R)=>{let O=indexedDB.open(this.name,this.version);O.onsuccess=T=>{let R=T.target.result;S(R)},O.onblocked=()=>{R(new t_(T,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},O.onerror=S=>{let O=S.target.error;"VersionError"===O.name?R(new eT(e_.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===O.name?R(new eT(e_.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+O)):R(new t_(T,O))},O.onupgradeneeded=T=>{eh(tp,'Database "'+this.name+'" requires upgrade from version:',T.oldVersion);let S=T.target.result;this.schemaConverter.createOrUpgrade(S,O.transaction,T.oldVersion,this.version).next(()=>{eh(tp,"Database upgrade to version "+this.version+" complete")})}})),this.versionchangelistener&&(this.db.onversionchange=T=>this.versionchangelistener(T)),this.db}setVersionChangeListener(T){this.versionchangelistener=T,this.db&&(this.db.onversionchange=S=>T(S))}async runTransaction(T,S,R,O){let N="readonly"===S,M=0;for(;;){++M;try{this.db=await this.ensureDb(T);let S=tg.open(this.db,T,N?"readonly":"readwrite",R),M=O(S).next(T=>(S.maybeCommit(),T)).catch(T=>(S.abort(T),tf.reject(T))).toPromise();return M.catch(()=>{}),await S.completionPromise,M}catch(R){let T=R,S="FirebaseError"!==T.name&&M<tm;if(eh(tp,"Transaction failed with error:",T.message,"Retrying:",S),this.close(),!S)return Promise.reject(T)}}}close(){this.db&&this.db.close(),this.db=void 0}}function tv(T){let S=T.match(/Android ([\d.]+)/i),R=S?S[1].split(".").slice(0,2).join("."):"-1";return Number(R)}class tb{constructor(T){this.dbCursor=T,this.shouldStop=!1,this.nextKey=null}get isDone(){return this.shouldStop}get skipToKey(){return this.nextKey}set cursor(T){this.dbCursor=T}done(){this.shouldStop=!0}skip(T){this.nextKey=T}delete(){return tE(this.dbCursor.delete())}}class t_ extends null{constructor(T,S){super(e_.UNAVAILABLE,`IndexedDB transaction '${T}' failed: ${S}`),this.name="IndexedDbTransactionError"}}function tT(T){return"IndexedDbTransactionError"===T.name}class tS{constructor(T){this.store=T}put(T,S){let R;return void 0!==S?(eh(tp,"PUT",this.store.name,T,S),R=this.store.put(S,T)):(eh(tp,"PUT",this.store.name,"<auto-key>",T),R=this.store.put(T)),tE(R)}add(T){eh(tp,"ADD",this.store.name,T,T);let S=this.store.add(T);return tE(S)}get(T){let S=this.store.get(T);return tE(S).next(S=>(void 0===S&&(S=null),eh(tp,"GET",this.store.name,T,S),S))}delete(T){eh(tp,"DELETE",this.store.name,T);let S=this.store.delete(T);return tE(S)}count(){eh(tp,"COUNT",this.store.name);let T=this.store.count();return tE(T)}loadAll(T,S){let R=this.options(T,S),O=R.index?this.store.index(R.index):this.store;if("function"==typeof O.getAll){let T=O.getAll(R.range);return new tf((S,R)=>{T.onerror=T=>{R(T.target.error)},T.onsuccess=T=>{S(T.target.result)}})}{let T=this.cursor(R),S=[];return this.iterateCursor(T,(T,R)=>{S.push(R)}).next(()=>S)}}loadFirst(T,S){let R=this.store.getAll(T,null===S?void 0:S);return new tf((T,S)=>{R.onerror=T=>{S(T.target.error)},R.onsuccess=S=>{T(S.target.result)}})}deleteAll(T,S){eh(tp,"DELETE ALL",this.store.name);let R=this.options(T,S);R.keysOnly=!1;let O=this.cursor(R);return this.iterateCursor(O,(T,S,R)=>R.delete())}iterate(T,S){let R;S?R=T:(R={},S=T);let O=this.cursor(R);return this.iterateCursor(O,S)}iterateSerial(T){let S=this.cursor({});return new tf((R,O)=>{S.onerror=T=>{let S=tC(T.target.error);O(S)},S.onsuccess=S=>{let O=S.target.result;if(!O){R();return}T(O.primaryKey,O.value).next(T=>{T?O.continue():R()})}})}iterateCursor(T,S){let R=[];return new tf((O,N)=>{T.onerror=T=>{N(T.target.error)},T.onsuccess=T=>{let N=T.target.result;if(!N){O();return}let M=new tb(N),L=S(N.primaryKey,N.value,M);if(L instanceof tf){let T=L.catch(T=>(M.done(),tf.reject(T)));R.push(T)}M.isDone?O():null===M.skipToKey?N.continue():N.continue(M.skipToKey)}}).next(()=>tf.waitFor(R))}options(T,S){let R;return void 0!==T&&("string"==typeof T?R=T:S=T),{index:R,range:S}}cursor(T){let S="next";if(T.reverse&&(S="prev"),!T.index)return this.store.openCursor(T.range,S);{let R=this.store.index(T.index);return T.keysOnly?R.openKeyCursor(T.range,S):R.openCursor(T.range,S)}}}function tE(T){return new tf((S,R)=>{T.onsuccess=T=>{let R=T.target.result;S(R)},T.onerror=T=>{let S=tC(T.target.error);R(S)}})}let tw=!1;function tC(T){let S=ty.getIOSVersion(getUA());if(S>=12.2&&S<13){let S="An internal error was encountered in the Indexed Database server";if(T.message.indexOf(S)>=0){let T=new eT("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${S}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return tw||(tw=!0,setTimeout(()=>{throw T},0)),T}}return T}let tI="IndexBackfiller",tR=null,tA=null,tO=50;class tN{constructor(T,S){this.asyncQueue=T,this.backfiller=S,this.task=null}start(){this.schedule(tR)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}schedule(T){eh(tI,`Scheduled in ${T}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",T,async()=>{this.task=null;try{let T=await this.backfiller.backfill();eh(tI,`Documents written: ${T}`)}catch(T){tT(T)?eh(tI,"Ignoring IndexedDB error during index backfill: ",T):await th(T)}await this.schedule(tA)})}}class tk{constructor(T,S){this.localStore=T,this.persistence=S}async backfill(T=tO){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",S=>this.writeIndexEntries(S,T))}writeIndexEntries(T,S){let R=new Set,O=S,N=!0;return tf.doWhile(()=>!0===N&&O>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(T).next(S=>{if(!(null===S||R.has(S)))return eh(tI,`Processing collection: ${S}`),this.writeEntriesForCollectionGroup(T,S,O).next(T=>{O-=T,R.add(S)});N=!1})).next(()=>S-O)}writeEntriesForCollectionGroup(T,S,R){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(T,S).next(O=>this.localStore.localDocuments.getNextDocuments(T,S,O,R).next(R=>{let N=R.changes;return this.localStore.indexManager.updateIndexEntries(T,N).next(()=>this.getNewOffset(O,R)).next(R=>(eh(tI,`Updating offset: ${R}`),this.localStore.indexManager.updateCollectionGroup(T,S,R))).next(()=>N.size)}))}getNewOffset(T,S){let R=T;return S.changes.forEach((T,S)=>{let O=ta(S);tu(O,R)>0&&(R=O)}),new tl(R.readTime,R.documentKey,Math.max(S.batchId,T.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(T,S){this.previousValue=T,S&&(S.sequenceNumberHandler=T=>this.setPreviousValue(T),this.writeNewSequenceNumber=T=>S.writeSequenceNumber(T))}setPreviousValue(T){return this.previousValue=Math.max(T,this.previousValue),this.previousValue}next(){let T=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(T),T}}tP.INVALID=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tD="\x01",tM="\x01",tL="\x10",tF="\x11";function tU(T){let S="";for(let R=0;R<T.length;R++)S.length>0&&(S=tB(S)),S=tj(T.get(R),S);return tB(S)}function tj(T,S){let R=S,O=T.length;for(let S=0;S<O;S++){let O=T.charAt(S);switch(O){case"\x00":R+=tD+tL;break;case tD:R+=tD+tF;break;default:R+=O}}return R}function tB(T){return T+tD+tM}function tV(T){let S=T.length;if(ev(S>=2,64408,{path:T}),2===S)return ev(T.charAt(0)===tD&&T.charAt(1)===tM,56145,{path:T}),ez.emptyPath();let R=S-2,O=[],N="";for(let M=0;M<S;){let S=T.indexOf(tD,M);(S<0||S>R)&&eg(50515,{path:T});let L=T.charAt(S+1);switch(L){case tM:let U;let V=T.substring(M,S);0===N.length?U=V:(N+=V,U=N,N=""),O.push(U);break;case tL:N+=T.substring(M,S)+"\x00";break;case tF:N+=T.substring(M,S+1);break;default:eg(61167,{path:T})}M=S+2}return new ez(O)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tz="remoteDocuments",tq="owner",tH="owner",tG="mutationQueues",tW="userId",tK="mutations",t$="batchId",tQ="userMutationsIndex",tY=null;function tJ(T){return[T]}function tX(T,S){return[T,tU(S)]}function tZ(T,S,R){return[T,tU(S),R]}let t0={},t1="documentMutations",t2="remoteDocumentsV14",t3=null,t4="documentKeyIndex",t6=null,t9="collectionGroupIndex",t5=null,t8="remoteDocumentGlobal",t7="remoteDocumentGlobalKey",rt="targets",rr="targetId",rn="queryTargetsIndex",ri=null,rs="targetDocuments",ra=null,ro="documentTargetsIndex",rl=null,ru="targetGlobalKey",rc="targetGlobal",rd="collectionParents",rh=null,rf="clientMetadata",rp="clientId",rm="bundles",rg="bundleId",ry="namedQueries",rv="name",rb="indexConfiguration",r_="indexId",rT="collectionGroupIndex",rS="collectionGroup",rE="indexState",rw=null,rC="sequenceNumberIndex",rI=null,rR="indexEntries",rA=null,rO="documentKeyIndex",rN=null,rk="documentOverlays",rP=null,rD="collectionPathOverlayIndex",rM=null,rx="collectionGroupOverlayIndex",rL=null,rF="globals",rU="name",rj=[tG,tK,t1,tz,rt,tq,rc,rs],rB=rj,rV=[...rB,rf],rz=[...rV,t8],rq=[...rz,rd],rH=[...rq,rm,ry],rG=[...rH,rk],rW=[tG,tK,t1,t2,rt,tq,rc,rs,rf,t8,rd,rm,ry,rk],rK=rW,r$=[...rK,rb,rE,rR],rQ=null,rY=[...r$,rF],rJ=null;function rX(T){return 18===T?rJ:17===T?rY:16===T?rQ:15===T?r$:14===T?rK:13===T?rW:12===T?rG:11===T?rH:void eg(60245)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rZ extends null{constructor(T,S){super(),this.simpleDbTransaction=T,this.currentSequenceNumber=S}}function r0(T,S){let R=eb(T);return ty.getStore(R.simpleDbTransaction,S)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r1(T){let S=0;for(let R in T)Object.prototype.hasOwnProperty.call(T,R)&&S++;return S}function r2(T,S){for(let R in T)Object.prototype.hasOwnProperty.call(T,R)&&S(R,T[R])}function r3(T){for(let S in T)if(Object.prototype.hasOwnProperty.call(T,S))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r4{constructor(T,S){this.comparator=T,this.root=S||r9.EMPTY}insert(T,S){return new r4(this.comparator,this.root.insert(T,S,this.comparator).copy(null,null,r9.BLACK,null,null))}remove(T){return new r4(this.comparator,this.root.remove(T,this.comparator).copy(null,null,r9.BLACK,null,null))}get(T){let S=this.root;for(;!S.isEmpty();){let R=this.comparator(T,S.key);if(0===R)return S.value;R<0?S=S.left:R>0&&(S=S.right)}return null}indexOf(T){let S=0,R=this.root;for(;!R.isEmpty();){let O=this.comparator(T,R.key);if(0===O)return S+R.left.size;O<0?R=R.left:(S+=R.left.size+1,R=R.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(T){return this.root.inorderTraversal(T)}forEach(T){this.inorderTraversal((S,R)=>(T(S,R),!1))}toString(){let T=[];return this.inorderTraversal((S,R)=>(T.push(`${S}:${R}`),!1)),`{${T.join(", ")}}`}reverseTraversal(T){return this.root.reverseTraversal(T)}getIterator(){return new r6(this.root,null,this.comparator,!1)}getIteratorFrom(T){return new r6(this.root,T,this.comparator,!1)}getReverseIterator(){return new r6(this.root,null,this.comparator,!0)}getReverseIteratorFrom(T){return new r6(this.root,T,this.comparator,!0)}}class r6{constructor(T,S,R,O){this.isReverse=O,this.nodeStack=[];let N=1;for(;!T.isEmpty();)if(N=S?R(T.key,S):1,S&&O&&(N*=-1),N<0)T=this.isReverse?T.left:T.right;else if(0===N){this.nodeStack.push(T);break}else this.nodeStack.push(T),T=this.isReverse?T.right:T.left}getNext(){let T=this.nodeStack.pop(),S={key:T.key,value:T.value};if(this.isReverse)for(T=T.left;!T.isEmpty();)this.nodeStack.push(T),T=T.right;else for(T=T.right;!T.isEmpty();)this.nodeStack.push(T),T=T.left;return S}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let T=this.nodeStack[this.nodeStack.length-1];return{key:T.key,value:T.value}}}class r9{constructor(T,S,R,O,N){this.key=T,this.value=S,this.color=null!=R?R:r9.RED,this.left=null!=O?O:r9.EMPTY,this.right=null!=N?N:r9.EMPTY,this.size=this.left.size+1+this.right.size}copy(T,S,R,O,N){return new r9(null!=T?T:this.key,null!=S?S:this.value,null!=R?R:this.color,null!=O?O:this.left,null!=N?N:this.right)}isEmpty(){return!1}inorderTraversal(T){return this.left.inorderTraversal(T)||T(this.key,this.value)||this.right.inorderTraversal(T)}reverseTraversal(T){return this.right.reverseTraversal(T)||T(this.key,this.value)||this.left.reverseTraversal(T)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(T,S,R){let O=this,N=R(T,O.key);return(O=N<0?O.copy(null,null,null,O.left.insert(T,S,R),null):0===N?O.copy(null,S,null,null,null):O.copy(null,null,null,null,O.right.insert(T,S,R))).fixUp()}removeMin(){if(this.left.isEmpty())return r9.EMPTY;let T=this;return T.left.isRed()||T.left.left.isRed()||(T=T.moveRedLeft()),(T=T.copy(null,null,null,T.left.removeMin(),null)).fixUp()}remove(T,S){let R;let O=this;if(0>S(T,O.key))O.left.isEmpty()||O.left.isRed()||O.left.left.isRed()||(O=O.moveRedLeft()),O=O.copy(null,null,null,O.left.remove(T,S),null);else{if(O.left.isRed()&&(O=O.rotateRight()),O.right.isEmpty()||O.right.isRed()||O.right.left.isRed()||(O=O.moveRedRight()),0===S(T,O.key)){if(O.right.isEmpty())return r9.EMPTY;R=O.right.min(),O=O.copy(R.key,R.value,null,null,O.right.removeMin())}O=O.copy(null,null,null,null,O.right.remove(T,S))}return O.fixUp()}isRed(){return this.color}fixUp(){let T=this;return T.right.isRed()&&!T.left.isRed()&&(T=T.rotateLeft()),T.left.isRed()&&T.left.left.isRed()&&(T=T.rotateRight()),T.left.isRed()&&T.right.isRed()&&(T=T.colorFlip()),T}moveRedLeft(){let T=this.colorFlip();return T.right.left.isRed()&&(T=(T=(T=T.copy(null,null,null,null,T.right.rotateRight())).rotateLeft()).colorFlip()),T}moveRedRight(){let T=this.colorFlip();return T.left.left.isRed()&&(T=(T=T.rotateRight()).colorFlip()),T}rotateLeft(){let T=this.copy(null,null,r9.RED,null,this.right.left);return this.right.copy(null,null,this.color,T,null)}rotateRight(){let T=this.copy(null,null,r9.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,T)}colorFlip(){let T=this.left.copy(null,null,!this.left.color,null,null),S=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,T,S)}checkMaxDepth(){let T=this.check();return Math.pow(2,T)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw eg(43730,{key:this.key,value:this.value});if(this.right.isRed())throw eg(14113,{key:this.key,value:this.value});let T=this.left.check();if(T===this.right.check())return T+(this.isRed()?0:1);throw eg(27949)}}r9.EMPTY=null,r9.RED=!0,r9.BLACK=!1;class r5{constructor(){this.size=0}get key(){throw eg(57766)}get value(){throw eg(16141)}get color(){throw eg(16727)}get left(){throw eg(29726)}get right(){throw eg(36894)}copy(T,S,R,O,N){return this}insert(T,S,R){return new r9(T,S)}remove(T,S){return this}isEmpty(){return!0}inorderTraversal(T){return!1}reverseTraversal(T){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}}r9.EMPTY=new r5;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r8{constructor(T){this.comparator=T,this.data=new r4(this.comparator)}has(T){return null!==this.data.get(T)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(T){return this.data.indexOf(T)}forEach(T){this.data.inorderTraversal((S,R)=>(T(S),!1))}forEachInRange(T,S){let R=this.data.getIteratorFrom(T[0]);for(;R.hasNext();){let O=R.getNext();if(this.comparator(O.key,T[1])>=0)return;S(O.key)}}forEachWhile(T,S){let R;for(R=void 0!==S?this.data.getIteratorFrom(S):this.data.getIterator();R.hasNext();){let S=R.getNext(),O=T(S.key);if(!O)return}}firstAfterOrEqual(T){let S=this.data.getIteratorFrom(T);return S.hasNext()?S.getNext().key:null}getIterator(){return new r7(this.data.getIterator())}getIteratorFrom(T){return new r7(this.data.getIteratorFrom(T))}add(T){return this.copy(this.data.remove(T).insert(T,!0))}delete(T){return this.has(T)?this.copy(this.data.remove(T)):this}isEmpty(){return this.data.isEmpty()}unionWith(T){let S=this;return S.size<T.size&&(S=T,T=this),T.forEach(T=>{S=S.add(T)}),S}isEqual(T){if(!(T instanceof r8)||this.size!==T.size)return!1;let S=this.data.getIterator(),R=T.data.getIterator();for(;S.hasNext();){let T=S.getNext().key,O=R.getNext().key;if(0!==this.comparator(T,O))return!1}return!0}toArray(){let T=[];return this.forEach(S=>{T.push(S)}),T}toString(){let T=[];return this.forEach(S=>T.push(S)),"SortedSet("+T.toString()+")"}copy(T){let S=new r8(this.comparator);return S.data=T,S}}class r7{constructor(T){this.iter=T}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ne(T,S,R,O,N){let M=T.getIterator(),L=S.getIterator(),U=nt(M),V=nt(L);for(;U||V;){let T=!1,S=!1;if(U&&V){let O=R(U,V);O<0?S=!0:O>0&&(T=!0)}else null!=U?S=!0:T=!0;T?(O(V),V=nt(L)):S?(N(U),U=nt(M)):(U=nt(M),V=nt(L))}}function nt(T){return T.hasNext()?T.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(T){this.fields=T,T.sort(eH.comparator)}static empty(){return new nn([])}unionWith(T){let S=new r8(eH.comparator);for(let T of this.fields)S=S.add(T);for(let R of T)S=S.add(R);return new nn(S.toArray())}covers(T){for(let S of this.fields)if(S.isPrefixOf(T))return!0;return!1}isEqual(T){return eU(this.fields,T.fields,(T,S)=>T.isEqual(S))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ni(T){return Buffer.from(T,"base64").toString("binary")}function na(T){return Buffer.from(T,"binary").toString("base64")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(T){this.binaryString=T}static fromBase64String(T){let S=ni(T);return new no(S)}static fromUint8Array(T){let S=nu(T);return new no(S)}[Symbol.iterator](){let T=0;return{next:()=>T<this.binaryString.length?{value:this.binaryString.charCodeAt(T++),done:!1}:{value:void 0,done:!0}}}toBase64(){return na(this.binaryString)}toUint8Array(){return nc(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(T){return eD(this.binaryString,T.binaryString)}isEqual(T){return this.binaryString===T.binaryString}}function nu(T){let S="";for(let R=0;R<T.length;++R)S+=String.fromCharCode(T[R]);return S}function nc(T){let S=new Uint8Array(T.length);for(let R=0;R<T.length;R++)S[R]=T.charCodeAt(R);return S}no.EMPTY_BYTE_STRING=new no("");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nd=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function nh(T){if(ev(!!T,39018),"string"==typeof T){let S=0,R=nd.exec(T);if(ev(!!R,46558,{timestamp:T}),R[1]){let T=R[1];S=Number(T=(T+"000000000").substr(0,9))}let O=new Date(T),N=Math.floor(O.getTime()/1e3);return{seconds:N,nanos:S}}{let S=nf(T.seconds),R=nf(T.nanos);return{seconds:S,nanos:R}}}function nf(T){return"number"==typeof T?T:"string"==typeof T?Number(T):0}function np(T){return"string"==typeof T?no.fromBase64String(T):no.fromUint8Array(T)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nm="server_timestamp",ng="__type__",ny="__previous_value__",nv="__local_write_time__";function nb(T){let S=(T?.mapValue?.fields||{})[ng]?.stringValue;return S===nm}function n_(T,S){let R={fields:{[ng]:{stringValue:nm},[nv]:{timestampValue:{seconds:T.seconds,nanos:T.nanoseconds}}}};return S&&nb(S)&&(S=nT(S)),S&&(R.fields[ny]=S),{mapValue:R}}function nT(T){let S=T.mapValue.fields[ny];return nb(S)?nT(S):S}function nS(T){let S=nh(T.mapValue.fields[nv].timestampValue);return new e1(S.seconds,S.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nE{constructor(T,S,R,O,N,M,L,U,V,K){this.databaseId=T,this.appId=S,this.persistenceKey=R,this.host=O,this.ssl=N,this.forceLongPolling=M,this.autoDetectLongPolling=L,this.longPollingOptions=U,this.useFetchStreams=V,this.isUsingEmulator=K}}let nw="(default)";class nC{constructor(T,S){this.projectId=T,this.database=S||nw}static empty(){return new nC("","")}get isDefaultDatabase(){return this.database===nw}isEqual(T){return T instanceof nC&&T.projectId===this.projectId&&T.database===this.database}}function nI(T,S){if(!Object.prototype.hasOwnProperty.apply(T.options,["projectId"]))throw new eT(e_.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new nC(T.options.projectId,S)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nR=-1;function nA(T){return null==T}function nO(T){return 0===T&&1/T==-1/0}function nN(T){return"number"==typeof T&&Number.isInteger(T)&&!nO(T)&&T<=Number.MAX_SAFE_INTEGER&&T>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nk="__type__",nP="__max__",nD={mapValue:{fields:{__type__:{stringValue:nP}}}},nM="__vector__",nx="value",nL={nullValue:"NULL_VALUE"};function nF(T){return"nullValue"in T?0:"booleanValue"in T?1:"integerValue"in T||"doubleValue"in T?2:"timestampValue"in T?3:"stringValue"in T?5:"bytesValue"in T?6:"referenceValue"in T?7:"geoPointValue"in T?8:"arrayValue"in T?9:"mapValue"in T?nb(T)?4:iy(T)?9007199254740991:im(T)?10:11:eg(28295,{value:T})}function nU(T,S){if(T===S)return!0;let R=nF(T),O=nF(S);if(R!==O)return!1;switch(R){case 0:case 9007199254740991:return!0;case 1:return T.booleanValue===S.booleanValue;case 4:return nS(T).isEqual(nS(S));case 3:return nj(T,S);case 5:return T.stringValue===S.stringValue;case 6:return nV(T,S);case 7:return T.referenceValue===S.referenceValue;case 8:return nB(T,S);case 2:return nz(T,S);case 9:return eU(T.arrayValue.values||[],S.arrayValue.values||[],nU);case 10:case 11:return nq(T,S);default:return eg(52216,{left:T})}}function nj(T,S){if("string"==typeof T.timestampValue&&"string"==typeof S.timestampValue&&T.timestampValue.length===S.timestampValue.length)return T.timestampValue===S.timestampValue;let R=nh(T.timestampValue),O=nh(S.timestampValue);return R.seconds===O.seconds&&R.nanos===O.nanos}function nB(T,S){return nf(T.geoPointValue.latitude)===nf(S.geoPointValue.latitude)&&nf(T.geoPointValue.longitude)===nf(S.geoPointValue.longitude)}function nV(T,S){return np(T.bytesValue).isEqual(np(S.bytesValue))}function nz(T,S){if("integerValue"in T&&"integerValue"in S)return nf(T.integerValue)===nf(S.integerValue);if("doubleValue"in T&&"doubleValue"in S){let R=nf(T.doubleValue),O=nf(S.doubleValue);return R===O?nO(R)===nO(O):isNaN(R)&&isNaN(O)}return!1}function nq(T,S){let R=T.mapValue.fields||{},O=S.mapValue.fields||{};if(r1(R)!==r1(O))return!1;for(let T in R)if(R.hasOwnProperty(T)&&(void 0===O[T]||!nU(R[T],O[T])))return!1;return!0}function nH(T,S){return void 0!==(T.values||[]).find(T=>nU(T,S))}function nG(T,S){if(T===S)return 0;let R=nF(T),O=nF(S);if(R!==O)return eD(R,O);switch(R){case 0:case 9007199254740991:return 0;case 1:return eD(T.booleanValue,S.booleanValue);case 2:return nW(T,S);case 3:return nK(T.timestampValue,S.timestampValue);case 4:return nK(nS(T),nS(S));case 5:return eM(T.stringValue,S.stringValue);case 6:return nY(T.bytesValue,S.bytesValue);case 7:return n$(T.referenceValue,S.referenceValue);case 8:return nQ(T.geoPointValue,S.geoPointValue);case 9:return nJ(T.arrayValue,S.arrayValue);case 10:return nX(T.mapValue,S.mapValue);case 11:return nZ(T.mapValue,S.mapValue);default:throw eg(23264,{leftType:R})}}function nW(T,S){let R=nf(T.integerValue||T.doubleValue),O=nf(S.integerValue||S.doubleValue);return R<O?-1:R>O?1:R===O?0:isNaN(R)?isNaN(O)?0:-1:1}function nK(T,S){if("string"==typeof T&&"string"==typeof S&&T.length===S.length)return eD(T,S);let R=nh(T),O=nh(S),N=eD(R.seconds,O.seconds);return 0!==N?N:eD(R.nanos,O.nanos)}function n$(T,S){let R=T.split("/"),O=S.split("/");for(let T=0;T<R.length&&T<O.length;T++){let S=eD(R[T],O[T]);if(0!==S)return S}return eD(R.length,O.length)}function nQ(T,S){let R=eD(nf(T.latitude),nf(S.latitude));return 0!==R?R:eD(nf(T.longitude),nf(S.longitude))}function nY(T,S){let R=np(T),O=np(S);return R.compareTo(O)}function nJ(T,S){let R=T.values||[],O=S.values||[];for(let T=0;T<R.length&&T<O.length;++T){let S=nG(R[T],O[T]);if(S)return S}return eD(R.length,O.length)}function nX(T,S){let R=T.fields||{},O=S.fields||{},N=R[nx]?.arrayValue,M=O[nx]?.arrayValue,L=eD(N?.values?.length||0,M?.values?.length||0);return 0!==L?L:nJ(N,M)}function nZ(T,S){if(T===nD.mapValue&&S===nD.mapValue)return 0;if(T===nD.mapValue)return 1;if(S===nD.mapValue)return -1;let R=T.fields||{},O=Object.keys(R),N=S.fields||{},M=Object.keys(N);O.sort(),M.sort();for(let T=0;T<O.length&&T<M.length;++T){let S=eM(O[T],M[T]);if(0!==S)return S;let L=nG(R[O[T]],N[M[T]]);if(0!==L)return L}return eD(O.length,M.length)}function n0(T){return n3(T)}function n3(T){if("nullValue"in T)return"null";if("booleanValue"in T)return""+T.booleanValue;if("integerValue"in T)return""+T.integerValue;if("doubleValue"in T)return""+T.doubleValue;if("timestampValue"in T)return n6(T.timestampValue);if("stringValue"in T)return T.stringValue;if("bytesValue"in T)return n4(T.bytesValue);else if("referenceValue"in T)return n5(T.referenceValue);else if("geoPointValue"in T)return n9(T.geoPointValue);else if("arrayValue"in T)return n7(T.arrayValue);else if("mapValue"in T)return n8(T.mapValue);else return eg(61005,{value:T})}function n4(T){return np(T).toBase64()}function n6(T){let S=nh(T);return`time(${S.seconds},${S.nanos})`}function n9(T){return`geo(${T.latitude},${T.longitude})`}function n5(T){return eG.fromName(T).toString()}function n8(T){let S=Object.keys(T.fields||{}).sort(),R="{",O=!0;for(let N of S)O?O=!1:R+=",",R+=`${N}:${n3(T.fields[N])}`;return R+"}"}function n7(T){let S="[",R=!0;for(let O of T.values||[])R?R=!1:S+=",",S+=n3(O);return S+"]"}function ie(T){switch(nF(T)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let S=nT(T);return S?16+ie(S):16;case 5:return 2*T.stringValue.length;case 6:return np(T.bytesValue).approximateByteSize();case 7:return T.referenceValue.length;case 9:return ii(T.arrayValue);case 10:case 11:return ir(T.mapValue);default:throw eg(13486,{value:T})}}function ir(T){let S=0;return r2(T.fields,(T,R)=>{S+=T.length+ie(R)}),S}function ii(T){return(T.values||[]).reduce((T,S)=>T+ie(S),0)}function is(T,S){return{referenceValue:`projects/${T.projectId}/databases/${T.database}/documents/${S.path.canonicalString()}`}}function ia(T){return!!T&&"integerValue"in T}function io(T){return!!T&&"doubleValue"in T}function il(T){return ia(T)||io(T)}function iu(T){return!!T&&"arrayValue"in T}function ic(T){return!!T&&"nullValue"in T}function ih(T){return!!T&&"doubleValue"in T&&isNaN(Number(T.doubleValue))}function ip(T){return!!T&&"mapValue"in T}function im(T){let S=(T?.mapValue?.fields||{})[nk]?.stringValue;return S===nM}function ig(T){if(T.geoPointValue)return{geoPointValue:{...T.geoPointValue}};if(T.timestampValue&&"object"==typeof T.timestampValue)return{timestampValue:{...T.timestampValue}};if(T.mapValue){let S={mapValue:{fields:{}}};return r2(T.mapValue.fields,(T,R)=>S.mapValue.fields[T]=ig(R)),S}{if(!T.arrayValue)return{...T};let S={arrayValue:{values:[]}};for(let R=0;R<(T.arrayValue.values||[]).length;++R)S.arrayValue.values[R]=ig(T.arrayValue.values[R]);return S}}function iy(T){return(((T.mapValue||{}).fields||{}).__type__||{}).stringValue===nP}let iv={mapValue:{fields:{[nk]:{stringValue:nM},[nx]:{arrayValue:{}}}}};function ib(T){if("nullValue"in T)return nL;if("booleanValue"in T)return{booleanValue:!1};if("integerValue"in T||"doubleValue"in T)return{doubleValue:NaN};if("timestampValue"in T)return{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}};if("stringValue"in T)return{stringValue:""};if("bytesValue"in T)return{bytesValue:""};if("referenceValue"in T)return is(nC.empty(),eG.empty());else if("geoPointValue"in T)return{geoPointValue:{latitude:-90,longitude:-180}};else if("arrayValue"in T)return{arrayValue:{}};else if(!("mapValue"in T))return eg(35942,{value:T});else return im(T)?iv:{mapValue:{}}}function i_(T){if("nullValue"in T)return{booleanValue:!1};if("booleanValue"in T)return{doubleValue:NaN};if("integerValue"in T||"doubleValue"in T)return{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}};if("timestampValue"in T)return{stringValue:""};if("stringValue"in T)return{bytesValue:""};if("bytesValue"in T)return is(nC.empty(),eG.empty());if("referenceValue"in T)return{geoPointValue:{latitude:-90,longitude:-180}};else if("geoPointValue"in T)return{arrayValue:{}};else if("arrayValue"in T)return iv;else if(!("mapValue"in T))return eg(61959,{value:T});else return im(T)?{mapValue:{}}:nD}function iT(T,S){let R=nG(T.value,S.value);return 0!==R?R:T.inclusive&&!S.inclusive?-1:!T.inclusive&&S.inclusive?1:0}function iS(T,S){let R=nG(T.value,S.value);return 0!==R?R:T.inclusive&&!S.inclusive?1:!T.inclusive&&S.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iE{constructor(T){this.value=T}static empty(){return new iE({mapValue:{}})}field(T){if(T.isEmpty())return this.value;{let S=this.value;for(let R=0;R<T.length-1;++R)if(!ip(S=(S.mapValue.fields||{})[T.get(R)]))return null;return(S=(S.mapValue.fields||{})[T.lastSegment()])||null}}set(T,S){let R=this.getFieldsMap(T.popLast());R[T.lastSegment()]=ig(S)}setAll(T){let S=eH.emptyPath(),R={},O=[];T.forEach((T,N)=>{if(!S.isImmediateParentOf(N)){let T=this.getFieldsMap(S);this.applyChanges(T,R,O),R={},O=[],S=N.popLast()}T?R[N.lastSegment()]=ig(T):O.push(N.lastSegment())});let N=this.getFieldsMap(S);this.applyChanges(N,R,O)}delete(T){let S=this.field(T.popLast());ip(S)&&S.mapValue.fields&&delete S.mapValue.fields[T.lastSegment()]}isEqual(T){return nU(this.value,T.value)}getFieldsMap(T){let S=this.value;S.mapValue.fields||(S.mapValue={fields:{}});for(let R=0;R<T.length;++R){let O=S.mapValue.fields[T.get(R)];ip(O)&&O.mapValue.fields||(O={mapValue:{fields:{}}},S.mapValue.fields[T.get(R)]=O),S=O}return S.mapValue.fields}applyChanges(T,S,R){for(let O of(r2(S,(S,R)=>T[S]=R),R))delete T[O]}clone(){return new iE(ig(this.value))}}function iw(T){let S=[];return r2(T.fields,(T,R)=>{let O=new eH([T]);if(ip(R)){let T=iw(R.mapValue),N=T.fields;if(0===N.length)S.push(O);else for(let T of N)S.push(O.child(T))}else S.push(O)}),new nn(S)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(T,S,R,O,N,M,L){this.key=T,this.documentType=S,this.version=R,this.readTime=O,this.createTime=N,this.data=M,this.documentState=L}static newInvalidDocument(T){return new iC(T,0,e2.min(),e2.min(),e2.min(),iE.empty(),0)}static newFoundDocument(T,S,R,O){return new iC(T,1,S,e2.min(),R,O,0)}static newNoDocument(T,S){return new iC(T,2,S,e2.min(),e2.min(),iE.empty(),0)}static newUnknownDocument(T,S){return new iC(T,3,S,e2.min(),e2.min(),iE.empty(),2)}convertToFoundDocument(T,S){return this.createTime.isEqual(e2.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=T),this.version=T,this.documentType=1,this.data=S,this.documentState=0,this}convertToNoDocument(T){return this.version=T,this.documentType=2,this.data=iE.empty(),this.documentState=0,this}convertToUnknownDocument(T){return this.version=T,this.documentType=3,this.data=iE.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=e2.min(),this}setReadTime(T){return this.readTime=T,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(T){return T instanceof iC&&this.key.isEqual(T.key)&&this.version.isEqual(T.version)&&this.documentType===T.documentType&&this.documentState===T.documentState&&this.data.isEqual(T.data)}mutableCopy(){return new iC(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}function iI(T,S,R){let O=S.data.field(T),N=R.data.field(T);return null!==O&&null!==N?nG(O,N):eg(42886)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iR{constructor(T,S){this.position=T,this.inclusive=S}}function iA(T,S,R){let O=0;for(let N=0;N<T.position.length;N++){let M=S[N],L=T.position[N];if(M.field.isKeyField())O=eG.comparator(eG.fromName(L.referenceValue),R.key);else{let T=R.data.field(M.field);O=nG(L,T)}if("desc"===M.dir&&(O*=-1),0!==O)break}return O}function iO(T,S,R){let O=iA(T,S,R);return T.inclusive?O>=0:O>0}function iN(T,S,R){let O=iA(T,S,R);return T.inclusive?O<=0:O<0}function ik(T,S){if(null===T)return null===S;if(null===S||T.inclusive!==S.inclusive||T.position.length!==S.position.length)return!1;for(let R=0;R<T.position.length;R++){let O=T.position[R],N=S.position[R];if(!nU(O,N))return!1}return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(T,S="asc"){this.field=T,this.dir=S}}function iD(T){return T.field.canonicalString()+T.dir}function iM(T){return`${T.field.canonicalString()} (${T.dir})`}function ix(T,S){return T.dir===S.dir&&T.field.isEqual(S.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iL{}class iF extends iL{constructor(T,S,R){super(),this.field=T,this.op=S,this.value=R}static create(T,S,R){return T.isKeyField()?"in"===S||"not-in"===S?this.createKeyFieldInFilter(T,S,R):new iJ(T,S,R):"array-contains"===S?new i1(T,R):"in"===S?new i2(T,R):"not-in"===S?new i3(T,R):"array-contains-any"===S?new i4(T,R):new iF(T,S,R)}static createKeyFieldInFilter(T,S,R){return"in"===S?new iX(T,R):new iZ(T,R)}matches(T){let S=T.data.field(this.field);return"!="===this.op?null!==S&&void 0===S.nullValue&&this.matchesComparison(nG(S,this.value)):null!==S&&nF(this.value)===nF(S)&&this.matchesComparison(nG(S,this.value))}matchesComparison(T){switch(this.op){case"<":return T<0;case"<=":return T<=0;case"==":return 0===T;case"!=":return 0!==T;case">":return T>0;case">=":return T>=0;default:return eg(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class iU extends iL{constructor(T,S){super(),this.filters=T,this.op=S,this.memoizedFlattenedFilters=null}static create(T,S){return new iU(T,S)}matches(T){return ij(this)?void 0===this.filters.find(S=>!S.matches(T)):void 0!==this.filters.find(S=>S.matches(T))}getFlattenedFilters(){return null!==this.memoizedFlattenedFilters||(this.memoizedFlattenedFilters=this.filters.reduce((T,S)=>T.concat(S.getFlattenedFilters()),[])),this.memoizedFlattenedFilters}getFilters(){return Object.assign([],this.filters)}}function ij(T){return"and"===T.op}function iB(T){return"or"===T.op}function iV(T){return iz(T)&&ij(T)}function iz(T){for(let S of T.filters)if(S instanceof iU)return!1;return!0}function iq(T){if(T instanceof iF)return T.field.canonicalString()+T.op.toString()+n0(T.value);if(iV(T))return T.filters.map(T=>iq(T)).join(",");{let S=T.filters.map(T=>iq(T)).join(",");return`${T.op}(${S})`}}function iH(T,S){return T instanceof iF?iG(T,S):T instanceof iU?iW(T,S):void eg(19439)}function iG(T,S){return S instanceof iF&&T.op===S.op&&T.field.isEqual(S.field)&&nU(T.value,S.value)}function iW(T,S){if(S instanceof iU&&T.op===S.op&&T.filters.length===S.filters.length){let R=T.filters.reduce((T,R,O)=>T&&iH(R,S.filters[O]),!0);return R}return!1}function iK(T,S){let R=T.filters.concat(S);return iU.create(R,T.op)}function i$(T){return T instanceof iF?iY(T):T instanceof iU?iQ(T):"Filter"}function iQ(T){return T.op.toString()+" {"+T.getFilters().map(i$).join(" ,")+"}"}function iY(T){return`${T.field.canonicalString()} ${T.op} ${n0(T.value)}`}class iJ extends iF{constructor(T,S,R){super(T,S,R),this.key=eG.fromName(R.referenceValue)}matches(T){let S=eG.comparator(T.key,this.key);return this.matchesComparison(S)}}class iX extends iF{constructor(T,S){super(T,"in",S),this.keys=i0("in",S)}matches(T){return this.keys.some(S=>S.isEqual(T.key))}}class iZ extends iF{constructor(T,S){super(T,"not-in",S),this.keys=i0("not-in",S)}matches(T){return!this.keys.some(S=>S.isEqual(T.key))}}function i0(T,S){return(S.arrayValue?.values||[]).map(T=>eG.fromName(T.referenceValue))}class i1 extends iF{constructor(T,S){super(T,"array-contains",S)}matches(T){let S=T.data.field(this.field);return iu(S)&&nH(S.arrayValue,this.value)}}class i2 extends iF{constructor(T,S){super(T,"in",S)}matches(T){let S=T.data.field(this.field);return null!==S&&nH(this.value.arrayValue,S)}}class i3 extends iF{constructor(T,S){super(T,"not-in",S)}matches(T){if(nH(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let S=T.data.field(this.field);return null!==S&&void 0===S.nullValue&&!nH(this.value.arrayValue,S)}}class i4 extends iF{constructor(T,S){super(T,"array-contains-any",S)}matches(T){let S=T.data.field(this.field);return!!iu(S)&&!!S.arrayValue.values&&S.arrayValue.values.some(T=>nH(this.value.arrayValue,T))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i6{constructor(T,S=null,R=[],O=[],N=null,M=null,L=null){this.path=T,this.collectionGroup=S,this.orderBy=R,this.filters=O,this.limit=N,this.startAt=M,this.endAt=L,this.memoizedCanonicalId=null}}function i9(T,S=null,R=[],O=[],N=null,M=null,L=null){return new i6(T,S,R,O,N,M,L)}function i5(T){let S=eb(T);if(null===S.memoizedCanonicalId){let T=S.path.canonicalString();null!==S.collectionGroup&&(T+="|cg:"+S.collectionGroup),T+="|f:"+S.filters.map(T=>iq(T)).join(",")+"|ob:"+S.orderBy.map(T=>iD(T)).join(","),nA(S.limit)||(T+="|l:"+S.limit),S.startAt&&(T+="|lb:"+(S.startAt.inclusive?"b:":"a:")+S.startAt.position.map(T=>n0(T)).join(",")),S.endAt&&(T+="|ub:"+(S.endAt.inclusive?"a:":"b:")+S.endAt.position.map(T=>n0(T)).join(",")),S.memoizedCanonicalId=T}return S.memoizedCanonicalId}function i8(T){let S=T.path.canonicalString();return null!==T.collectionGroup&&(S+=" collectionGroup="+T.collectionGroup),T.filters.length>0&&(S+=`, filters: [${T.filters.map(T=>i$(T)).join(", ")}]`),nA(T.limit)||(S+=", limit: "+T.limit),T.orderBy.length>0&&(S+=`, orderBy: [${T.orderBy.map(T=>iM(T)).join(", ")}]`),T.startAt&&(S+=", startAt: "+(T.startAt.inclusive?"b:":"a:")+T.startAt.position.map(T=>n0(T)).join(",")),T.endAt&&(S+=", endAt: "+(T.endAt.inclusive?"a:":"b:")+T.endAt.position.map(T=>n0(T)).join(",")),`Target(${S})`}function i7(T,S){if(T.limit!==S.limit||T.orderBy.length!==S.orderBy.length)return!1;for(let R=0;R<T.orderBy.length;R++)if(!ix(T.orderBy[R],S.orderBy[R]))return!1;if(T.filters.length!==S.filters.length)return!1;for(let R=0;R<T.filters.length;R++)if(!iH(T.filters[R],S.filters[R]))return!1;return!!(T.collectionGroup===S.collectionGroup&&T.path.isEqual(S.path)&&ik(T.startAt,S.startAt))&&ik(T.endAt,S.endAt)}function se(T){return eG.isDocumentKey(T.path)&&null===T.collectionGroup&&0===T.filters.length}function st(T,S){return T.filters.filter(T=>T instanceof iF&&T.field.isEqual(S))}function sr(T,S){let R=e9(S);if(void 0===R)return null;for(let S of st(T,R.fieldPath))switch(S.op){case"array-contains-any":return S.value.arrayValue.values||[];case"array-contains":return[S.value]}return null}function sn(T,S){let R=new Map;for(let O of e5(S))for(let S of st(T,O.fieldPath))switch(S.op){case"==":case"in":R.set(O.fieldPath.canonicalString(),S.value);break;case"not-in":case"!=":return R.set(O.fieldPath.canonicalString(),S.value),Array.from(R.values())}return null}function si(T,S){let R=[],O=!0;for(let N of e5(S)){let S=0===N.kind?sa(T,N.fieldPath,T.startAt):so(T,N.fieldPath,T.startAt);R.push(S.value),O&&(O=S.inclusive)}return new iR(R,O)}function ss(T,S){let R=[],O=!0;for(let N of e5(S)){let S=0===N.kind?so(T,N.fieldPath,T.endAt):sa(T,N.fieldPath,T.endAt);R.push(S.value),O&&(O=S.inclusive)}return new iR(R,O)}function sa(T,S,R){let O=nL,N=!0;for(let R of st(T,S)){let T=nL,S=!0;switch(R.op){case"<":case"<=":T=ib(R.value);break;case"==":case"in":case">=":T=R.value;break;case">":T=R.value,S=!1;break;case"!=":case"not-in":T=nL}0>iT({value:O,inclusive:N},{value:T,inclusive:S})&&(O=T,N=S)}if(null!==R)for(let M=0;M<T.orderBy.length;++M){let L=T.orderBy[M];if(L.field.isEqual(S)){let T=R.position[M];0>iT({value:O,inclusive:N},{value:T,inclusive:R.inclusive})&&(O=T,N=R.inclusive);break}}return{value:O,inclusive:N}}function so(T,S,R){let O=nD,N=!0;for(let R of st(T,S)){let T=nD,S=!0;switch(R.op){case">=":case">":T=i_(R.value),S=!1;break;case"==":case"in":case"<=":T=R.value;break;case"<":T=R.value,S=!1;break;case"!=":case"not-in":T=nD}iS({value:O,inclusive:N},{value:T,inclusive:S})>0&&(O=T,N=S)}if(null!==R)for(let M=0;M<T.orderBy.length;++M){let L=T.orderBy[M];if(L.field.isEqual(S)){let T=R.position[M];iS({value:O,inclusive:N},{value:T,inclusive:R.inclusive})>0&&(O=T,N=R.inclusive);break}}return{value:O,inclusive:N}}function sl(T){let S=new r8(eH.comparator),R=!1;for(let O of T.filters)for(let T of O.getFlattenedFilters())T.field.isKeyField()||("array-contains"===T.op||"array-contains-any"===T.op?R=!0:S=S.add(T.field));for(let R of T.orderBy)R.field.isKeyField()||(S=S.add(R.field));return S.size+(R?1:0)}function su(T){return null!==T.limit}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(T,S=null,R=[],O=[],N=null,M="F",L=null,U=null){this.path=T,this.collectionGroup=S,this.explicitOrderBy=R,this.filters=O,this.limit=N,this.limitType=M,this.startAt=L,this.endAt=U,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}}function sd(T,S,R,O,N,M,L,U){return new sc(T,S,R,O,N,M,L,U)}function sh(T){return new sc(T)}function sf(T,S){return new sc(S,null,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)}function sp(T){return 0===T.filters.length&&null===T.limit&&null==T.startAt&&null==T.endAt&&(0===T.explicitOrderBy.length||1===T.explicitOrderBy.length&&T.explicitOrderBy[0].field.isKeyField())}function sm(T){let S=new r8(eH.comparator);return T.filters.forEach(T=>{let R=T.getFlattenedFilters();R.forEach(T=>{T.isInequality()&&(S=S.add(T.field))})}),S}function sg(T){return eG.isDocumentKey(T.path)&&null===T.collectionGroup&&0===T.filters.length}function sy(T){return null!==T.collectionGroup}function sv(T){let S=eb(T);if(null===S.memoizedNormalizedOrderBy){S.memoizedNormalizedOrderBy=[];let T=new Set;for(let R of S.explicitOrderBy)S.memoizedNormalizedOrderBy.push(R),T.add(R.field.canonicalString());let R=S.explicitOrderBy.length>0?S.explicitOrderBy[S.explicitOrderBy.length-1].dir:"asc",O=sm(S);O.forEach(O=>{T.has(O.canonicalString())||O.isKeyField()||S.memoizedNormalizedOrderBy.push(new iP(O,R))}),T.has(eH.keyField().canonicalString())||S.memoizedNormalizedOrderBy.push(new iP(eH.keyField(),R))}return S.memoizedNormalizedOrderBy}function sb(T){let S=eb(T);return S.memoizedTarget||(S.memoizedTarget=sT(S,sv(T))),S.memoizedTarget}function s_(T){let S=eb(T);return S.memoizedAggregateTarget||(S.memoizedAggregateTarget=sT(S,T.explicitOrderBy)),S.memoizedAggregateTarget}function sT(T,S){if("F"===T.limitType)return i9(T.path,T.collectionGroup,S,T.filters,T.limit,T.startAt,T.endAt);{S=S.map(T=>{let S="desc"===T.dir?"asc":"desc";return new iP(T.field,S)});let R=T.endAt?new iR(T.endAt.position,T.endAt.inclusive):null,O=T.startAt?new iR(T.startAt.position,T.startAt.inclusive):null;return i9(T.path,T.collectionGroup,S,T.filters,T.limit,R,O)}}function sS(T,S){let R=T.filters.concat([S]);return new sc(T.path,T.collectionGroup,T.explicitOrderBy.slice(),R,T.limit,T.limitType,T.startAt,T.endAt)}function sE(T,S){let R=T.explicitOrderBy.concat([S]);return new sc(T.path,T.collectionGroup,R,T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)}function sw(T,S,R){return new sc(T.path,T.collectionGroup,T.explicitOrderBy.slice(),T.filters.slice(),S,R,T.startAt,T.endAt)}function sC(T,S){return new sc(T.path,T.collectionGroup,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,S,T.endAt)}function sI(T,S){return new sc(T.path,T.collectionGroup,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,S)}function sR(T,S){return i7(sb(T),sb(S))&&T.limitType===S.limitType}function sA(T){return`${i5(sb(T))}|lt:${T.limitType}`}function sO(T){return`Query(target=${i8(sb(T))}; limitType=${T.limitType})`}function sN(T,S){return S.isFoundDocument()&&sk(T,S)&&sP(T,S)&&sD(T,S)&&sM(T,S)}function sk(T,S){let R=S.key.path;return null!==T.collectionGroup?S.key.hasCollectionId(T.collectionGroup)&&T.path.isPrefixOf(R):eG.isDocumentKey(T.path)?T.path.isEqual(R):T.path.isImmediateParentOf(R)}function sP(T,S){for(let R of sv(T))if(!R.field.isKeyField()&&null===S.data.field(R.field))return!1;return!0}function sD(T,S){for(let R of T.filters)if(!R.matches(S))return!1;return!0}function sM(T,S){return(!T.startAt||!!iN(T.startAt,sv(T),S))&&(!T.endAt||!!iO(T.endAt,sv(T),S))}function sx(T){return T.collectionGroup||(T.path.length%2==1?T.path.lastSegment():T.path.get(T.path.length-2))}function sL(T){return(S,R)=>{let O=!1;for(let N of sv(T)){let T=sF(N,S,R);if(0!==T)return T;O=O||N.field.isKeyField()}return 0}}function sF(T,S,R){let O=T.field.isKeyField()?eG.comparator(S.key,R.key):iI(T.field,S,R);switch(T.dir){case"asc":return O;case"desc":return -1*O;default:return eg(19790,{direction:T.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sU{constructor(T,S){this.mapKeyFn=T,this.equalsFn=S,this.inner={},this.innerSize=0}get(T){let S=this.mapKeyFn(T),R=this.inner[S];if(void 0!==R){for(let[S,O]of R)if(this.equalsFn(S,T))return O}}has(T){return void 0!==this.get(T)}set(T,S){let R=this.mapKeyFn(T),O=this.inner[R];if(void 0===O){this.inner[R]=[[T,S]],this.innerSize++;return}for(let R=0;R<O.length;R++)if(this.equalsFn(O[R][0],T)){O[R]=[T,S];return}O.push([T,S]),this.innerSize++}delete(T){let S=this.mapKeyFn(T),R=this.inner[S];if(void 0===R)return!1;for(let O=0;O<R.length;O++)if(this.equalsFn(R[O][0],T))return 1===R.length?delete this.inner[S]:R.splice(O,1),this.innerSize--,!0;return!1}forEach(T){r2(this.inner,(S,R)=>{for(let[S,O]of R)T(S,O)})}isEmpty(){return r3(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sj=new r4(eG.comparator);function sB(){return sj}let sV=new r4(eG.comparator);function sz(...T){let S=sV;for(let R of T)S=S.insert(R.key,R);return S}function sq(){return sK()}function sH(T){let S=sV;return T.forEach((T,R)=>S=S.insert(T,R.overlayedDocument)),S}function sG(){return sK()}function sW(){return sK()}function sK(){return new sU(T=>T.toString(),(T,S)=>T.isEqual(S))}let s$=new r4(eG.comparator);function sQ(){return s$}let sY=new r8(eG.comparator);function sJ(...T){let S=sY;for(let R of T)S=S.add(R);return S}let sX=new r8(eD);function sZ(){return sX}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s0(T,S){if(T.useProto3Json){if(isNaN(S))return{doubleValue:"NaN"};if(S===1/0)return{doubleValue:"Infinity"};if(S===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:nO(S)?"-0":S}}function s1(T){return{integerValue:""+T}}function s2(T,S){return nN(S)?s1(S):s0(T,S)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s3{constructor(){this._=void 0}}function s4(T,S,R){return T instanceof s8?n_(R,S):T instanceof s7?ae(T,S):T instanceof at?ar(T,S):ai(T,S)}function s6(T,S,R){return T instanceof s7?ae(T,S):T instanceof at?ar(T,S):R}function s9(T,S){return T instanceof an?il(S)?S:{integerValue:0}:null}function s5(T,S){return T instanceof s7&&S instanceof s7||T instanceof at&&S instanceof at?eU(T.elements,S.elements,nU):T instanceof an&&S instanceof an?nU(T.operand,S.operand):T instanceof s8&&S instanceof s8}class s8 extends s3{}class s7 extends s3{constructor(T){super(),this.elements=T}}function ae(T,S){let R=aa(S);for(let S of T.elements)R.some(T=>nU(T,S))||R.push(S);return{arrayValue:{values:R}}}class at extends s3{constructor(T){super(),this.elements=T}}function ar(T,S){let R=aa(S);for(let S of T.elements)R=R.filter(T=>!nU(T,S));return{arrayValue:{values:R}}}class an extends s3{constructor(T,S){super(),this.serializer=T,this.operand=S}}function ai(T,S){let R=s9(T,S),O=as(R)+as(T.operand);return ia(R)&&ia(T.operand)?s1(O):s0(T.serializer,O)}function as(T){return nf(T.integerValue||T.doubleValue)}function aa(T){return iu(T)&&T.arrayValue.values?T.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(T,S){this.field=T,this.transform=S}}function al(T,S){return T.field.isEqual(S.field)&&s5(T.transform,S.transform)}function au(T,S){return void 0===T&&void 0===S||!!T&&!!S&&eU(T,S,(T,S)=>al(T,S))}class ac{constructor(T,S){this.version=T,this.transformResults=S}}class ad{constructor(T,S){this.updateTime=T,this.exists=S}static none(){return new ad}static exists(T){return new ad(void 0,T)}static updateTime(T){return new ad(T)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(T){return this.exists===T.exists&&(this.updateTime?!!T.updateTime&&this.updateTime.isEqual(T.updateTime):!T.updateTime)}}function ah(T,S){return void 0!==T.updateTime?S.isFoundDocument()&&S.version.isEqual(T.updateTime):void 0===T.exists||T.exists===S.isFoundDocument()}class af{}function ap(T,S){if(!T.hasLocalMutations||S&&0===S.fields.length)return null;if(null===S)return T.isNoDocument()?new aA(T.key,ad.none()):new ab(T.key,T.data,ad.none());{let R=T.data,O=iE.empty(),N=new r8(eH.comparator);for(let T of S.fields)if(!N.has(T)){let S=R.field(T);null===S&&T.length>1&&(T=T.popLast(),S=R.field(T)),null===S?O.delete(T):O.set(T,S),N=N.add(T)}return new aS(T.key,O,new nn(N.toArray()),ad.none())}}function am(T,S,R){T instanceof ab?a_(T,S,R):T instanceof aS?aE(T,S,R):aO(T,S,R)}function ag(T,S,R,O){return T instanceof ab?aT(T,S,R,O):T instanceof aS?aw(T,S,R,O):aN(T,S,R)}function ay(T,S){let R=null;for(let O of T.fieldTransforms){let T=S.data.field(O.field),N=s9(O.transform,T||null);null!=N&&(null===R&&(R=iE.empty()),R.set(O.field,N))}return R||null}function av(T,S){return!!(T.type===S.type&&T.key.isEqual(S.key)&&T.precondition.isEqual(S.precondition)&&au(T.fieldTransforms,S.fieldTransforms))&&(0===T.type?T.value.isEqual(S.value):1!==T.type||T.data.isEqual(S.data)&&T.fieldMask.isEqual(S.fieldMask))}class ab extends af{constructor(T,S,R,O=[]){super(),this.key=T,this.value=S,this.precondition=R,this.fieldTransforms=O,this.type=0}getFieldMask(){return null}}function a_(T,S,R){let O=T.value.clone(),N=aI(T.fieldTransforms,S,R.transformResults);O.setAll(N),S.convertToFoundDocument(R.version,O).setHasCommittedMutations()}function aT(T,S,R,O){if(!ah(T.precondition,S))return R;let N=T.value.clone(),M=aR(T.fieldTransforms,O,S);return N.setAll(M),S.convertToFoundDocument(S.version,N).setHasLocalMutations(),null}class aS extends af{constructor(T,S,R,O,N=[]){super(),this.key=T,this.data=S,this.fieldMask=R,this.precondition=O,this.fieldTransforms=N,this.type=1}getFieldMask(){return this.fieldMask}}function aE(T,S,R){if(!ah(T.precondition,S)){S.convertToUnknownDocument(R.version);return}let O=aI(T.fieldTransforms,S,R.transformResults),N=S.data;N.setAll(aC(T)),N.setAll(O),S.convertToFoundDocument(R.version,N).setHasCommittedMutations()}function aw(T,S,R,O){if(!ah(T.precondition,S))return R;let N=aR(T.fieldTransforms,O,S),M=S.data;return(M.setAll(aC(T)),M.setAll(N),S.convertToFoundDocument(S.version,M).setHasLocalMutations(),null===R)?null:R.unionWith(T.fieldMask.fields).unionWith(T.fieldTransforms.map(T=>T.field))}function aC(T){let S=new Map;return T.fieldMask.fields.forEach(R=>{if(!R.isEmpty()){let O=T.data.field(R);S.set(R,O)}}),S}function aI(T,S,R){let O=new Map;ev(T.length===R.length,32656,{serverTransformResultCount:R.length,fieldTransformCount:T.length});for(let N=0;N<R.length;N++){let M=T[N],L=M.transform,U=S.data.field(M.field);O.set(M.field,s6(L,U,R[N]))}return O}function aR(T,S,R){let O=new Map;for(let N of T){let T=N.transform,M=R.data.field(N.field);O.set(N.field,s4(T,M,S))}return O}class aA extends af{constructor(T,S){super(),this.key=T,this.precondition=S,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}function aO(T,S,R){S.convertToNoDocument(R.version).setHasCommittedMutations()}function aN(T,S,R){return ah(T.precondition,S)?(S.convertToNoDocument(S.version).setHasLocalMutations(),null):R}class ak extends null{constructor(T,S){super(),this.key=T,this.precondition=S,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{constructor(T,S,R,O){this.batchId=T,this.localWriteTime=S,this.baseMutations=R,this.mutations=O}applyToRemoteDocument(T,S){let R=S.mutationResults;for(let S=0;S<this.mutations.length;S++){let O=this.mutations[S];if(O.key.isEqual(T.key)){let N=R[S];am(O,T,N)}}}applyToLocalView(T,S){for(let R of this.baseMutations)R.key.isEqual(T.key)&&(S=ag(R,T,S,this.localWriteTime));for(let R of this.mutations)R.key.isEqual(T.key)&&(S=ag(R,T,S,this.localWriteTime));return S}applyToLocalDocumentSet(T,S){let R=sW();return this.mutations.forEach(O=>{let N=T.get(O.key),M=N.overlayedDocument,L=this.applyToLocalView(M,N.mutatedFields);L=S.has(O.key)?null:L;let U=ap(M,L);null!==U&&R.set(O.key,U),M.isValidDocument()||M.convertToNoDocument(e2.min())}),R}keys(){return this.mutations.reduce((T,S)=>T.add(S.key),sJ())}isEqual(T){return this.batchId===T.batchId&&eU(this.mutations,T.mutations,(T,S)=>av(T,S))&&eU(this.baseMutations,T.baseMutations,(T,S)=>av(T,S))}}class aD{constructor(T,S,R,O){this.batch=T,this.commitVersion=S,this.mutationResults=R,this.docVersions=O}static from(T,S,R){ev(T.mutations.length===R.length,58842,{mutationsSent:T.mutations.length,resultsReceived:R.length});let O=sQ(),N=T.mutations;for(let T=0;T<N.length;T++)O=O.insert(N[T].key,R[T].version);return new aD(T,S,R,O)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aM{constructor(T,S){this.largestBatchId=T,this.mutation=S}getKey(){return this.mutation.key}isEqual(T){return null!==T&&this.mutation===T.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ax{constructor(T,S){this.count=T,this.unchangedNames=S}}function aL(T){switch(T){case e_.OK:return eg(64938);case e_.CANCELLED:case e_.UNKNOWN:case e_.DEADLINE_EXCEEDED:case e_.RESOURCE_EXHAUSTED:case e_.INTERNAL:case e_.UNAVAILABLE:case e_.UNAUTHENTICATED:return!1;case e_.INVALID_ARGUMENT:case e_.NOT_FOUND:case e_.ALREADY_EXISTS:case e_.PERMISSION_DENIED:case e_.FAILED_PRECONDITION:case e_.ABORTED:case e_.OUT_OF_RANGE:case e_.UNIMPLEMENTED:case e_.DATA_LOSS:return!0;default:return eg(15467,{code:T})}}function aF(T){return aL(T)&&T!==e_.ABORTED}function aU(T){if(void 0===T)return ef("GRPC error has no .code"),e_.UNKNOWN;switch(T){case M.OK:return e_.OK;case M.CANCELLED:return e_.CANCELLED;case M.UNKNOWN:return e_.UNKNOWN;case M.DEADLINE_EXCEEDED:return e_.DEADLINE_EXCEEDED;case M.RESOURCE_EXHAUSTED:return e_.RESOURCE_EXHAUSTED;case M.INTERNAL:return e_.INTERNAL;case M.UNAVAILABLE:return e_.UNAVAILABLE;case M.UNAUTHENTICATED:return e_.UNAUTHENTICATED;case M.INVALID_ARGUMENT:return e_.INVALID_ARGUMENT;case M.NOT_FOUND:return e_.NOT_FOUND;case M.ALREADY_EXISTS:return e_.ALREADY_EXISTS;case M.PERMISSION_DENIED:return e_.PERMISSION_DENIED;case M.FAILED_PRECONDITION:return e_.FAILED_PRECONDITION;case M.ABORTED:return e_.ABORTED;case M.OUT_OF_RANGE:return e_.OUT_OF_RANGE;case M.UNIMPLEMENTED:return e_.UNIMPLEMENTED;case M.DATA_LOSS:return e_.DATA_LOSS;default:return eg(39323,{code:T})}}!function(T){T[T.OK=0]="OK",T[T.CANCELLED=1]="CANCELLED",T[T.UNKNOWN=2]="UNKNOWN",T[T.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",T[T.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",T[T.NOT_FOUND=5]="NOT_FOUND",T[T.ALREADY_EXISTS=6]="ALREADY_EXISTS",T[T.PERMISSION_DENIED=7]="PERMISSION_DENIED",T[T.UNAUTHENTICATED=16]="UNAUTHENTICATED",T[T.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",T[T.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",T[T.ABORTED=10]="ABORTED",T[T.OUT_OF_RANGE=11]="OUT_OF_RANGE",T[T.UNIMPLEMENTED=12]="UNIMPLEMENTED",T[T.INTERNAL=13]="INTERNAL",T[T.UNAVAILABLE=14]="UNAVAILABLE",T[T.DATA_LOSS=15]="DATA_LOSS"}(M||(M={}));/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj extends null{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let aB=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aV(){return new $.TextEncoder}function az(){return new TextDecoder("utf-8")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let aq=new O([4294967295,4294967295],0);function aH(T){let S=aV().encode(T),R=new Md5;return R.update(S),new Uint8Array(R.digest())}function aG(T){let S=new DataView(T.buffer),R=S.getUint32(0,!0),O=S.getUint32(4,!0),N=S.getUint32(8,!0),M=S.getUint32(12,!0),L=new Integer([R,O],0),U=new Integer([N,M],0);return[L,U]}class aW{constructor(T,S,R){if(this.bitmap=T,this.padding=S,this.hashCount=R,S<0||S>=8)throw new aK(`Invalid padding: ${S}`);if(R<0||T.length>0&&0===this.hashCount)throw new aK(`Invalid hash count: ${R}`);if(0===T.length&&0!==S)throw new aK(`Invalid padding when bitmap length is 0: ${S}`);this.bitCount=8*T.length-S,this.bitCountInInteger=Integer.fromNumber(this.bitCount)}getBitIndex(T,S,R){let O=T.add(S.multiply(Integer.fromNumber(R)));return 1===O.compare(aq)&&(O=new Integer([O.getBits(0),O.getBits(1)],0)),O.modulo(this.bitCountInInteger).toNumber()}isBitSet(T){let S=this.bitmap[Math.floor(T/8)],R=T%8;return(S&1<<R)!=0}mightContain(T){if(0===this.bitCount)return!1;let S=aH(T),[R,O]=aG(S);for(let T=0;T<this.hashCount;T++){let S=this.getBitIndex(R,O,T);if(!this.isBitSet(S))return!1}return!0}static create(T,S,R){let O=T%8==0?0:8-T%8,N=new Uint8Array(Math.ceil(T/8)),M=new aW(N,O,S);return R.forEach(T=>M.insert(T)),M}insert(T){if(0===this.bitCount)return;let S=aH(T),[R,O]=aG(S);for(let T=0;T<this.hashCount;T++){let S=this.getBitIndex(R,O,T);this.setBit(S)}}setBit(T){let S=Math.floor(T/8),R=T%8;this.bitmap[S]|=1<<R}}class aK extends null{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a${constructor(T,S,R,O,N){this.snapshotVersion=T,this.targetChanges=S,this.targetMismatches=R,this.documentUpdates=O,this.resolvedLimboDocuments=N}static createSynthesizedRemoteEventForCurrentChange(T,S,R){let O=new Map;return O.set(T,aQ.createSynthesizedTargetChangeForCurrentChange(T,S,R)),new a$(e2.min(),O,new r4(eD),sB(),sJ())}}class aQ{constructor(T,S,R,O,N){this.resumeToken=T,this.current=S,this.addedDocuments=R,this.modifiedDocuments=O,this.removedDocuments=N}static createSynthesizedTargetChangeForCurrentChange(T,S,R){return new aQ(R,S,sJ(),sJ(),sJ())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aY{constructor(T,S,R,O){this.updatedTargetIds=T,this.removedTargetIds=S,this.key=R,this.newDoc=O}}class aJ{constructor(T,S){this.targetId=T,this.existenceFilter=S}}class aX{constructor(T,S,R=no.EMPTY_BYTE_STRING,O=null){this.state=T,this.targetIds=S,this.resumeToken=R,this.cause=O}}class aZ{constructor(){this.pendingResponses=0,this.documentChanges=a3(),this._resumeToken=no.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}get current(){return this._current}get resumeToken(){return this._resumeToken}get isPending(){return 0!==this.pendingResponses}get hasPendingChanges(){return this._hasPendingChanges}updateResumeToken(T){T.approximateByteSize()>0&&(this._hasPendingChanges=!0,this._resumeToken=T)}toTargetChange(){let T=sJ(),S=sJ(),R=sJ();return this.documentChanges.forEach((O,N)=>{switch(N){case 0:T=T.add(O);break;case 2:S=S.add(O);break;case 1:R=R.add(O);break;default:eg(38017,{changeType:N})}}),new aQ(this._resumeToken,this._current,T,S,R)}clearPendingChanges(){this._hasPendingChanges=!1,this.documentChanges=a3()}addDocumentChange(T,S){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(T,S)}removeDocumentChange(T){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(T)}recordPendingTargetRequest(){this.pendingResponses+=1}recordTargetResponse(){this.pendingResponses-=1,ev(this.pendingResponses>=0,3241,{pendingResponses:this.pendingResponses})}markCurrent(){this._hasPendingChanges=!0,this._current=!0}}let a0="WatchChangeAggregator";class a1{constructor(T){this.metadataProvider=T,this.targetStates=new Map,this.pendingDocumentUpdates=sB(),this.pendingDocumentUpdatesByTarget=a2(),this.pendingDocumentTargetMapping=a2(),this.pendingTargetResets=new r4(eD)}handleDocumentChange(T){for(let S of T.updatedTargetIds)T.newDoc&&T.newDoc.isFoundDocument()?this.addDocumentToTarget(S,T.newDoc):this.removeDocumentFromTarget(S,T.key,T.newDoc);for(let S of T.removedTargetIds)this.removeDocumentFromTarget(S,T.key,T.newDoc)}handleTargetChange(T){this.forEachTarget(T,S=>{let R=this.ensureTargetState(S);switch(T.state){case 0:this.isActiveTarget(S)&&R.updateResumeToken(T.resumeToken);break;case 1:R.recordTargetResponse(),R.isPending||R.clearPendingChanges(),R.updateResumeToken(T.resumeToken);break;case 2:R.recordTargetResponse(),R.isPending||this.removeTarget(S);break;case 3:this.isActiveTarget(S)&&(R.markCurrent(),R.updateResumeToken(T.resumeToken));break;case 4:this.isActiveTarget(S)&&(this.resetTarget(S),R.updateResumeToken(T.resumeToken));break;default:eg(56790,{state:T.state})}})}forEachTarget(T,S){T.targetIds.length>0?T.targetIds.forEach(S):this.targetStates.forEach((T,R)=>{this.isActiveTarget(R)&&S(R)})}handleExistenceFilter(T){let S=T.targetId,R=T.existenceFilter.count,O=this.targetDataForActiveTarget(S);if(O){let N=O.target;if(se(N)){if(0===R){let T=new eG(N.path);this.removeDocumentFromTarget(S,T,iC.newNoDocument(T,e2.min()))}else ev(1===R,20013,{expectedCount:R})}else{let O=this.getCurrentDocumentCountForTarget(S);if(O!==R){let R=this.parseBloomFilter(T),N=R?this.applyBloomFilter(R,T,O):1;if(0!==N){this.resetTarget(S);let T=2===N?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.pendingTargetResets=this.pendingTargetResets.insert(S,T)}aB?.notifyOnExistenceFilterMismatch(a4(O,T.existenceFilter,this.metadataProvider.getDatabaseId(),R,N))}}}}parseBloomFilter(T){let S,R;let O=T.existenceFilter.unchangedNames;if(!O||!O.bits)return null;let{bits:{bitmap:N="",padding:M=0},hashCount:L=0}=O;try{S=np(N).toUint8Array()}catch(T){if(T instanceof aj)return ep("Decoding the base64 bloom filter in existence filter failed ("+T.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw T}try{R=new aW(S,M,L)}catch(T){return T instanceof aK?ep("BloomFilter error: ",T):ep("Applying bloom filter failed: ",T),null}return 0===R.bitCount?null:R}applyBloomFilter(T,S,R){let O=S.existenceFilter.count,N=this.filterRemovedDocuments(T,S.targetId);return O===R-N?0:2}filterRemovedDocuments(T,S){let R=this.metadataProvider.getRemoteKeysForTarget(S),O=0;return R.forEach(R=>{let N=this.metadataProvider.getDatabaseId(),M=`projects/${N.projectId}/databases/${N.database}/documents/${R.path.canonicalString()}`;!T.mightContain(M)&&(this.removeDocumentFromTarget(S,R,null),O++)}),O}createRemoteEvent(T){let S=new Map;this.targetStates.forEach((R,O)=>{let N=this.targetDataForActiveTarget(O);if(N){if(R.current&&se(N.target)){let S=new eG(N.target.path);this.ensureDocumentUpdateByTarget(S).has(O)||this.targetContainsDocument(O,S)||this.removeDocumentFromTarget(O,S,iC.newNoDocument(S,T))}R.hasPendingChanges&&(S.set(O,R.toTargetChange()),R.clearPendingChanges())}});let R=sJ();this.pendingDocumentTargetMapping.forEach((T,S)=>{let O=!0;S.forEachWhile(T=>{let S=this.targetDataForActiveTarget(T);return!S||"TargetPurposeLimboResolution"===S.purpose||(O=!1,!1)}),O&&(R=R.add(T))}),this.pendingDocumentUpdates.forEach((S,R)=>R.setReadTime(T));let O=new a$(T,S,this.pendingTargetResets,this.pendingDocumentUpdates,R);return this.pendingDocumentUpdates=sB(),this.pendingDocumentUpdatesByTarget=a2(),this.pendingDocumentTargetMapping=a2(),this.pendingTargetResets=new r4(eD),O}addDocumentToTarget(T,S){if(!this.isActiveTarget(T))return;let R=this.targetContainsDocument(T,S.key)?2:0,O=this.ensureTargetState(T);O.addDocumentChange(S.key,R),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(S.key,S),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(S.key,this.ensureDocumentUpdateByTarget(S.key).add(T)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(S.key,this.ensureDocumentTargetMapping(S.key).add(T))}removeDocumentFromTarget(T,S,R){if(!this.isActiveTarget(T))return;let O=this.ensureTargetState(T);this.targetContainsDocument(T,S)?O.addDocumentChange(S,1):O.removeDocumentChange(S),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(S,this.ensureDocumentTargetMapping(S).delete(T)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(S,this.ensureDocumentTargetMapping(S).add(T)),R&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(S,R))}removeTarget(T){this.targetStates.delete(T)}getCurrentDocumentCountForTarget(T){let S=this.ensureTargetState(T),R=S.toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(T).size+R.addedDocuments.size-R.removedDocuments.size}recordPendingTargetRequest(T){let S=this.ensureTargetState(T);S.recordPendingTargetRequest()}ensureTargetState(T){let S=this.targetStates.get(T);return S||(S=new aZ,this.targetStates.set(T,S)),S}ensureDocumentTargetMapping(T){let S=this.pendingDocumentTargetMapping.get(T);return S||(S=new r8(eD),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(T,S)),S}ensureDocumentUpdateByTarget(T){let S=this.pendingDocumentUpdatesByTarget.get(T);return S||(S=new r8(eD),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(T,S)),S}isActiveTarget(T){let S=null!==this.targetDataForActiveTarget(T);return S||eh(a0,"Detected inactive target",T),S}targetDataForActiveTarget(T){let S=this.targetStates.get(T);return S&&S.isPending?null:this.metadataProvider.getTargetDataForTarget(T)}resetTarget(T){this.targetStates.set(T,new aZ);let S=this.metadataProvider.getRemoteKeysForTarget(T);S.forEach(S=>{this.removeDocumentFromTarget(T,S,null)})}targetContainsDocument(T,S){let R=this.metadataProvider.getRemoteKeysForTarget(T);return R.has(S)}}function a2(){return new r4(eG.comparator)}function a3(){return new r4(eG.comparator)}function a4(T,S,R,O,N){let M={localCacheCount:T,existenceFilterCount:S.count,databaseId:R.database,projectId:R.projectId},L=S.unchangedNames;return L&&(M.bloomFilter={applied:0===N,hashCount:L?.hashCount??0,bitmapLength:L?.bits?.bitmap?.length??0,padding:L?.bits?.padding??0,mightContain:T=>O?.mightContain(T)??!1}),M}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let a6=(()=>{let T={};return T.asc="ASCENDING",T.desc="DESCENDING",T})(),a9=(()=>{let T={};return T["<"]="LESS_THAN",T["<="]="LESS_THAN_OR_EQUAL",T[">"]="GREATER_THAN",T[">="]="GREATER_THAN_OR_EQUAL",T["=="]="EQUAL",T["!="]="NOT_EQUAL",T["array-contains"]="ARRAY_CONTAINS",T.in="IN",T["not-in"]="NOT_IN",T["array-contains-any"]="ARRAY_CONTAINS_ANY",T})(),a5=(()=>{let T={};return T.and="AND",T.or="OR",T})();class a8{constructor(T,S){this.databaseId=T,this.useProto3Json=S}}function a7(T){let S=void 0===T.code?e_.UNKNOWN:aU(T.code);return new eT(S,T.message||"")}function oe(T,S){return T.useProto3Json||nA(S)?S:{value:S}}function ot(T){let S;return nA(S="object"==typeof T?T.value:T)?null:S}function or(T,S){if(!T.useProto3Json)return{seconds:""+S.seconds,nanos:S.nanoseconds};{let T=new Date(1e3*S.seconds).toISOString(),R=T.replace(/\.\d*/,"").replace("Z",""),O=("000000000"+S.nanoseconds).slice(-9);return`${R}.${O}Z`}}function on(T){let S=nh(T);return new e1(S.seconds,S.nanos)}function oi(T,S){return T.useProto3Json?S.toBase64():S.toUint8Array()}function oa(T,S){return T.useProto3Json?(ev(void 0===S||"string"==typeof S,58123),no.fromBase64String(S||"")):(ev(void 0===S||S instanceof Buffer||S instanceof Uint8Array,16193),no.fromUint8Array(S||new Uint8Array))}function oo(T,S){return or(T,S.toTimestamp())}function ol(T){return ev(!!T,49232),e2.fromTimestamp(on(T))}function ou(T,S){return oc(T,S).canonicalString()}function oc(T,S){let R=ov(T).child("documents");return void 0===S?R:R.child(S)}function od(T){let S=ez.fromString(T);return ev(ld(S),10190,{key:S.toString()}),S}function oh(T,S){return ou(T.databaseId,S.path)}function of(T,S){let R=od(S);if(R.get(1)!==T.databaseId.projectId)throw new eT(e_.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+R.get(1)+" vs "+T.databaseId.projectId);if(R.get(3)!==T.databaseId.database)throw new eT(e_.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+R.get(3)+" vs "+T.databaseId.database);return new eG(ob(R))}function om(T,S){return ou(T.databaseId,S)}function og(T){let S=od(T);return 4===S.length?ez.emptyPath():ob(S)}function oy(T){let S=new ez(["projects",T.databaseId.projectId,"databases",T.databaseId.database]);return S.canonicalString()}function ov(T){return new ez(["projects",T.projectId,"databases",T.database])}function ob(T){return ev(T.length>4&&"documents"===T.get(4),29091,{key:T.toString()}),T.popFirst(5)}function o_(T,S,R){return{name:oh(T,S),fields:R.value.mapValue.fields}}function oT(T,S){return{name:oh(T,S.key),fields:S.data.value.mapValue.fields,updateTime:or(T,S.version.toTimestamp()),createTime:or(T,S.createTime.toTimestamp())}}function oS(T,S,R){let O=of(T,S.name),N=ol(S.updateTime),M=S.createTime?ol(S.createTime):e2.min(),L=new iE({mapValue:{fields:S.fields}}),U=iC.newFoundDocument(O,N,M,L);return R&&U.setHasCommittedMutations(),R?U.setHasCommittedMutations():U}function oE(T,S){ev(!!S.found,43571),S.found.name,S.found.updateTime;let R=of(T,S.found.name),O=ol(S.found.updateTime),N=S.found.createTime?ol(S.found.createTime):e2.min(),M=new iE({mapValue:{fields:S.found.fields}});return iC.newFoundDocument(R,O,N,M)}function ow(T,S){ev(!!S.missing,3894),ev(!!S.readTime,22933);let R=of(T,S.missing),O=ol(S.readTime);return iC.newNoDocument(R,O)}function oC(T,S){return"found"in S?oE(T,S):"missing"in S?ow(T,S):eg(7234,{result:S})}function oI(T,S){let R;if("targetChange"in S){S.targetChange;let O=oR(S.targetChange.targetChangeType||"NO_CHANGE"),N=S.targetChange.targetIds||[],M=oa(T,S.targetChange.resumeToken),L=S.targetChange.cause,U=L&&a7(L);R=new aX(O,N,M,U||null)}else if("documentChange"in S){S.documentChange;let O=S.documentChange;O.document,O.document.name,O.document.updateTime;let N=of(T,O.document.name),M=ol(O.document.updateTime),L=O.document.createTime?ol(O.document.createTime):e2.min(),U=new iE({mapValue:{fields:O.document.fields}}),V=iC.newFoundDocument(N,M,L,U),K=O.targetIds||[],$=O.removedTargetIds||[];R=new aY(K,$,V.key,V)}else if("documentDelete"in S){S.documentDelete;let O=S.documentDelete;O.document;let N=of(T,O.document),M=O.readTime?ol(O.readTime):e2.min(),L=iC.newNoDocument(N,M),U=O.removedTargetIds||[];R=new aY([],U,L.key,L)}else if("documentRemove"in S){S.documentRemove;let O=S.documentRemove;O.document;let N=of(T,O.document),M=O.removedTargetIds||[];R=new aY([],M,N,null)}else{if(!("filter"in S))return eg(11601,{change:S});S.filter;let T=S.filter;T.targetId;let{count:O=0,unchangedNames:N}=T,M=new ax(O,N),L=T.targetId;R=new aJ(L,M)}return R}function oR(T){return"NO_CHANGE"===T?0:"ADD"===T?1:"REMOVE"===T?2:"CURRENT"===T?3:"RESET"===T?4:eg(39313,{state:T})}function oA(T){if(!("targetChange"in T))return e2.min();let S=T.targetChange;return S.targetIds&&S.targetIds.length||!S.readTime?e2.min():ol(S.readTime)}function oO(T,S){let R;if(S instanceof ab)R={update:o_(T,S.key,S.value)};else if(S instanceof aA)R={delete:oh(T,S.key)};else if(S instanceof aS)R={update:o_(T,S.key,S.data),updateMask:lu(S.fieldMask)};else{if(!(S instanceof ak))return eg(16599,{mutationType:S.type});R={verify:oh(T,S.key)}}return S.fieldTransforms.length>0&&(R.updateTransforms=S.fieldTransforms.map(S=>ox(T,S))),S.precondition.isNone||(R.currentDocument=ok(T,S.precondition)),R}function oN(T,S){let R=S.currentDocument?oP(S.currentDocument):ad.none(),O=S.updateTransforms?S.updateTransforms.map(S=>oL(T,S)):[];if(S.update){S.update.name;let N=of(T,S.update.name),M=new iE({mapValue:{fields:S.update.fields}});if(!S.updateMask)return new ab(N,M,R,O);{let T=lc(S.updateMask);return new aS(N,M,T,R,O)}}if(S.delete){let O=of(T,S.delete);return new aA(O,R)}if(!S.verify)return eg(1463,{proto:S});{let O=of(T,S.verify);return new ak(O,R)}}function ok(T,S){return void 0!==S.updateTime?{updateTime:oo(T,S.updateTime)}:void 0!==S.exists?{exists:S.exists}:eg(27497)}function oP(T){return void 0!==T.updateTime?ad.updateTime(ol(T.updateTime)):void 0!==T.exists?ad.exists(T.exists):ad.none()}function oD(T,S){let R=T.updateTime?ol(T.updateTime):ol(S);return R.isEqual(e2.min())&&(R=ol(S)),new ac(R,T.transformResults||[])}function oM(T,S){return T&&T.length>0?(ev(void 0!==S,14353),T.map(T=>oD(T,S))):[]}function ox(T,S){let R=S.transform;if(R instanceof s8)return{fieldPath:S.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(R instanceof s7)return{fieldPath:S.field.canonicalString(),appendMissingElements:{values:R.elements}};if(R instanceof at)return{fieldPath:S.field.canonicalString(),removeAllFromArray:{values:R.elements}};if(R instanceof an)return{fieldPath:S.field.canonicalString(),increment:R.operand};throw eg(20930,{transform:S.transform})}function oL(T,S){let R=null;if("setToServerValue"in S)ev("REQUEST_TIME"===S.setToServerValue,16630,{proto:S}),R=new s8;else if("appendMissingElements"in S){let T=S.appendMissingElements.values||[];R=new s7(T)}else if("removeAllFromArray"in S){let T=S.removeAllFromArray.values||[];R=new at(T)}else"increment"in S?R=new an(T,S.increment):eg(16584,{proto:S});let O=eH.fromServerFormat(S.fieldPath);return new ao(O,R)}function oF(T,S){return{documents:[om(T,S.path)]}}function oU(T){let S=T.documents.length;ev(1===S,1966,{count:S});let R=T.documents[0];return sb(sh(og(R)))}function oj(T,S){let R;let O={structuredQuery:{}},N=S.path;null!==S.collectionGroup?(R=N,O.structuredQuery.from=[{collectionId:S.collectionGroup,allDescendants:!0}]):(R=N.popLast(),O.structuredQuery.from=[{collectionId:N.lastSegment()}]),O.parent=om(T,R);let M=oW(S.filters);M&&(O.structuredQuery.where=M);let L=oQ(S.orderBy);L&&(O.structuredQuery.orderBy=L);let U=oe(T,S.limit);return null!==U&&(O.structuredQuery.limit=U),S.startAt&&(O.structuredQuery.startAt=oJ(S.startAt)),S.endAt&&(O.structuredQuery.endAt=oX(S.endAt)),{queryTarget:O,parent:R}}function oB(T,S,R,O){let{queryTarget:N,parent:M}=oj(T,S),L={},U=[],V=0;return R.forEach(T=>{let S=O?T.alias:`aggregate_${V++}`;L[S]=T.alias,"count"===T.aggregateType?U.push({alias:S,count:{}}):"avg"===T.aggregateType?U.push({alias:S,avg:{field:o5(T.fieldPath)}}):"sum"===T.aggregateType&&U.push({alias:S,sum:{field:o5(T.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:U,structuredQuery:N.structuredQuery},parent:N.parent},aliasMap:L,parent:M}}function oV(T){let S=og(T.parent),R=T.structuredQuery,O=R.from?R.from.length:0,N=null;if(O>0){ev(1===O,65062);let T=R.from[0];T.allDescendants?N=T.collectionId:S=S.child(T.collectionId)}let M=[];R.where&&(M=oK(R.where));let L=[];R.orderBy&&(L=oY(R.orderBy));let U=null;R.limit&&(U=ot(R.limit));let V=null;R.startAt&&(V=oZ(R.startAt));let K=null;return R.endAt&&(K=o0(R.endAt)),sd(S,N,L,M,U,"F",V,K)}function oz(T){return sb(oV(T))}function oq(T,S){let R=oH(S.purpose);return null==R?null:{"goog-listen-tags":R}}function oH(T){switch(T){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return eg(28987,{purpose:T})}}function oG(T,S){let R;let O=S.target;if((R=se(O)?{documents:oF(T,O)}:{query:oj(T,O).queryTarget}).targetId=S.targetId,S.resumeToken.approximateByteSize()>0){R.resumeToken=oi(T,S.resumeToken);let O=oe(T,S.expectedCount);null!==O&&(R.expectedCount=O)}else if(S.snapshotVersion.compareTo(e2.min())>0){R.readTime=or(T,S.snapshotVersion.toTimestamp());let O=oe(T,S.expectedCount);null!==O&&(R.expectedCount=O)}return R}function oW(T){if(0!==T.length)return lr(iU.create(T,"and"))}function oK(T){let S=o$(T);return S instanceof iU&&iV(S)?S.getFilters():[S]}function o$(T){return void 0!==T.unaryFilter?ls(T):void 0!==T.fieldFilter?la(T):void 0!==T.compositeFilter?ll(T):eg(30097,{filter:T})}function oQ(T){if(0!==T.length)return T.map(T=>o7(T))}function oY(T){return T.map(T=>lt(T))}function oJ(T){return{before:T.inclusive,values:T.position}}function oX(T){return{before:!T.inclusive,values:T.position}}function oZ(T){let S=!!T.before,R=T.values||[];return new iR(R,S)}function o0(T){let S=!T.before,R=T.values||[];return new iR(R,S)}function o1(T){return a6[T]}function o2(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}function o3(T){return a9[T]}function o4(T){return a5[T]}function o6(T){switch(T){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return eg(58110);default:return eg(50506)}}function o9(T){switch(T){case"AND":return"and";case"OR":return"or";default:return eg(1026)}}function o5(T){return{fieldPath:T.canonicalString()}}function o8(T){return eH.fromServerFormat(T.fieldPath)}function o7(T){return{field:o5(T.field),direction:o1(T.dir)}}function lt(T){return new iP(o8(T.field),o2(T.direction))}function lr(T){return T instanceof iF?li(T):T instanceof iU?ln(T):eg(54877,{filter:T})}function ln(T){let S=T.getFilters().map(T=>lr(T));return 1===S.length?S[0]:{compositeFilter:{op:o4(T.op),filters:S}}}function li(T){if("=="===T.op){if(ih(T.value))return{unaryFilter:{field:o5(T.field),op:"IS_NAN"}};if(ic(T.value))return{unaryFilter:{field:o5(T.field),op:"IS_NULL"}}}else if("!="===T.op){if(ih(T.value))return{unaryFilter:{field:o5(T.field),op:"IS_NOT_NAN"}};if(ic(T.value))return{unaryFilter:{field:o5(T.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:o5(T.field),op:o3(T.op),value:T.value}}}function ls(T){switch(T.unaryFilter.op){case"IS_NAN":let S=o8(T.unaryFilter.field);return iF.create(S,"==",{doubleValue:NaN});case"IS_NULL":let R=o8(T.unaryFilter.field);return iF.create(R,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let O=o8(T.unaryFilter.field);return iF.create(O,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let N=o8(T.unaryFilter.field);return iF.create(N,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return eg(61313);default:return eg(60726)}}function la(T){return iF.create(o8(T.fieldFilter.field),o6(T.fieldFilter.op),T.fieldFilter.value)}function ll(T){return iU.create(T.compositeFilter.filters.map(T=>o$(T)),o9(T.compositeFilter.op))}function lu(T){let S=[];return T.fields.forEach(T=>S.push(T.canonicalString())),{fieldPaths:S}}function lc(T){let S=T.fieldPaths||[];return new nn(S.map(T=>eH.fromServerFormat(T)))}function ld(T){return T.length>=4&&"projects"===T.get(0)&&"databases"===T.get(2)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(T,S,R,O,N=e2.min(),M=e2.min(),L=no.EMPTY_BYTE_STRING,U=null){this.target=T,this.targetId=S,this.purpose=R,this.sequenceNumber=O,this.snapshotVersion=N,this.lastLimboFreeSnapshotVersion=M,this.resumeToken=L,this.expectedCount=U}withSequenceNumber(T){return new lh(this.target,this.targetId,this.purpose,T,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(T,S){return new lh(this.target,this.targetId,this.purpose,this.sequenceNumber,S,this.lastLimboFreeSnapshotVersion,T,null)}withExpectedCount(T){return new lh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,T)}withLastLimboFreeSnapshotVersion(T){return new lh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,T,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(T){this.remoteSerializer=T}}function lp(T,S){let R;if(S.document)R=oS(T.remoteSerializer,S.document,!!S.hasCommittedMutations);else if(S.noDocument){let T=eG.fromSegments(S.noDocument.path),O=lb(S.noDocument.readTime);R=iC.newNoDocument(T,O),S.hasCommittedMutations&&R.setHasCommittedMutations()}else{if(!S.unknownDocument)return eg(56709);let T=eG.fromSegments(S.unknownDocument.path),O=lb(S.unknownDocument.version);R=iC.newUnknownDocument(T,O)}return S.readTime&&R.setReadTime(ly(S.readTime)),R}function lm(T,S){let R=S.key,O={prefixPath:R.getCollectionPath().popLast().toArray(),collectionGroup:R.collectionGroup,documentId:R.path.lastSegment(),readTime:lg(S.readTime),hasCommittedMutations:S.hasCommittedMutations};if(S.isFoundDocument())O.document=oT(T.remoteSerializer,S);else if(S.isNoDocument())O.noDocument={path:R.path.toArray(),readTime:lv(S.version)};else{if(!S.isUnknownDocument())return eg(57904,{document:S});O.unknownDocument={path:R.path.toArray(),version:lv(S.version)}}return O}function lg(T){let S=T.toTimestamp();return[S.seconds,S.nanoseconds]}function ly(T){let S=new e1(T[0],T[1]);return e2.fromTimestamp(S)}function lv(T){let S=T.toTimestamp();return{seconds:S.seconds,nanoseconds:S.nanoseconds}}function lb(T){let S=new e1(T.seconds,T.nanoseconds);return e2.fromTimestamp(S)}function l_(T,S,R){let O=R.baseMutations.map(S=>oO(T.remoteSerializer,S)),N=R.mutations.map(S=>oO(T.remoteSerializer,S));return{userId:S,batchId:R.batchId,localWriteTimeMs:R.localWriteTime.toMillis(),baseMutations:O,mutations:N}}function lT(T,S){let R=(S.baseMutations||[]).map(S=>oN(T.remoteSerializer,S));for(let T=0;T<S.mutations.length-1;++T){let R=S.mutations[T],O=T+1<S.mutations.length&&void 0!==S.mutations[T+1].transform;if(O){let O=S.mutations[T+1];R.updateTransforms=O.transform.fieldTransforms,S.mutations.splice(T+1,1),++T}}let O=S.mutations.map(S=>oN(T.remoteSerializer,S)),N=e1.fromMillis(S.localWriteTimeMs);return new aP(S.batchId,N,R,O)}function lS(T){let S;let R=lb(T.readTime),O=void 0!==T.lastLimboFreeSnapshotVersion?lb(T.lastLimboFreeSnapshotVersion):e2.min();return S=lw(T.query)?oU(T.query):oz(T.query),new lh(S,T.targetId,"TargetPurposeListen",T.lastListenSequenceNumber,R,O,no.fromBase64String(T.resumeToken))}function lE(T,S){let R;let O=lv(S.snapshotVersion),N=lv(S.lastLimboFreeSnapshotVersion);R=se(S.target)?oF(T.remoteSerializer,S.target):oj(T.remoteSerializer,S.target).queryTarget;let M=S.resumeToken.toBase64();return{targetId:S.targetId,canonicalId:i5(S.target),readTime:O,resumeToken:M,lastListenSequenceNumber:S.sequenceNumber,lastLimboFreeSnapshotVersion:N,query:R}}function lw(T){return void 0!==T.documents}function lC(T){return{id:T.bundleId,createTime:lb(T.createTime),version:T.version}}function lI(T){return{bundleId:T.id,createTime:lv(ol(T.createTime)),version:T.version}}function lR(T){return{name:T.name,query:lO(T.bundledQuery),readTime:lb(T.readTime)}}function lA(T){return{name:T.name,readTime:lv(ol(T.readTime)),bundledQuery:T.bundledQuery}}function lO(T){let S=oV({parent:T.parent,structuredQuery:T.structuredQuery});return"LAST"===T.limitType?sw(S,S.limit,"L"):S}function lN(T){return{name:T.name,query:lO(T.bundledQuery),readTime:ol(T.readTime)}}function lk(T){return{id:T.id,version:T.version,createTime:ol(T.createTime)}}function lP(T,S){return new aM(S.largestBatchId,oN(T.remoteSerializer,S.overlayMutation))}function lD(T,S,R){let[O,N,M]=lM(S,R.mutation.key);return{userId:S,collectionPath:N,documentId:M,collectionGroup:R.mutation.key.getCollectionGroup(),largestBatchId:R.largestBatchId,overlayMutation:oO(T.remoteSerializer,R.mutation)}}function lM(T,S){let R=S.path.lastSegment(),O=tU(S.path.popLast());return[T,O,R]}function lx(T){return{indexId:T.indexId,collectionGroup:T.collectionGroup,fields:T.fields.map(T=>[T.fieldPath.canonicalString(),T.kind])}}function lL(T,S){let R=S?new ti(S.sequenceNumber,new tl(lb(S.readTime),new eG(tV(S.documentKey)),S.largestBatchId)):ti.empty(),O=T.fields.map(([T,S])=>new tt(eH.fromServerFormat(T),S));return new e6(T.indexId,T.collectionGroup,O,R)}function lF(T,S,R,O){return{indexId:T,uid:S,sequenceNumber:R,readTime:lv(O.readTime),documentKey:tU(O.documentKey.path),largestBatchId:O.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lU{getBundleMetadata(T,S){return lj(T).get(S).next(T=>{if(T)return lC(T)})}saveBundleMetadata(T,S){return lj(T).put(lI(S))}getNamedQuery(T,S){return lB(T).get(S).next(T=>{if(T)return lR(T)})}saveNamedQuery(T,S){return lB(T).put(lA(S))}}function lj(T){return r0(T,rm)}function lB(T){return r0(T,ry)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(T,S){this.serializer=T,this.userId=S}static forUser(T,S){let R=S.uid||"";return new lV(T,R)}getOverlay(T,S){return lz(T).get(lM(this.userId,S)).next(T=>T?lP(this.serializer,T):null)}getOverlays(T,S){let R=sG();return tf.forEach(S,S=>this.getOverlay(T,S).next(T=>{null!==T&&R.set(S,T)})).next(()=>R)}saveOverlays(T,S,R){let O=[];return R.forEach((R,N)=>{let M=new aM(S,N);O.push(this.saveOverlay(T,M))}),tf.waitFor(O)}removeOverlaysForBatchId(T,S,R){let O=new Set;S.forEach(T=>O.add(tU(T.getCollectionPath())));let N=[];return O.forEach(S=>{let O=IDBKeyRange.bound([this.userId,S,R],[this.userId,S,R+1],!1,!0);N.push(lz(T).deleteAll(rD,O))}),tf.waitFor(N)}getOverlaysForCollection(T,S,R){let O=sG(),N=tU(S),M=IDBKeyRange.bound([this.userId,N,R],[this.userId,N,Number.POSITIVE_INFINITY],!0);return lz(T).loadAll(rD,M).next(T=>{for(let S of T){let T=lP(this.serializer,S);O.set(T.getKey(),T)}return O})}getOverlaysForCollectionGroup(T,S,R,O){let N;let M=sG(),L=IDBKeyRange.bound([this.userId,S,R],[this.userId,S,Number.POSITIVE_INFINITY],!0);return lz(T).iterate({index:rx,range:L},(T,S,R)=>{let L=lP(this.serializer,S);M.size()<O||L.largestBatchId===N?(M.set(L.getKey(),L),N=L.largestBatchId):R.done()}).next(()=>M)}saveOverlay(T,S){return lz(T).put(lD(this.serializer,this.userId,S))}}function lz(T){return r0(T,rk)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lq{globalsStore(T){return r0(T,rF)}getSessionToken(T){let S=this.globalsStore(T);return S.get("sessionToken").next(T=>{let S=T?.value;return S?no.fromUint8Array(S):no.EMPTY_BYTE_STRING})}setSessionToken(T,S){let R=this.globalsStore(T);return R.put({name:"sessionToken",value:S.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lH=5,lG=10,lW=13,lK=15,l$=20,lQ=25,lY=30,lJ=37,lX=45,lZ=50,l0=53,l1=55,l2=60,l3=2;class l4{constructor(){}writeIndexValue(T,S){this.writeIndexValueAux(T,S),S.writeInfinity()}writeIndexValueAux(T,S){if("nullValue"in T)this.writeValueTypeLabel(S,lH);else if("booleanValue"in T)this.writeValueTypeLabel(S,lG),S.writeNumber(T.booleanValue?1:0);else if("integerValue"in T)this.writeValueTypeLabel(S,lK),S.writeNumber(nf(T.integerValue));else if("doubleValue"in T){let R=nf(T.doubleValue);isNaN(R)?this.writeValueTypeLabel(S,lW):(this.writeValueTypeLabel(S,lK),nO(R)?S.writeNumber(0):S.writeNumber(R))}else if("timestampValue"in T){let R=T.timestampValue;this.writeValueTypeLabel(S,l$),"string"==typeof R&&(R=nh(R)),S.writeString(`${R.seconds||""}`),S.writeNumber(R.nanos||0)}else if("stringValue"in T)this.writeIndexString(T.stringValue,S),this.writeTruncationMarker(S);else if("bytesValue"in T)this.writeValueTypeLabel(S,lY),S.writeBytes(np(T.bytesValue)),this.writeTruncationMarker(S);else if("referenceValue"in T)this.writeIndexEntityRef(T.referenceValue,S);else if("geoPointValue"in T){let R=T.geoPointValue;this.writeValueTypeLabel(S,lX),S.writeNumber(R.latitude||0),S.writeNumber(R.longitude||0)}else"mapValue"in T?iy(T)?this.writeValueTypeLabel(S,Number.MAX_SAFE_INTEGER):im(T)?this.writeIndexVector(T.mapValue,S):(this.writeIndexMap(T.mapValue,S),this.writeTruncationMarker(S)):"arrayValue"in T?(this.writeIndexArray(T.arrayValue,S),this.writeTruncationMarker(S)):eg(19022,{indexValue:T})}writeIndexString(T,S){this.writeValueTypeLabel(S,lQ),this.writeUnlabeledIndexString(T,S)}writeUnlabeledIndexString(T,S){S.writeString(T)}writeIndexMap(T,S){let R=T.fields||{};for(let T of(this.writeValueTypeLabel(S,l1),Object.keys(R)))this.writeIndexString(T,S),this.writeIndexValueAux(R[T],S)}writeIndexVector(T,S){let R=T.fields||{};this.writeValueTypeLabel(S,l0);let O=nx,N=R[O].arrayValue?.values?.length||0;this.writeValueTypeLabel(S,lK),S.writeNumber(nf(N)),this.writeIndexString(O,S),this.writeIndexValueAux(R[O],S)}writeIndexArray(T,S){let R=T.values||[];for(let T of(this.writeValueTypeLabel(S,lZ),R))this.writeIndexValueAux(T,S)}writeIndexEntityRef(T,S){this.writeValueTypeLabel(S,lJ);let R=eG.fromName(T).path;R.forEach(T=>{this.writeValueTypeLabel(S,l2),this.writeUnlabeledIndexString(T,S)})}writeValueTypeLabel(T,S){T.writeNumber(S)}writeTruncationMarker(T){T.writeNumber(l3)}}l4.INSTANCE=new l4;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let l6="\uD800",l9="\uDBFF",l5=0,l8=255,l7=1,ue=255,ut=255,ur=0,un=64,ui=8,us=1024;function uo(T){let S=new DataView(new ArrayBuffer(8));return S.setFloat64(0,T,!1),new Uint8Array(S.buffer)}function ul(T){if(0===T)return 8;let S=0;return T>>4==0&&(S+=4,T<<=4),T>>6==0&&(S+=2,T<<=2),T>>7==0&&(S+=1),S}function uu(T){let S=0;for(let R=0;R<8;++R){let O=ul(255&T[R]);if(S+=O,8!==O)break}return S}function uc(T){let S=un-uu(T);return Math.ceil(S/ui)}class ud{constructor(){this.buffer=new Uint8Array(us),this.position=0}writeBytesAscending(T){let S=T[Symbol.iterator](),R=S.next();for(;!R.done;)this.writeByteAscending(R.value),R=S.next();this.writeSeparatorAscending()}writeBytesDescending(T){let S=T[Symbol.iterator](),R=S.next();for(;!R.done;)this.writeByteDescending(R.value),R=S.next();this.writeSeparatorDescending()}writeUtf8Ascending(T){for(let S of T){let T=S.charCodeAt(0);if(T<128)this.writeByteAscending(T);else if(T<2048)this.writeByteAscending(960|T>>>6),this.writeByteAscending(128|63&T);else if(S<l6||l9<S)this.writeByteAscending(480|T>>>12),this.writeByteAscending(128|63&T>>>6),this.writeByteAscending(128|63&T);else{let T=S.codePointAt(0);this.writeByteAscending(240|T>>>18),this.writeByteAscending(128|63&T>>>12),this.writeByteAscending(128|63&T>>>6),this.writeByteAscending(128|63&T)}}this.writeSeparatorAscending()}writeUtf8Descending(T){for(let S of T){let T=S.charCodeAt(0);if(T<128)this.writeByteDescending(T);else if(T<2048)this.writeByteDescending(960|T>>>6),this.writeByteDescending(128|63&T);else if(S<l6||l9<S)this.writeByteDescending(480|T>>>12),this.writeByteDescending(128|63&T>>>6),this.writeByteDescending(128|63&T);else{let T=S.codePointAt(0);this.writeByteDescending(240|T>>>18),this.writeByteDescending(128|63&T>>>12),this.writeByteDescending(128|63&T>>>6),this.writeByteDescending(128|63&T)}}this.writeSeparatorDescending()}writeNumberAscending(T){let S=this.toOrderedBits(T),R=uc(S);this.ensureAvailable(1+R),this.buffer[this.position++]=255&R;for(let T=S.length-R;T<S.length;++T)this.buffer[this.position++]=255&S[T]}writeNumberDescending(T){let S=this.toOrderedBits(T),R=uc(S);this.ensureAvailable(1+R),this.buffer[this.position++]=~(255&R);for(let T=S.length-R;T<S.length;++T)this.buffer[this.position++]=~(255&S[T])}writeInfinityAscending(){this.writeEscapedByteAscending(ue),this.writeEscapedByteAscending(ut)}writeInfinityDescending(){this.writeEscapedByteDescending(ue),this.writeEscapedByteDescending(ut)}reset(){this.position=0}seed(T){this.ensureAvailable(T.length),this.buffer.set(T,this.position),this.position+=T.length}encodedBytes(){return this.buffer.slice(0,this.position)}toOrderedBits(T){let S=uo(T),R=(128&S[0])!=0;S[0]^=R?255:128;for(let T=1;T<S.length;++T)S[T]^=R?255:0;return S}writeByteAscending(T){let S=255&T;S===l5?(this.writeEscapedByteAscending(l5),this.writeEscapedByteAscending(l8)):S===ue?(this.writeEscapedByteAscending(ue),this.writeEscapedByteAscending(ur)):this.writeEscapedByteAscending(S)}writeByteDescending(T){let S=255&T;S===l5?(this.writeEscapedByteDescending(l5),this.writeEscapedByteDescending(l8)):S===ue?(this.writeEscapedByteDescending(ue),this.writeEscapedByteDescending(ur)):this.writeEscapedByteDescending(T)}writeSeparatorAscending(){this.writeEscapedByteAscending(l5),this.writeEscapedByteAscending(l7)}writeSeparatorDescending(){this.writeEscapedByteDescending(l5),this.writeEscapedByteDescending(l7)}writeEscapedByteAscending(T){this.ensureAvailable(1),this.buffer[this.position++]=T}writeEscapedByteDescending(T){this.ensureAvailable(1),this.buffer[this.position++]=~T}ensureAvailable(T){let S=T+this.position;if(S<=this.buffer.length)return;let R=2*this.buffer.length;R<S&&(R=S);let O=new Uint8Array(R);O.set(this.buffer),this.buffer=O}}class uh{constructor(T){this.orderedCode=T}writeBytes(T){this.orderedCode.writeBytesAscending(T)}writeString(T){this.orderedCode.writeUtf8Ascending(T)}writeNumber(T){this.orderedCode.writeNumberAscending(T)}writeInfinity(){this.orderedCode.writeInfinityAscending()}}class uf{constructor(T){this.orderedCode=T}writeBytes(T){this.orderedCode.writeBytesDescending(T)}writeString(T){this.orderedCode.writeUtf8Descending(T)}writeNumber(T){this.orderedCode.writeNumberDescending(T)}writeInfinity(){this.orderedCode.writeInfinityDescending()}}class up{constructor(){this.orderedCode=new ud,this.ascending=new uh(this.orderedCode),this.descending=new uf(this.orderedCode)}seed(T){this.orderedCode.seed(T)}forKind(T){return 0===T?this.ascending:this.descending}encodedBytes(){return this.orderedCode.encodedBytes()}reset(){this.orderedCode.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(T,S,R,O){this._indexId=T,this._documentKey=S,this._arrayValue=R,this._directionalValue=O}successor(){let T=this._directionalValue.length,S=0===T||255===this._directionalValue[T-1]?T+1:T,R=new Uint8Array(S);return R.set(this._directionalValue,0),S!==T?R.set([0],this._directionalValue.length):++R[R.length-1],new um(this._indexId,this._documentKey,this._arrayValue,R)}dbIndexEntry(T,S,R){return{indexId:this._indexId,uid:T,arrayValue:uv(this._arrayValue),directionalValue:uv(this._directionalValue),orderedDocumentKey:uv(S),documentKey:R.path.toArray()}}dbIndexEntryKey(T,S,R){let O=this.dbIndexEntry(T,S,R);return[O.indexId,O.uid,O.arrayValue,O.directionalValue,O.orderedDocumentKey,O.documentKey]}}function ug(T,S){let R=T._indexId-S._indexId;return 0!==R||0!==(R=uy(T._arrayValue,S._arrayValue))||0!==(R=uy(T._directionalValue,S._directionalValue))?R:eG.comparator(T._documentKey,S._documentKey)}function uy(T,S){for(let R=0;R<T.length&&R<S.length;++R){let O=T[R]-S[R];if(0!==O)return O}return T.length-S.length}function uv(T){return isSafariOrWebkit()?u_(T):T}function ub(T){return"string"!=typeof T?T:uT(T)}function u_(T){let S="";for(let R=0;R<T.length;R++)S+=String.fromCharCode(T[R]);return S}function uT(T){let S=new Uint8Array(T.length);for(let R=0;R<T.length;R++)S[R]=T.charCodeAt(R);return S}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{constructor(T){for(let S of(this.inequalityFilters=new r8((T,S)=>eH.comparator(T.field,S.field)),this.collectionId=null!=T.collectionGroup?T.collectionGroup:T.path.lastSegment(),this.orderBys=T.orderBy,this.equalityFilters=[],T.filters)){let T=S;T.isInequality()?this.inequalityFilters=this.inequalityFilters.add(T):this.equalityFilters.push(T)}}get hasMultipleInequality(){return this.inequalityFilters.size>1}servedByIndex(T){if(ev(T.collectionGroup===this.collectionId,49279),this.hasMultipleInequality)return!1;let S=e9(T);if(void 0!==S&&!this.hasMatchingEqualityFilter(S))return!1;let R=e5(T),O=new Set,N=0,M=0;for(;N<R.length;++N)if(this.hasMatchingEqualityFilter(R[N]))O=O.add(R[N].fieldPath.canonicalString());else break;if(N===R.length)return!0;if(this.inequalityFilters.size>0){let T=this.inequalityFilters.getIterator().getNext();if(!O.has(T.field.canonicalString())){let S=R[N];if(!this.matchesFilter(T,S)||!this.matchesOrderBy(this.orderBys[M++],S))return!1}++N}for(;N<R.length;++N){let T=R[N];if(M>=this.orderBys.length||!this.matchesOrderBy(this.orderBys[M++],T))return!1}return!0}buildTargetIndex(){if(this.hasMultipleInequality)return null;let T=new r8(eH.comparator),S=[];for(let R of this.equalityFilters){if(R.field.isKeyField())continue;let O="array-contains"===R.op||"array-contains-any"===R.op;if(O)S.push(new tt(R.field,2));else{if(T.has(R.field))continue;T=T.add(R.field),S.push(new tt(R.field,0))}}for(let R of this.orderBys)R.field.isKeyField()||T.has(R.field)||(T=T.add(R.field),S.push(new tt(R.field,"asc"===R.dir?0:1)));return new e6(e6.UNKNOWN_ID,this.collectionId,S,ti.empty())}hasMatchingEqualityFilter(T){for(let S of this.equalityFilters)if(this.matchesFilter(S,T))return!0;return!1}matchesFilter(T,S){if(void 0===T||!T.field.isEqual(S.fieldPath))return!1;let R="array-contains"===T.op||"array-contains-any"===T.op;return 2===S.kind===R}matchesOrderBy(T,S){return!!T.field.isEqual(S.fieldPath)&&(0===S.kind&&"asc"===T.dir||1===S.kind&&"desc"===T.dir)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uE(T){if(ev(T instanceof iF||T instanceof iU,20012),T instanceof iF){if(!(T instanceof i2))return T;{let S=T.value.arrayValue?.values?.map(S=>iF.create(T.field,"==",S))||[];return iU.create(S,"or")}}let S=T.filters.map(T=>uE(T));return iU.create(S,T.op)}function uw(T){if(0===T.getFilters().length)return[];let S=uO(uE(T));return(ev(uR(S),7391),uC(S)||uI(S))?[S]:S.getFilters()}function uC(T){return T instanceof iF}function uI(T){return T instanceof iU&&iV(T)}function uR(T){return uC(T)||uI(T)||uA(T)}function uA(T){if(T instanceof iU&&iB(T)){for(let S of T.getFilters())if(!uC(S)&&!uI(S))return!1;return!0}return!1}function uO(T){if(ev(T instanceof iF||T instanceof iU,34018),T instanceof iF)return T;if(1===T.filters.length)return uO(T.filters[0]);let S=T.filters.map(T=>uO(T)),R=iU.create(S,T.op);return uR(R=uM(R))?R:(ev(R instanceof iU,64498),ev(ij(R),40251),ev(R.filters.length>1,57927),R.filters.reduce((T,S)=>uN(T,S)))}function uN(T,S){let R;return ev(T instanceof iF||T instanceof iU,38388),ev(S instanceof iF||S instanceof iU,25473),uM(R=T instanceof iF?S instanceof iF?uk(T,S):uD(T,S):S instanceof iF?uD(S,T):uP(T,S))}function uk(T,S){return iU.create([T,S],"and")}function uP(T,S){if(ev(T.filters.length>0&&S.filters.length>0,48005),ij(T)&&ij(S))return iK(T,S.getFilters());let R=iB(T)?T:S,O=iB(T)?S:T,N=R.filters.map(T=>uN(T,O));return iU.create(N,"or")}function uD(T,S){if(ij(S))return iK(S,T.getFilters());{let R=S.filters.map(S=>uN(T,S));return iU.create(R,"or")}}function uM(T){if(ev(T instanceof iF||T instanceof iU,11850),T instanceof iF)return T;let S=T.getFilters();if(1===S.length)return uM(S[0]);if(iz(T))return T;let R=S.map(T=>uM(T)),O=[];return(R.forEach(S=>{S instanceof iF?O.push(S):S instanceof iU&&(S.op===T.op?O.push(...S.filters):O.push(S))}),1===O.length)?O[0]:iU.create(O,T.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ux{constructor(){this.collectionParentIndex=new uL}addToCollectionParentIndex(T,S){return this.collectionParentIndex.add(S),tf.resolve()}getCollectionParents(T,S){return tf.resolve(this.collectionParentIndex.getEntries(S))}addFieldIndex(T,S){return tf.resolve()}deleteFieldIndex(T,S){return tf.resolve()}deleteAllFieldIndexes(T){return tf.resolve()}createTargetIndexes(T,S){return tf.resolve()}getDocumentsMatchingTarget(T,S){return tf.resolve(null)}getIndexType(T,S){return tf.resolve(0)}getFieldIndexes(T,S){return tf.resolve([])}getNextCollectionGroupToUpdate(T){return tf.resolve(null)}getMinOffset(T,S){return tf.resolve(tl.min())}getMinOffsetFromCollectionGroup(T,S){return tf.resolve(tl.min())}updateCollectionGroup(T,S,R){return tf.resolve()}updateIndexEntries(T,S){return tf.resolve()}}class uL{constructor(){this.index={}}add(T){let S=T.lastSegment(),R=T.popLast(),O=this.index[S]||new r8(ez.comparator),N=!O.has(R);return this.index[S]=O.add(R),N}has(T){let S=T.lastSegment(),R=T.popLast(),O=this.index[S];return O&&O.has(R)}getEntries(T){let S=this.index[T]||new r8(ez.comparator);return S.toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uF="IndexedDbIndexManager",uU=new Uint8Array(0);class uj{constructor(T,S){this.databaseId=S,this.collectionParentsCache=new uL,this.targetToDnfSubTargets=new sU(T=>i5(T),(T,S)=>i7(T,S)),this.uid=T.uid||""}addToCollectionParentIndex(T,S){if(!this.collectionParentsCache.has(S)){let R=S.lastSegment(),O=S.popLast();T.addOnCommittedListener(()=>{this.collectionParentsCache.add(S)});let N={collectionId:R,parent:tU(O)};return uB(T).put(N)}return tf.resolve()}getCollectionParents(T,S){let R=[],O=IDBKeyRange.bound([S,""],[ej(S),""],!1,!0);return uB(T).loadAll(O).next(T=>{for(let O of T){if(O.collectionId!==S)break;R.push(tV(O.parent))}return R})}addFieldIndex(T,S){let R=uz(T),O=lx(S);delete O.indexId;let N=R.add(O);if(!S.indexState)return N.next();{let R=uq(T);return N.next(T=>{R.put(lF(T,this.uid,S.indexState.sequenceNumber,S.indexState.offset))})}}deleteFieldIndex(T,S){let R=uz(T),O=uq(T),N=uV(T);return R.delete(S.indexId).next(()=>O.delete(IDBKeyRange.bound([S.indexId],[S.indexId+1],!1,!0))).next(()=>N.delete(IDBKeyRange.bound([S.indexId],[S.indexId+1],!1,!0)))}deleteAllFieldIndexes(T){let S=uz(T),R=uV(T),O=uq(T);return S.deleteAll().next(()=>R.deleteAll()).next(()=>O.deleteAll())}createTargetIndexes(T,S){return tf.forEach(this.getSubTargets(S),S=>this.getIndexType(T,S).next(R=>{if(0===R||1===R){let R=new uS(S),O=R.buildTargetIndex();if(null!=O)return this.addFieldIndex(T,O)}}))}getDocumentsMatchingTarget(T,S){let R=uV(T),O=!0,N=new Map;return tf.forEach(this.getSubTargets(S),S=>this.getFieldIndex(T,S).next(T=>{O&&(O=!!T),N.set(S,T)})).next(()=>{if(!O)return tf.resolve(null);{let T=sJ(),O=[];return tf.forEach(N,(N,M)=>{eh(uF,`Using index ${te(N)} to execute ${i5(S)}`);let L=sr(M,N),U=sn(M,N),V=si(M,N),K=ss(M,N),$=this.encodeBound(N,M,V),Q=this.encodeBound(N,M,K),Y=this.encodeValues(N,M,U),X=this.generateIndexRanges(N.indexId,L,$,V.inclusive,Q,K.inclusive,Y);return tf.forEach(X,N=>R.loadFirst(N,S.limit).next(S=>{S.forEach(S=>{let R=eG.fromSegments(S.documentKey);T.has(R)||(T=T.add(R),O.push(R))})}))}).next(()=>O)}})}getSubTargets(T){let S=this.targetToDnfSubTargets.get(T);if(S)return S;if(0===T.filters.length)S=[T];else{let R=uw(iU.create(T.filters,"and"));S=R.map(S=>i9(T.path,T.collectionGroup,T.orderBy,S.getFilters(),T.limit,T.startAt,T.endAt))}return this.targetToDnfSubTargets.set(T,S),S}generateIndexRanges(T,S,R,O,N,M,L){let U=(null!=S?S.length:1)*Math.max(R.length,N.length),V=U/(null!=S?S.length:1),K=[];for(let $=0;$<U;++$){let U=S?this.encodeSingleElement(S[$/V]):uU,Q=this.generateLowerBound(T,U,R[$%V],O),Y=this.generateUpperBound(T,U,N[$%V],M),X=L.map(S=>this.generateLowerBound(T,U,S,!0));K.push(...this.createRange(Q,Y,X))}return K}generateLowerBound(T,S,R,O){let N=new um(T,eG.empty(),S,R);return O?N:N.successor()}generateUpperBound(T,S,R,O){let N=new um(T,eG.empty(),S,R);return O?N.successor():N}getFieldIndex(T,S){let R=new uS(S),O=null!=S.collectionGroup?S.collectionGroup:S.path.lastSegment();return this.getFieldIndexes(T,O).next(T=>{let S=null;for(let O of T){let T=R.servedByIndex(O);T&&(!S||O.fields.length>S.fields.length)&&(S=O)}return S})}getIndexType(T,S){let R=2,O=this.getSubTargets(S);return tf.forEach(O,S=>this.getFieldIndex(T,S).next(T=>{T?0!==R&&T.fields.length<sl(S)&&(R=1):R=0})).next(()=>su(S)&&O.length>1&&2===R?1:R)}encodeDirectionalElements(T,S){let R=new up;for(let O of e5(T)){let T=S.data.field(O.fieldPath);if(null==T)return null;let N=R.forKind(O.kind);l4.INSTANCE.writeIndexValue(T,N)}return R.encodedBytes()}encodeSingleElement(T){let S=new up;return l4.INSTANCE.writeIndexValue(T,S.forKind(0)),S.encodedBytes()}encodeDirectionalKey(T,S){let R=new up;return l4.INSTANCE.writeIndexValue(is(this.databaseId,S),R.forKind(e8(T))),R.encodedBytes()}encodeValues(T,S,R){if(null===R)return[];let O=[];O.push(new up);let N=0;for(let M of e5(T)){let T=R[N++];for(let R of O)if(this.isInFilter(S,M.fieldPath)&&iu(T))O=this.expandIndexValues(O,M,T);else{let S=R.forKind(M.kind);l4.INSTANCE.writeIndexValue(T,S)}}return this.getEncodedBytes(O)}encodeBound(T,S,R){return this.encodeValues(T,S,R.position)}getEncodedBytes(T){let S=[];for(let R=0;R<T.length;++R)S[R]=T[R].encodedBytes();return S}expandIndexValues(T,S,R){let O=[...T],N=[];for(let T of R.arrayValue.values||[])for(let R of O){let O=new up;O.seed(R.encodedBytes()),l4.INSTANCE.writeIndexValue(T,O.forKind(S.kind)),N.push(O)}return N}isInFilter(T,S){return!!T.filters.find(T=>T instanceof iF&&T.field.isEqual(S)&&("in"===T.op||"not-in"===T.op))}getFieldIndexes(T,S){let R=uz(T),O=uq(T);return(S?R.loadAll(rT,IDBKeyRange.bound(S,S)):R.loadAll()).next(T=>{let S=[];return tf.forEach(T,T=>O.get([T.indexId,this.uid]).next(R=>{S.push(lL(T,R))})).next(()=>S)})}getNextCollectionGroupToUpdate(T){return this.getFieldIndexes(T).next(T=>0===T.length?null:(T.sort((T,S)=>{let R=T.indexState.sequenceNumber-S.indexState.sequenceNumber;return 0!==R?R:eD(T.collectionGroup,S.collectionGroup)}),T[0].collectionGroup))}updateCollectionGroup(T,S,R){let O=uz(T),N=uq(T);return this.getNextSequenceNumber(T).next(T=>O.loadAll(rT,IDBKeyRange.bound(S,S)).next(S=>tf.forEach(S,S=>N.put(lF(S.indexId,this.uid,T,R)))))}updateIndexEntries(T,S){let R=new Map;return tf.forEach(S,(S,O)=>{let N=R.get(S.collectionGroup),M=N?tf.resolve(N):this.getFieldIndexes(T,S.collectionGroup);return M.next(N=>(R.set(S.collectionGroup,N),tf.forEach(N,R=>this.getExistingIndexEntries(T,S,R).next(S=>{let N=this.computeIndexEntries(O,R);return S.isEqual(N)?tf.resolve():this.updateEntries(T,O,R,S,N)}))))})}addIndexEntry(T,S,R,O){let N=uV(T);return N.put(O.dbIndexEntry(this.uid,this.encodeDirectionalKey(R,S.key),S.key))}deleteIndexEntry(T,S,R,O){let N=uV(T);return N.delete(O.dbIndexEntryKey(this.uid,this.encodeDirectionalKey(R,S.key),S.key))}getExistingIndexEntries(T,S,R){let O=uV(T),N=new r8(ug);return O.iterate({index:rO,range:IDBKeyRange.only([R.indexId,this.uid,uv(this.encodeDirectionalKey(R,S))])},(T,O)=>{N=N.add(new um(R.indexId,S,ub(O.arrayValue),ub(O.directionalValue)))}).next(()=>N)}computeIndexEntries(T,S){let R=new r8(ug),O=this.encodeDirectionalElements(S,T);if(null==O)return R;let N=e9(S);if(null!=N){let M=T.data.field(N.fieldPath);if(iu(M))for(let N of M.arrayValue.values||[])R=R.add(new um(S.indexId,T.key,this.encodeSingleElement(N),O))}else R=R.add(new um(S.indexId,T.key,uU,O));return R}updateEntries(T,S,R,O,N){eh(uF,"Updating index entries for document '%s'",S.key);let M=[];return ne(O,N,ug,O=>{M.push(this.addIndexEntry(T,S,R,O))},O=>{M.push(this.deleteIndexEntry(T,S,R,O))}),tf.waitFor(M)}getNextSequenceNumber(T){let S=1,R=uq(T);return R.iterate({index:rC,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(T,R,O)=>{O.done(),S=R.sequenceNumber+1}).next(()=>S)}createRange(T,S,R){R=R.sort((T,S)=>ug(T,S)).filter((T,S,R)=>!S||0!==ug(T,R[S-1]));let O=[];for(let N of(O.push(T),R)){let R=ug(N,T),M=ug(N,S);if(0===R)O[0]=T.successor();else if(R>0&&M<0)O.push(N),O.push(N.successor());else if(M>0)break}O.push(S);let N=[];for(let T=0;T<O.length;T+=2){if(this.isRangeMatchable(O[T],O[T+1]))return[];let S=O[T].dbIndexEntryKey(this.uid,uU,eG.empty()),R=O[T+1].dbIndexEntryKey(this.uid,uU,eG.empty());N.push(IDBKeyRange.bound(S,R))}return N}isRangeMatchable(T,S){return ug(T,S)>0}getMinOffsetFromCollectionGroup(T,S){return this.getFieldIndexes(T,S).next(uH)}getMinOffset(T,S){return tf.mapArray(this.getSubTargets(S),S=>this.getFieldIndex(T,S).next(T=>T||eg(44426))).next(uH)}}function uB(T){return r0(T,rd)}function uV(T){return r0(T,rR)}function uz(T){return r0(T,rb)}function uq(T){return r0(T,rE)}function uH(T){ev(0!==T.length,28825);let S=T[0].indexState.offset,R=S.largestBatchId;for(let O=1;O<T.length;O++){let N=T[O].indexState.offset;0>tu(N,S)&&(S=N),R<N.largestBatchId&&(R=N.largestBatchId)}return new tl(S.readTime,S.documentKey,R)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uG(T,S,R){let O=T.store(tK),N=T.store(t1),M=[],L=IDBKeyRange.only(R.batchId),U=0,V=O.iterate({range:L},(T,S,R)=>(U++,R.delete()));M.push(V.next(()=>{ev(1===U,47070,{batchId:R.batchId})}));let K=[];for(let T of R.mutations){let O=tZ(S,T.key.path,R.batchId);M.push(N.delete(O)),K.push(T.key)}return tf.waitFor(M).next(()=>K)}function uW(T){let S;if(!T)return 0;if(T.document)S=T.document;else if(T.unknownDocument)S=T.unknownDocument;else if(T.noDocument)S=T.noDocument;else throw eg(14731);return JSON.stringify(S).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uK{constructor(T,S,R,O){this.userId=T,this.serializer=S,this.indexManager=R,this.referenceDelegate=O,this.documentKeysByBatchId={}}static forUser(T,S,R,O){ev(""!==T.uid,64387);let N=T.isAuthenticated()?T.uid:"";return new uK(N,S,R,O)}checkEmpty(T){let S=!0,R=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return uY(T).iterate({index:tQ,range:R},(T,R,O)=>{S=!1,O.done()}).next(()=>S)}addMutationBatch(T,S,R,O){let N=uJ(T),M=uY(T);return M.add({}).next(L=>{ev("number"==typeof L,49019);let U=new aP(L,S,R,O),V=l_(this.serializer,this.userId,U),K=[],$=new r8((T,S)=>eD(T.canonicalString(),S.canonicalString()));for(let T of O){let S=tZ(this.userId,T.key.path,L);$=$.add(T.key.path.popLast()),K.push(M.put(V)),K.push(N.put(S,t0))}return $.forEach(S=>{K.push(this.indexManager.addToCollectionParentIndex(T,S))}),T.addOnCommittedListener(()=>{this.documentKeysByBatchId[L]=U.keys()}),tf.waitFor(K).next(()=>U)})}lookupMutationBatch(T,S){return uY(T).get(S).next(T=>T?(ev(T.userId===this.userId,48,"Unexpected user for mutation batch",{userId:T.userId,batchId:S}),lT(this.serializer,T)):null)}lookupMutationKeys(T,S){return this.documentKeysByBatchId[S]?tf.resolve(this.documentKeysByBatchId[S]):this.lookupMutationBatch(T,S).next(T=>{if(!T)return null;{let R=T.keys();return this.documentKeysByBatchId[S]=R,R}})}getNextMutationBatchAfterBatchId(T,S){let R=S+1,O=IDBKeyRange.lowerBound([this.userId,R]),N=null;return uY(T).iterate({index:tQ,range:O},(T,S,O)=>{S.userId===this.userId&&(ev(S.batchId>=R,47524,{nextBatchId:R}),N=lT(this.serializer,S)),O.done()}).next(()=>N)}getHighestUnacknowledgedBatchId(T){let S=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),R=nR;return uY(T).iterate({index:tQ,range:S,reverse:!0},(T,S,O)=>{R=S.batchId,O.done()}).next(()=>R)}getAllMutationBatches(T){let S=IDBKeyRange.bound([this.userId,nR],[this.userId,Number.POSITIVE_INFINITY]);return uY(T).loadAll(tQ,S).next(T=>T.map(T=>lT(this.serializer,T)))}getAllMutationBatchesAffectingDocumentKey(T,S){let R=tX(this.userId,S.path),O=IDBKeyRange.lowerBound(R),N=[];return uJ(T).iterate({range:O},(R,O,M)=>{let[L,U,V]=R,K=tV(U);if(L!==this.userId||!S.path.isEqual(K)){M.done();return}return uY(T).get(V).next(T=>{if(!T)throw eg(61480,{indexKey:R,batchId:V});ev(T.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:T.userId,batchId:V}),N.push(lT(this.serializer,T))})}).next(()=>N)}getAllMutationBatchesAffectingDocumentKeys(T,S){let R=new r8(eD),O=[];return S.forEach(S=>{let N=tX(this.userId,S.path),M=IDBKeyRange.lowerBound(N),L=uJ(T).iterate({range:M},(T,O,N)=>{let[M,L,U]=T,V=tV(L);if(M!==this.userId||!S.path.isEqual(V)){N.done();return}R=R.add(U)});O.push(L)}),tf.waitFor(O).next(()=>this.lookupMutationBatches(T,R))}getAllMutationBatchesAffectingQuery(T,S){let R=S.path,O=R.length+1,N=tX(this.userId,R),M=IDBKeyRange.lowerBound(N),L=new r8(eD);return uJ(T).iterate({range:M},(T,S,N)=>{let[M,U,V]=T,K=tV(U);if(M!==this.userId||!R.isPrefixOf(K)){N.done();return}K.length===O&&(L=L.add(V))}).next(()=>this.lookupMutationBatches(T,L))}lookupMutationBatches(T,S){let R=[],O=[];return S.forEach(S=>{O.push(uY(T).get(S).next(T=>{if(null===T)throw eg(35274,{batchId:S});ev(T.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:T.userId,batchId:S}),R.push(lT(this.serializer,T))}))}),tf.waitFor(O).next(()=>R)}removeMutationBatch(T,S){return uG(T.simpleDbTransaction,this.userId,S).next(R=>(T.addOnCommittedListener(()=>{this.removeCachedMutationKeys(S.batchId)}),tf.forEach(R,S=>this.referenceDelegate.markPotentiallyOrphaned(T,S))))}removeCachedMutationKeys(T){delete this.documentKeysByBatchId[T]}performConsistencyCheck(T){return this.checkEmpty(T).next(S=>{if(!S)return tf.resolve();let R=IDBKeyRange.lowerBound(tJ(this.userId)),O=[];return uJ(T).iterate({range:R},(T,S,R)=>{let N=T[0];if(N!==this.userId){R.done();return}{let S=tV(T[1]);O.push(S)}}).next(()=>{ev(0===O.length,56720,{danglingKeys:O.map(T=>T.canonicalString())})})})}containsKey(T,S){return u$(T,this.userId,S)}getMutationQueueMetadata(T){return uX(T).get(this.userId).next(T=>T||{userId:this.userId,lastAcknowledgedBatchId:nR,lastStreamToken:""})}}function u$(T,S,R){let O=tX(S,R.path),N=O[1],M=IDBKeyRange.lowerBound(O),L=!1;return uJ(T).iterate({range:M,keysOnly:!0},(T,R,O)=>{let[M,U,V]=T;M===S&&U===N&&(L=!0),O.done()}).next(()=>L)}function uQ(T,S){let R=!1;return uX(T).iterateSerial(O=>u$(T,O,S).next(T=>(T&&(R=!0),tf.resolve(!T)))).next(()=>R)}function uY(T){return r0(T,tK)}function uJ(T){return r0(T,t1)}function uX(T){return r0(T,tG)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uZ=2;class u0{constructor(T){this.lastId=T}next(){return this.lastId+=uZ,this.lastId}static forTargetCache(){return new u0(2-uZ)}static forSyncEngine(){return new u0(1-uZ)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1{constructor(T,S){this.referenceDelegate=T,this.serializer=S}allocateTargetId(T){return this.retrieveMetadata(T).next(S=>{let R=new u0(S.highestTargetId);return S.highestTargetId=R.next(),this.saveMetadata(T,S).next(()=>S.highestTargetId)})}getLastRemoteSnapshotVersion(T){return this.retrieveMetadata(T).next(T=>e2.fromTimestamp(new e1(T.lastRemoteSnapshotVersion.seconds,T.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(T){return this.retrieveMetadata(T).next(T=>T.highestListenSequenceNumber)}setTargetsMetadata(T,S,R){return this.retrieveMetadata(T).next(O=>(O.highestListenSequenceNumber=S,R&&(O.lastRemoteSnapshotVersion=R.toTimestamp()),S>O.highestListenSequenceNumber&&(O.highestListenSequenceNumber=S),this.saveMetadata(T,O)))}addTargetData(T,S){return this.saveTargetData(T,S).next(()=>this.retrieveMetadata(T).next(R=>(R.targetCount+=1,this.updateMetadataFromTargetData(S,R),this.saveMetadata(T,R))))}updateTargetData(T,S){return this.saveTargetData(T,S)}removeTargetData(T,S){return this.removeMatchingKeysForTargetId(T,S.targetId).next(()=>u2(T).delete(S.targetId)).next(()=>this.retrieveMetadata(T)).next(S=>(ev(S.targetCount>0,8065),S.targetCount-=1,this.saveMetadata(T,S)))}removeTargets(T,S,R){let O=0,N=[];return u2(T).iterate((M,L)=>{let U=lS(L);U.sequenceNumber<=S&&null===R.get(U.targetId)&&(O++,N.push(this.removeTargetData(T,U)))}).next(()=>tf.waitFor(N)).next(()=>O)}forEachTarget(T,S){return u2(T).iterate((T,R)=>{let O=lS(R);S(O)})}retrieveMetadata(T){return u3(T).get(ru).next(T=>(ev(null!==T,2888),T))}saveMetadata(T,S){return u3(T).put(ru,S)}saveTargetData(T,S){return u2(T).put(lE(this.serializer,S))}updateMetadataFromTargetData(T,S){let R=!1;return T.targetId>S.highestTargetId&&(S.highestTargetId=T.targetId,R=!0),T.sequenceNumber>S.highestListenSequenceNumber&&(S.highestListenSequenceNumber=T.sequenceNumber,R=!0),R}getTargetCount(T){return this.retrieveMetadata(T).next(T=>T.targetCount)}getTargetData(T,S){let R=i5(S),O=IDBKeyRange.bound([R,Number.NEGATIVE_INFINITY],[R,Number.POSITIVE_INFINITY]),N=null;return u2(T).iterate({range:O,index:rn},(T,R,O)=>{let M=lS(R);i7(S,M.target)&&(N=M,O.done())}).next(()=>N)}addMatchingKeys(T,S,R){let O=[],N=u4(T);return S.forEach(S=>{let M=tU(S.path);O.push(N.put({targetId:R,path:M})),O.push(this.referenceDelegate.addReference(T,R,S))}),tf.waitFor(O)}removeMatchingKeys(T,S,R){let O=u4(T);return tf.forEach(S,S=>{let N=tU(S.path);return tf.waitFor([O.delete([R,N]),this.referenceDelegate.removeReference(T,R,S)])})}removeMatchingKeysForTargetId(T,S){let R=u4(T),O=IDBKeyRange.bound([S],[S+1],!1,!0);return R.delete(O)}getMatchingKeysForTargetId(T,S){let R=IDBKeyRange.bound([S],[S+1],!1,!0),O=u4(T),N=sJ();return O.iterate({range:R,keysOnly:!0},(T,S,R)=>{let O=tV(T[1]),M=new eG(O);N=N.add(M)}).next(()=>N)}containsKey(T,S){let R=tU(S.path),O=IDBKeyRange.bound([R],[ej(R)],!1,!0),N=0;return u4(T).iterate({index:ro,keysOnly:!0,range:O},([T,S],R,O)=>{0!==T&&(N++,O.done())}).next(()=>N>0)}getTargetDataForTarget(T,S){return u2(T).get(S).next(T=>T?lS(T):null)}}function u2(T){return r0(T,rt)}function u3(T){return r0(T,rc)}function u4(T){return r0(T,rs)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let u6={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},u9=-1,u5=41943040;class u8{static withCacheSize(T){return new u8(T,u8.DEFAULT_COLLECTION_PERCENTILE,u8.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(T,S,R){this.cacheSizeCollectionThreshold=T,this.percentileToCollect=S,this.maximumSequenceNumbersToCollect=R}}u8.DEFAULT_COLLECTION_PERCENTILE=10,u8.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,u8.DEFAULT=new u8(u5,u8.DEFAULT_COLLECTION_PERCENTILE,u8.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),u8.DISABLED=new u8(u9,0,0);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let u7="LruGarbageCollector",ce=1048576,ct=null,cr=null;function cn([T,S],[R,O]){let N=eD(T,R);return 0===N?eD(S,O):N}class ci{constructor(T){this.maxElements=T,this.buffer=new r8(cn),this.previousIndex=0}nextIndex(){return++this.previousIndex}addElement(T){let S=[T,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(S);else{let T=this.buffer.last();0>cn(S,T)&&(this.buffer=this.buffer.delete(T).add(S))}}get maxValue(){return this.buffer.last()[0]}}class cs{constructor(T,S,R){this.garbageCollector=T,this.asyncQueue=S,this.localStore=R,this.gcTask=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==u9&&this.scheduleGC(ct)}stop(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)}get started(){return null!==this.gcTask}scheduleGC(T){eh(u7,`Garbage collection scheduled in ${T}ms`),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",T,async()=>{this.gcTask=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(T){tT(T)?eh(u7,"Ignoring IndexedDB error during garbage collection: ",T):await th(T)}await this.scheduleGC(cr)})}}class ca{constructor(T,S){this.delegate=T,this.params=S}calculateTargetCount(T,S){return this.delegate.getSequenceNumberCount(T).next(T=>Math.floor(S/100*T))}nthSequenceNumber(T,S){if(0===S)return tf.resolve(tP.INVALID);let R=new ci(S);return this.delegate.forEachTarget(T,T=>R.addElement(T.sequenceNumber)).next(()=>this.delegate.forEachOrphanedDocumentSequenceNumber(T,T=>R.addElement(T))).next(()=>R.maxValue)}removeTargets(T,S,R){return this.delegate.removeTargets(T,S,R)}removeOrphanedDocuments(T,S){return this.delegate.removeOrphanedDocuments(T,S)}collect(T,S){return this.params.cacheSizeCollectionThreshold===u9?(eh("LruGarbageCollector","Garbage collection skipped; disabled"),tf.resolve(u6)):this.getCacheSize(T).next(R=>R<this.params.cacheSizeCollectionThreshold?(eh("LruGarbageCollector",`Garbage collection skipped; Cache size ${R} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),u6):this.runGarbageCollection(T,S))}getCacheSize(T){return this.delegate.getCacheSize(T)}runGarbageCollection(T,S){let R,O,N,M,L,U,V;let K=Date.now();return this.calculateTargetCount(T,this.params.percentileToCollect).next(S=>(S>this.params.maximumSequenceNumbersToCollect?(eh("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${S}`),O=this.params.maximumSequenceNumbersToCollect):O=S,M=Date.now(),this.nthSequenceNumber(T,O))).next(O=>(R=O,L=Date.now(),this.removeTargets(T,R,S))).next(S=>(N=S,U=Date.now(),this.removeOrphanedDocuments(T,R))).next(T=>{if(V=Date.now(),ed()<=LogLevel.DEBUG){let S=`LRU Garbage Collection
	Counted targets in ${M-K}ms
	Determined least recently used ${O} in ${L-M}ms
	Removed ${N} targets in ${U-L}ms
	Removed ${T} documents in ${V-U}ms
Total Duration: ${V-K}ms`;eh("LruGarbageCollector",S)}return tf.resolve({didRun:!0,sequenceNumbersCollected:O,targetsRemoved:N,documentsRemoved:T})})}}function co(T,S){return new ca(T,S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(T,S){this.db=T,this.garbageCollector=co(this,S)}getSequenceNumberCount(T){let S=this.orphanedDocumentCount(T),R=this.db.getTargetCache().getTargetCount(T);return R.next(T=>S.next(S=>T+S))}orphanedDocumentCount(T){let S=0;return this.forEachOrphanedDocumentSequenceNumber(T,T=>{S++}).next(()=>S)}forEachTarget(T,S){return this.db.getTargetCache().forEachTarget(T,S)}forEachOrphanedDocumentSequenceNumber(T,S){return this.forEachOrphanedDocument(T,(T,R)=>S(R))}addReference(T,S,R){return cd(T,R)}removeReference(T,S,R){return cd(T,R)}removeTargets(T,S,R){return this.db.getTargetCache().removeTargets(T,S,R)}markPotentiallyOrphaned(T,S){return cd(T,S)}isPinned(T,S){return uQ(T,S)}removeOrphanedDocuments(T,S){let R=this.db.getRemoteDocumentCache(),O=R.newChangeBuffer(),N=[],M=0,L=this.forEachOrphanedDocument(T,(R,L)=>{if(L<=S){let S=this.isPinned(T,R).next(S=>{if(!S)return M++,O.getEntry(T,R).next(()=>(O.removeEntry(R,e2.min()),u4(T).delete(cu(R))))});N.push(S)}});return L.next(()=>tf.waitFor(N)).next(()=>O.apply(T)).next(()=>M)}removeTarget(T,S){let R=S.withSequenceNumber(T.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(T,R)}updateLimboDocument(T,S){return cd(T,S)}forEachOrphanedDocument(T,S){let R;let O=u4(T),N=tP.INVALID;return O.iterate({index:ro},([T,O],{path:M,sequenceNumber:L})=>{0===T?(N!==tP.INVALID&&S(new eG(tV(R)),N),N=L,R=M):N=tP.INVALID}).next(()=>{N!==tP.INVALID&&S(new eG(tV(R)),N)})}getCacheSize(T){return this.db.getRemoteDocumentCache().getSize(T)}}function cu(T){return[0,tU(T.path)]}function cc(T,S){return{targetId:0,path:tU(T.path),sequenceNumber:S}}function cd(T,S){return u4(T).put(cc(S,T.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch{constructor(){this.changes=new sU(T=>T.toString(),(T,S)=>T.isEqual(S)),this.changesApplied=!1}addEntry(T){this.assertNotApplied(),this.changes.set(T.key,T)}removeEntry(T,S){this.assertNotApplied(),this.changes.set(T,iC.newInvalidDocument(T).setReadTime(S))}getEntry(T,S){this.assertNotApplied();let R=this.changes.get(S);return void 0!==R?tf.resolve(R):this.getFromCache(T,S)}getEntries(T,S){return this.getAllFromCache(T,S)}apply(T){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(T)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(T){this.serializer=T}setIndexManager(T){this.indexManager=T}addEntry(T,S,R){let O=cv(T);return O.put(R)}removeEntry(T,S,R){let O=cv(T);return O.delete(cT(S,R))}updateMetadata(T,S){return this.getMetadata(T).next(R=>(R.byteSize+=S,this.setMetadata(T,R)))}getEntry(T,S){let R=iC.newInvalidDocument(S);return cv(T).iterate({index:t4,range:IDBKeyRange.only(c_(S))},(T,O)=>{R=this.maybeDecodeDocument(S,O)}).next(()=>R)}getSizedEntry(T,S){let R={size:0,document:iC.newInvalidDocument(S)};return cv(T).iterate({index:t4,range:IDBKeyRange.only(c_(S))},(T,O)=>{R={document:this.maybeDecodeDocument(S,O),size:uW(O)}}).next(()=>R)}getEntries(T,S){let R=sB();return this.forEachDbEntry(T,S,(T,S)=>{let O=this.maybeDecodeDocument(T,S);R=R.insert(T,O)}).next(()=>R)}getSizedEntries(T,S){let R=sB(),O=new r4(eG.comparator);return this.forEachDbEntry(T,S,(T,S)=>{let N=this.maybeDecodeDocument(T,S);R=R.insert(T,N),O=O.insert(T,uW(S))}).next(()=>({documents:R,sizeMap:O}))}forEachDbEntry(T,S,R){if(S.isEmpty())return tf.resolve();let O=new r8(cE);S.forEach(T=>O=O.add(T));let N=IDBKeyRange.bound(c_(O.first()),c_(O.last())),M=O.getIterator(),L=M.getNext();return cv(T).iterate({index:t4,range:N},(T,S,O)=>{let N=eG.fromSegments([...S.prefixPath,S.collectionGroup,S.documentId]);for(;L&&0>cE(L,N);)R(L,null),L=M.getNext();L&&L.isEqual(N)&&(R(L,S),L=M.hasNext()?M.getNext():null),L?O.skip(c_(L)):O.done()}).next(()=>{for(;L;)R(L,null),L=M.hasNext()?M.getNext():null})}getDocumentsMatchingQuery(T,S,R,O,N){let M=S.path,L=[M.popLast().toArray(),M.lastSegment(),lg(R.readTime),R.documentKey.path.isEmpty()?"":R.documentKey.path.lastSegment()],U=[M.popLast().toArray(),M.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return cv(T).loadAll(IDBKeyRange.bound(L,U,!0)).next(T=>{N?.incrementDocumentReadCount(T.length);let R=sB();for(let N of T){let T=this.maybeDecodeDocument(eG.fromSegments(N.prefixPath.concat(N.collectionGroup,N.documentId)),N);T.isFoundDocument()&&(sN(S,T)||O.has(T.key))&&(R=R.insert(T.key,T))}return R})}getAllFromCollectionGroup(T,S,R,O){let N=sB(),M=cS(S,R),L=cS(S,tl.max());return cv(T).iterate({index:t9,range:IDBKeyRange.bound(M,L,!0)},(T,S,R)=>{let M=this.maybeDecodeDocument(eG.fromSegments(S.prefixPath.concat(S.collectionGroup,S.documentId)),S);(N=N.insert(M.key,M)).size===O&&R.done()}).next(()=>N)}newChangeBuffer(T){return new cm(this,!!T&&T.trackRemovals)}getSize(T){return this.getMetadata(T).next(T=>T.byteSize)}getMetadata(T){return cy(T).get(t7).next(T=>(ev(!!T,20021),T))}setMetadata(T,S){return cy(T).put(t7,S)}maybeDecodeDocument(T,S){if(S){let T=lp(this.serializer,S),R=T.isNoDocument()&&T.version.isEqual(e2.min());if(!R)return T}return iC.newInvalidDocument(T)}}function cp(T){return new cf(T)}class cm extends null{constructor(T,S){super(),this.documentCache=T,this.trackRemovals=S,this.documentStates=new sU(T=>T.toString(),(T,S)=>T.isEqual(S))}applyChanges(T){let S=[],R=0,O=new r8((T,S)=>eD(T.canonicalString(),S.canonicalString()));return this.changes.forEach((N,M)=>{let L=this.documentStates.get(N);if(S.push(this.documentCache.removeEntry(T,N,L.readTime)),M.isValidDocument()){let U=lm(this.documentCache.serializer,M);O=O.add(N.path.popLast());let V=uW(U);R+=V-L.size,S.push(this.documentCache.addEntry(T,N,U))}else if(R-=L.size,this.trackRemovals){let R=lm(this.documentCache.serializer,M.convertToNoDocument(e2.min()));S.push(this.documentCache.addEntry(T,N,R))}}),O.forEach(R=>{S.push(this.documentCache.indexManager.addToCollectionParentIndex(T,R))}),S.push(this.documentCache.updateMetadata(T,R)),tf.waitFor(S)}getFromCache(T,S){return this.documentCache.getSizedEntry(T,S).next(T=>(this.documentStates.set(S,{size:T.size,readTime:T.document.readTime}),T.document))}getAllFromCache(T,S){return this.documentCache.getSizedEntries(T,S).next(({documents:T,sizeMap:S})=>(S.forEach((S,R)=>{this.documentStates.set(S,{size:R,readTime:T.get(S).readTime})}),T))}}function cy(T){return r0(T,t8)}function cv(T){return r0(T,t2)}function c_(T){let S=T.path.toArray();return[S.slice(0,S.length-2),S[S.length-2],S[S.length-1]]}function cT(T,S){let R=T.path.toArray();return[R.slice(0,R.length-2),R[R.length-2],lg(S),R[R.length-1]]}function cS(T,S){let R=S.documentKey.path.toArray();return[T,lg(S.readTime),R.slice(0,R.length-2),R.length>0?R[R.length-1]:""]}function cE(T,S){let R=T.path.toArray(),O=S.path.toArray(),N=0;for(let T=0;T<R.length-2&&T<O.length-2;++T)if(N=eD(R[T],O[T]))return N;return(N=eD(R.length,O.length))||(N=eD(R[R.length-2],O[O.length-2]))?N:eD(R[R.length-1],O[O.length-1])}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cw=18;/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC{constructor(T,S){this.overlayedDocument=T,this.mutatedFields=S}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI{constructor(T,S,R,O){this.remoteDocumentCache=T,this.mutationQueue=S,this.documentOverlayCache=R,this.indexManager=O}getDocument(T,S){let R=null;return this.documentOverlayCache.getOverlay(T,S).next(O=>(R=O,this.remoteDocumentCache.getEntry(T,S))).next(T=>(null!==R&&ag(R.mutation,T,nn.empty(),e1.now()),T))}getDocuments(T,S){return this.remoteDocumentCache.getEntries(T,S).next(S=>this.getLocalViewOfDocuments(T,S,sJ()).next(()=>S))}getLocalViewOfDocuments(T,S,R=sJ()){let O=sG();return this.populateOverlays(T,O,S).next(()=>this.computeViews(T,S,O,R).next(T=>{let S=sz();return T.forEach((T,R)=>{S=S.insert(T,R.overlayedDocument)}),S}))}getOverlayedDocuments(T,S){let R=sG();return this.populateOverlays(T,R,S).next(()=>this.computeViews(T,S,R,sJ()))}populateOverlays(T,S,R){let O=[];return R.forEach(T=>{S.has(T)||O.push(T)}),this.documentOverlayCache.getOverlays(T,O).next(T=>{T.forEach((T,R)=>{S.set(T,R)})})}computeViews(T,S,R,O){let N=sB(),M=sK(),L=sq();return S.forEach((T,S)=>{let L=R.get(S.key);O.has(S.key)&&(void 0===L||L.mutation instanceof aS)?N=N.insert(S.key,S):void 0!==L?(M.set(S.key,L.mutation.getFieldMask()),ag(L.mutation,S,L.mutation.getFieldMask(),e1.now())):M.set(S.key,nn.empty())}),this.recalculateAndSaveOverlays(T,N).next(T=>(T.forEach((T,S)=>M.set(T,S)),S.forEach((T,S)=>L.set(T,new cC(S,M.get(T)??null))),L))}recalculateAndSaveOverlays(T,S){let R=sK(),O=new r4((T,S)=>T-S),N=sJ();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(T,S).next(T=>{for(let N of T)N.keys().forEach(T=>{let M=S.get(T);if(null===M)return;let L=R.get(T)||nn.empty();L=N.applyToLocalView(M,L),R.set(T,L);let U=(O.get(N.batchId)||sJ()).add(T);O=O.insert(N.batchId,U)})}).next(()=>{let M=[],L=O.getReverseIterator();for(;L.hasNext();){let O=L.getNext(),U=O.key,V=O.value,K=sW();V.forEach(T=>{if(!N.has(T)){let O=ap(S.get(T),R.get(T));null!==O&&K.set(T,O),N=N.add(T)}}),M.push(this.documentOverlayCache.saveOverlays(T,U,K))}return tf.waitFor(M)}).next(()=>R)}recalculateAndSaveOverlaysForDocumentKeys(T,S){return this.remoteDocumentCache.getEntries(T,S).next(S=>this.recalculateAndSaveOverlays(T,S))}getDocumentsMatchingQuery(T,S,R,O){return sg(S)?this.getDocumentsMatchingDocumentQuery(T,S.path):sy(S)?this.getDocumentsMatchingCollectionGroupQuery(T,S,R,O):this.getDocumentsMatchingCollectionQuery(T,S,R,O)}getNextDocuments(T,S,R,O){return this.remoteDocumentCache.getAllFromCollectionGroup(T,S,R,O).next(N=>{let M=O-N.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(T,S,R.largestBatchId,O-N.size):tf.resolve(sG()),L=e3,U=N;return M.next(S=>tf.forEach(S,(S,R)=>(L<R.largestBatchId&&(L=R.largestBatchId),N.get(S))?tf.resolve():this.remoteDocumentCache.getEntry(T,S).next(T=>{U=U.insert(S,T)})).next(()=>this.populateOverlays(T,S,N)).next(()=>this.computeViews(T,U,S,sJ())).next(T=>({batchId:L,changes:sH(T)})))})}getDocumentsMatchingDocumentQuery(T,S){return this.getDocument(T,new eG(S)).next(T=>{let S=sz();return T.isFoundDocument()&&(S=S.insert(T.key,T)),S})}getDocumentsMatchingCollectionGroupQuery(T,S,R,O){let N=S.collectionGroup,M=sz();return this.indexManager.getCollectionParents(T,N).next(L=>tf.forEach(L,L=>{let U=sf(S,L.child(N));return this.getDocumentsMatchingCollectionQuery(T,U,R,O).next(T=>{T.forEach((T,S)=>{M=M.insert(T,S)})})}).next(()=>M))}getDocumentsMatchingCollectionQuery(T,S,R,O){let N;return this.documentOverlayCache.getOverlaysForCollection(T,S.path,R.largestBatchId).next(M=>(N=M,this.remoteDocumentCache.getDocumentsMatchingQuery(T,S,R,N,O))).next(T=>{N.forEach((S,R)=>{let O=R.getKey();null===T.get(O)&&(T=T.insert(O,iC.newInvalidDocument(O)))});let R=sz();return T.forEach((T,O)=>{let M=N.get(T);void 0!==M&&ag(M.mutation,O,nn.empty(),e1.now()),sN(S,O)&&(R=R.insert(T,O))}),R})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cR{constructor(T){this.serializer=T,this.bundles=new Map,this.namedQueries=new Map}getBundleMetadata(T,S){return tf.resolve(this.bundles.get(S))}saveBundleMetadata(T,S){return this.bundles.set(S.id,lk(S)),tf.resolve()}getNamedQuery(T,S){return tf.resolve(this.namedQueries.get(S))}saveNamedQuery(T,S){return this.namedQueries.set(S.name,lN(S)),tf.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA{constructor(){this.overlays=new r4(eG.comparator),this.overlayByBatchId=new Map}getOverlay(T,S){return tf.resolve(this.overlays.get(S))}getOverlays(T,S){let R=sG();return tf.forEach(S,S=>this.getOverlay(T,S).next(T=>{null!==T&&R.set(S,T)})).next(()=>R)}saveOverlays(T,S,R){return R.forEach((R,O)=>{this.saveOverlay(T,S,O)}),tf.resolve()}removeOverlaysForBatchId(T,S,R){let O=this.overlayByBatchId.get(R);return void 0!==O&&(O.forEach(T=>this.overlays=this.overlays.remove(T)),this.overlayByBatchId.delete(R)),tf.resolve()}getOverlaysForCollection(T,S,R){let O=sG(),N=S.length+1,M=new eG(S.child("")),L=this.overlays.getIteratorFrom(M);for(;L.hasNext();){let T=L.getNext(),M=T.value,U=M.getKey();if(!S.isPrefixOf(U.path))break;U.path.length===N&&M.largestBatchId>R&&O.set(M.getKey(),M)}return tf.resolve(O)}getOverlaysForCollectionGroup(T,S,R,O){let N=new r4((T,S)=>T-S),M=this.overlays.getIterator();for(;M.hasNext();){let T=M.getNext(),O=T.value,L=O.getKey();if(L.getCollectionGroup()===S&&O.largestBatchId>R){let T=N.get(O.largestBatchId);null===T&&(T=sG(),N=N.insert(O.largestBatchId,T)),T.set(O.getKey(),O)}}let L=sG(),U=N.getIterator();for(;U.hasNext();){let T=U.getNext(),S=T.value;if(S.forEach((T,S)=>L.set(T,S)),L.size()>=O)break}return tf.resolve(L)}saveOverlay(T,S,R){let O=this.overlays.get(R.key);if(null!==O){let T=this.overlayByBatchId.get(O.largestBatchId).delete(R.key);this.overlayByBatchId.set(O.largestBatchId,T)}this.overlays=this.overlays.insert(R.key,new aM(S,R));let N=this.overlayByBatchId.get(S);void 0===N&&(N=sJ(),this.overlayByBatchId.set(S,N)),this.overlayByBatchId.set(S,N.add(R.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(){this.sessionToken=no.EMPTY_BYTE_STRING}getSessionToken(T){return tf.resolve(this.sessionToken)}setSessionToken(T,S){return this.sessionToken=S,tf.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cN{constructor(){this.refsByKey=new r8(ck.compareByKey),this.refsByTarget=new r8(ck.compareByTargetId)}isEmpty(){return this.refsByKey.isEmpty()}addReference(T,S){let R=new ck(T,S);this.refsByKey=this.refsByKey.add(R),this.refsByTarget=this.refsByTarget.add(R)}addReferences(T,S){T.forEach(T=>this.addReference(T,S))}removeReference(T,S){this.removeRef(new ck(T,S))}removeReferences(T,S){T.forEach(T=>this.removeReference(T,S))}removeReferencesForId(T){let S=new eG(new ez([])),R=new ck(S,T),O=new ck(S,T+1),N=[];return this.refsByTarget.forEachInRange([R,O],T=>{this.removeRef(T),N.push(T.key)}),N}removeAllReferences(){this.refsByKey.forEach(T=>this.removeRef(T))}removeRef(T){this.refsByKey=this.refsByKey.delete(T),this.refsByTarget=this.refsByTarget.delete(T)}referencesForId(T){let S=new eG(new ez([])),R=new ck(S,T),O=new ck(S,T+1),N=sJ();return this.refsByTarget.forEachInRange([R,O],T=>{N=N.add(T.key)}),N}containsKey(T){let S=new ck(T,0),R=this.refsByKey.firstAfterOrEqual(S);return null!==R&&T.isEqual(R.key)}}class ck{constructor(T,S){this.key=T,this.targetOrBatchId=S}static compareByKey(T,S){return eG.comparator(T.key,S.key)||eD(T.targetOrBatchId,S.targetOrBatchId)}static compareByTargetId(T,S){return eD(T.targetOrBatchId,S.targetOrBatchId)||eG.comparator(T.key,S.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{constructor(T,S){this.indexManager=T,this.referenceDelegate=S,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new r8(ck.compareByKey)}checkEmpty(T){return tf.resolve(0===this.mutationQueue.length)}addMutationBatch(T,S,R,O){let N=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let M=new aP(N,S,R,O);for(let S of(this.mutationQueue.push(M),O))this.batchesByDocumentKey=this.batchesByDocumentKey.add(new ck(S.key,N)),this.indexManager.addToCollectionParentIndex(T,S.key.path.popLast());return tf.resolve(M)}lookupMutationBatch(T,S){return tf.resolve(this.findMutationBatch(S))}getNextMutationBatchAfterBatchId(T,S){let R=S+1,O=this.indexOfBatchId(R),N=O<0?0:O;return tf.resolve(this.mutationQueue.length>N?this.mutationQueue[N]:null)}getHighestUnacknowledgedBatchId(){return tf.resolve(0===this.mutationQueue.length?nR:this.nextBatchId-1)}getAllMutationBatches(T){return tf.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(T,S){let R=new ck(S,0),O=new ck(S,Number.POSITIVE_INFINITY),N=[];return this.batchesByDocumentKey.forEachInRange([R,O],T=>{let S=this.findMutationBatch(T.targetOrBatchId);N.push(S)}),tf.resolve(N)}getAllMutationBatchesAffectingDocumentKeys(T,S){let R=new r8(eD);return S.forEach(T=>{let S=new ck(T,0),O=new ck(T,Number.POSITIVE_INFINITY);this.batchesByDocumentKey.forEachInRange([S,O],T=>{R=R.add(T.targetOrBatchId)})}),tf.resolve(this.findMutationBatches(R))}getAllMutationBatchesAffectingQuery(T,S){let R=S.path,O=R.length+1,N=R;eG.isDocumentKey(N)||(N=N.child(""));let M=new ck(new eG(N),0),L=new r8(eD);return this.batchesByDocumentKey.forEachWhile(T=>{let S=T.key.path;return!!R.isPrefixOf(S)&&(S.length===O&&(L=L.add(T.targetOrBatchId)),!0)},M),tf.resolve(this.findMutationBatches(L))}findMutationBatches(T){let S=[];return T.forEach(T=>{let R=this.findMutationBatch(T);null!==R&&S.push(R)}),S}removeMutationBatch(T,S){let R=this.indexOfExistingBatchId(S.batchId,"removed");ev(0===R,55003),this.mutationQueue.shift();let O=this.batchesByDocumentKey;return tf.forEach(S.mutations,R=>{let N=new ck(R.key,S.batchId);return O=O.delete(N),this.referenceDelegate.markPotentiallyOrphaned(T,R.key)}).next(()=>{this.batchesByDocumentKey=O})}removeCachedMutationKeys(T){}containsKey(T,S){let R=new ck(S,0),O=this.batchesByDocumentKey.firstAfterOrEqual(R);return tf.resolve(S.isEqual(O&&O.key))}performConsistencyCheck(T){return this.mutationQueue.length,tf.resolve()}indexOfExistingBatchId(T,S){let R=this.indexOfBatchId(T);return R}indexOfBatchId(T){if(0===this.mutationQueue.length)return 0;let S=this.mutationQueue[0].batchId;return T-S}findMutationBatch(T){let S=this.indexOfBatchId(T);if(S<0||S>=this.mutationQueue.length)return null;let R=this.mutationQueue[S];return R}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cD="-9223372036854775808";function cM(){return new r4(eG.comparator)}class cx{constructor(T){this.sizer=T,this.docs=cM(),this.size=0}setIndexManager(T){this.indexManager=T}addEntry(T,S){let R=S.key,O=this.docs.get(R),N=O?O.size:0,M=this.sizer(S);return this.docs=this.docs.insert(R,{document:S.mutableCopy(),size:M}),this.size+=M-N,this.indexManager.addToCollectionParentIndex(T,R.path.popLast())}removeEntry(T){let S=this.docs.get(T);S&&(this.docs=this.docs.remove(T),this.size-=S.size)}getEntry(T,S){let R=this.docs.get(S);return tf.resolve(R?R.document.mutableCopy():iC.newInvalidDocument(S))}getEntries(T,S){let R=sB();return S.forEach(T=>{let S=this.docs.get(T);R=R.insert(T,S?S.document.mutableCopy():iC.newInvalidDocument(T))}),tf.resolve(R)}getDocumentsMatchingQuery(T,S,R,O){let N=sB(),M=S.path,L=new eG(M.child("__id"+cD+"__")),U=this.docs.getIteratorFrom(L);for(;U.hasNext();){let{key:T,value:{document:L}}=U.getNext();if(!M.isPrefixOf(T.path))break;!(T.path.length>M.length+1||0>=tu(ta(L),R))&&(O.has(L.key)||sN(S,L))&&(N=N.insert(L.key,L.mutableCopy()))}return tf.resolve(N)}getAllFromCollectionGroup(T,S,R,O){eg(9500)}forEachDocumentKey(T,S){return tf.forEach(this.docs,T=>S(T))}newChangeBuffer(T){return new cF(this)}getSize(T){return tf.resolve(this.size)}}function cL(T){return new cx(T)}class cF extends ch{constructor(T){super(),this.documentCache=T}applyChanges(T){let S=[];return this.changes.forEach((R,O)=>{O.isValidDocument()?S.push(this.documentCache.addEntry(T,O)):this.documentCache.removeEntry(R)}),tf.waitFor(S)}getFromCache(T,S){return this.documentCache.getEntry(T,S)}getAllFromCache(T,S){return this.documentCache.getEntries(T,S)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cU{constructor(T){this.persistence=T,this.targets=new sU(T=>i5(T),i7),this.lastRemoteSnapshotVersion=e2.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new cN,this.targetCount=0,this.targetIdGenerator=u0.forTargetCache()}forEachTarget(T,S){return this.targets.forEach((T,R)=>S(R)),tf.resolve()}getLastRemoteSnapshotVersion(T){return tf.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(T){return tf.resolve(this.highestSequenceNumber)}allocateTargetId(T){return this.highestTargetId=this.targetIdGenerator.next(),tf.resolve(this.highestTargetId)}setTargetsMetadata(T,S,R){return R&&(this.lastRemoteSnapshotVersion=R),S>this.highestSequenceNumber&&(this.highestSequenceNumber=S),tf.resolve()}saveTargetData(T){this.targets.set(T.target,T);let S=T.targetId;S>this.highestTargetId&&(this.targetIdGenerator=new u0(S),this.highestTargetId=S),T.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=T.sequenceNumber)}addTargetData(T,S){return this.saveTargetData(S),this.targetCount+=1,tf.resolve()}updateTargetData(T,S){return this.saveTargetData(S),tf.resolve()}removeTargetData(T,S){return this.targets.delete(S.target),this.references.removeReferencesForId(S.targetId),this.targetCount-=1,tf.resolve()}removeTargets(T,S,R){let O=0,N=[];return this.targets.forEach((M,L)=>{L.sequenceNumber<=S&&null===R.get(L.targetId)&&(this.targets.delete(M),N.push(this.removeMatchingKeysForTargetId(T,L.targetId)),O++)}),tf.waitFor(N).next(()=>O)}getTargetCount(T){return tf.resolve(this.targetCount)}getTargetData(T,S){let R=this.targets.get(S)||null;return tf.resolve(R)}addMatchingKeys(T,S,R){return this.references.addReferences(S,R),tf.resolve()}removeMatchingKeys(T,S,R){this.references.removeReferences(S,R);let O=this.persistence.referenceDelegate,N=[];return O&&S.forEach(S=>{N.push(O.markPotentiallyOrphaned(T,S))}),tf.waitFor(N)}removeMatchingKeysForTargetId(T,S){return this.references.removeReferencesForId(S),tf.resolve()}getMatchingKeysForTargetId(T,S){let R=this.references.referencesForId(S);return tf.resolve(R)}containsKey(T,S){return tf.resolve(this.references.containsKey(S))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cj="MemoryPersistence";class cB{constructor(T,S){this.mutationQueues={},this.overlays={},this.listenSequence=new tP(0),this._started=!1,this._started=!0,this.globalsCache=new cO,this.referenceDelegate=T(this),this.targetCache=new cU(this);let R=T=>this.referenceDelegate.documentSize(T);this.indexManager=new ux,this.remoteDocumentCache=cL(R),this.serializer=new lf(S),this.bundleCache=new cR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this._started=!1,Promise.resolve()}get started(){return this._started}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(T){return this.indexManager}getDocumentOverlayCache(T){let S=this.overlays[T.toKey()];return S||(S=new cA,this.overlays[T.toKey()]=S),S}getMutationQueue(T,S){let R=this.mutationQueues[T.toKey()];return R||(R=new cP(S,this.referenceDelegate),this.mutationQueues[T.toKey()]=R),R}getGlobalsCache(){return this.globalsCache}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.bundleCache}runTransaction(T,S,R){eh(cj,"Starting transaction:",T);let O=new cV(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),R(O).next(T=>this.referenceDelegate.onTransactionCommitted(O).next(()=>T)).toPromise().then(T=>(O.raiseOnCommittedEvent(),T))}mutationQueuesContainKey(T,S){return tf.or(Object.values(this.mutationQueues).map(R=>()=>R.containsKey(T,S)))}}class cV extends td{constructor(T){super(),this.currentSequenceNumber=T}}class cz{constructor(T){this.persistence=T,this.localViewReferences=new cN,this._orphanedDocuments=null}static factory(T){return new cz(T)}get orphanedDocuments(){if(this._orphanedDocuments)return this._orphanedDocuments;throw eg(60996)}addReference(T,S,R){return this.localViewReferences.addReference(R,S),this.orphanedDocuments.delete(R.toString()),tf.resolve()}removeReference(T,S,R){return this.localViewReferences.removeReference(R,S),this.orphanedDocuments.add(R.toString()),tf.resolve()}markPotentiallyOrphaned(T,S){return this.orphanedDocuments.add(S.toString()),tf.resolve()}removeTarget(T,S){let R=this.localViewReferences.removeReferencesForId(S.targetId);R.forEach(T=>this.orphanedDocuments.add(T.toString()));let O=this.persistence.getTargetCache();return O.getMatchingKeysForTargetId(T,S.targetId).next(T=>{T.forEach(T=>this.orphanedDocuments.add(T.toString()))}).next(()=>O.removeTargetData(T,S))}onTransactionStarted(){this._orphanedDocuments=new Set}onTransactionCommitted(T){let S=this.persistence.getRemoteDocumentCache(),R=S.newChangeBuffer();return tf.forEach(this.orphanedDocuments,S=>{let O=eG.fromPath(S);return this.isReferenced(T,O).next(T=>{T||R.removeEntry(O,e2.min())})}).next(()=>(this._orphanedDocuments=null,R.apply(T)))}updateLimboDocument(T,S){return this.isReferenced(T,S).next(T=>{T?this.orphanedDocuments.delete(S.toString()):this.orphanedDocuments.add(S.toString())})}documentSize(T){return 0}isReferenced(T,S){return tf.or([()=>tf.resolve(this.localViewReferences.containsKey(S)),()=>this.persistence.getTargetCache().containsKey(T,S),()=>this.persistence.mutationQueuesContainKey(T,S)])}}class cq{constructor(T,S){this.persistence=T,this.orphanedSequenceNumbers=new sU(T=>tU(T.path),(T,S)=>T.isEqual(S)),this.garbageCollector=co(this,S)}static factory(T,S){return new cq(T,S)}onTransactionStarted(){}onTransactionCommitted(T){return tf.resolve()}forEachTarget(T,S){return this.persistence.getTargetCache().forEachTarget(T,S)}getSequenceNumberCount(T){let S=this.orphanedDocumentCount(T),R=this.persistence.getTargetCache().getTargetCount(T);return R.next(T=>S.next(S=>T+S))}orphanedDocumentCount(T){let S=0;return this.forEachOrphanedDocumentSequenceNumber(T,T=>{S++}).next(()=>S)}forEachOrphanedDocumentSequenceNumber(T,S){return tf.forEach(this.orphanedSequenceNumbers,(R,O)=>this.isPinned(T,R,O).next(T=>T?tf.resolve():S(O)))}removeTargets(T,S,R){return this.persistence.getTargetCache().removeTargets(T,S,R)}removeOrphanedDocuments(T,S){let R=0,O=this.persistence.getRemoteDocumentCache(),N=O.newChangeBuffer(),M=O.forEachDocumentKey(T,O=>this.isPinned(T,O,S).next(T=>{T||(R++,N.removeEntry(O,e2.min()))}));return M.next(()=>N.apply(T)).next(()=>R)}markPotentiallyOrphaned(T,S){return this.orphanedSequenceNumbers.set(S,T.currentSequenceNumber),tf.resolve()}removeTarget(T,S){let R=S.withSequenceNumber(T.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(T,R)}addReference(T,S,R){return this.orphanedSequenceNumbers.set(R,T.currentSequenceNumber),tf.resolve()}removeReference(T,S,R){return this.orphanedSequenceNumbers.set(R,T.currentSequenceNumber),tf.resolve()}updateLimboDocument(T,S){return this.orphanedSequenceNumbers.set(S,T.currentSequenceNumber),tf.resolve()}documentSize(T){let S=T.key.toString().length;return T.isFoundDocument()&&(S+=ie(T.data.value)),S}isPinned(T,S,R){return tf.or([()=>this.persistence.mutationQueuesContainKey(T,S),()=>this.persistence.getTargetCache().containsKey(T,S),()=>{let T=this.orphanedSequenceNumbers.get(S);return tf.resolve(void 0!==T&&T>R)}])}getCacheSize(T){return this.persistence.getRemoteDocumentCache().getSize(T)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cH{constructor(T){this.serializer=T}createOrUpgrade(T,S,R,O){let N=new tg("createOrUpgrade",S);R<1&&O>=1&&(cW(T),cK(T),cX(T),cQ(T));let M=tf.resolve();return R<3&&O>=3&&(0!==R&&(cZ(T),cX(T)),M=M.next(()=>c6(N))),R<4&&O>=4&&(0!==R&&(M=M.next(()=>c$(T,N))),M=M.next(()=>{c9(T)})),R<5&&O>=5&&(M=M.next(()=>this.removeAcknowledgedMutations(N))),R<6&&O>=6&&(M=M.next(()=>(cJ(T),this.addDocumentGlobal(N)))),R<7&&O>=7&&(M=M.next(()=>this.ensureSequenceNumbers(N))),R<8&&O>=8&&(M=M.next(()=>this.createCollectionParentIndex(T,N))),R<9&&O>=9&&(M=M.next(()=>{c0(T)})),R<10&&O>=10&&(M=M.next(()=>this.rewriteCanonicalIds(N))),R<11&&O>=11&&(M=M.next(()=>{c5(T),c8(T)})),R<12&&O>=12&&(M=M.next(()=>{de(T)})),R<13&&O>=13&&(M=M.next(()=>cY(T)).next(()=>this.rewriteRemoteDocumentCache(T,N)).next(()=>T.deleteObjectStore(tz))),R<14&&O>=14&&(M=M.next(()=>this.runOverlayMigration(T,N))),R<15&&O>=15&&(M=M.next(()=>c7(T))),R<16&&O>=16&&(M=M.next(()=>{let T=S.objectStore(rE);T.clear()}).next(()=>{let T=S.objectStore(rR);T.clear()})),R<17&&O>=17&&(M=M.next(()=>{dt(T)})),R<18&&O>=18&&isSafariOrWebkit()&&(M=M.next(()=>{let T=S.objectStore(rE);T.clear()}).next(()=>{let T=S.objectStore(rR);T.clear()})),M}addDocumentGlobal(T){let S=0;return T.store(tz).iterate((T,R)=>{S+=uW(R)}).next(()=>{let R={byteSize:S};return T.store(t8).put(t7,R)})}removeAcknowledgedMutations(T){let S=T.store(tG),R=T.store(tK);return S.loadAll().next(S=>tf.forEach(S,S=>{let O=IDBKeyRange.bound([S.userId,nR],[S.userId,S.lastAcknowledgedBatchId]);return R.loadAll(tQ,O).next(R=>tf.forEach(R,R=>{ev(R.userId===S.userId,18650,"Cannot process batch from unexpected user",{batchId:R.batchId});let O=lT(this.serializer,R);return uG(T,S.userId,O).next(()=>{})}))}))}ensureSequenceNumbers(T){let S=T.store(rs),R=T.store(tz),O=T.store(rc);return O.get(ru).next(T=>{let O=R=>S.put({targetId:0,path:tU(R),sequenceNumber:T.highestListenSequenceNumber}),N=[];return R.iterate((T,R)=>{let M=new ez(T),L=cG(M);N.push(S.get(L).next(T=>T?tf.resolve():O(M)))}).next(()=>tf.waitFor(N))})}createCollectionParentIndex(T,S){T.createObjectStore(rd,{keyPath:rh});let R=S.store(rd),O=new uL,N=T=>{if(O.add(T)){let S=T.lastSegment(),O=T.popLast();return R.put({collectionId:S,parent:tU(O)})}};return S.store(tz).iterate({keysOnly:!0},(T,S)=>{let R=new ez(T);return N(R.popLast())}).next(()=>S.store(t1).iterate({keysOnly:!0},([T,S,R],O)=>{let M=tV(S);return N(M.popLast())}))}rewriteCanonicalIds(T){let S=T.store(rt);return S.iterate((T,R)=>{let O=lS(R),N=lE(this.serializer,O);return S.put(N)})}rewriteRemoteDocumentCache(T,S){let R=S.store(tz),O=[];return R.iterate((T,R)=>{let N=S.store(t2),M=dr(R).path.toArray(),L={prefixPath:M.slice(0,M.length-2),collectionGroup:M[M.length-2],documentId:M[M.length-1],readTime:R.readTime||[0,0],unknownDocument:R.unknownDocument,noDocument:R.noDocument,document:R.document,hasCommittedMutations:!!R.hasCommittedMutations};O.push(N.put(L))}).next(()=>tf.waitFor(O))}runOverlayMigration(T,S){let R=S.store(tK),O=cp(this.serializer),N=new cB(cz.factory,this.serializer.remoteSerializer);return R.loadAll().next(T=>{let R=new Map;return T.forEach(T=>{let S=R.get(T.userId)??sJ(),O=lT(this.serializer,T);O.keys().forEach(T=>S=S.add(T)),R.set(T.userId,S)}),tf.forEach(R,(T,R)=>{let M=new ei(R),L=lV.forUser(this.serializer,M),U=N.getIndexManager(M),V=uK.forUser(M,this.serializer,U,N.referenceDelegate),K=new cI(O,V,L,U);return K.recalculateAndSaveOverlaysForDocumentKeys(new rZ(S,tP.INVALID),T).next()})})}}function cG(T){return[0,tU(T)]}function cW(T){T.createObjectStore(tq)}function cK(T){T.createObjectStore(tG,{keyPath:tW});let S=T.createObjectStore(tK,{keyPath:t$,autoIncrement:!0});S.createIndex(tQ,tY,{unique:!0}),T.createObjectStore(t1)}function c$(T,S){let R=S.store(tK);return R.loadAll().next(R=>{T.deleteObjectStore(tK);let O=T.createObjectStore(tK,{keyPath:t$,autoIncrement:!0});O.createIndex(tQ,tY,{unique:!0});let N=S.store(tK),M=R.map(T=>N.put(T));return tf.waitFor(M)})}function cQ(T){T.createObjectStore(tz)}function cY(T){let S=T.createObjectStore(t2,{keyPath:t3});S.createIndex(t4,t6),S.createIndex(t9,t5)}function cJ(T){T.createObjectStore(t8)}function cX(T){let S=T.createObjectStore(rs,{keyPath:ra});S.createIndex(ro,rl,{unique:!0});let R=T.createObjectStore(rt,{keyPath:rr});R.createIndex(rn,ri,{unique:!0}),T.createObjectStore(rc)}function cZ(T){T.deleteObjectStore(rs),T.deleteObjectStore(rt),T.deleteObjectStore(rc)}function c0(T){T.objectStoreNames.contains("remoteDocumentChanges")&&T.deleteObjectStore("remoteDocumentChanges")}function c6(T){let S=T.store(rc),R={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:e2.min().toTimestamp(),targetCount:0};return S.put(ru,R)}function c9(T){T.createObjectStore(rf,{keyPath:rp})}function c5(T){T.createObjectStore(rm,{keyPath:rg})}function c8(T){T.createObjectStore(ry,{keyPath:rv})}function c7(T){let S=T.createObjectStore(rb,{keyPath:r_,autoIncrement:!0});S.createIndex(rT,rS,{unique:!1});let R=T.createObjectStore(rE,{keyPath:rw});R.createIndex(rC,rI,{unique:!1});let O=T.createObjectStore(rR,{keyPath:rA});O.createIndex(rO,rN,{unique:!1})}function de(T){let S=T.createObjectStore(rk,{keyPath:rP});S.createIndex(rD,rM,{unique:!1}),S.createIndex(rx,rL,{unique:!1})}function dt(T){T.createObjectStore(rF,{keyPath:rU})}function dr(T){return T.document?new eG(ez.fromString(T.document.name).popFirst(5)):T.noDocument?eG.fromSegments(T.noDocument.path):T.unknownDocument?eG.fromSegments(T.unknownDocument.path):eg(36783)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dn="IndexedDbPersistence",di=null,ds=5e3,da=4e3,dl=null,du=null,dc="firestore_zombie",dd="main";class dh{constructor(T,S,R,O,N,M,L,U,V,K,$=cw){if(this.allowTabSynchronization=T,this.persistenceKey=S,this.clientId=R,this.queue=N,this.window=M,this.document=L,this.sequenceNumberSyncer=V,this.forceOwningTab=K,this.schemaVersion=$,this.listenSequence=null,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=T=>Promise.resolve(),!dh.isAvailable())throw new eT(e_.UNIMPLEMENTED,du);this.referenceDelegate=new cl(this,O),this.dbName=S+dd,this.serializer=new lf(U),this.simpleDb=new ty(this.dbName,this.schemaVersion,new cH(this.serializer)),this.globalsCache=new lq,this.targetCache=new u1(this.referenceDelegate,this.serializer),this.remoteDocumentCache=cp(this.serializer),this.bundleCache=new lU,this.window&&this.window.localStorage?this.webStorage=this.window.localStorage:(this.webStorage=null,!1===K&&ef(dn,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.updateClientMetadataAndTryBecomePrimary().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new eT(e_.FAILED_PRECONDITION,dl);return this.attachVisibilityHandler(),this.attachWindowUnloadHook(),this.scheduleClientMetadataAndPrimaryLeaseRefreshes(),this.runTransaction("getHighestListenSequenceNumber","readonly",T=>this.targetCache.getHighestSequenceNumber(T))}).then(T=>{this.listenSequence=new tP(T,this.sequenceNumberSyncer)}).then(()=>{this._started=!0}).catch(T=>(this.simpleDb&&this.simpleDb.close(),Promise.reject(T)))}setPrimaryStateListener(T){return this.primaryStateListener=async S=>{if(this.started)return T(S)},T(this.isPrimary)}setDatabaseDeletedListener(T){this.simpleDb.setVersionChangeListener(async S=>{null===S.newVersion&&await T()})}setNetworkEnabled(T){this.networkEnabled!==T&&(this.networkEnabled=T,this.queue.enqueueAndForget(async()=>{this.started&&await this.updateClientMetadataAndTryBecomePrimary()}))}updateClientMetadataAndTryBecomePrimary(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",T=>{let S=dp(T);return S.put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.verifyPrimaryLease(T).next(T=>{T||(this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)))})}).next(()=>this.canActAsPrimary(T)).next(S=>this.isPrimary&&!S?this.releasePrimaryLeaseIfHeld(T).next(()=>!1):!!S&&this.acquireOrExtendPrimaryLease(T).next(()=>!0))}).catch(T=>{if(tT(T))return eh(dn,"Failed to extend owner lease: ",T),this.isPrimary;if(!this.allowTabSynchronization)throw T;return eh(dn,"Releasing owner lease after error during lease refresh",T),!1}).then(T=>{this.isPrimary!==T&&this.queue.enqueueRetryable(()=>this.primaryStateListener(T)),this.isPrimary=T})}verifyPrimaryLease(T){let S=df(T);return S.get(tH).next(T=>tf.resolve(this.isLocalClient(T)))}removeClientMetadata(T){let S=dp(T);return S.delete(this.clientId)}async maybeGarbageCollectMultiClientState(){if(this.isPrimary&&!this.isWithinAge(this.lastGarbageCollectionTime,di)){this.lastGarbageCollectionTime=Date.now();let T=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",T=>{let S=r0(T,rf);return S.loadAll().next(T=>{let R=this.filterActiveClients(T,di),O=T.filter(T=>-1===R.indexOf(T));return tf.forEach(O,T=>S.delete(T.clientId)).next(()=>O)})}).catch(()=>[]);if(this.webStorage)for(let S of T)this.webStorage.removeItem(this.zombiedClientLocalStorageKey(S.clientId))}}scheduleClientMetadataAndPrimaryLeaseRefreshes(){this.clientMetadataRefresher=this.queue.enqueueAfterDelay("client_metadata_refresh",da,()=>this.updateClientMetadataAndTryBecomePrimary().then(()=>this.maybeGarbageCollectMultiClientState()).then(()=>this.scheduleClientMetadataAndPrimaryLeaseRefreshes()))}isLocalClient(T){return!!T&&T.ownerId===this.clientId}canActAsPrimary(T){if(this.forceOwningTab)return tf.resolve(!0);let S=df(T);return S.get(tH).next(S=>{let R=null!==S&&this.isWithinAge(S.leaseTimestampMs,ds)&&!this.isClientZombied(S.ownerId);if(R){if(this.isLocalClient(S)&&this.networkEnabled)return!0;if(!this.isLocalClient(S)){if(!S.allowTabSynchronization)throw new eT(e_.FAILED_PRECONDITION,dl);return!1}}return!!this.networkEnabled&&!!this.inForeground||dp(T).loadAll().next(T=>{let S=this.filterActiveClients(T,ds).find(T=>{if(this.clientId!==T.clientId){let S=!this.networkEnabled&&T.networkEnabled,R=!this.inForeground&&T.inForeground,O=this.networkEnabled===T.networkEnabled;if(S||R&&O)return!0}return!1});return void 0===S})}).next(T=>(this.isPrimary!==T&&eh(dn,`Client ${T?"is":"is not"} eligible for a primary lease.`),T))}async shutdown(){this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),await this.simpleDb.runTransaction("shutdown","readwrite",[tq,rf],T=>{let S=new rZ(T,tP.INVALID);return this.releasePrimaryLeaseIfHeld(S).next(()=>this.removeClientMetadata(S))}),this.simpleDb.close(),this.removeClientZombiedEntry()}filterActiveClients(T,S){return T.filter(T=>this.isWithinAge(T.updateTimeMs,S)&&!this.isClientZombied(T.clientId))}getActiveClients(){return this.runTransaction("getActiveClients","readonly",T=>dp(T).loadAll().next(T=>this.filterActiveClients(T,di).map(T=>T.clientId)))}get started(){return this._started}getGlobalsCache(){return this.globalsCache}getMutationQueue(T,S){return uK.forUser(T,this.serializer,S,this.referenceDelegate)}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(T){return new uj(T,this.serializer.remoteSerializer.databaseId)}getDocumentOverlayCache(T){return lV.forUser(this.serializer,T)}getBundleCache(){return this.bundleCache}runTransaction(T,S,R){let O;eh(dn,"Starting transaction:",T);let N="readonly"===S?"readonly":"readwrite",M=rX(this.schemaVersion);return this.simpleDb.runTransaction(T,N,M,N=>(O=new rZ(N,this.listenSequence?this.listenSequence.next():tP.INVALID),"readwrite-primary"===S)?this.verifyPrimaryLease(O).next(T=>!!T||this.canActAsPrimary(O)).next(S=>{if(!S)throw ef(`Failed to obtain primary lease for action '${T}'.`),this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)),new eT(e_.FAILED_PRECONDITION,tc);return R(O)}).next(T=>this.acquireOrExtendPrimaryLease(O).next(()=>T)):this.verifyAllowTabSynchronization(O).next(()=>R(O))).then(T=>(O.raiseOnCommittedEvent(),T))}verifyAllowTabSynchronization(T){let S=df(T);return S.get(tH).next(T=>{let S=null!==T&&this.isWithinAge(T.leaseTimestampMs,ds)&&!this.isClientZombied(T.ownerId);if(S&&!this.isLocalClient(T)&&!this.forceOwningTab&&(!this.allowTabSynchronization||!T.allowTabSynchronization))throw new eT(e_.FAILED_PRECONDITION,dl)})}acquireOrExtendPrimaryLease(T){let S={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return df(T).put(tH,S)}static isAvailable(){return ty.isAvailable()}releasePrimaryLeaseIfHeld(T){let S=df(T);return S.get(tH).next(T=>this.isLocalClient(T)?(eh(dn,"Releasing primary lease."),S.delete(tH)):tf.resolve())}isWithinAge(T,S){let R=Date.now(),O=R-S,N=R;return!(T<O)&&(!(T>N)||(ef(`Detected an update time that is in the future: ${T} > ${N}`),!1))}attachVisibilityHandler(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=()=>{this.queue.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.updateClientMetadataAndTryBecomePrimary()))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)}detachVisibilityHandler(){this.documentVisibilityHandler&&(this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)}attachWindowUnloadHook(){"function"==typeof this.window?.addEventListener&&(this.windowUnloadHandler=()=>{this.markClientZombied();let T=/(?:Version|Mobile)\/1[456]/;isSafari()&&(navigator.appVersion.match(T)||navigator.userAgent.match(T))&&this.queue.enterRestrictedMode(!0),this.queue.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.windowUnloadHandler))}detachWindowUnloadHook(){this.windowUnloadHandler&&(this.window.removeEventListener("pagehide",this.windowUnloadHandler),this.windowUnloadHandler=null)}isClientZombied(T){try{let S=this.webStorage?.getItem(this.zombiedClientLocalStorageKey(T))!==null;return eh(dn,`Client '${T}' ${S?"is":"is not"} zombied in LocalStorage`),S}catch(T){return ef(dn,"Failed to get zombied client id.",T),!1}}markClientZombied(){if(this.webStorage)try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(T){ef("Failed to set zombie client id.",T)}}removeClientZombiedEntry(){if(this.webStorage)try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(T){}}zombiedClientLocalStorageKey(T){return`${dc}_${this.persistenceKey}_${T}`}}function df(T){return r0(T,tq)}function dp(T){return r0(T,rf)}function dm(T,S){let R=T.projectId;return T.isDefaultDatabase||(R+="."+T.database),"firestore/"+S+"/"+R+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dg(T,S,R,O,N){S=[...S],(T=[...T]).sort(R),S.sort(R);let M=T.length,L=S.length,U=0,V=0;for(;U<L&&V<M;){let M=R(T[V],S[U]);M<0?N(T[V++]):M>0?O(S[U++]):(U++,V++)}for(;U<L;)O(S[U++]);for(;V<M;)N(T[V++])}function dy(T,S){if(T.length!==S.length)return!1;for(let R=0;R<T.length;++R)if(T[R]!==S[R])return!1;return!0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let d_="LocalStore",dT=null;class dS{constructor(T,S,R,O){this.persistence=T,this.queryEngine=S,this.serializer=O,this.targetDataByTarget=new r4(eD),this.targetIdByTarget=new sU(T=>i5(T),i7),this.collectionGroupReadTime=new Map,this.remoteDocuments=T.getRemoteDocumentCache(),this.targetCache=T.getTargetCache(),this.bundleCache=T.getBundleCache(),this.initializeUserComponents(R)}initializeUserComponents(T){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(T),this.indexManager=this.persistence.getIndexManager(T),this.mutationQueue=this.persistence.getMutationQueue(T,this.indexManager),this.localDocuments=new cI(this.remoteDocuments,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.remoteDocuments.setIndexManager(this.indexManager),this.queryEngine.initialize(this.localDocuments,this.indexManager)}collectGarbage(T){return this.persistence.runTransaction("Collect garbage","readwrite-primary",S=>T.collect(S,this.targetDataByTarget))}}function dE(T,S,R,O){return new dS(T,S,R,O)}async function dw(T,S){let R=eb(T),O=await R.persistence.runTransaction("Handle user change","readonly",T=>{let O;return R.mutationQueue.getAllMutationBatches(T).next(N=>(O=N,R.initializeUserComponents(S),R.mutationQueue.getAllMutationBatches(T))).next(S=>{let N=[],M=[],L=sJ();for(let T of O)for(let S of(N.push(T.batchId),T.mutations))L=L.add(S.key);for(let T of S)for(let S of(M.push(T.batchId),T.mutations))L=L.add(S.key);return R.localDocuments.getDocuments(T,L).next(T=>({affectedDocuments:T,removedBatchIds:N,addedBatchIds:M}))})});return O}function dC(T,S){let R,O;let N=eb(T),M=e1.now(),L=S.reduce((T,S)=>T.add(S.key),sJ());return N.persistence.runTransaction("Locally write mutations","readwrite",T=>{let U=sB(),V=sJ();return N.remoteDocuments.getEntries(T,L).next(T=>{(U=T).forEach((T,S)=>{S.isValidDocument()||(V=V.add(T))})}).next(()=>N.localDocuments.getOverlayedDocuments(T,U)).next(O=>{R=O;let L=[];for(let T of S){let S=ay(T,R.get(T.key).overlayedDocument);null!=S&&L.push(new aS(T.key,S,iw(S.value.mapValue),ad.exists(!0)))}return N.mutationQueue.addMutationBatch(T,M,L,S)}).next(S=>{O=S;let M=S.applyToLocalDocumentSet(R,V);return N.documentOverlayCache.saveOverlays(T,S.batchId,M)})}).then(()=>({batchId:O.batchId,changes:sH(R)}))}function dI(T,S){let R=eb(T);return R.persistence.runTransaction("Acknowledge batch","readwrite-primary",T=>{let O=S.batch.keys(),N=R.remoteDocuments.newChangeBuffer({trackRemovals:!0});return dV(R,T,S,N).next(()=>N.apply(T)).next(()=>R.mutationQueue.performConsistencyCheck(T)).next(()=>R.documentOverlayCache.removeOverlaysForBatchId(T,O,S.batch.batchId)).next(()=>R.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(T,dR(S))).next(()=>R.localDocuments.getDocuments(T,O))})}function dR(T){let S=sJ();for(let R=0;R<T.mutationResults.length;++R){let O=T.mutationResults[R];O.transformResults.length>0&&(S=S.add(T.batch.mutations[R].key))}return S}function dA(T,S){let R=eb(T);return R.persistence.runTransaction("Reject batch","readwrite-primary",T=>{let O;return R.mutationQueue.lookupMutationBatch(T,S).next(S=>(ev(null!==S,37113),O=S.keys(),R.mutationQueue.removeMutationBatch(T,S))).next(()=>R.mutationQueue.performConsistencyCheck(T)).next(()=>R.documentOverlayCache.removeOverlaysForBatchId(T,O,S)).next(()=>R.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(T,O)).next(()=>R.localDocuments.getDocuments(T,O))})}function dO(T){let S=eb(T);return S.persistence.runTransaction("Get highest unacknowledged batch id","readonly",T=>S.mutationQueue.getHighestUnacknowledgedBatchId(T))}function dN(T){let S=eb(T);return S.persistence.runTransaction("Get last remote snapshot version","readonly",T=>S.targetCache.getLastRemoteSnapshotVersion(T))}function dk(T,S){let R=eb(T),O=S.snapshotVersion,N=R.targetDataByTarget;return R.persistence.runTransaction("Apply remote event","readwrite-primary",T=>{let M=R.remoteDocuments.newChangeBuffer({trackRemovals:!0});N=R.targetDataByTarget;let L=[];S.targetChanges.forEach((M,U)=>{let V=N.get(U);if(!V)return;L.push(R.targetCache.removeMatchingKeys(T,M.removedDocuments,U).next(()=>R.targetCache.addMatchingKeys(T,M.addedDocuments,U)));let K=V.withSequenceNumber(T.currentSequenceNumber);null!==S.targetMismatches.get(U)?K=K.withResumeToken(no.EMPTY_BYTE_STRING,e2.min()).withLastLimboFreeSnapshotVersion(e2.min()):M.resumeToken.approximateByteSize()>0&&(K=K.withResumeToken(M.resumeToken,O)),N=N.insert(U,K),dD(V,K,M)&&L.push(R.targetCache.updateTargetData(T,K))});let U=sB(),V=sJ();if(S.documentUpdates.forEach(O=>{S.resolvedLimboDocuments.has(O)&&L.push(R.persistence.referenceDelegate.updateLimboDocument(T,O))}),L.push(dP(T,M,S.documentUpdates).next(T=>{U=T.changedDocuments,V=T.existenceChangedKeys})),!O.isEqual(e2.min())){let S=R.targetCache.getLastRemoteSnapshotVersion(T).next(S=>R.targetCache.setTargetsMetadata(T,T.currentSequenceNumber,O));L.push(S)}return tf.waitFor(L).next(()=>M.apply(T)).next(()=>R.localDocuments.getLocalViewOfDocuments(T,U,V)).next(()=>U)}).then(T=>(R.targetDataByTarget=N,T))}function dP(T,S,R){let O=sJ(),N=sJ();return R.forEach(T=>O=O.add(T)),S.getEntries(T,O).next(T=>{let O=sB();return R.forEach((R,M)=>{let L=T.get(R);M.isFoundDocument()!==L.isFoundDocument()&&(N=N.add(R)),M.isNoDocument()&&M.version.isEqual(e2.min())?(S.removeEntry(R,M.readTime),O=O.insert(R,M)):!L.isValidDocument()||M.version.compareTo(L.version)>0||0===M.version.compareTo(L.version)&&L.hasPendingWrites?(S.addEntry(M),O=O.insert(R,M)):eh(d_,"Ignoring outdated watch update for ",R,". Current version:",L.version," Watch version:",M.version)}),{changedDocuments:O,existenceChangedKeys:N}})}function dD(T,S,R){if(0===T.resumeToken.approximateByteSize())return!0;let O=S.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds();if(O>=dT)return!0;let N=R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size;return N>0}async function dM(T,S){let R=eb(T);try{await R.persistence.runTransaction("notifyLocalViewChanges","readwrite",T=>tf.forEach(S,S=>tf.forEach(S.addedKeys,O=>R.persistence.referenceDelegate.addReference(T,S.targetId,O)).next(()=>tf.forEach(S.removedKeys,O=>R.persistence.referenceDelegate.removeReference(T,S.targetId,O)))))}catch(T){if(tT(T))eh(d_,"Failed to update sequence numbers: "+T);else throw T}for(let T of S){let S=T.targetId;if(!T.fromCache){let T=R.targetDataByTarget.get(S),O=T.snapshotVersion,N=T.withLastLimboFreeSnapshotVersion(O);R.targetDataByTarget=R.targetDataByTarget.insert(S,N)}}}function dx(T,S){let R=eb(T);return R.persistence.runTransaction("Get next mutation batch","readonly",T=>(void 0===S&&(S=nR),R.mutationQueue.getNextMutationBatchAfterBatchId(T,S)))}function dL(T,S){let R=eb(T);return R.persistence.runTransaction("read document","readonly",T=>R.localDocuments.getDocument(T,S))}function dF(T,S){let R=eb(T);return R.persistence.runTransaction("Allocate target","readwrite",T=>{let O;return R.targetCache.getTargetData(T,S).next(N=>N?(O=N,tf.resolve(O)):R.targetCache.allocateTargetId(T).next(N=>(O=new lh(S,N,"TargetPurposeListen",T.currentSequenceNumber),R.targetCache.addTargetData(T,O).next(()=>O))))}).then(T=>{let O=R.targetDataByTarget.get(T.targetId);return(null===O||T.snapshotVersion.compareTo(O.snapshotVersion)>0)&&(R.targetDataByTarget=R.targetDataByTarget.insert(T.targetId,T),R.targetIdByTarget.set(S,T.targetId)),T})}function dU(T,S,R){let O=eb(T),N=O.targetIdByTarget.get(R);return void 0!==N?tf.resolve(O.targetDataByTarget.get(N)):O.targetCache.getTargetData(S,R)}async function dj(T,S,R){let O=eb(T),N=O.targetDataByTarget.get(S),M=R?"readwrite":"readwrite-primary";try{R||await O.persistence.runTransaction("Release target",M,T=>O.persistence.referenceDelegate.removeTarget(T,N))}catch(T){if(tT(T))eh(d_,`Failed to update sequence numbers for target ${S}: ${T}`);else throw T}O.targetDataByTarget=O.targetDataByTarget.remove(S),O.targetIdByTarget.delete(N.target)}function dB(T,S,R){let O=eb(T),N=e2.min(),M=sJ();return O.persistence.runTransaction("Execute query","readwrite",T=>dU(O,T,sb(S)).next(S=>{if(S)return N=S.lastLimboFreeSnapshotVersion,O.targetCache.getMatchingKeysForTargetId(T,S.targetId).next(T=>{M=T})}).next(()=>O.queryEngine.getDocumentsMatchingQuery(T,S,R?N:e2.min(),R?M:sJ())).next(T=>(dK(O,sx(S),T),{documents:T,remoteKeys:M})))}function dV(T,S,R,O){let N=R.batch,M=N.keys(),L=tf.resolve();return M.forEach(T=>{L=L.next(()=>O.getEntry(S,T)).next(S=>{let M=R.docVersions.get(T);ev(null!==M,48541),0>S.version.compareTo(M)&&(N.applyToRemoteDocument(S,R),S.isValidDocument()&&(S.setReadTime(R.commitVersion),O.addEntry(S)))})}),L.next(()=>T.mutationQueue.removeMutationBatch(S,N))}function dz(T,S){let R=eb(T),O=eb(R.mutationQueue);return R.persistence.runTransaction("Lookup mutation documents","readonly",T=>O.lookupMutationKeys(T,S).next(S=>S?R.localDocuments.getDocuments(T,S):tf.resolve(null)))}function dq(T,S){let R=eb(eb(T,dS).mutationQueue);R.removeCachedMutationKeys(S)}function dH(T){let S=eb(eb(T,dS).persistence);return S.getActiveClients()}function dG(T,S){let R=eb(T),O=eb(R.targetCache),N=R.targetDataByTarget.get(S);return N?Promise.resolve(N.target):R.persistence.runTransaction("Get target data","readonly",T=>O.getTargetDataForTarget(T,S).next(T=>T?T.target:null))}function dW(T,S){let R=eb(T),O=R.collectionGroupReadTime.get(S)||e2.min();return R.persistence.runTransaction("Get new document changes","readonly",T=>R.remoteDocuments.getAllFromCollectionGroup(T,S,ts(O,e3),Number.MAX_SAFE_INTEGER)).then(T=>(dK(R,S,T),T))}function dK(T,S,R){let O=T.collectionGroupReadTime.get(S)||e2.min();R.forEach((T,S)=>{S.readTime.compareTo(O)>0&&(O=S.readTime)}),T.collectionGroupReadTime.set(S,O)}function d$(T){return sb(sh(ez.fromString(`__bundle__/docs/${T}`)))}async function dQ(T,S,R,O){let N=eb(T),M=sJ(),L=sB();for(let T of R){let R=S.toDocumentKey(T.metadata.name);T.document&&(M=M.add(R));let O=S.toMutableDocument(T);O.setReadTime(S.toSnapshotVersion(T.metadata.readTime)),L=L.insert(R,O)}let U=N.remoteDocuments.newChangeBuffer({trackRemovals:!0}),V=await dF(N,d$(O));return N.persistence.runTransaction("Apply bundle documents","readwrite",T=>dP(T,U,L).next(S=>(U.apply(T),S)).next(S=>N.targetCache.removeMatchingKeysForTargetId(T,V.targetId).next(()=>N.targetCache.addMatchingKeys(T,M,V.targetId)).next(()=>N.localDocuments.getLocalViewOfDocuments(T,S.changedDocuments,S.existenceChangedKeys)).next(()=>S.changedDocuments)))}function dY(T,S){let R=eb(T),O=ol(S.createTime);return R.persistence.runTransaction("hasNewerBundle","readonly",T=>R.bundleCache.getBundleMetadata(T,S.id)).then(T=>!!T&&T.createTime.compareTo(O)>=0)}function dJ(T,S){let R=eb(T);return R.persistence.runTransaction("Save bundle","readwrite",T=>R.bundleCache.saveBundleMetadata(T,S))}function dX(T,S){let R=eb(T);return R.persistence.runTransaction("Get named query","readonly",T=>R.bundleCache.getNamedQuery(T,S))}async function dZ(T,S,R=sJ()){let O=await dF(T,sb(lO(S.bundledQuery))),N=eb(T);return N.persistence.runTransaction("Save named query","readwrite",T=>{let M=ol(S.readTime);if(O.snapshotVersion.compareTo(M)>=0)return N.bundleCache.saveNamedQuery(T,S);let L=O.withResumeToken(no.EMPTY_BYTE_STRING,M);return N.targetDataByTarget=N.targetDataByTarget.insert(L.targetId,L),N.targetCache.updateTargetData(T,L).next(()=>N.targetCache.removeMatchingKeysForTargetId(T,O.targetId)).next(()=>N.targetCache.addMatchingKeys(T,R,O.targetId)).next(()=>N.bundleCache.saveNamedQuery(T,S))})}function d0(T,S){let R=eb(T);R.queryEngine.indexAutoCreationEnabled=S}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d3{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(T){this._documentReadCount+=T}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let d4=100;function d6(){return(0,Q.G6)()?8:tv((0,Q.z$)())>0?6:4}class d9{constructor(){this.initialized=!1,this.indexAutoCreationEnabled=!1,this.indexAutoCreationMinCollectionSize=d4,this.relativeIndexReadCostPerDocument=d6()}initialize(T,S){this.localDocumentsView=T,this.indexManager=S,this.initialized=!0}getDocumentsMatchingQuery(T,S,R,O){let N={result:null};return this.performQueryUsingIndex(T,S).next(T=>{N.result=T}).next(()=>{if(!N.result)return this.performQueryUsingRemoteKeys(T,S,O,R).next(T=>{N.result=T})}).next(()=>{if(N.result)return;let R=new d3;return this.executeFullCollectionScan(T,S,R).next(O=>{if(N.result=O,this.indexAutoCreationEnabled)return this.createCacheIndexes(T,S,R,O.size)})}).next(()=>N.result)}createCacheIndexes(T,S,R,O){return R.documentReadCount<this.indexAutoCreationMinCollectionSize?(ed()<=K.in.DEBUG&&eh("QueryEngine","SDK will not create cache indexes for query:",sO(S),"since it only creates cache indexes for collection contains","more than or equal to",this.indexAutoCreationMinCollectionSize,"documents"),tf.resolve()):(ed()<=K.in.DEBUG&&eh("QueryEngine","Query:",sO(S),"scans",R.documentReadCount,"local documents and returns",O,"documents as results."),R.documentReadCount>this.relativeIndexReadCostPerDocument*O)?(ed()<=K.in.DEBUG&&eh("QueryEngine","The SDK decides to create cache indexes for query:",sO(S),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(T,sb(S))):tf.resolve()}performQueryUsingIndex(T,S){if(sp(S))return tf.resolve(null);let R=sb(S);return this.indexManager.getIndexType(T,R).next(O=>0===O?null:(null!==S.limit&&1===O&&(R=sb(S=sw(S,null,"F"))),this.indexManager.getDocumentsMatchingTarget(T,R).next(O=>{let N=sJ(...O);return this.localDocumentsView.getDocuments(T,N).next(O=>this.indexManager.getMinOffset(T,R).next(R=>{let M=this.applyQuery(S,O);return this.needsRefill(S,M,N,R.readTime)?this.performQueryUsingIndex(T,sw(S,null,"F")):this.appendRemainingResults(T,M,S,R)}))})))}performQueryUsingRemoteKeys(T,S,R,O){return sp(S)||O.isEqual(e2.min())?tf.resolve(null):this.localDocumentsView.getDocuments(T,R).next(N=>{let M=this.applyQuery(S,N);return this.needsRefill(S,M,R,O)?tf.resolve(null):(ed()<=K.in.DEBUG&&eh("QueryEngine","Re-using previous result from %s to execute query: %s",O.toString(),sO(S)),this.appendRemainingResults(T,M,S,ts(O,e3)).next(T=>T))})}applyQuery(T,S){let R=new r8(sL(T));return S.forEach((S,O)=>{sN(T,O)&&(R=R.add(O))}),R}needsRefill(T,S,R,O){if(null===T.limit)return!1;if(R.size!==S.size)return!0;let N="F"===T.limitType?S.last():S.first();return!!N&&(N.hasPendingWrites||N.version.compareTo(O)>0)}executeFullCollectionScan(T,S,R){return ed()<=K.in.DEBUG&&eh("QueryEngine","Using full collection scan to execute query:",sO(S)),this.localDocumentsView.getDocumentsMatchingQuery(T,S,tl.min(),R)}appendRemainingResults(T,S,R,O){return this.localDocumentsView.getDocumentsMatchingQuery(T,R,O).next(T=>(S.forEach(S=>{T=T.insert(S.key,S)}),T))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let d5="firestore_clients";function d8(T,S){return`${d5}_${T}_${S}`}let d7="firestore_mutations";function he(T,S,R){let O=`${d7}_${T}_${R}`;return S.isAuthenticated()&&(O+=`_${S.uid}`),O}let ht="firestore_targets";function hr(T,S){return`${ht}_${T}_${S}`}let hn="firestore_online_state";function hs(T){return`${hn}_${T}`}let ha="firestore_bundle_loaded_v2";function ho(T){return`${ha}_${T}`}let hl="firestore_sequence_number";function hu(T){return`${hl}_${T}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hc="SharedClientState";class hd{constructor(T,S,R,O){this.user=T,this.batchId=S,this.state=R,this.error=O}static fromWebStorageEntry(T,S,R){let O;let N=JSON.parse(R),M="object"==typeof N&&-1!==["pending","acknowledged","rejected"].indexOf(N.state)&&(void 0===N.error||"object"==typeof N.error);return(M&&N.error&&(M="string"==typeof N.error.message&&"string"==typeof N.error.code)&&(O=new eT(N.error.code,N.error.message)),M)?new hd(T,S,N.state,O):(ef(hc,`Failed to parse mutation state for ID '${S}': ${R}`),null)}toWebStorageJSON(){let T={state:this.state,updateTimeMs:Date.now()};return this.error&&(T.error={code:this.error.code,message:this.error.message}),JSON.stringify(T)}}class hh{constructor(T,S,R){this.targetId=T,this.state=S,this.error=R}static fromWebStorageEntry(T,S){let R;let O=JSON.parse(S),N="object"==typeof O&&-1!==["not-current","current","rejected"].indexOf(O.state)&&(void 0===O.error||"object"==typeof O.error);return(N&&O.error&&(N="string"==typeof O.error.message&&"string"==typeof O.error.code)&&(R=new eT(O.error.code,O.error.message)),N)?new hh(T,O.state,R):(ef(hc,`Failed to parse target state for ID '${T}': ${S}`),null)}toWebStorageJSON(){let T={state:this.state,updateTimeMs:Date.now()};return this.error&&(T.error={code:this.error.code,message:this.error.message}),JSON.stringify(T)}}class hf{constructor(T,S){this.clientId=T,this.activeTargetIds=S}static fromWebStorageEntry(T,S){let R=JSON.parse(S),O="object"==typeof R&&R.activeTargetIds instanceof Array,N=sZ();for(let T=0;O&&T<R.activeTargetIds.length;++T)O=nN(R.activeTargetIds[T]),N=N.add(R.activeTargetIds[T]);return O?new hf(T,N):(ef(hc,`Failed to parse client data for instance '${T}': ${S}`),null)}}class hp{constructor(T,S){this.clientId=T,this.onlineState=S}static fromWebStorageEntry(T){let S=JSON.parse(T),R="object"==typeof S&&-1!==["Unknown","Online","Offline"].indexOf(S.onlineState)&&"string"==typeof S.clientId;return R?new hp(S.clientId,S.onlineState):(ef(hc,`Failed to parse online state: ${T}`),null)}}class hm{constructor(){this.activeTargetIds=sZ()}addQueryTarget(T){this.activeTargetIds=this.activeTargetIds.add(T)}removeQueryTarget(T){this.activeTargetIds=this.activeTargetIds.delete(T)}toWebStorageJSON(){let T={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(T)}}class hg{constructor(T,S,R,O,N){this.window=T,this.queue=S,this.persistenceKey=R,this.localClientId=O,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.storageListener=this.handleWebStorageEvent.bind(this),this.activeClients=new r4(eD),this.started=!1,this.earlyEvents=[];let M=R.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=N,this.localClientStorageKey=d8(this.persistenceKey,this.localClientId),this.sequenceNumberKey=hu(this.persistenceKey),this.activeClients=this.activeClients.insert(this.localClientId,new hm),this.clientStateKeyRe=RegExp(`^${d5}_${M}_([^_]*)$`),this.mutationBatchKeyRe=RegExp(`^${d7}_${M}_(\\d+)(?:_(.*))?$`),this.queryTargetKeyRe=RegExp(`^${ht}_${M}_(\\d+)$`),this.onlineStateKey=hs(this.persistenceKey),this.bundleLoadedKey=ho(this.persistenceKey),this.window.addEventListener("storage",this.storageListener)}static isAvailable(T){return!!(T&&T.localStorage)}async start(){let T=await this.syncEngine.getActiveClients();for(let S of T){if(S===this.localClientId)continue;let T=this.getItem(d8(this.persistenceKey,S));if(T){let R=hf.fromWebStorageEntry(S,T);R&&(this.activeClients=this.activeClients.insert(R.clientId,R))}}this.persistClientState();let S=this.storage.getItem(this.onlineStateKey);if(S){let T=this.fromWebStorageOnlineState(S);T&&this.handleOnlineStateEvent(T)}for(let T of this.earlyEvents)this.handleWebStorageEvent(T);this.earlyEvents=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(T){this.setItem(this.sequenceNumberKey,JSON.stringify(T))}getAllActiveQueryTargets(){return this.extractActiveQueryTargets(this.activeClients)}isActiveQueryTarget(T){let S=!1;return this.activeClients.forEach((R,O)=>{O.activeTargetIds.has(T)&&(S=!0)}),S}addPendingMutation(T){this.persistMutationState(T,"pending")}updateMutationState(T,S,R){this.persistMutationState(T,S,R),this.removeMutationState(T)}addLocalQueryTarget(T,S=!0){let R="not-current";if(this.isActiveQueryTarget(T)){let S=this.storage.getItem(hr(this.persistenceKey,T));if(S){let O=hh.fromWebStorageEntry(T,S);O&&(R=O.state)}}return S&&this.localClientState.addQueryTarget(T),this.persistClientState(),R}removeLocalQueryTarget(T){this.localClientState.removeQueryTarget(T),this.persistClientState()}isLocalQueryTarget(T){return this.localClientState.activeTargetIds.has(T)}clearQueryState(T){this.removeItem(hr(this.persistenceKey,T))}updateQueryState(T,S,R){this.persistQueryTargetState(T,S,R)}handleUserChange(T,S,R){S.forEach(T=>{this.removeMutationState(T)}),this.currentUser=T,R.forEach(T=>{this.addPendingMutation(T)})}setOnlineState(T){this.persistOnlineState(T)}notifyBundleLoaded(T){this.persistBundleLoadedState(T)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)}getItem(T){let S=this.storage.getItem(T);return eh(hc,"READ",T,S),S}setItem(T,S){eh(hc,"SET",T,S),this.storage.setItem(T,S)}removeItem(T){eh(hc,"REMOVE",T),this.storage.removeItem(T)}handleWebStorageEvent(T){let S=T;if(S.storageArea===this.storage){if(eh(hc,"EVENT",S.key,S.newValue),S.key===this.localClientStorageKey){ef("Received WebStorage notification for local change. Another client might have garbage-collected our state");return}this.queue.enqueueRetryable(async()=>{if(!this.started){this.earlyEvents.push(S);return}if(null!==S.key){if(this.clientStateKeyRe.test(S.key)){if(null!=S.newValue){let T=this.fromWebStorageClientState(S.key,S.newValue);if(T)return this.handleClientStateEvent(T.clientId,T)}else{let T=this.fromWebStorageClientStateKey(S.key);return this.handleClientStateEvent(T,null)}}else if(this.mutationBatchKeyRe.test(S.key)){if(null!==S.newValue){let T=this.fromWebStorageMutationMetadata(S.key,S.newValue);if(T)return this.handleMutationBatchEvent(T)}}else if(this.queryTargetKeyRe.test(S.key)){if(null!==S.newValue){let T=this.fromWebStorageQueryTargetMetadata(S.key,S.newValue);if(T)return this.handleQueryTargetEvent(T)}}else if(S.key===this.onlineStateKey){if(null!==S.newValue){let T=this.fromWebStorageOnlineState(S.newValue);if(T)return this.handleOnlineStateEvent(T)}}else if(S.key===this.sequenceNumberKey){let T=hy(S.newValue);T!==tP.INVALID&&this.sequenceNumberHandler(T)}else if(S.key===this.bundleLoadedKey){let T=this.fromWebStoreBundleLoadedState(S.newValue);await Promise.all(T.map(T=>this.syncEngine.synchronizeWithChangedDocuments(T)))}}})}}get localClientState(){return this.activeClients.get(this.localClientId)}persistClientState(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())}persistMutationState(T,S,R){let O=new hd(this.currentUser,T,S,R),N=he(this.persistenceKey,this.currentUser,T);this.setItem(N,O.toWebStorageJSON())}removeMutationState(T){let S=he(this.persistenceKey,this.currentUser,T);this.removeItem(S)}persistOnlineState(T){let S={clientId:this.localClientId,onlineState:T};this.storage.setItem(this.onlineStateKey,JSON.stringify(S))}persistQueryTargetState(T,S,R){let O=hr(this.persistenceKey,T),N=new hh(T,S,R);this.setItem(O,N.toWebStorageJSON())}persistBundleLoadedState(T){let S=JSON.stringify(Array.from(T));this.setItem(this.bundleLoadedKey,S)}fromWebStorageClientStateKey(T){let S=this.clientStateKeyRe.exec(T);return S?S[1]:null}fromWebStorageClientState(T,S){let R=this.fromWebStorageClientStateKey(T);return hf.fromWebStorageEntry(R,S)}fromWebStorageMutationMetadata(T,S){let R=this.mutationBatchKeyRe.exec(T),O=Number(R[1]),N=void 0!==R[2]?R[2]:null;return hd.fromWebStorageEntry(new ei(N),O,S)}fromWebStorageQueryTargetMetadata(T,S){let R=this.queryTargetKeyRe.exec(T),O=Number(R[1]);return hh.fromWebStorageEntry(O,S)}fromWebStorageOnlineState(T){return hp.fromWebStorageEntry(T)}fromWebStoreBundleLoadedState(T){return JSON.parse(T)}async handleMutationBatchEvent(T){if(T.user.uid!==this.currentUser.uid){eh(hc,`Ignoring mutation for non-active user ${T.user.uid}`);return}return this.syncEngine.applyBatchState(T.batchId,T.state,T.error)}handleQueryTargetEvent(T){return this.syncEngine.applyTargetState(T.targetId,T.state,T.error)}handleClientStateEvent(T,S){let R=S?this.activeClients.insert(T,S):this.activeClients.remove(T),O=this.extractActiveQueryTargets(this.activeClients),N=this.extractActiveQueryTargets(R),M=[],L=[];return N.forEach(T=>{O.has(T)||M.push(T)}),O.forEach(T=>{N.has(T)||L.push(T)}),this.syncEngine.applyActiveTargetsChange(M,L).then(()=>{this.activeClients=R})}handleOnlineStateEvent(T){this.activeClients.get(T.clientId)&&this.onlineStateHandler(T.onlineState)}extractActiveQueryTargets(T){let S=sZ();return T.forEach((T,R)=>{S=S.unionWith(R.activeTargetIds)}),S}}function hy(T){let S=tP.INVALID;if(null!=T)try{let R=JSON.parse(T);ev("number"==typeof R,30636,{seqString:T}),S=R}catch(T){ef(hc,"Failed to read sequence number from WebStorage",T)}return S}class hv{constructor(){this.localState=new hm,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(T){}updateMutationState(T,S,R){}addLocalQueryTarget(T,S=!0){return S&&this.localState.addQueryTarget(T),this.queryState[T]||"not-current"}updateQueryState(T,S,R){this.queryState[T]=S}removeLocalQueryTarget(T){this.localState.removeQueryTarget(T)}isLocalQueryTarget(T){return this.localState.activeTargetIds.has(T)}clearQueryState(T){delete this.queryState[T]}getAllActiveQueryTargets(){return this.localState.activeTargetIds}isActiveQueryTarget(T){return this.localState.activeTargetIds.has(T)}start(){return this.localState=new hm,Promise.resolve()}handleUserChange(T,S,R){}setOnlineState(T){}shutdown(){}writeSequenceNumber(T){}notifyBundleLoaded(T){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{addCallback(T){}shutdown(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(T){this.sendFn=T.sendFn,this.closeFn=T.closeFn}onConnected(T){this.wrappedOnConnected=T}onOpen(T){this.wrappedOnOpen=T}onClose(T){this.wrappedOnClose=T}onMessage(T){this.wrappedOnMessage=T}close(){this.closeFn()}send(T){this.sendFn(T)}callOnConnected(){this.wrappedOnConnected()}callOnOpen(){this.wrappedOnOpen()}callOnClose(T){this.wrappedOnClose(T)}callOnMessage(T){this.wrappedOnMessage(T)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hS=null;function hE(){let T=268435456,S=2415919104,R=S-T,O=Math.round(R*Math.random());return T+O}function hw(){return null===hS?hS=hE():hS++,"0x"+hS.toString(16)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hC(T){return new Promise((S,R)=>{T((T,O)=>{T?R(T):S(O)})})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hI="1.9.15",hR="GrpcConnection",hA=`gl-node/${process.versions.node} fire/${ea} grpc/${hI}`;function hO(T,S,R,O){ev(null===S||"OAuth"===S.type,36936);let N=new ee.SF;return S&&S.headers.forEach((T,S)=>N.set(S,T)),R&&R.headers.forEach((T,S)=>N.set(S,T)),O&&N.set("X-Firebase-GMPID",O),N.set("X-Goog-Api-Client",hA),N.set("Google-Cloud-Resource-Prefix",T),N.set("x-goog-request-params",T),N}class hN{get shouldResourcePathBeIncludedInRequest(){return!0}constructor(T,S){this.databaseInfo=S,this.cachedStub=null,this.firestore=T.google.firestore.v1,this.databasePath=`projects/${S.databaseId.projectId}/databases/${S.databaseId.database}`}ensureActiveStub(){if(!this.cachedStub){eh(hR,"Creating Firestore stub.");let T=this.databaseInfo.ssl?ee.K9.createSsl():ee.K9.createInsecure();this.cachedStub=new this.firestore.Firestore(this.databaseInfo.host,T)}return this.cachedStub}invokeRPC(T,S,R,O,N){let M=hw(),L=this.ensureActiveStub(),U=hO(this.databasePath,O,N,this.databaseInfo.appId),V={database:this.databasePath,...R};return hC(S=>(eh(hR,`RPC '${T}' ${M} invoked with request:`,R),L[T](V,U,(R,O)=>{R?(eh(hR,`RPC '${T}' ${M} failed with error:`,R),S(new eT(aU(R.code),R.message))):(eh(hR,`RPC '${T}' ${M} completed with response:`,O),S(void 0,O))})))}invokeStreamingRPC(T,S,R,O,N,M){let L=hw(),U=[],V=new eS;eh(hR,`RPC '${T}' ${L} invoked (streaming) with request:`,R);let K=this.ensureActiveStub(),$=hO(this.databasePath,O,N,this.databaseInfo.appId),Q={...R,database:this.databasePath},Y=K[T](Q,$),X=!1;return Y.on("data",S=>{eh(hR,`RPC ${T} ${L} received result:`,S),U.push(S),void 0!==M&&U.length===M&&(X=!0,V.resolve(U))}),Y.on("end",()=>{eh(hR,`RPC '${T}' ${L} completed.`),X||(X=!0,V.resolve(U))}),Y.on("error",S=>{eh(hR,`RPC '${T}' ${L} failed with error:`,S);let R=aU(S.code);V.reject(new eT(R,S.message))}),V.promise}openStream(T,S,R){let O=hw(),N=this.ensureActiveStub(),M=hO(this.databasePath,S,R,this.databaseInfo.appId),L=N[T](M),U=!1,V=T=>{U||(U=!0,K.callOnClose(T),L.end())},K=new hT({sendFn:S=>{if(U)eh(hR,`RPC '${T}' stream ${O} not sending because gRPC stream is closed:`,S);else{eh(hR,`RPC '${T}' stream ${O} sending:`,S);try{L.write(S)}catch(T){throw ef("Failure sending:",S),ef("Error:",T),T}}},closeFn:()=>{eh(hR,`RPC '${T}' stream ${O} closed locally via close().`),V()}}),$=!1;return L.on("data",S=>{U||(eh(hR,`RPC '${T}' stream ${O} received:`,S),$||(K.callOnConnected(),$=!0),K.callOnMessage(S))}),L.on("end",()=>{eh(hR,`RPC '${T}' stream ${O} ended.`),V()}),L.on("error",S=>{if(!U){ep(hR,`RPC '${T}' stream ${O} error. Code:`,S.code,"Message:",S.message);let R=aU(S.code);V(new eT(R,S.message))}}),eh(hR,`Opening RPC '${T}' stream ${O} to ${this.databaseInfo.host}`),setTimeout(()=>{K.callOnOpen()},0),K}terminate(){this.cachedStub&&(this.cachedStub.close(),this.cachedStub=void 0)}}let hk={google:{nested:{protobuf:{options:{csharp_namespace:"Google.Protobuf.WellKnownTypes",go_package:"github.com/golang/protobuf/ptypes/wrappers",java_package:"com.google.protobuf",java_outer_classname:"WrappersProto",java_multiple_files:!0,objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{Timestamp:{fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}},FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}},Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},Empty:{fields:{}},DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}},Any:{fields:{typeUrl:{type:"string",id:1},value:{type:"bytes",id:2}}}}},firestore:{nested:{v1:{options:{csharp_namespace:"Google.Cloud.Firestore.V1",go_package:"google.golang.org/genproto/googleapis/firestore/v1;firestore",java_multiple_files:!0,java_outer_classname:"WriteProto",java_package:"com.google.firestore.v1",objc_class_prefix:"GCFS",php_namespace:"Google\\Cloud\\Firestore\\V1",ruby_package:"Google::Cloud::Firestore::V1"},nested:{AggregationResult:{fields:{aggregateFields:{keyType:"string",type:"Value",id:2}}},BitSequence:{fields:{bitmap:{type:"bytes",id:1},padding:{type:"int32",id:2}}},BloomFilter:{fields:{bits:{type:"BitSequence",id:1},hashCount:{type:"int32",id:2}}},DocumentMask:{fields:{fieldPaths:{rule:"repeated",type:"string",id:1}}},Precondition:{oneofs:{conditionType:{oneof:["exists","updateTime"]}},fields:{exists:{type:"bool",id:1},updateTime:{type:"google.protobuf.Timestamp",id:2}}},TransactionOptions:{oneofs:{mode:{oneof:["readOnly","readWrite"]}},fields:{readOnly:{type:"ReadOnly",id:2},readWrite:{type:"ReadWrite",id:3}},nested:{ReadWrite:{fields:{retryTransaction:{type:"bytes",id:1}}},ReadOnly:{oneofs:{consistencySelector:{oneof:["readTime"]}},fields:{readTime:{type:"google.protobuf.Timestamp",id:2}}}}},Document:{fields:{name:{type:"string",id:1},fields:{keyType:"string",type:"Value",id:2},createTime:{type:"google.protobuf.Timestamp",id:3},updateTime:{type:"google.protobuf.Timestamp",id:4}}},Value:{oneofs:{valueType:{oneof:["nullValue","booleanValue","integerValue","doubleValue","timestampValue","stringValue","bytesValue","referenceValue","geoPointValue","arrayValue","mapValue"]}},fields:{nullValue:{type:"google.protobuf.NullValue",id:11},booleanValue:{type:"bool",id:1},integerValue:{type:"int64",id:2},doubleValue:{type:"double",id:3},timestampValue:{type:"google.protobuf.Timestamp",id:10},stringValue:{type:"string",id:17},bytesValue:{type:"bytes",id:18},referenceValue:{type:"string",id:5},geoPointValue:{type:"google.type.LatLng",id:8},arrayValue:{type:"ArrayValue",id:9},mapValue:{type:"MapValue",id:6}}},ArrayValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},MapValue:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Firestore:{options:{"(google.api.default_host)":"firestore.googleapis.com","(google.api.oauth_scopes)":"https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/datastore"},methods:{GetDocument:{requestType:"GetDocumentRequest",responseType:"Document",options:{"(google.api.http).get":"/v1/{name=projects/*/databases/*/documents/*/**}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{name=projects/*/databases/*/documents/*/**}"}}]},ListDocuments:{requestType:"ListDocumentsRequest",responseType:"ListDocumentsResponse",options:{"(google.api.http).get":"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"}}]},UpdateDocument:{requestType:"UpdateDocumentRequest",responseType:"Document",options:{"(google.api.http).patch":"/v1/{document.name=projects/*/databases/*/documents/*/**}","(google.api.http).body":"document","(google.api.method_signature)":"document,update_mask"},parsedOptions:[{"(google.api.http)":{patch:"/v1/{document.name=projects/*/databases/*/documents/*/**}",body:"document"}},{"(google.api.method_signature)":"document,update_mask"}]},DeleteDocument:{requestType:"DeleteDocumentRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).delete":"/v1/{name=projects/*/databases/*/documents/*/**}","(google.api.method_signature)":"name"},parsedOptions:[{"(google.api.http)":{delete:"/v1/{name=projects/*/databases/*/documents/*/**}"}},{"(google.api.method_signature)":"name"}]},BatchGetDocuments:{requestType:"BatchGetDocumentsRequest",responseType:"BatchGetDocumentsResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchGet","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchGet",body:"*"}}]},BeginTransaction:{requestType:"BeginTransactionRequest",responseType:"BeginTransactionResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:beginTransaction","(google.api.http).body":"*","(google.api.method_signature)":"database"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:beginTransaction",body:"*"}},{"(google.api.method_signature)":"database"}]},Commit:{requestType:"CommitRequest",responseType:"CommitResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:commit","(google.api.http).body":"*","(google.api.method_signature)":"database,writes"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:commit",body:"*"}},{"(google.api.method_signature)":"database,writes"}]},Rollback:{requestType:"RollbackRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:rollback","(google.api.http).body":"*","(google.api.method_signature)":"database,transaction"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:rollback",body:"*"}},{"(google.api.method_signature)":"database,transaction"}]},RunQuery:{requestType:"RunQueryRequest",responseType:"RunQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery",body:"*"}}}]},RunAggregationQuery:{requestType:"RunAggregationQueryRequest",responseType:"RunAggregationQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery",body:"*"}}}]},PartitionQuery:{requestType:"PartitionQueryRequest",responseType:"PartitionQueryResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:partitionQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:partitionQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery",body:"*"}}}]},Write:{requestType:"WriteRequest",requestStream:!0,responseType:"WriteResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:write","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:write",body:"*"}}]},Listen:{requestType:"ListenRequest",requestStream:!0,responseType:"ListenResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:listen","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:listen",body:"*"}}]},ListCollectionIds:{requestType:"ListCollectionIdsRequest",responseType:"ListCollectionIdsResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds","(google.api.http).additional_bindings.body":"*","(google.api.method_signature)":"parent"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds",body:"*"}}},{"(google.api.method_signature)":"parent"}]},BatchWrite:{requestType:"BatchWriteRequest",responseType:"BatchWriteResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchWrite","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchWrite",body:"*"}}]},CreateDocument:{requestType:"CreateDocumentRequest",responseType:"Document",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}","(google.api.http).body":"document"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}",body:"document"}}]}}},GetDocumentRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:5}}},ListDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:3},pageToken:{type:"string",id:4},orderBy:{type:"string",id:6},mask:{type:"DocumentMask",id:7},transaction:{type:"bytes",id:8},readTime:{type:"google.protobuf.Timestamp",id:10},showMissing:{type:"bool",id:12}}},ListDocumentsResponse:{fields:{documents:{rule:"repeated",type:"Document",id:1},nextPageToken:{type:"string",id:2}}},CreateDocumentRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},documentId:{type:"string",id:3},document:{type:"Document",id:4,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:5}}},UpdateDocumentRequest:{fields:{document:{type:"Document",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},updateMask:{type:"DocumentMask",id:2},mask:{type:"DocumentMask",id:3},currentDocument:{type:"Precondition",id:4}}},DeleteDocumentRequest:{fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},currentDocument:{type:"Precondition",id:2}}},BatchGetDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},documents:{rule:"repeated",type:"string",id:2},mask:{type:"DocumentMask",id:3},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:7}}},BatchGetDocumentsResponse:{oneofs:{result:{oneof:["found","missing"]}},fields:{found:{type:"Document",id:1},missing:{type:"string",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:4}}},BeginTransactionRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},options:{type:"TransactionOptions",id:2}}},BeginTransactionResponse:{fields:{transaction:{type:"bytes",id:1}}},CommitRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},transaction:{type:"bytes",id:3}}},CommitResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},commitTime:{type:"google.protobuf.Timestamp",id:2}}},RollbackRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},transaction:{type:"bytes",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}}}},RunQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},transaction:{type:"bytes",id:5},newTransaction:{type:"TransactionOptions",id:6},readTime:{type:"google.protobuf.Timestamp",id:7}}},RunQueryResponse:{fields:{transaction:{type:"bytes",id:2},document:{type:"Document",id:1},readTime:{type:"google.protobuf.Timestamp",id:3},skippedResults:{type:"int32",id:4}}},RunAggregationQueryRequest:{oneofs:{queryType:{oneof:["structuredAggregationQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredAggregationQuery:{type:"StructuredAggregationQuery",id:2},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:6}}},RunAggregationQueryResponse:{fields:{result:{type:"AggregationResult",id:1},transaction:{type:"bytes",id:2},readTime:{type:"google.protobuf.Timestamp",id:3}}},PartitionQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},partitionCount:{type:"int64",id:3},pageToken:{type:"string",id:4},pageSize:{type:"int32",id:5}}},PartitionQueryResponse:{fields:{partitions:{rule:"repeated",type:"Cursor",id:1},nextPageToken:{type:"string",id:2}}},WriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},streamId:{type:"string",id:2},writes:{rule:"repeated",type:"Write",id:3},streamToken:{type:"bytes",id:4},labels:{keyType:"string",type:"string",id:5}}},WriteResponse:{fields:{streamId:{type:"string",id:1},streamToken:{type:"bytes",id:2},writeResults:{rule:"repeated",type:"WriteResult",id:3},commitTime:{type:"google.protobuf.Timestamp",id:4}}},ListenRequest:{oneofs:{targetChange:{oneof:["addTarget","removeTarget"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},addTarget:{type:"Target",id:2},removeTarget:{type:"int32",id:3},labels:{keyType:"string",type:"string",id:4}}},ListenResponse:{oneofs:{responseType:{oneof:["targetChange","documentChange","documentDelete","documentRemove","filter"]}},fields:{targetChange:{type:"TargetChange",id:2},documentChange:{type:"DocumentChange",id:3},documentDelete:{type:"DocumentDelete",id:4},documentRemove:{type:"DocumentRemove",id:6},filter:{type:"ExistenceFilter",id:5}}},Target:{oneofs:{targetType:{oneof:["query","documents"]},resumeType:{oneof:["resumeToken","readTime"]}},fields:{query:{type:"QueryTarget",id:2},documents:{type:"DocumentsTarget",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:11},targetId:{type:"int32",id:5},once:{type:"bool",id:6},expectedCount:{type:"google.protobuf.Int32Value",id:12}},nested:{DocumentsTarget:{fields:{documents:{rule:"repeated",type:"string",id:2}}},QueryTarget:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1},structuredQuery:{type:"StructuredQuery",id:2}}}}},TargetChange:{fields:{targetChangeType:{type:"TargetChangeType",id:1},targetIds:{rule:"repeated",type:"int32",id:2},cause:{type:"google.rpc.Status",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:6}},nested:{TargetChangeType:{values:{NO_CHANGE:0,ADD:1,REMOVE:2,CURRENT:3,RESET:4}}}},ListCollectionIdsRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:2},pageToken:{type:"string",id:3}}},ListCollectionIdsResponse:{fields:{collectionIds:{rule:"repeated",type:"string",id:1},nextPageToken:{type:"string",id:2}}},BatchWriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},labels:{keyType:"string",type:"string",id:3}}},BatchWriteResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},status:{rule:"repeated",type:"google.rpc.Status",id:2}}},StructuredQuery:{fields:{select:{type:"Projection",id:1},from:{rule:"repeated",type:"CollectionSelector",id:2},where:{type:"Filter",id:3},orderBy:{rule:"repeated",type:"Order",id:4},startAt:{type:"Cursor",id:7},endAt:{type:"Cursor",id:8},offset:{type:"int32",id:6},limit:{type:"google.protobuf.Int32Value",id:5}},nested:{CollectionSelector:{fields:{collectionId:{type:"string",id:2},allDescendants:{type:"bool",id:3}}},Filter:{oneofs:{filterType:{oneof:["compositeFilter","fieldFilter","unaryFilter"]}},fields:{compositeFilter:{type:"CompositeFilter",id:1},fieldFilter:{type:"FieldFilter",id:2},unaryFilter:{type:"UnaryFilter",id:3}}},CompositeFilter:{fields:{op:{type:"Operator",id:1},filters:{rule:"repeated",type:"Filter",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,AND:1,OR:2}}}},FieldFilter:{fields:{field:{type:"FieldReference",id:1},op:{type:"Operator",id:2},value:{type:"Value",id:3}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,LESS_THAN:1,LESS_THAN_OR_EQUAL:2,GREATER_THAN:3,GREATER_THAN_OR_EQUAL:4,EQUAL:5,NOT_EQUAL:6,ARRAY_CONTAINS:7,IN:8,ARRAY_CONTAINS_ANY:9,NOT_IN:10}}}},UnaryFilter:{oneofs:{operandType:{oneof:["field"]}},fields:{op:{type:"Operator",id:1},field:{type:"FieldReference",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,IS_NAN:2,IS_NULL:3,IS_NOT_NAN:4,IS_NOT_NULL:5}}}},Order:{fields:{field:{type:"FieldReference",id:1},direction:{type:"Direction",id:2}}},FieldReference:{fields:{fieldPath:{type:"string",id:2}}},Projection:{fields:{fields:{rule:"repeated",type:"FieldReference",id:2}}},Direction:{values:{DIRECTION_UNSPECIFIED:0,ASCENDING:1,DESCENDING:2}}}},StructuredAggregationQuery:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{structuredQuery:{type:"StructuredQuery",id:1},aggregations:{rule:"repeated",type:"Aggregation",id:3}},nested:{Aggregation:{oneofs:{operator:{oneof:["count","sum","avg"]}},fields:{count:{type:"Count",id:1},sum:{type:"Sum",id:2},avg:{type:"Avg",id:3},alias:{type:"string",id:7}},nested:{Count:{fields:{upTo:{type:"google.protobuf.Int64Value",id:1}}},Sum:{fields:{field:{type:"FieldReference",id:1}}},Avg:{fields:{field:{type:"FieldReference",id:1}}}}}}},Cursor:{fields:{values:{rule:"repeated",type:"Value",id:1},before:{type:"bool",id:2}}},Write:{oneofs:{operation:{oneof:["update","delete","verify","transform"]}},fields:{update:{type:"Document",id:1},delete:{type:"string",id:2},verify:{type:"string",id:5},transform:{type:"DocumentTransform",id:6},updateMask:{type:"DocumentMask",id:3},updateTransforms:{rule:"repeated",type:"DocumentTransform.FieldTransform",id:7},currentDocument:{type:"Precondition",id:4}}},DocumentTransform:{fields:{document:{type:"string",id:1},fieldTransforms:{rule:"repeated",type:"FieldTransform",id:2}},nested:{FieldTransform:{oneofs:{transformType:{oneof:["setToServerValue","increment","maximum","minimum","appendMissingElements","removeAllFromArray"]}},fields:{fieldPath:{type:"string",id:1},setToServerValue:{type:"ServerValue",id:2},increment:{type:"Value",id:3},maximum:{type:"Value",id:4},minimum:{type:"Value",id:5},appendMissingElements:{type:"ArrayValue",id:6},removeAllFromArray:{type:"ArrayValue",id:7}},nested:{ServerValue:{values:{SERVER_VALUE_UNSPECIFIED:0,REQUEST_TIME:1}}}}}},WriteResult:{fields:{updateTime:{type:"google.protobuf.Timestamp",id:1},transformResults:{rule:"repeated",type:"Value",id:2}}},DocumentChange:{fields:{document:{type:"Document",id:1},targetIds:{rule:"repeated",type:"int32",id:5},removedTargetIds:{rule:"repeated",type:"int32",id:6}}},DocumentDelete:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:6},readTime:{type:"google.protobuf.Timestamp",id:4}}},DocumentRemove:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:2},readTime:{type:"google.protobuf.Timestamp",id:4}}},ExistenceFilter:{fields:{targetId:{type:"int32",id:1},count:{type:"int32",id:2},unchangedNames:{type:"BloomFilter",id:3}}}}}}},api:{options:{go_package:"google.golang.org/genproto/googleapis/api/annotations;annotations",java_multiple_files:!0,java_outer_classname:"HttpProto",java_package:"com.google.api",objc_class_prefix:"GAPI",cc_enable_arenas:!0},nested:{http:{type:"HttpRule",id:72295728,extend:"google.protobuf.MethodOptions"},Http:{fields:{rules:{rule:"repeated",type:"HttpRule",id:1}}},HttpRule:{oneofs:{pattern:{oneof:["get","put","post","delete","patch","custom"]}},fields:{get:{type:"string",id:2},put:{type:"string",id:3},post:{type:"string",id:4},delete:{type:"string",id:5},patch:{type:"string",id:6},custom:{type:"CustomHttpPattern",id:8},selector:{type:"string",id:1},body:{type:"string",id:7},additionalBindings:{rule:"repeated",type:"HttpRule",id:11}}},CustomHttpPattern:{fields:{kind:{type:"string",id:1},path:{type:"string",id:2}}},methodSignature:{rule:"repeated",type:"string",id:1051,extend:"google.protobuf.MethodOptions"},defaultHost:{type:"string",id:1049,extend:"google.protobuf.ServiceOptions"},oauthScopes:{type:"string",id:1050,extend:"google.protobuf.ServiceOptions"},fieldBehavior:{rule:"repeated",type:"google.api.FieldBehavior",id:1052,extend:"google.protobuf.FieldOptions"},FieldBehavior:{values:{FIELD_BEHAVIOR_UNSPECIFIED:0,OPTIONAL:1,REQUIRED:2,OUTPUT_ONLY:3,INPUT_ONLY:4,IMMUTABLE:5,UNORDERED_LIST:6,NON_EMPTY_DEFAULT:7}}}},type:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/type/latlng;latlng",java_multiple_files:!0,java_outer_classname:"LatLngProto",java_package:"com.google.type",objc_class_prefix:"GTP"},nested:{LatLng:{fields:{latitude:{type:"double",id:1},longitude:{type:"double",id:2}}}}},rpc:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/rpc/status;status",java_multiple_files:!0,java_outer_classname:"StatusProto",java_package:"com.google.rpc",objc_class_prefix:"RPC"},nested:{Status:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2},details:{rule:"repeated",type:"google.protobuf.Any",id:3}}}}}}}};var hP={nested:hk},hD=Object.freeze({__proto__:null,nested:hk,default:hP});/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hM={longs:String,enums:String,defaults:!0,oneofs:!1};function hx(){let T=et.im(hD,hM);return ee.Rz(T)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hL(T){let S=hx();return new hN(S,T)}function hF(){return new h_}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hU(){return"YES"===process.env.USE_MOCK_PERSISTENCE?window:null}function hj(){return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hB(T){return new a8(T,!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hV="ExponentialBackoff",hz=1e3,hq=1.5,hH=6e4;class hG{constructor(T,S,R=hz,O=hq,N=hH){this.queue=T,this.timerId=S,this.initialDelayMs=R,this.backoffFactor=O,this.maxDelayMs=N,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(T){this.cancel();let S=Math.floor(this.currentBaseMs+this.jitterDelayMs()),R=Math.max(0,Date.now()-this.lastAttemptTime),O=Math.max(0,S-R);O>0&&eh(hV,`Backing off for ${O} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${S} ms, last attempt: ${R} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,O,()=>(this.lastAttemptTime=Date.now(),T())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){null!==this.timerPromise&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}}class hW extends null{constructor(T,S,R,O,N,M){super(T,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",S,R,O,M),this.serializer=N}startRpc(T,S){return this.connection.openStream("Listen",T,S)}onFirst(T){return this.onNext(T)}onNext(T){this.backoff.reset();let S=oI(this.serializer,T),R=oA(T);return this.listener.onWatchChange(S,R)}watch(T){let S={};S.database=oy(this.serializer),S.addTarget=oG(this.serializer,T);let R=oq(this.serializer,T);R&&(S.labels=R),this.sendRequest(S)}unwatch(T){let S={};S.database=oy(this.serializer),S.removeTarget=T,this.sendRequest(S)}}class hK extends null{constructor(T,S,R,O,N,M){super(T,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",S,R,O,M),this.serializer=N}get handshakeComplete(){return this.responseCount>0}start(){this.lastStreamToken=void 0,super.start()}tearDown(){this.handshakeComplete&&this.writeMutations([])}startRpc(T,S){return this.connection.openStream("Write",T,S)}onFirst(T){return ev(!!T.streamToken,31322),this.lastStreamToken=T.streamToken,ev(!T.writeResults||0===T.writeResults.length,55816),this.listener.onHandshakeComplete()}onNext(T){ev(!!T.streamToken,12678),this.lastStreamToken=T.streamToken,this.backoff.reset();let S=oM(T.writeResults,T.commitTime),R=ol(T.commitTime);return this.listener.onMutationResult(R,S)}writeHandshake(){let T={};T.database=oy(this.serializer),this.sendRequest(T)}writeMutations(T){let S={streamToken:this.lastStreamToken,writes:T.map(T=>oO(this.serializer,T))};this.sendRequest(S)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h${}class hQ extends h${constructor(T,S,R,O){super(),this.authCredentials=T,this.appCheckCredentials=S,this.connection=R,this.serializer=O,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new eT(e_.FAILED_PRECONDITION,"The client has already been terminated.")}invokeRPC(T,S,R,O){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([N,M])=>this.connection.invokeRPC(T,oc(S,R),O,N,M)).catch(T=>{if("FirebaseError"===T.name)throw T.code===e_.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),T;throw new eT(e_.UNKNOWN,T.toString())})}invokeStreamingRPC(T,S,R,O,N){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([M,L])=>this.connection.invokeStreamingRPC(T,oc(S,R),O,M,L,N)).catch(T=>{if("FirebaseError"===T.name)throw T.code===e_.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),T;throw new eT(e_.UNKNOWN,T.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}}function hY(T,S,R,O){return new hQ(T,S,R,O)}async function hJ(T,S){let R=eb(T),O={writes:S.map(T=>oO(R.serializer,T))};await R.invokeRPC("Commit",R.serializer.databaseId,ez.emptyPath(),O)}async function hX(T,S){let R=eb(T),O={documents:S.map(T=>oh(R.serializer,T))},N=await R.invokeStreamingRPC("BatchGetDocuments",R.serializer.databaseId,ez.emptyPath(),O,S.length),M=new Map;N.forEach(T=>{let S=oC(R.serializer,T);M.set(S.key.toString(),S)});let L=[];return S.forEach(T=>{let S=M.get(T.toString());ev(!!S,55234,{key:T}),L.push(S)}),L}async function hZ(T,S,R){let O=eb(T),{request:N,aliasMap:M,parent:L}=oB(O.serializer,s_(S),R);O.connection.shouldResourcePathBeIncludedInRequest||delete N.parent;let U=await O.invokeStreamingRPC("RunAggregationQuery",O.serializer.databaseId,L,N,1),V=U.filter(T=>!!T.result);ev(1===V.length,64727);let K=V[0].result?.aggregateFields,$=Object.keys(K).reduce((T,S)=>(T[M[S]]=K[S],T),{});return $}function h0(T,S,R){let O=eb(T);return O.verifyInitialized(),new hK(S,O.connection,O.authCredentials,O.appCheckCredentials,O.serializer,R)}function h1(T,S,R){let O=eb(T);return O.verifyInitialized(),new hW(S,O.connection,O.authCredentials,O.appCheckCredentials,O.serializer,R)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let h2="OnlineStateTracker",h3=1,h4=1e4;class h6{constructor(T,S){this.asyncQueue=T,this.onlineStateHandler=S,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}handleWatchStreamStart(){0===this.watchStreamFailures&&(this.setAndBroadcast("Unknown"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",h4,()=>(this.onlineStateTimer=null,this.logClientOfflineWarningIfNecessary(`Backend didn't respond within ${h4/1e3} seconds.`),this.setAndBroadcast("Offline"),Promise.resolve())))}handleWatchStreamFailure(T){"Online"===this.state?this.setAndBroadcast("Unknown"):(this.watchStreamFailures++,this.watchStreamFailures>=h3&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(`Connection failed ${h3} times. Most recent error: ${T.toString()}`),this.setAndBroadcast("Offline")))}set(T){this.clearOnlineStateTimer(),this.watchStreamFailures=0,"Online"===T&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(T)}setAndBroadcast(T){T!==this.state&&(this.state=T,this.onlineStateHandler(T))}logClientOfflineWarningIfNecessary(T){let S=`Could not reach Cloud Firestore backend. ${T}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.shouldWarnClientIsOffline?(ef(S),this.shouldWarnClientIsOffline=!1):eh(h2,S)}clearOnlineStateTimer(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let h9="RemoteStore",h5=10;class h8{constructor(T,S,R,O,N){this.localStore=T,this.datastore=S,this.asyncQueue=R,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=N,this.connectivityMonitor.addCallback(T=>{R.enqueueAndForget(async()=>{fd(this)&&(eh(h9,"Restarting streams for network reachability change."),await fk(this))})}),this.onlineStateTracker=new h6(R,O)}}function h7(T,S,R,O,N){return new h8(T,S,R,O,N)}async function fe(T){if(fd(T))for(let S of T.onNetworkStatusChange)await S(!0)}async function ft(T){for(let S of T.onNetworkStatusChange)await S(!1)}async function fr(T){let S=eb(T);eh(h9,"RemoteStore shutting down."),S.offlineCauses.add(5),await ft(S),S.connectivityMonitor.shutdown(),S.onlineStateTracker.set("Unknown")}function fi(T,S){let R=eb(T);!R.listenTargets.has(S.targetId)&&(R.listenTargets.set(S.targetId,S),fc(R)?fu(R):fM(R).isOpen()&&fo(R,S))}function fa(T,S){let R=eb(T),O=fM(R);R.listenTargets.delete(S),O.isOpen()&&fl(R,S),0===R.listenTargets.size&&(O.isOpen()?O.markIdle():fd(R)&&R.onlineStateTracker.set("Unknown"))}function fo(T,S){if(T.watchChangeAggregator.recordPendingTargetRequest(S.targetId),S.resumeToken.approximateByteSize()>0||S.snapshotVersion.compareTo(e2.min())>0){let R=T.remoteSyncer.getRemoteKeysForTarget(S.targetId).size;S=S.withExpectedCount(R)}fM(T).watch(S)}function fl(T,S){T.watchChangeAggregator.recordPendingTargetRequest(S),fM(T).unwatch(S)}function fu(T){T.watchChangeAggregator=new a1({getRemoteKeysForTarget:S=>T.remoteSyncer.getRemoteKeysForTarget(S),getTargetDataForTarget:S=>T.listenTargets.get(S)||null,getDatabaseId:()=>T.datastore.serializer.databaseId}),fM(T).start(),T.onlineStateTracker.handleWatchStreamStart()}function fc(T){return fd(T)&&!fM(T).isStarted()&&T.listenTargets.size>0}function fd(T){let S=eb(T);return 0===S.offlineCauses.size}function fh(T){T.watchChangeAggregator=void 0}async function ff(T){T.onlineStateTracker.set("Online")}async function fp(T){T.listenTargets.forEach((S,R)=>{fo(T,S)})}async function fm(T,S){fh(T),fc(T)?(T.onlineStateTracker.handleWatchStreamFailure(S),fu(T)):T.onlineStateTracker.set("Unknown")}async function fg(T,S,R){if(T.onlineStateTracker.set("Online"),S instanceof aX&&2===S.state&&S.cause){try{await f_(T,S)}catch(R){eh(h9,"Failed to remove targets %s: %s ",S.targetIds.join(","),R),await fy(T,R)}return}if(S instanceof aY?T.watchChangeAggregator.handleDocumentChange(S):S instanceof aJ?T.watchChangeAggregator.handleExistenceFilter(S):T.watchChangeAggregator.handleTargetChange(S),!R.isEqual(e2.min()))try{let S=await dN(T.localStore);R.compareTo(S)>=0&&await fb(T,R)}catch(S){eh(h9,"Failed to raise snapshot:",S),await fy(T,S)}}async function fy(T,S,R){if(tT(S))T.offlineCauses.add(1),await ft(T),T.onlineStateTracker.set("Offline"),R||(R=()=>dN(T.localStore)),T.asyncQueue.enqueueRetryable(async()=>{eh(h9,"Retrying IndexedDB access"),await R(),T.offlineCauses.delete(1),await fe(T)});else throw S}function fv(T,S){return S().catch(R=>fy(T,R,S))}function fb(T,S){let R=T.watchChangeAggregator.createRemoteEvent(S);return R.targetChanges.forEach((R,O)=>{if(R.resumeToken.approximateByteSize()>0){let N=T.listenTargets.get(O);N&&T.listenTargets.set(O,N.withResumeToken(R.resumeToken,S))}}),R.targetMismatches.forEach((S,R)=>{let O=T.listenTargets.get(S);if(!O)return;T.listenTargets.set(S,O.withResumeToken(no.EMPTY_BYTE_STRING,O.snapshotVersion)),fl(T,S);let N=new lh(O.target,S,R,O.sequenceNumber);fo(T,N)}),T.remoteSyncer.applyRemoteEvent(R)}async function f_(T,S){let R=S.cause;for(let O of S.targetIds)T.listenTargets.has(O)&&(await T.remoteSyncer.rejectListen(O,R),T.listenTargets.delete(O),T.watchChangeAggregator.removeTarget(O))}async function fT(T){let S=eb(T),R=fx(S),O=S.writePipeline.length>0?S.writePipeline[S.writePipeline.length-1].batchId:nR;for(;fS(S);)try{let T=await dx(S.localStore,O);if(null===T){0===S.writePipeline.length&&R.markIdle();break}O=T.batchId,fE(S,T)}catch(T){await fy(S,T)}fw(S)&&fC(S)}function fS(T){return fd(T)&&T.writePipeline.length<h5}function fE(T,S){T.writePipeline.push(S);let R=fx(T);R.isOpen()&&R.handshakeComplete&&R.writeMutations(S.mutations)}function fw(T){return fd(T)&&!fx(T).isStarted()&&T.writePipeline.length>0}function fC(T){fx(T).start()}async function fI(T){fx(T).writeHandshake()}async function fR(T){let S=fx(T);for(let R of T.writePipeline)S.writeMutations(R.mutations)}async function fA(T,S,R){let O=T.writePipeline.shift(),N=aD.from(O,S,R);await fv(T,()=>T.remoteSyncer.applySuccessfulWrite(N)),await fT(T)}async function fO(T,S){S&&fx(T).handshakeComplete&&await fN(T,S),fw(T)&&fC(T)}async function fN(T,S){if(aF(S.code)){let R=T.writePipeline.shift();fx(T).inhibitBackoff(),await fv(T,()=>T.remoteSyncer.rejectFailedWrite(R.batchId,S)),await fT(T)}}async function fk(T){let S=eb(T);S.offlineCauses.add(4),await ft(S),S.onlineStateTracker.set("Unknown"),S.offlineCauses.delete(4),await fe(S)}async function fP(T,S){let R=eb(T);R.asyncQueue.verifyOperationInProgress(),eh(h9,"RemoteStore received new credentials");let O=fd(R);R.offlineCauses.add(3),await ft(R),O&&R.onlineStateTracker.set("Unknown"),await R.remoteSyncer.handleCredentialChange(S),R.offlineCauses.delete(3),await fe(R)}async function fD(T,S){let R=eb(T);S?(R.offlineCauses.delete(2),await fe(R)):S||(R.offlineCauses.add(2),await ft(R),R.onlineStateTracker.set("Unknown"))}function fM(T){return T.watchStream||(T.watchStream=h1(T.datastore,T.asyncQueue,{onConnected:ff.bind(null,T),onOpen:fp.bind(null,T),onClose:fm.bind(null,T),onWatchChange:fg.bind(null,T)}),T.onNetworkStatusChange.push(async S=>{S?(T.watchStream.inhibitBackoff(),fc(T)?fu(T):T.onlineStateTracker.set("Unknown")):(await T.watchStream.stop(),fh(T))})),T.watchStream}function fx(T){return T.writeStream||(T.writeStream=h0(T.datastore,T.asyncQueue,{onConnected:()=>Promise.resolve(),onOpen:fI.bind(null,T),onClose:fO.bind(null,T),onHandshakeComplete:fR.bind(null,T),onMutationResult:fA.bind(null,T)}),T.onNetworkStatusChange.push(async S=>{S?(T.writeStream.inhibitBackoff(),await fT(T)):(await T.writeStream.stop(),T.writePipeline.length>0&&(eh(h9,`Stopping write stream with ${T.writePipeline.length} pending writes`),T.writePipeline=[]))})),T.writeStream}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fL="AsyncQueue";class fF{constructor(T,S,R,O,N){this.asyncQueue=T,this.timerId=S,this.targetTimeMs=R,this.op=O,this.removalCallback=N,this.deferred=new eS,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(T=>{})}get promise(){return this.deferred.promise}static createAndSchedule(T,S,R,O,N){let M=Date.now()+R,L=new fF(T,S,M,O,N);return L.start(R),L}start(T){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),T)}skipDelay(){return this.handleDelayElapsed()}cancel(T){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new eT(e_.CANCELLED,"Operation cancelled"+(T?": "+T:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(T=>this.deferred.resolve(T))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fU(T,S){if(ef(fL,`${S}: ${T}`),tT(T))return new eT(e_.UNAVAILABLE,`${S}: ${T}`);throw T}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fj{static emptySet(T){return new fj(T.comparator)}constructor(T){T?this.comparator=(S,R)=>T(S,R)||eG.comparator(S.key,R.key):this.comparator=(T,S)=>eG.comparator(T.key,S.key),this.keyedMap=sz(),this.sortedSet=new r4(this.comparator)}has(T){return null!=this.keyedMap.get(T)}get(T){return this.keyedMap.get(T)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(T){let S=this.keyedMap.get(T);return S?this.sortedSet.indexOf(S):-1}get size(){return this.sortedSet.size}forEach(T){this.sortedSet.inorderTraversal((S,R)=>(T(S),!1))}add(T){let S=this.delete(T.key);return S.copy(S.keyedMap.insert(T.key,T),S.sortedSet.insert(T,null))}delete(T){let S=this.get(T);return S?this.copy(this.keyedMap.remove(T),this.sortedSet.remove(S)):this}isEqual(T){if(!(T instanceof fj)||this.size!==T.size)return!1;let S=this.sortedSet.getIterator(),R=T.sortedSet.getIterator();for(;S.hasNext();){let T=S.getNext().key,O=R.getNext().key;if(!T.isEqual(O))return!1}return!0}toString(){let T=[];return(this.forEach(S=>{T.push(S.toString())}),0===T.length)?"DocumentSet ()":"DocumentSet (\n  "+T.join("  \n")+"\n)"}copy(T,S){let R=new fj;return R.comparator=this.comparator,R.keyedMap=T,R.sortedSet=S,R}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fB{constructor(){this.changeMap=new r4(eG.comparator)}track(T){let S=T.doc.key,R=this.changeMap.get(S);if(!R){this.changeMap=this.changeMap.insert(S,T);return}0!==T.type&&3===R.type?this.changeMap=this.changeMap.insert(S,T):3===T.type&&1!==R.type?this.changeMap=this.changeMap.insert(S,{type:R.type,doc:T.doc}):2===T.type&&2===R.type?this.changeMap=this.changeMap.insert(S,{type:2,doc:T.doc}):2===T.type&&0===R.type?this.changeMap=this.changeMap.insert(S,{type:0,doc:T.doc}):1===T.type&&0===R.type?this.changeMap=this.changeMap.remove(S):1===T.type&&2===R.type?this.changeMap=this.changeMap.insert(S,{type:1,doc:R.doc}):0===T.type&&1===R.type?this.changeMap=this.changeMap.insert(S,{type:2,doc:T.doc}):eg(63341,{change:T,oldChange:R})}getChanges(){let T=[];return this.changeMap.inorderTraversal((S,R)=>{T.push(R)}),T}}class fV{constructor(T,S,R,O,N,M,L,U,V){this.query=T,this.docs=S,this.oldDocs=R,this.docChanges=O,this.mutatedKeys=N,this.fromCache=M,this.syncStateChanged=L,this.excludesMetadataChanges=U,this.hasCachedResults=V}static fromInitialDocuments(T,S,R,O,N){let M=[];return S.forEach(T=>{M.push({type:0,doc:T})}),new fV(T,S,fj.emptySet(S),M,R,O,!0,!1,N)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(T){if(this.fromCache!==T.fromCache||this.hasCachedResults!==T.hasCachedResults||this.syncStateChanged!==T.syncStateChanged||!this.mutatedKeys.isEqual(T.mutatedKeys)||!sR(this.query,T.query)||!this.docs.isEqual(T.docs)||!this.oldDocs.isEqual(T.oldDocs))return!1;let S=this.docChanges,R=T.docChanges;if(S.length!==R.length)return!1;for(let T=0;T<S.length;T++)if(S[T].type!==R[T].type||!S[T].doc.isEqual(R[T].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fz{constructor(){this.viewSnap=void 0,this.listeners=[]}hasRemoteListeners(){return this.listeners.some(T=>T.listensToRemoteStore())}}function fq(){return new fH}class fH{constructor(){this.queries=fG(),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set}terminate(){fJ(this,new eT(e_.ABORTED,"Firestore shutting down"))}}function fG(){return new sU(T=>sA(T),sR)}async function fW(T,S){let R=eb(T),O=3,N=S.query,M=R.queries.get(N);M?!M.hasRemoteListeners()&&S.listensToRemoteStore()&&(O=2):(M=new fz,O=S.listensToRemoteStore()?0:1);try{switch(O){case 0:M.viewSnap=await R.onListen(N,!0);break;case 1:M.viewSnap=await R.onListen(N,!1);break;case 2:await R.onFirstRemoteStoreListen(N)}}catch(R){let T=fU(R,`Initialization of query '${sO(S.query)}' failed`);S.onError(T);return}if(R.queries.set(N,M),M.listeners.push(S),S.applyOnlineStateChange(R.onlineState),M.viewSnap){let T=S.onViewSnapshot(M.viewSnap);T&&fX(R)}}async function fK(T,S){let R=eb(T),O=S.query,N=3,M=R.queries.get(O);if(M){let T=M.listeners.indexOf(S);T>=0&&(M.listeners.splice(T,1),0===M.listeners.length?N=S.listensToRemoteStore()?0:1:!M.hasRemoteListeners()&&S.listensToRemoteStore()&&(N=2))}switch(N){case 0:return R.queries.delete(O),R.onUnlisten(O,!0);case 1:return R.queries.delete(O),R.onUnlisten(O,!1);case 2:return R.onLastRemoteStoreUnlisten(O);default:return}}function f$(T,S){let R=eb(T),O=!1;for(let T of S){let S=T.query,N=R.queries.get(S);if(N){for(let S of N.listeners)S.onViewSnapshot(T)&&(O=!0);N.viewSnap=T}}O&&fX(R)}function fQ(T,S,R){let O=eb(T),N=O.queries.get(S);if(N)for(let T of N.listeners)T.onError(R);O.queries.delete(S)}function fY(T,S){let R=eb(T);R.onlineState=S;let O=!1;R.queries.forEach((T,R)=>{for(let T of R.listeners)T.applyOnlineStateChange(S)&&(O=!0)}),O&&fX(R)}function fJ(T,S){let R=eb(T),O=R.queries;R.queries=fG(),O.forEach((T,R)=>{for(let T of R.listeners)T.onError(S)})}function fX(T){T.snapshotsInSyncListeners.forEach(T=>{T.next()})}!function(T){T.Default="default",T.Cache="cache"}(L||(L={}));class fZ{constructor(T,S,R){this.query=T,this.queryObserver=S,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=R||{}}onViewSnapshot(T){if(!this.options.includeMetadataChanges){let S=[];for(let R of T.docChanges)3!==R.type&&S.push(R);T=new fV(T.query,T.docs,T.oldDocs,S,T.mutatedKeys,T.fromCache,T.syncStateChanged,!0,T.hasCachedResults)}let S=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(T)&&(this.queryObserver.next(T),S=!0):this.shouldRaiseInitialEvent(T,this.onlineState)&&(this.raiseInitialEvent(T),S=!0),this.snap=T,S}onError(T){this.queryObserver.error(T)}applyOnlineStateChange(T){this.onlineState=T;let S=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,T)&&(this.raiseInitialEvent(this.snap),S=!0),S}shouldRaiseInitialEvent(T,S){if(!T.fromCache||!this.listensToRemoteStore())return!0;let R="Offline"!==S;return(!this.options.waitForSyncWhenOnline||!R)&&(!T.docs.isEmpty()||T.hasCachedResults||"Offline"===S)}shouldRaiseEvent(T){if(T.docChanges.length>0)return!0;let S=this.snap&&this.snap.hasPendingWrites!==T.hasPendingWrites;return(!!T.syncStateChanged||!!S)&&!0===this.options.includeMetadataChanges}raiseInitialEvent(T){T=fV.fromInitialDocuments(T.query,T.docs,T.mutatedKeys,T.fromCache,T.hasCachedResults),this.raisedInitialEvent=!0,this.queryObserver.next(T)}listensToRemoteStore(){return this.options.source!==L.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0{constructor(T,S,R,O){this.targetId=T,this.fromCache=S,this.addedKeys=R,this.removedKeys=O}static fromSnapshot(T,S){let R=sJ(),O=sJ();for(let T of S.docChanges)switch(T.type){case 0:R=R.add(T.doc.key);break;case 1:O=O.add(T.doc.key)}return new f0(T,S.fromCache,R,O)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f3{constructor(T){this.serializer=T}toDocumentKey(T){return of(this.serializer,T)}toMutableDocument(T){return T.metadata.exists?oS(this.serializer,T.document,!1):iC.newNoDocument(this.toDocumentKey(T.metadata.name),this.toSnapshotVersion(T.metadata.readTime))}toSnapshotVersion(T){return ol(T)}}class f4{constructor(T,S){this.bundleMetadata=T,this.serializer=S,this._queries=[],this._documents=[],this.collectionGroups=new Set,this.progress=f6(T)}get queries(){return this._queries}get documents(){return this._documents}addSizedElement(T){this.progress.bytesLoaded+=T.byteLength;let S=this.progress.documentsLoaded;if(T.payload.namedQuery)this._queries.push(T.payload.namedQuery);else if(T.payload.documentMetadata){this._documents.push({metadata:T.payload.documentMetadata}),!T.payload.documentMetadata.exists&&++S;let R=ez.fromString(T.payload.documentMetadata.name);this.collectionGroups.add(R.get(R.length-2))}else T.payload.document&&(this._documents[this._documents.length-1].document=T.payload.document,++S);return S!==this.progress.documentsLoaded?(this.progress.documentsLoaded=S,{...this.progress}):null}getQueryDocumentMapping(T){let S=new Map,R=new f3(this.serializer);for(let O of T)if(O.metadata.queries){let T=R.toDocumentKey(O.metadata.name);for(let R of O.metadata.queries){let O=(S.get(R)||sJ()).add(T);S.set(R,O)}}return S}async completeAndStoreAsync(T){let S=await dQ(T,new f3(this.serializer),this._documents,this.bundleMetadata.id),R=this.getQueryDocumentMapping(this.documents);for(let S of this._queries)await dZ(T,S,R.get(S.name));return this.progress.taskState="Success",{progress:this.progress,changedCollectionGroups:this.collectionGroups,changedDocs:S}}}function f6(T){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:T.totalDocuments,totalBytes:T.totalBytes}}function f9(T){return{taskState:"Success",documentsLoaded:T.totalDocuments,bytesLoaded:T.totalBytes,totalDocuments:T.totalDocuments,totalBytes:T.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f5{constructor(T){this.key=T}}class f8{constructor(T){this.key=T}}class f7{constructor(T,S){this.query=T,this._syncedDocuments=S,this.syncState=null,this.hasCachedResults=!1,this.current=!1,this.limboDocuments=sJ(),this.mutatedKeys=sJ(),this.docComparator=sL(T),this.documentSet=new fj(this.docComparator)}get syncedDocuments(){return this._syncedDocuments}computeDocChanges(T,S){let R=S?S.changeSet:new fB,O=S?S.documentSet:this.documentSet,N=S?S.mutatedKeys:this.mutatedKeys,M=O,L=!1,U="F"===this.query.limitType&&O.size===this.query.limit?O.last():null,V="L"===this.query.limitType&&O.size===this.query.limit?O.first():null;if(T.inorderTraversal((T,S)=>{let K=O.get(T),$=sN(this.query,S)?S:null,Q=!!K&&this.mutatedKeys.has(K.key),Y=!!$&&($.hasLocalMutations||this.mutatedKeys.has($.key)&&$.hasCommittedMutations),X=!1;if(K&&$){let T=K.data.isEqual($.data);T?Q!==Y&&(R.track({type:3,doc:$}),X=!0):!this.shouldWaitForSyncedDocument(K,$)&&(R.track({type:2,doc:$}),X=!0,(U&&this.docComparator($,U)>0||V&&0>this.docComparator($,V))&&(L=!0))}else!K&&$?(R.track({type:0,doc:$}),X=!0):K&&!$&&(R.track({type:1,doc:K}),X=!0,(U||V)&&(L=!0));X&&($?(M=M.add($),N=Y?N.add(T):N.delete(T)):(M=M.delete(T),N=N.delete(T)))}),null!==this.query.limit)for(;M.size>this.query.limit;){let T="F"===this.query.limitType?M.last():M.first();M=M.delete(T.key),N=N.delete(T.key),R.track({type:1,doc:T})}return{documentSet:M,changeSet:R,needsRefill:L,mutatedKeys:N}}shouldWaitForSyncedDocument(T,S){return T.hasLocalMutations&&S.hasCommittedMutations&&!S.hasLocalMutations}applyChanges(T,S,R,O){let N=this.documentSet;this.documentSet=T.documentSet,this.mutatedKeys=T.mutatedKeys;let M=T.changeSet.getChanges();M.sort((T,S)=>pe(T.type,S.type)||this.docComparator(T.doc,S.doc)),this.applyTargetChange(R),O=O??!1;let L=S&&!O?this.updateLimboDocuments():[],U=0===this.limboDocuments.size&&this.current&&!O,V=U?1:0,K=V!==this.syncState;if(this.syncState=V,0===M.length&&!K)return{limboChanges:L};{let S=new fV(this.query,T.documentSet,N,M,T.mutatedKeys,0===V,K,!1,!!R&&R.resumeToken.approximateByteSize()>0);return{snapshot:S,limboChanges:L}}}applyOnlineStateChange(T){return this.current&&"Offline"===T?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new fB,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}}shouldBeInLimbo(T){return!this._syncedDocuments.has(T)&&!!this.documentSet.has(T)&&!this.documentSet.get(T).hasLocalMutations}applyTargetChange(T){T&&(T.addedDocuments.forEach(T=>this._syncedDocuments=this._syncedDocuments.add(T)),T.modifiedDocuments.forEach(T=>{}),T.removedDocuments.forEach(T=>this._syncedDocuments=this._syncedDocuments.delete(T)),this.current=T.current)}updateLimboDocuments(){if(!this.current)return[];let T=this.limboDocuments;this.limboDocuments=sJ(),this.documentSet.forEach(T=>{this.shouldBeInLimbo(T.key)&&(this.limboDocuments=this.limboDocuments.add(T.key))});let S=[];return T.forEach(T=>{this.limboDocuments.has(T)||S.push(new f8(T))}),this.limboDocuments.forEach(R=>{T.has(R)||S.push(new f5(R))}),S}synchronizeWithPersistedState(T){this._syncedDocuments=T.remoteKeys,this.limboDocuments=sJ();let S=this.computeDocChanges(T.documents);return this.applyChanges(S,!0)}computeInitialSnapshot(){return fV.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,0===this.syncState,this.hasCachedResults)}}function pe(T,S){let R=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return eg(20277,{change:T})}};return R(T)-R(S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pt="SyncEngine";class pr{constructor(T,S,R){this.query=T,this.targetId=S,this.view=R}}class pn{constructor(T){this.key=T,this.receivedDocument=!1}}class pi{constructor(T,S,R,O,N,M){this.localStore=T,this.remoteStore=S,this.eventManager=R,this.sharedClientState=O,this.currentUser=N,this.maxConcurrentLimboResolutions=M,this.syncEngineListener={},this.queryViewsByQuery=new sU(T=>sA(T),sR),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=new Set,this.activeLimboTargetsByKey=new r4(eG.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new cN,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=u0.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}get isPrimaryClient(){return!0===this._isPrimaryClient}}function ps(T,S,R,O,N,M,L){let U=new pi(T,S,R,O,N,M);return L&&(U._isPrimaryClient=!0),U}async function pa(T,S,R=!0){let O;let N=pz(T),M=N.queryViewsByQuery.get(S);return M?(N.sharedClientState.addLocalQueryTarget(M.targetId),O=M.view.computeInitialSnapshot()):O=await pl(N,S,R,!0),O}async function po(T,S){let R=pz(T);await pl(R,S,!0,!1)}async function pl(T,S,R,O){let N;let M=await dF(T.localStore,sb(S)),L=M.targetId,U=T.sharedClientState.addLocalQueryTarget(L,R);return O&&(N=await pu(T,S,L,"current"===U,M.resumeToken)),T.isPrimaryClient&&R&&fi(T.remoteStore,M),N}async function pu(T,S,R,O,N){T.applyDocChanges=(S,R,O)=>pO(T,S,R,O);let M=await dB(T.localStore,S,!0),L=new f7(S,M.remoteKeys),U=L.computeDocChanges(M.documents),V=aQ.createSynthesizedTargetChangeForCurrentChange(R,O&&"Offline"!==T.onlineState,N),K=L.applyChanges(U,T.isPrimaryClient,V);pC(T,R,K.limboChanges);let $=new pr(S,R,L);return T.queryViewsByQuery.set(S,$),T.queriesByTarget.has(R)?T.queriesByTarget.get(R).push(S):T.queriesByTarget.set(R,[S]),K.snapshot}async function pc(T,S,R){let O=eb(T),N=O.queryViewsByQuery.get(S),M=O.queriesByTarget.get(N.targetId);if(M.length>1){O.queriesByTarget.set(N.targetId,M.filter(T=>!sR(T,S))),O.queryViewsByQuery.delete(S);return}if(O.isPrimaryClient){O.sharedClientState.removeLocalQueryTarget(N.targetId);let T=O.sharedClientState.isActiveQueryTarget(N.targetId);T||await dj(O.localStore,N.targetId,!1).then(()=>{O.sharedClientState.clearQueryState(N.targetId),R&&fa(O.remoteStore,N.targetId),pE(O,N.targetId)}).catch(th)}else pE(O,N.targetId),await dj(O.localStore,N.targetId,!0)}async function ph(T,S){let R=eb(T),O=R.queryViewsByQuery.get(S),N=R.queriesByTarget.get(O.targetId);R.isPrimaryClient&&1===N.length&&(R.sharedClientState.removeLocalQueryTarget(O.targetId),fa(R.remoteStore,O.targetId))}async function pf(T,S,R){let O=pq(T);try{let T=await dC(O.localStore,S);O.sharedClientState.addPendingMutation(T.batchId),pT(O,T.batchId,R),await pA(O,T.changes),await fT(O.remoteStore)}catch(S){let T=fU(S,"Failed to persist write");R.reject(T)}}async function pp(T,S){let R=eb(T);try{let T=await dk(R.localStore,S);S.targetChanges.forEach((T,S)=>{let O=R.activeLimboResolutionsByTarget.get(S);O&&(ev(T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size<=1,22616),T.addedDocuments.size>0?O.receivedDocument=!0:T.modifiedDocuments.size>0?ev(O.receivedDocument,14607):T.removedDocuments.size>0&&(ev(O.receivedDocument,42227),O.receivedDocument=!1))}),await pA(R,T,S)}catch(T){await th(T)}}function pm(T,S,R){let O=eb(T);if(O.isPrimaryClient&&0===R||!O.isPrimaryClient&&1===R){let T=[];O.queryViewsByQuery.forEach((R,O)=>{let N=O.view.applyOnlineStateChange(S);N.snapshot&&T.push(N.snapshot)}),fY(O.eventManager,S),T.length&&O.syncEngineListener.onWatchChange(T),O.onlineState=S,O.isPrimaryClient&&O.sharedClientState.setOnlineState(S)}}async function pg(T,S,R){let O=eb(T);O.sharedClientState.updateQueryState(S,"rejected",R);let N=O.activeLimboResolutionsByTarget.get(S),M=N&&N.key;if(M){let T=new r4(eG.comparator);T=T.insert(M,iC.newNoDocument(M,e2.min()));let R=sJ().add(M),N=new a$(e2.min(),new Map,new r4(eD),T,R);await pp(O,N),O.activeLimboTargetsByKey=O.activeLimboTargetsByKey.remove(M),O.activeLimboResolutionsByTarget.delete(S),pR(O)}else await dj(O.localStore,S,!1).then(()=>pE(O,S,R)).catch(th)}async function py(T,S){let R=eb(T),O=S.batch.batchId;try{let T=await dI(R.localStore,S);pS(R,O,null),pb(R,O),R.sharedClientState.updateMutationState(O,"acknowledged"),await pA(R,T)}catch(T){await th(T)}}async function pv(T,S,R){let O=eb(T);try{let T=await dA(O.localStore,S);pS(O,S,R),pb(O,S),O.sharedClientState.updateMutationState(S,"rejected",R),await pA(O,T)}catch(T){await th(T)}}function pb(T,S){(T.pendingWritesCallbacks.get(S)||[]).forEach(T=>{T.resolve()}),T.pendingWritesCallbacks.delete(S)}function p_(T,S){T.pendingWritesCallbacks.forEach(T=>{T.forEach(T=>{T.reject(new eT(e_.CANCELLED,S))})}),T.pendingWritesCallbacks.clear()}function pT(T,S,R){let O=T.mutationUserCallbacks[T.currentUser.toKey()];O||(O=new r4(eD)),O=O.insert(S,R),T.mutationUserCallbacks[T.currentUser.toKey()]=O}function pS(T,S,R){let O=eb(T),N=O.mutationUserCallbacks[O.currentUser.toKey()];if(N){let T=N.get(S);T&&(R?T.reject(R):T.resolve(),N=N.remove(S)),O.mutationUserCallbacks[O.currentUser.toKey()]=N}}function pE(T,S,R=null){for(let O of(T.sharedClientState.removeLocalQueryTarget(S),T.queriesByTarget.get(S)))T.queryViewsByQuery.delete(O),R&&T.syncEngineListener.onWatchError(O,R);if(T.queriesByTarget.delete(S),T.isPrimaryClient){let R=T.limboDocumentRefs.removeReferencesForId(S);R.forEach(S=>{let R=T.limboDocumentRefs.containsKey(S);R||pw(T,S)})}}function pw(T,S){T.enqueuedLimboResolutions.delete(S.path.canonicalString());let R=T.activeLimboTargetsByKey.get(S);null!==R&&(fa(T.remoteStore,R),T.activeLimboTargetsByKey=T.activeLimboTargetsByKey.remove(S),T.activeLimboResolutionsByTarget.delete(R),pR(T))}function pC(T,S,R){for(let O of R)if(O instanceof f5)T.limboDocumentRefs.addReference(O.key,S),pI(T,O);else if(O instanceof f8){eh(pt,"Document no longer in limbo: "+O.key),T.limboDocumentRefs.removeReference(O.key,S);let R=T.limboDocumentRefs.containsKey(O.key);R||pw(T,O.key)}else eg(19791,{limboChange:O})}function pI(T,S){let R=S.key,O=R.path.canonicalString();T.activeLimboTargetsByKey.get(R)||T.enqueuedLimboResolutions.has(O)||(eh(pt,"New document in limbo: "+R),T.enqueuedLimboResolutions.add(O),pR(T))}function pR(T){for(;T.enqueuedLimboResolutions.size>0&&T.activeLimboTargetsByKey.size<T.maxConcurrentLimboResolutions;){let S=T.enqueuedLimboResolutions.values().next().value;T.enqueuedLimboResolutions.delete(S);let R=new eG(ez.fromString(S)),O=T.limboTargetIdGenerator.next();T.activeLimboResolutionsByTarget.set(O,new pn(R)),T.activeLimboTargetsByKey=T.activeLimboTargetsByKey.insert(R,O),fi(T.remoteStore,new lh(sb(sh(R.path)),O,"TargetPurposeLimboResolution",tP.INVALID))}}async function pA(T,S,R){let O=eb(T),N=[],M=[],L=[];O.queryViewsByQuery.isEmpty()||(O.queryViewsByQuery.forEach((T,U)=>{L.push(O.applyDocChanges(U,S,R).then(T=>{if((T||R)&&O.isPrimaryClient){let S=T?!T.fromCache:R?.targetChanges.get(U.targetId)?.current;O.sharedClientState.updateQueryState(U.targetId,S?"current":"not-current")}if(T){N.push(T);let S=f0.fromSnapshot(U.targetId,T);M.push(S)}}))}),await Promise.all(L),O.syncEngineListener.onWatchChange(N),await dM(O.localStore,M))}async function pO(T,S,R,O){let N=S.view.computeDocChanges(R);N.needsRefill&&(N=await dB(T.localStore,S.query,!1).then(({documents:T})=>S.view.computeDocChanges(T,N)));let M=O&&O.targetChanges.get(S.targetId),L=O&&null!=O.targetMismatches.get(S.targetId),U=S.view.applyChanges(N,T.isPrimaryClient,M,L);return pC(T,S.targetId,U.limboChanges),U.snapshot}async function pN(T,S){let R=eb(T),O=!R.currentUser.isEqual(S);if(O){eh(pt,"User change. New user:",S.toKey());let T=await dw(R.localStore,S);R.currentUser=S,p_(R,"'waitForPendingWrites' promise is rejected due to a user change."),R.sharedClientState.handleUserChange(S,T.removedBatchIds,T.addedBatchIds),await pA(R,T.affectedDocuments)}}function pk(T,S){let R=eb(T),O=R.activeLimboResolutionsByTarget.get(S);if(O&&O.receivedDocument)return sJ().add(O.key);{let T=sJ(),O=R.queriesByTarget.get(S);if(!O)return T;for(let S of O){let O=R.queryViewsByQuery.get(S);T=T.unionWith(O.view.syncedDocuments)}return T}}async function pP(T,S){let R=eb(T),O=await dB(R.localStore,S.query,!0),N=S.view.synchronizeWithPersistedState(O);return R.isPrimaryClient&&pC(R,S.targetId,N.limboChanges),N}async function pD(T,S){let R=eb(T);return dW(R.localStore,S).then(T=>pA(R,T))}async function pM(T,S,R,O){let N=eb(T),M=await dz(N.localStore,S);if(null===M){eh(pt,"Cannot apply mutation batch with id: "+S);return}"pending"===R?await fT(N.remoteStore):"acknowledged"===R||"rejected"===R?(pS(N,S,O||null),pb(N,S),dq(N.localStore,S)):eg(6720,"Unknown batchState",{batchState:R}),await pA(N,M)}async function px(T,S){let R=eb(T);if(pz(R),pq(R),!0===S&&!0!==R._isPrimaryClient){let T=R.sharedClientState.getAllActiveQueryTargets(),S=await pF(R,T.toArray());for(let T of(R._isPrimaryClient=!0,await fD(R.remoteStore,!0),S))fi(R.remoteStore,T)}else if(!1===S&&!1!==R._isPrimaryClient){let T=[],S=Promise.resolve();R.queriesByTarget.forEach((O,N)=>{R.sharedClientState.isLocalQueryTarget(N)?T.push(N):S=S.then(()=>(pE(R,N),dj(R.localStore,N,!0))),fa(R.remoteStore,N)}),await S,await pF(R,T),pL(R),R._isPrimaryClient=!1,await fD(R.remoteStore,!1)}}function pL(T){let S=eb(T);S.activeLimboResolutionsByTarget.forEach((T,R)=>{fa(S.remoteStore,R)}),S.limboDocumentRefs.removeAllReferences(),S.activeLimboResolutionsByTarget=new Map,S.activeLimboTargetsByKey=new r4(eG.comparator)}async function pF(T,S,R){let O=eb(T),N=[],M=[];for(let T of S){let S;let R=O.queriesByTarget.get(T);if(R&&0!==R.length)for(let T of(S=await dF(O.localStore,sb(R[0])),R)){let S=O.queryViewsByQuery.get(T),R=await pP(O,S);R.snapshot&&M.push(R.snapshot)}else{let R=await dG(O.localStore,T);S=await dF(O.localStore,R),await pu(O,pU(R),T,!1,S.resumeToken)}N.push(S)}return O.syncEngineListener.onWatchChange(M),N}function pU(T){return sd(T.path,T.collectionGroup,T.orderBy,T.filters,T.limit,"F",T.startAt,T.endAt)}function pj(T){let S=eb(T);return dH(S.localStore)}async function pB(T,S,R,O){let N=eb(T);if(N._isPrimaryClient){eh(pt,"Ignoring unexpected query state notification.");return}let M=N.queriesByTarget.get(S);if(M&&M.length>0)switch(R){case"current":case"not-current":{let T=await dW(N.localStore,sx(M[0])),O=a$.createSynthesizedRemoteEventForCurrentChange(S,"current"===R,no.EMPTY_BYTE_STRING);await pA(N,T,O);break}case"rejected":await dj(N.localStore,S,!0),pE(N,S,O);break;default:eg(64155,R)}}async function pV(T,S,R){let O=pz(T);if(O._isPrimaryClient){for(let T of S){let S=O.queriesByTarget.has(T)&&O.sharedClientState.isActiveQueryTarget(T);if(S){eh(pt,"Adding an already active target "+T);continue}let R=await dG(O.localStore,T),N=await dF(O.localStore,R);await pu(O,pU(R),N.targetId,!1,N.resumeToken),fi(O.remoteStore,N)}for(let T of R)O.queriesByTarget.has(T)&&await dj(O.localStore,T,!1).then(()=>{fa(O.remoteStore,T),pE(O,T)}).catch(th)}}function pz(T){let S=eb(T);return S.remoteStore.remoteSyncer.applyRemoteEvent=pp.bind(null,S),S.remoteStore.remoteSyncer.getRemoteKeysForTarget=pk.bind(null,S),S.remoteStore.remoteSyncer.rejectListen=pg.bind(null,S),S.syncEngineListener.onWatchChange=f$.bind(null,S.eventManager),S.syncEngineListener.onWatchError=fQ.bind(null,S.eventManager),S}function pq(T){let S=eb(T);return S.remoteStore.remoteSyncer.applySuccessfulWrite=py.bind(null,S),S.remoteStore.remoteSyncer.rejectFailedWrite=pv.bind(null,S),S}function pH(T,S,R){let O=eb(T);pG(O,S,R).then(T=>{O.sharedClientState.notifyBundleLoaded(T)})}async function pG(T,S,R){try{let O=await S.getMetadata(),N=await dY(T.localStore,O);if(N)return await S.close(),R._completeWith(f9(O)),Promise.resolve(new Set);R._updateProgress(f6(O));let M=new f4(O,S.serializer),L=await S.nextElement();for(;L;){let T=await M.addSizedElement(L);T&&R._updateProgress(T),L=await S.nextElement()}let U=await M.completeAndStoreAsync(T.localStore);return await pA(T,U.changedDocs,void 0),await dJ(T.localStore,O),R._completeWith(U.progress),Promise.resolve(U.changedCollectionGroups)}catch(T){return ep(pt,`Loading bundle failed with ${T}`),R._failWith(T),Promise.resolve(new Set)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pW{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(T){this.serializer=hB(T.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(T),this.persistence=this.createPersistence(T),await this.persistence.start(),this.localStore=this.createLocalStore(T),this.gcScheduler=this.createGarbageCollectionScheduler(T,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(T,this.localStore)}createGarbageCollectionScheduler(T,S){return null}createIndexBackfillerScheduler(T,S){return null}createLocalStore(T){return dE(this.persistence,new d9,T.initialUser,this.serializer)}createPersistence(T){return new cB(cz.factory,this.serializer)}createSharedClientState(T){return new hv}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}pW.provider={build:()=>new pW};class pK extends null{constructor(T){super(),this.cacheSizeBytes=T}createGarbageCollectionScheduler(T,S){ev(this.persistence.referenceDelegate instanceof cq,46915);let R=this.persistence.referenceDelegate.garbageCollector;return new cs(R,T.asyncQueue,S)}createPersistence(T){let S=void 0!==this.cacheSizeBytes?u8.withCacheSize(this.cacheSizeBytes):u8.DEFAULT;return new cB(T=>cq.factory(T,S),this.serializer)}}class p$ extends null{constructor(T,S,R){super(),this.onlineComponentProvider=T,this.cacheSizeBytes=S,this.forceOwnership=R,this.kind="persistent",this.synchronizeTabs=!1}async initialize(T){await super.initialize(T),await this.onlineComponentProvider.initialize(this,T),await pq(this.onlineComponentProvider.syncEngine),await fT(this.onlineComponentProvider.remoteStore),await this.persistence.setPrimaryStateListener(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(T){return dE(this.persistence,new d9,T.initialUser,this.serializer)}createGarbageCollectionScheduler(T,S){let R=this.persistence.referenceDelegate.garbageCollector;return new cs(R,T.asyncQueue,S)}createIndexBackfillerScheduler(T,S){let R=new tk(S,this.persistence);return new tN(T.asyncQueue,R)}createPersistence(T){let S=dm(T.databaseInfo.databaseId,T.databaseInfo.persistenceKey),R=void 0!==this.cacheSizeBytes?u8.withCacheSize(this.cacheSizeBytes):u8.DEFAULT;return new dh(this.synchronizeTabs,S,T.clientId,R,T.asyncQueue,hU(),hj(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(T){return new hv}}class pQ{async initialize(T,S){this.localStore||(this.localStore=T.localStore,this.sharedClientState=T.sharedClientState,this.datastore=this.createDatastore(S),this.remoteStore=this.createRemoteStore(S),this.eventManager=this.createEventManager(S),this.syncEngine=this.createSyncEngine(S,!T.synchronizeTabs),this.sharedClientState.onlineStateHandler=T=>pm(this.syncEngine,T,1),this.remoteStore.remoteSyncer.handleCredentialChange=pN.bind(null,this.syncEngine),await fD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(T){return fq()}createDatastore(T){let S=hB(T.databaseInfo.databaseId),R=hL(T.databaseInfo);return hY(T.authCredentials,T.appCheckCredentials,R,S)}createRemoteStore(T){return h7(this.localStore,this.datastore,T.asyncQueue,T=>pm(this.syncEngine,T,0),hF())}createSyncEngine(T,S){return ps(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,T.initialUser,T.maxConcurrentLimboResolutions,S)}async terminate(){await fr(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}pQ.provider={build:()=>new pQ};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pY=10240;function pJ(T,S=pY){let R=0,O={async read(){if(R<T.byteLength){let O={value:T.slice(R,R+S),done:!1};return R+=S,O}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()};return O}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pX(T,S){if(!(T instanceof Uint8Array))throw new eT(e_.INVALID_ARGUMENT,`NodePlatform.toByteStreamReader expects source to be Uint8Array, got ${e$(T)}`);return pJ(T,S)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pZ{constructor(T){this.observer=T,this.muted=!1}next(T){!this.muted&&this.observer.next&&this.scheduleEvent(this.observer.next,T)}error(T){this.muted||(this.observer.error?this.scheduleEvent(this.observer.error,T):ef("Uncaught Error in snapshot listener:",T.toString()))}mute(){this.muted=!0}scheduleEvent(T,S){setTimeout(()=>{this.muted||T(S)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{constructor(T,S){this.payload=T,this.byteLength=S}isBundleMetadata(){return"metadata"in this.payload}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p3{constructor(T,S){this.reader=T,this.serializer=S,this.metadata=new eS,this.buffer=new Uint8Array,this.textDecoder=az(),this.nextElementImpl().then(T=>{T&&T.isBundleMetadata()?this.metadata.resolve(T.payload.metadata):this.metadata.reject(Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(T?.payload)}`))},T=>this.metadata.reject(T))}close(){return this.reader.cancel()}async getMetadata(){return this.metadata.promise}async nextElement(){return await this.getMetadata(),this.nextElementImpl()}async nextElementImpl(){let T=await this.readLength();if(null===T)return null;let S=this.textDecoder.decode(T),R=Number(S);isNaN(R)&&this.raiseError(`length string (${S}) is not valid number`);let O=await this.readJsonString(R);return new p0(JSON.parse(O),T.length+R)}indexOfOpenBracket(){return this.buffer.findIndex(T=>123===T)}async readLength(){for(;0>this.indexOfOpenBracket();){let T=await this.pullMoreDataToBuffer();if(T)break}if(0===this.buffer.length)return null;let T=this.indexOfOpenBracket();T<0&&this.raiseError("Reached the end of bundle when a length string is expected.");let S=this.buffer.slice(0,T);return this.buffer=this.buffer.slice(T),S}async readJsonString(T){for(;this.buffer.length<T;){let T=await this.pullMoreDataToBuffer();T&&this.raiseError("Reached the end of bundle when more is expected.")}let S=this.textDecoder.decode(this.buffer.slice(0,T));return this.buffer=this.buffer.slice(T),S}raiseError(T){throw this.reader.cancel(),Error(`Invalid bundle format: ${T}`)}async pullMoreDataToBuffer(){let T=await this.reader.read();if(!T.done){let S=new Uint8Array(this.buffer.length+T.value.length);S.set(this.buffer),S.set(T.value,this.buffer.length),this.buffer=S}return T.done}}function p4(T,S){return new p3(T,S)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(T,S){this.bundleData=T,this.serializer=S,this.cursor=0,this.elements=[];let R=this.nextElement();if(R&&R.isBundleMetadata())this.metadata=R;else throw Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(R?.payload)}`);do null!==(R=this.nextElement())&&this.elements.push(R);while(null!==R)}getMetadata(){return this.metadata}getElements(){return this.elements}nextElement(){if(this.cursor===this.bundleData.length)return null;let T=this.readLength(),S=this.readJsonString(T);return new p0(JSON.parse(S),T)}readJsonString(T){if(this.cursor+T>this.bundleData.length)throw new eT(e_.INTERNAL,"Reached the end of bundle when more is expected.");let S=this.bundleData.slice(this.cursor,this.cursor+=T);return S}readLength(){let T=this.cursor,S=this.cursor;for(;S<this.bundleData.length;){if("{"===this.bundleData[S]){if(S===T)throw Error("First character is a bracket and not a number");return this.cursor=S,Number(this.bundleData.slice(T,S))}S++}throw Error("Reached the end of bundle when more is expected.")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p9{constructor(T){this.datastore=T,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(T){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new eT(e_.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let S=await hX(this.datastore,T);return S.forEach(T=>this.recordVersion(T)),S}set(T,S){this.write(S.toMutation(T,this.precondition(T))),this.writtenDocs.add(T.toString())}update(T,S){try{this.write(S.toMutation(T,this.preconditionForUpdate(T)))}catch(T){this.lastTransactionError=T}this.writtenDocs.add(T.toString())}delete(T){this.write(new aA(T,this.precondition(T))),this.writtenDocs.add(T.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let T=this.readVersions;this.mutations.forEach(S=>{T.delete(S.key.toString())}),T.forEach((T,S)=>{let R=eG.fromPath(S);this.mutations.push(new ak(R,this.precondition(R)))}),await hJ(this.datastore,this.mutations),this.committed=!0}recordVersion(T){let S;if(T.isFoundDocument())S=T.version;else if(T.isNoDocument())S=e2.min();else throw eg(50498,{documentName:T.constructor.name});let R=this.readVersions.get(T.key.toString());if(R){if(!S.isEqual(R))throw new eT(e_.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(T.key.toString(),S)}precondition(T){let S=this.readVersions.get(T.toString());return this.writtenDocs.has(T.toString())||!S?ad.none():S.isEqual(e2.min())?ad.exists(!1):ad.updateTime(S)}preconditionForUpdate(T){let S=this.readVersions.get(T.toString());if(this.writtenDocs.has(T.toString())||!S)return ad.exists(!0);if(S.isEqual(e2.min()))throw new eT(e_.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ad.updateTime(S)}write(T){this.ensureCommitNotCalled(),this.mutations.push(T)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let p5="FirestoreClient",p8=100,p7=11,me=20,mt=22;class mr{constructor(T,S,R,O,N){this.authCredentials=T,this.appCheckCredentials=S,this.asyncQueue=R,this.databaseInfo=O,this.user=ei.UNAUTHENTICATED,this.clientId=eP.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=N,this.authCredentials.start(R,async T=>{eh(p5,"Received user=",T.uid),await this.authCredentialListener(T),this.user=T}),this.appCheckCredentials.start(R,T=>(eh(p5,"Received new app check token=",T),this.appCheckCredentialListener(T,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:p8}}setCredentialChangeListener(T){this.authCredentialListener=T}setAppCheckTokenChangeListener(T){this.appCheckCredentialListener=T}terminate(){this.asyncQueue.enterRestrictedMode();let T=new eS;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),T.resolve()}catch(R){let S=fU(R,"Failed to shutdown persistence");T.reject(S)}}),T.promise}}async function mn(T,S){T.asyncQueue.verifyOperationInProgress(),eh(p5,"Initializing OfflineComponentProvider");let R=T.configuration;await S.initialize(R);let O=R.initialUser;T.setCredentialChangeListener(async T=>{O.isEqual(T)||(await dw(S.localStore,T),O=T)}),S.persistence.setDatabaseDeletedListener(()=>T.terminate()),T._offlineComponents=S}async function mi(T,S){T.asyncQueue.verifyOperationInProgress();let R=await ma(T);eh(p5,"Initializing OnlineComponentProvider"),await S.initialize(R,T.configuration),T.setCredentialChangeListener(T=>fP(S.remoteStore,T)),T.setAppCheckTokenChangeListener((T,R)=>fP(S.remoteStore,R)),T._onlineComponents=S}function ms(T){return"FirebaseError"===T.name?T.code===e_.FAILED_PRECONDITION||T.code===e_.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&T instanceof DOMException)||T.code===mt||T.code===me||T.code===p7}async function ma(T){if(!T._offlineComponents){if(T._uninitializedComponentsProvider){eh(p5,"Using user provided OfflineComponentProvider");try{await mn(T,T._uninitializedComponentsProvider._offline)}catch(R){let S=R;if(!ms(S))throw S;ep("Error using user provided cache. Falling back to memory cache: "+S),await mn(T,new pW)}}else eh(p5,"Using default OfflineComponentProvider"),await mn(T,new pK(void 0))}return T._offlineComponents}async function mo(T){return T._onlineComponents||(T._uninitializedComponentsProvider?(eh(p5,"Using user provided OnlineComponentProvider"),await mi(T,T._uninitializedComponentsProvider._online)):(eh(p5,"Using default OnlineComponentProvider"),await mi(T,new pQ))),T._onlineComponents}function ml(T){return ma(T).then(T=>T.localStore)}function mu(T){return mo(T).then(T=>T.syncEngine)}function mc(T){return mo(T).then(T=>T.datastore)}async function mh(T){let S=await mo(T),R=S.eventManager;return R.onListen=pa.bind(null,S.syncEngine),R.onUnlisten=pc.bind(null,S.syncEngine),R.onFirstRemoteStoreListen=po.bind(null,S.syncEngine),R.onLastRemoteStoreUnlisten=ph.bind(null,S.syncEngine),R}function mf(T,S,R,O){let N=new pZ(O),M=new fZ(S,N,R);return T.asyncQueue.enqueueAndForget(async()=>{let S=await mh(T);return fW(S,M)}),()=>{N.mute(),T.asyncQueue.enqueueAndForget(async()=>{let S=await mh(T);return fK(S,M)})}}function mp(T,S,R,O){let N=mg(R,hB(S));T.asyncQueue.enqueueAndForget(async()=>{pH(await mu(T),N,O)})}function mm(T,S){return T.asyncQueue.enqueue(async()=>dX(await ml(T),S))}function mg(T,S){let R;return p4(pX(R="string"==typeof T?aV().encode(T):T),S)}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function my(T,S){return T.timeoutSeconds===S.timeoutSeconds}function mv(T){let S={};return void 0!==T.timeoutSeconds&&(S.timeoutSeconds=T.timeoutSeconds),S}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mb="ComponentProvider",m_=new Map;function mT(T){let S=m_.get(T);S&&(eh(mb,"Removing Datastore"),m_.delete(T),S.terminate())}function mS(T,S,R,O){return new nE(T,S,R,O.host,O.ssl,O.experimentalForceLongPolling,O.experimentalAutoDetectLongPolling,mv(O.experimentalLongPollingOptions),O.useFetchStreams,O.isUsingEmulator)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mE="firestore.googleapis.com",mw=!0,mC=5,mI=30,mR=!0;class mA{constructor(T){if(void 0===T.host){if(void 0!==T.ssl)throw new eT(e_.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=mE,this.ssl=mw}else this.host=T.host,this.ssl=T.ssl??mw;if(this.isUsingEmulator=void 0!==T.emulatorOptions,this.credentials=T.credentials,this.ignoreUndefinedProperties=!!T.ignoreUndefinedProperties,this.localCache=T.localCache,void 0===T.cacheSizeBytes)this.cacheSizeBytes=u5;else{if(T.cacheSizeBytes!==u9&&T.cacheSizeBytes<ce)throw new eT(e_.INVALID_ARGUMENT,`cacheSizeBytes must be at least ${ce}`);this.cacheSizeBytes=T.cacheSizeBytes}eW("experimentalForceLongPolling",T.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",T.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!T.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===T.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=mR:this.experimentalAutoDetectLongPolling=!!T.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=mv(T.experimentalLongPollingOptions??{}),mO(this.experimentalLongPollingOptions),this.useFetchStreams=!!T.useFetchStreams}isEqual(T){return this.host===T.host&&this.ssl===T.ssl&&this.credentials===T.credentials&&this.cacheSizeBytes===T.cacheSizeBytes&&this.experimentalForceLongPolling===T.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===T.experimentalAutoDetectLongPolling&&my(this.experimentalLongPollingOptions,T.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===T.ignoreUndefinedProperties&&this.useFetchStreams===T.useFetchStreams}}function mO(T){if(void 0!==T.timeoutSeconds){if(isNaN(T.timeoutSeconds))throw new eT(e_.INVALID_ARGUMENT,`invalid long polling timeout: ${T.timeoutSeconds} (must not be NaN)`);if(T.timeoutSeconds<mC)throw new eT(e_.INVALID_ARGUMENT,`invalid long polling timeout: ${T.timeoutSeconds} (minimum allowed value is ${mC})`);if(T.timeoutSeconds>mI)throw new eT(e_.INVALID_ARGUMENT,`invalid long polling timeout: ${T.timeoutSeconds} (maximum allowed value is ${mI})`)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mN{constructor(T,S,R,O){this._authCredentials=T,this._appCheckCredentials=S,this._databaseId=R,this._app=O,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new mA({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new eT(e_.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(T){if(this._settingsFrozen)throw new eT(e_.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new mA(T),this._emulatorOptions=T.emulatorOptions||{},void 0!==T.credentials&&(this._authCredentials=eN(T.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return mT(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(T,S,R){this.converter=S,this._query=R,this.type="query",this.firestore=T}withConverter(T){return new mk(this.firestore,T,this._query)}}class mP{constructor(T,S,R){this.converter=S,this._key=R,this.type="document",this.firestore=T}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mD(this.firestore,this.converter,this._key.path.popLast())}withConverter(T){return new mP(this.firestore,T,this._key)}toJSON(){return{type:mP._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(T,S,R){if(eX(S,mP._jsonSchema))return new mP(T,R||null,new eG(ez.fromString(S.referencePath)))}}mP._jsonSchemaVersion="firestore/documentReference/1.0",mP._jsonSchema={type:eJ("string",mP._jsonSchemaVersion),referencePath:eJ("string")};class mD extends mk{constructor(T,S,R){super(T,S,sh(R)),this._path=R,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let T=this._path.popLast();return T.isEmpty()?null:new mP(this.firestore,null,new eG(T))}withConverter(T){return new mD(this.firestore,T,this._path)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mM="AsyncQueue";class mx{constructor(T=Promise.resolve()){this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new hG(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()},this.tail=T}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(T){this.enqueue(T)}enqueueAndForgetEvenWhileRestricted(T){this.verifyNotFailed(),this.enqueueInternal(T)}enterRestrictedMode(T){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=T||!1)}enqueue(T){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let S=new eS;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(T().then(S.resolve,S.reject),S.promise)).then(()=>S.promise)}enqueueRetryable(T){this.enqueueAndForget(()=>(this.retryableOps.push(T),this.retryNextOp()))}async retryNextOp(){if(0!==this.retryableOps.length){try{await this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(T){if(tT(T))eh(mM,"Operation failed with retryable error: "+T);else throw T}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}}enqueueInternal(T){let S=this.tail.then(()=>(this.operationInProgress=!0,T().catch(T=>{this.failure=T,this.operationInProgress=!1;let S=mL(T);throw ef("INTERNAL UNHANDLED ERROR: ",S),T}).then(T=>(this.operationInProgress=!1,T))));return this.tail=S,S}enqueueAfterDelay(T,S,R){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(T)>-1&&(S=0);let O=fF.createAndSchedule(this,T,S,R,T=>this.removeDelayedOperation(T));return this.delayedOperations.push(O),O}verifyNotFailed(){this.failure&&eg(47125,{messageOrStack:mL(this.failure)})}verifyOperationInProgress(){}async drain(){let T;do T=this.tail,await T;while(T!==this.tail)}containsDelayedOperation(T){for(let S of this.delayedOperations)if(S.timerId===T)return!0;return!1}runAllDelayedOperationsUntil(T){return this.drain().then(()=>{for(let S of(this.delayedOperations.sort((T,S)=>T.targetTimeMs-S.targetTimeMs),this.delayedOperations))if(S.skipDelay(),"all"!==T&&S.timerId===T)break;return this.drain()})}skipDelaysForTimerId(T){this.timerIdsToSkip.push(T)}removeDelayedOperation(T){let S=this.delayedOperations.indexOf(T);this.delayedOperations.splice(S,1)}}function mL(T){let S=T.message||"";return T.stack&&(S=T.stack.includes(T.message)?T.stack:T.message+"\n"+T.stack),S}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mF{constructor(){this._progressObserver={},this._taskCompletionResolver=new eS,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(T,S,R){this._progressObserver={next:T,error:S,complete:R}}catch(T){return this._taskCompletionResolver.promise.catch(T)}then(T,S){return this._taskCompletionResolver.promise.then(T,S)}_completeWith(T){this._updateProgress(T),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(T)}_failWith(T){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(T),this._taskCompletionResolver.reject(T)}_updateProgress(T){this._lastProgress=T,this._progressObserver.next&&this._progressObserver.next(T)}}class mU extends mN{constructor(T,S,R,O){super(T,S,R,O),this.type="firestore",this._queue=new mx,this._persistenceKey=O?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let T=this._firestoreClient.terminate();this._queue=new mx(T),this._firestoreClient=void 0,await T}}}function mj(T){if(T._terminated)throw new eT(e_.FAILED_PRECONDITION,"The client has already been terminated.");return T._firestoreClient||mB(T),T._firestoreClient}function mB(T){let S=T._freezeSettings(),R=mS(T._databaseId,T._app?.options.appId||"",T._persistenceKey,S);!T._componentsProvider&&S.localCache?._offlineComponentProvider&&S.localCache?._onlineComponentProvider&&(T._componentsProvider={_offline:S.localCache._offlineComponentProvider,_online:S.localCache._onlineComponentProvider}),T._firestoreClient=new mr(T._authCredentials,T._appCheckCredentials,T._queue,R,T._componentsProvider&&mV(T._componentsProvider))}function mV(T){let S=T?._online.build();return{_offline:T?._offline.build(S),_online:S}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mz(T,S=!0){eo(U.Jn),(0,U.Xd)(new V.wA("firestore",(T,{instanceIdentifier:R,options:O})=>{let N=T.getProvider("app").getImmediate(),M=new mU(new eC(T.getProvider("auth-internal")),new eO(N,T.getProvider("app-check-internal")),nI(N,R),N);return O={useFetchStreams:S,...O},M._setSettings(O),M},"PUBLIC").setMultipleInstances(!0)),(0,U.KN)(er,en,T),(0,U.KN)(er,en,"esm2020")}class mq{constructor(T,S,R){this._userDataWriter=S,this._data=R,this.type="AggregateQuerySnapshot",this.query=T}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mH{constructor(T){this._byteString=T}static fromBase64String(T){try{return new mH(no.fromBase64String(T))}catch(T){throw new eT(e_.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+T)}}static fromUint8Array(T){return new mH(no.fromUint8Array(T))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(T){return this._byteString.isEqual(T._byteString)}toJSON(){return{type:mH._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(T){if(eX(T,mH._jsonSchema))return mH.fromBase64String(T.bytes)}}mH._jsonSchemaVersion="firestore/bytes/1.0",mH._jsonSchema={type:eJ("string",mH._jsonSchemaVersion),bytes:eJ("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mG{constructor(...T){for(let S=0;S<T.length;++S)if(0===T[S].length)throw new eT(e_.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new eH(T)}isEqual(T){return this._internalPath.isEqual(T._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mW{constructor(T){this._methodName=T}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mK{constructor(T,S){if(!isFinite(T)||T<-90||T>90)throw new eT(e_.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+T);if(!isFinite(S)||S<-180||S>180)throw new eT(e_.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+S);this._lat=T,this._long=S}get latitude(){return this._lat}get longitude(){return this._long}isEqual(T){return this._lat===T._lat&&this._long===T._long}_compareTo(T){return eD(this._lat,T._lat)||eD(this._long,T._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:mK._jsonSchemaVersion}}static fromJSON(T){if(eX(T,mK._jsonSchema))return new mK(T.latitude,T.longitude)}}mK._jsonSchemaVersion="firestore/geoPoint/1.0",mK._jsonSchema={type:eJ("string",mK._jsonSchemaVersion),latitude:eJ("number"),longitude:eJ("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m${constructor(T){this._values=(T||[]).map(T=>T)}toArray(){return this._values.map(T=>T)}isEqual(T){return dy(this._values,T._values)}toJSON(){return{type:m$._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(T){if(eX(T,m$._jsonSchema)){if(Array.isArray(T.vectorValues)&&T.vectorValues.every(T=>"number"==typeof T))return new m$(T.vectorValues);throw new eT(e_.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}m$._jsonSchemaVersion="firestore/vectorValue/1.0",m$._jsonSchema={type:eJ("string",m$._jsonSchemaVersion),vectorValues:eJ("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mQ=/^__.*__$/;class mY{constructor(T,S,R){this.data=T,this.fieldMask=S,this.fieldTransforms=R}toMutation(T,S){return null!==this.fieldMask?new aS(T,this.data,this.fieldMask,S,this.fieldTransforms):new ab(T,this.data,S,this.fieldTransforms)}}class mJ{constructor(T,S,R){this.data=T,this.fieldMask=S,this.fieldTransforms=R}toMutation(T,S){return new aS(T,this.data,this.fieldMask,S,this.fieldTransforms)}}function mX(T){switch(T){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw eg(40011,{dataSource:T})}}class mZ{constructor(T,S,R,O,N,M){this.settings=T,this.databaseId=S,this.serializer=R,this.ignoreUndefinedProperties=O,void 0===N&&this.validatePath(),this.fieldTransforms=N||[],this.fieldMask=M||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(T){return new mZ({...this.settings,...T},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(T){let S=this.path?.child(T),R=this.contextWith({path:S,arrayElement:!1});return R.validatePathSegment(T),R}childContextForFieldPath(T){let S=this.path?.child(T),R=this.contextWith({path:S,arrayElement:!1});return R.validatePath(),R}childContextForArray(T){return this.contextWith({path:void 0,arrayElement:!0})}createError(T){return gc(T,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(T){return void 0!==this.fieldMask.find(S=>T.isPrefixOf(S))||void 0!==this.fieldTransforms.find(S=>T.isPrefixOf(S.field))}validatePath(){if(this.path)for(let T=0;T<this.path.length;T++)this.validatePathSegment(this.path.get(T))}validatePathSegment(T){if(0===T.length)throw this.createError("Document fields must not be empty");if(mX(this.dataSource)&&mQ.test(T))throw this.createError('Document fields cannot begin and end with "__"')}}class m0{constructor(T,S,R){this.databaseId=T,this.ignoreUndefinedProperties=S,this.serializer=R||hB(T)}createContext(T,S,R,O=!1){return new mZ({dataSource:T,methodName:S,targetDoc:R,path:eH.emptyPath(),arrayElement:!1,hasConverter:O},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function m1(T){let S=T._freezeSettings(),R=hB(T._databaseId);return new m0(T._databaseId,!!S.ignoreUndefinedProperties,R)}class m2 extends null{_toFieldTransform(T){if(2===T.dataSource)T.fieldMask.push(T.path);else if(1===T.dataSource)throw T.createError(`${this._methodName}() can only appear at the top level of your update data`);else throw T.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return null}isEqual(T){return T instanceof m2}}function m3(T,S,R){return new mZ({dataSource:3,targetDoc:S.settings.targetDoc,methodName:T._methodName,arrayElement:R},S.databaseId,S.serializer,S.ignoreUndefinedProperties)}class m4 extends null{_toFieldTransform(T){return new ao(T.path,new s8)}isEqual(T){return T instanceof m4}}class m6 extends null{constructor(T,S){super(T),this._elements=S}_toFieldTransform(T){let S=m3(this,T,!0),R=this._elements.map(T=>m7(T,S)),O=new s7(R);return new ao(T.path,O)}isEqual(T){return T instanceof m6&&deepEqual(this._elements,T._elements)}}class m9 extends null{constructor(T,S){super(T),this._elements=S}_toFieldTransform(T){let S=m3(this,T,!0),R=this._elements.map(T=>m7(T,S)),O=new at(R);return new ao(T.path,O)}isEqual(T){return T instanceof m9&&deepEqual(this._elements,T._elements)}}class m5 extends null{constructor(T,S){super(T),this._operand=S}_toFieldTransform(T){let S=new an(T.serializer,s2(T.serializer,this._operand));return new ao(T.path,S)}isEqual(T){return T instanceof m5&&this._operand===T._operand}}function m8(T,S,R,O=!1){let N=T.createContext(O?4:3,S),M=m7(R,N);return M}function m7(T,S){if(gs(T=(0,Q.m9)(T)))return ga("Unsupported field value:",S,T),ge(T,S);if(T instanceof mW)return gr(T,S),null;if(void 0===T&&S.ignoreUndefinedProperties)return null;if(S.path&&S.fieldMask.push(S.path),!(T instanceof Array))return gn(T,S);if(S.settings.arrayElement&&4!==S.dataSource)throw S.createError("Nested arrays are not supported");return gt(T,S)}function ge(T,S){let R={};return r3(T)?S.path&&S.path.length>0&&S.fieldMask.push(S.path):r2(T,(T,O)=>{let N=m7(O,S.childContextForField(T));null!=N&&(R[T]=N)}),{mapValue:{fields:R}}}function gt(T,S){let R=[],O=0;for(let N of T){let T=m7(N,S.childContextForArray(O));null==T&&(T={nullValue:"NULL_VALUE"}),R.push(T),O++}return{arrayValue:{values:R}}}function gr(T,S){if(!mX(S.dataSource))throw S.createError(`${T._methodName}() can only be used with update() and set()`);if(!S.path)throw S.createError(`${T._methodName}() is not currently supported inside arrays`);let R=T._toFieldTransform(S);R&&S.fieldTransforms.push(R)}function gn(T,S){if(null===(T=(0,Q.m9)(T)))return{nullValue:"NULL_VALUE"};if("number"==typeof T)return s2(S.serializer,T);if("boolean"==typeof T)return{booleanValue:T};if("string"==typeof T)return{stringValue:T};if(T instanceof Date){let R=e1.fromDate(T);return{timestampValue:or(S.serializer,R)}}if(T instanceof e1){let R=new e1(T.seconds,1e3*Math.floor(T.nanoseconds/1e3));return{timestampValue:or(S.serializer,R)}}if(T instanceof mK)return{geoPointValue:{latitude:T.latitude,longitude:T.longitude}};else if(T instanceof mH)return{bytesValue:oi(S.serializer,T._byteString)};else if(T instanceof mP){let R=S.databaseId,O=T.firestore._databaseId;if(!O.isEqual(R))throw S.createError(`Document reference is for database ${O.projectId}/${O.database} but should be for database ${R.projectId}/${R.database}`);return{referenceValue:ou(T.firestore._databaseId||S.databaseId,T._key.path)}}else if(T instanceof m$)return gi(T,S);else throw S.createError(`Unsupported field value: ${e$(T)}`)}function gi(T,S){let R={fields:{[nk]:{stringValue:nM},[nx]:{arrayValue:{values:T.toArray().map(T=>{if("number"!=typeof T)throw S.createError("VectorValues must only contain numeric values.");return s0(S.serializer,T)})}}}};return{mapValue:R}}function gs(T){return"object"==typeof T&&null!==T&&!(T instanceof Array)&&!(T instanceof Date)&&!(T instanceof e1)&&!(T instanceof mK)&&!(T instanceof mH)&&!(T instanceof mP)&&!(T instanceof mW)&&!(T instanceof m$)}function ga(T,S,R){if(!gs(R)||!eK(R)){let O=e$(R);if("an object"===O)throw S.createError(T+" a custom object");throw S.createError(T+" "+O)}}function go(T,S,R){if((S=getModularInstance(S))instanceof mG)return S._internalPath;if("string"==typeof S)return gu(T,S);{let S="Field path arguments must be of type string or ";throw gc(S,T,!1,void 0,R)}}let gl=RegExp("[~\\*/\\[\\]]");function gu(T,S,R){let O=S.search(gl);if(O>=0)throw gc(`Invalid field path (${S}). Paths must not contain '~', '*', '/', '[', or ']'`,T,!1,void 0,R);try{return new mG(...S.split("."))._internalPath}catch(O){throw gc(`Invalid field path (${S}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,T,!1,void 0,R)}}function gc(T,S,R,O,N){let M=O&&!O.isEmpty(),L=void 0!==N,U=`Function ${S}() called with invalid data`;R&&(U+=" (via `toFirestore()`)"),U+=". ";let V="";return(M||L)&&(V+=" (found",M&&(V+=` in field ${O}`),L&&(V+=` in document ${N}`),V+=")"),new eT(e_.INVALID_ARGUMENT,U+T+V)}function gd(T,S){return T.some(T=>T.isEqual(S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh{constructor(T,S,R,O,N){this._firestore=T,this._userDataWriter=S,this._key=R,this._document=O,this._converter=N}get id(){return this._key.path.lastSegment()}get ref(){return new mP(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value);{let T=new gf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(T)}}}get(T){if(this._document){let S=this._document.data.field(gp("DocumentSnapshot.get",T));if(null!==S)return this._userDataWriter.convertValue(S)}}}class gf extends gh{data(){return super.data()}}function gp(T,S){return"string"==typeof S?gu(T,S):S instanceof mG?S._internalPath:S._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gm(T){if("L"===T.limitType&&0===T.explicitOrderBy.length)throw new eT(e_.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class gg extends null{constructor(T,S,R){super(),this._field=T,this._op=S,this._value=R,this.type="where"}static _create(T,S,R){return new gg(T,S,R)}_apply(T){let S=this._parse(T);return gN(T._query,S),new mk(T.firestore,T.converter,sS(T._query,S))}_parse(T){let S=m1(T.firestore),R=gE(T._query,"where",S,T.firestore._databaseId,this._field,this._op,this._value);return R}}class gy extends null{constructor(T,S){super(),this.type=T,this._queryConstraints=S}static _create(T,S){return new gy(T,S)}_parse(T){let S=this._queryConstraints.map(S=>S._parse(T)).filter(T=>T.getFilters().length>0);return 1===S.length?S[0]:iU.create(S,this._getOperator())}_apply(T){let S=this._parse(T);return 0===S.getFilters().length?T:(gk(T._query,S),new mk(T.firestore,T.converter,sS(T._query,S)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class gv extends null{constructor(T,S){super(),this._field=T,this._direction=S,this.type="orderBy"}static _create(T,S){return new gv(T,S)}_apply(T){let S=gw(T._query,this._field,this._direction);return new mk(T.firestore,T.converter,sE(T._query,S))}}class gb extends null{constructor(T,S,R){super(),this.type=T,this._limit=S,this._limitType=R}static _create(T,S,R){return new gb(T,S,R)}_apply(T){return new mk(T.firestore,T.converter,sw(T._query,this._limit,this._limitType))}}class g_ extends null{constructor(T,S,R){super(),this.type=T,this._docOrFields=S,this._inclusive=R}static _create(T,S,R){return new g_(T,S,R)}_apply(T){let S=gS(T,this.type,this._docOrFields,this._inclusive);return new mk(T.firestore,T.converter,sC(T._query,S))}}class gT extends null{constructor(T,S,R){super(),this.type=T,this._docOrFields=S,this._inclusive=R}static _create(T,S,R){return new gT(T,S,R)}_apply(T){let S=gS(T,this.type,this._docOrFields,this._inclusive);return new mk(T.firestore,T.converter,sI(T._query,S))}}function gS(T,S,R,O){if(R[0]=getModularInstance(R[0]),R[0]instanceof gh)return gC(T._query,T.firestore._databaseId,S,R[0]._document,O);{let N=m1(T.firestore);return gI(T._query,T.firestore._databaseId,N,S,R,O)}}function gE(T,S,R,O,N,M,L){let U;if(N.isKeyField()){if("array-contains"===M||"array-contains-any"===M)throw new eT(e_.INVALID_ARGUMENT,`Invalid Query. You can't perform '${M}' queries on documentId().`);if("in"===M||"not-in"===M){gA(L,M);let S=[];for(let R of L)S.push(gR(O,T,R));U={arrayValue:{values:S}}}else U=gR(O,T,L)}else("in"===M||"not-in"===M||"array-contains-any"===M)&&gA(L,M),U=m8(R,S,L,"in"===M||"not-in"===M);let V=iF.create(N,M,U);return V}function gw(T,S,R){if(null!==T.startAt)throw new eT(e_.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==T.endAt)throw new eT(e_.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");let O=new iP(S,R);return O}function gC(T,S,R,O,N){if(!O)throw new eT(e_.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${R}().`);let M=[];for(let R of sv(T))if(R.field.isKeyField())M.push(is(S,O.key));else{let T=O.data.field(R.field);if(nb(T))throw new eT(e_.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+R.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null!==T)M.push(T);else{let T=R.field.canonicalString();throw new eT(e_.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${T}' (used as the orderBy) does not exist.`)}}return new iR(M,N)}function gI(T,S,R,O,N,M){let L=T.explicitOrderBy;if(N.length>L.length)throw new eT(e_.INVALID_ARGUMENT,`Too many arguments provided to ${O}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let U=[];for(let M=0;M<N.length;M++){let V=N[M],K=L[M];if(K.field.isKeyField()){if("string"!=typeof V)throw new eT(e_.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${O}(), but got a ${typeof V}`);if(!sy(T)&&-1!==V.indexOf("/"))throw new eT(e_.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${O}() must be a plain document ID, but '${V}' contains a slash.`);let R=T.path.child(ez.fromString(V));if(!eG.isDocumentKey(R))throw new eT(e_.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${O}() must result in a valid document path, but '${R}' is not because it contains an odd number of segments.`);let N=new eG(R);U.push(is(S,N))}else{let T=m8(R,O,V);U.push(T)}}return new iR(U,M)}function gR(T,S,R){if("string"==typeof(R=getModularInstance(R))){if(""===R)throw new eT(e_.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!sy(S)&&-1!==R.indexOf("/"))throw new eT(e_.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${R}' contains a '/' character.`);let O=S.path.child(ez.fromString(R));if(!eG.isDocumentKey(O))throw new eT(e_.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${O}' is not because it has an odd number of segments (${O.length}).`);return is(T,new eG(O))}if(R instanceof mP)return is(T,R._key);throw new eT(e_.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${e$(R)}.`)}function gA(T,S){if(!Array.isArray(T)||0===T.length)throw new eT(e_.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${S.toString()}' filters.`)}function gO(T){switch(T){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}function gN(T,S){let R=gP(T.filters,gO(S.op));if(null!==R){if(R===S.op)throw new eT(e_.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${S.op.toString()}' filter.`);throw new eT(e_.INVALID_ARGUMENT,`Invalid query. You cannot use '${S.op.toString()}' filters with '${R.toString()}' filters.`)}}function gk(T,S){let R=T,O=S.getFlattenedFilters();for(let T of O)gN(R,T),R=sS(R,T)}function gP(T,S){for(let R of T)for(let T of R.getFlattenedFilters())if(S.indexOf(T.op)>=0)return T.op;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gD(T){return gM(T,["next","error","complete"])}function gM(T,S){if("object"!=typeof T||null===T)return!1;let R=T;for(let T of S)if(T in R&&"function"==typeof R[T])return!0;return!1}let gx=aV();function gL(T){let S=JSON.stringify(T),R=gx.encode(S).byteLength;return`${R}${S}`}let gF={metadata:{id:"test-bundle",createTime:{seconds:1577836805,nanos:6},version:1,totalDocuments:1,totalBytes:416}};gL(gF);let gU={documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/doc1",readTime:{seconds:5,nanos:6},exists:!0}};gL(gU);let gj={document:{name:"projects/test-project/databases/(default)/documents/collectionId/doc1",createTime:{seconds:1,nanos:2e6},updateTime:{seconds:3,nanos:4e3},fields:{foo:{stringValue:"value"},bar:{integerValue:-42}}}};gL(gj);let gB={documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/doc2",readTime:{seconds:5,nanos:6},exists:!0}};gL(gB);let gV={document:{name:"projects/test-project/databases/(default)/documents/collectionId/doc2",createTime:{seconds:1,nanos:2e6},updateTime:{seconds:3,nanos:4e3},fields:{foo:{stringValue:"value1"},bar:{integerValue:42},emptyArray:{arrayValue:{}},emptyMap:{mapValue:{}}}}};gL(gV);let gz={documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/nodoc",readTime:{seconds:5,nanos:6},exists:!1}};gL(gz);let gq={namedQuery:{name:"limitQuery",bundledQuery:{parent:"projects/fireeats-97d5e/databases/(default)/documents",structuredQuery:{from:[{collectionId:"node_3.7.5_7Li7XoCjutvNxwD0tpo9"}],orderBy:[{field:{fieldPath:"sort"},direction:"DESCENDING"}],limit:{value:1}},limitType:"FIRST"},readTime:{seconds:1590011379,nanos:191164e3}}};gL(gq);let gH={namedQuery:{name:"limitToLastQuery",bundledQuery:{parent:"projects/fireeats-97d5e/databases/(default)/documents",structuredQuery:{from:[{collectionId:"node_3.7.5_7Li7XoCjutvNxwD0tpo9"}],orderBy:[{field:{fieldPath:"sort"},direction:"ASCENDING"}],limit:{value:1}},limitType:"LAST"},readTime:{seconds:1590011379,nanos:543063e3}}};gL(gH);/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gG=1;class gW{constructor(T,S){this.firestore=T,this.bundleId=S,this.documents=new Map,this.namedQueries=new Map,this.latestReadTime=new e1(0,0),this.databaseId=T._databaseId,this.serializer=new a8(this.databaseId,!0),this.userDataReader=new m0(this.databaseId,!0,this.serializer)}addBundleDocument(T,S){let R=this.documents.get(T.documentPath),O=R?.metadata.queries,N=T.readTime,M=R?.metadata.readTime?on(R.metadata.readTime):null,L=!N&&null==M,U=void 0!==N&&(null==M||M<N);if((L||U)&&this.documents.set(T.documentPath,{document:this.toBundleDocument(T),metadata:{name:oh(this.serializer,T.documentKey),readTime:N?or(this.serializer,N):void 0,exists:T.documentExists}}),N&&N>this.latestReadTime&&(this.latestReadTime=N),S){let R=this.documents.get(T.documentPath);R.metadata.queries=O||[],R.metadata.queries.push(S)}}addBundleQuery(T){if(this.namedQueries.has(T.name))throw Error(`Query name conflict: ${name} has already been added.`);let S=new e1(0,0);for(let R of T.docBundleDataArray)this.addBundleDocument(R,T.name),R.readTime&&R.readTime>S&&(S=R.readTime);let R=oj(this.serializer,sb(T.query)),O={parent:T.parent,structuredQuery:R.queryTarget.structuredQuery};this.namedQueries.set(T.name,{name:T.name,bundledQuery:O,readTime:or(this.serializer,S)})}toBundleDocument(T){let S=this.userDataReader.createContext(4,"internal toBundledDocument"),R=ge(T.documentData,S);return{name:oh(this.serializer,T.documentKey),fields:R.mapValue.fields,updateTime:or(this.serializer,T.versionTime),createTime:or(this.serializer,T.createdTime)}}lengthPrefixedString(T){let S=JSON.stringify(T),R=gx.encode(S).byteLength;return`${R}${S}`}build(){let T="";for(let S of this.namedQueries.values())T+=this.lengthPrefixedString({namedQuery:S});for(let S of this.documents.values()){let R=S.metadata;T+=this.lengthPrefixedString({documentMetadata:R});let O=S.document;O&&(T+=this.lengthPrefixedString({document:O}))}let S={id:this.bundleId,createTime:or(this.serializer,this.latestReadTime),version:gG,totalDocuments:this.documents.size,totalBytes:gx.encode(T).length};return this.lengthPrefixedString({metadata:S})+T}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gK(T,S,R,O){let N=new gW(T,eP.newId());return N.addBundleDocument(gQ(O,R,S)),N.build()}function g$(T,S,R,O,N,M,L){let U=[];for(let T=0;T<M.length;T++)U.push(gQ(N[T],L[T],M[T]));let V={name:R,query:S,parent:O,docBundleDataArray:U},K=new gW(T,R);return K.addBundleQuery(V),K.build()}function gQ(T,S,R){return{documentData:S,documentKey:R.mutableCopy().key,documentPath:T,documentExists:!0,createdTime:R.createTime.toTimestamp(),readTime:R.readTime.toTimestamp(),versionTime:R.version.toTimestamp()}}class gY{constructor(T,S){this.hasPendingWrites=T,this.fromCache=S}isEqual(T){return this.hasPendingWrites===T.hasPendingWrites&&this.fromCache===T.fromCache}}class gJ extends gh{constructor(T,S,R,O,N,M){super(T,S,R,O,M),this._firestore=T,this._firestoreImpl=T,this.metadata=N}exists(){return super.exists()}data(T={}){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value,T.serverTimestamps);{let S=new gX(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(S,T)}}}get(T,S={}){if(this._document){let R=this._document.data.field(gp("DocumentSnapshot.get",T));if(null!==R)return this._userDataWriter.convertValue(R,S.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new eT(e_.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let T=this._document,S={};if(S.type=gJ._jsonSchemaVersion,S.bundle="",S.bundleSource="DocumentSnapshot",S.bundleName=this._key.toString(),!T||!T.isValidDocument()||!T.isFoundDocument())return S;let R=this._userDataWriter.convertObjectMap(T.data.value.mapValue.fields,"previous");return S.bundle=gK(this._firestore,T,R,this.ref.path),S}}gJ._jsonSchemaVersion="firestore/documentSnapshot/1.0",gJ._jsonSchema={type:eJ("string",gJ._jsonSchemaVersion),bundleSource:eJ("string","DocumentSnapshot"),bundleName:eJ("string"),bundle:eJ("string")};class gX extends gJ{data(T={}){return super.data(T)}}class gZ{constructor(T,S,R,O){this._firestore=T,this._userDataWriter=S,this._snapshot=O,this.metadata=new gY(O.hasPendingWrites,O.fromCache),this.query=R}get docs(){let T=[];return this.forEach(S=>T.push(S)),T}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(T,S){this._snapshot.docs.forEach(R=>{T.call(S,new gX(this._firestore,this._userDataWriter,R.key,R,new gY(this._snapshot.mutatedKeys.has(R.key),this._snapshot.fromCache),this.query.converter))})}docChanges(T={}){let S=!!T.includeMetadataChanges;if(S&&this._snapshot.excludesMetadataChanges)throw new eT(e_.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===S||(this._cachedChanges=g0(this,S),this._cachedChangesIncludeMetadataChanges=S),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new eT(e_.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let T={};T.type=gZ._jsonSchemaVersion,T.bundleSource="QuerySnapshot",T.bundleName=eP.newId();let S=this._firestore._databaseId.database,R=this._firestore._databaseId.projectId,O=`projects/${R}/databases/${S}/documents`,N=[],M=[],L=[];return this.docs.forEach(T=>{null!==T._document&&(N.push(T._document),M.push(this._userDataWriter.convertObjectMap(T._document.data.value.mapValue.fields,"previous")),L.push(T.ref.path))}),T.bundle=g$(this._firestore,this.query._query,T.bundleName,O,L,N,M),T}}function g0(T,S){if(T._snapshot.oldDocs.isEmpty()){let S=0;return T._snapshot.docChanges.map(R=>{let O=new gX(T._firestore,T._userDataWriter,R.doc.key,R.doc,new gY(T._snapshot.mutatedKeys.has(R.doc.key),T._snapshot.fromCache),T.query.converter);return R.doc,{type:"added",doc:O,oldIndex:-1,newIndex:S++}})}{let R=T._snapshot.oldDocs;return T._snapshot.docChanges.filter(T=>S||3!==T.type).map(S=>{let O=new gX(T._firestore,T._userDataWriter,S.doc.key,S.doc,new gY(T._snapshot.mutatedKeys.has(S.doc.key),T._snapshot.fromCache),T.query.converter),N=-1,M=-1;return 0!==S.type&&(N=R.indexOf(S.doc.key),R=R.delete(S.doc.key)),1!==S.type&&(M=(R=R.add(S.doc)).indexOf(S.doc.key)),{type:g1(S.type),doc:O,oldIndex:N,newIndex:M}})}}function g1(T){switch(T){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return eg(61501,{type:T})}}gZ._jsonSchemaVersion="firestore/querySnapshot/1.0",gZ._jsonSchema={type:eJ("string",gZ._jsonSchemaVersion),bundleSource:eJ("string","QuerySnapshot"),bundleName:eJ("string"),bundle:eJ("string")};class g2 extends null{constructor(T){super(),this.firestore=T}convertBytes(T){return new mH(T)}convertReference(T){let S=this.convertDocumentKey(T,this.firestore._databaseId);return new mP(this.firestore,null,S)}}function g3(T,S,R){let O=R.docs.get(S._key),N=new g2(T);return new gJ(T,N,S._key,O,new gY(R.hasPendingWrites,R.fromCache),S.converter)}class g4{constructor(T){this.forceOwnership=T,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(T){this._onlineComponentProvider=pQ.provider,this._offlineComponentProvider={build:S=>new p$(S,T?.cacheSizeBytes,this.forceOwnership)}}}new WeakMap,/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mz("node")},2643:(T,S,R)=>{"use strict";let O,N;R.r(S),R.d(S,{deleteDB:()=>eo,openDB:()=>ea,unwrap:()=>es,wrap:()=>ei});let M=(T,S)=>S.some(S=>T instanceof S);function L(){return O||(O=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function U(){return N||(N=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}let V=new WeakMap,K=new WeakMap,$=new WeakMap,Q=new WeakMap,Y=new WeakMap;function X(T){let S=new Promise((S,R)=>{let O=()=>{T.removeEventListener("success",N),T.removeEventListener("error",M)},N=()=>{S(ei(T.result)),O()},M=()=>{R(T.error),O()};T.addEventListener("success",N),T.addEventListener("error",M)});return S.then(S=>{S instanceof IDBCursor&&V.set(S,T)}).catch(()=>{}),Y.set(S,T),S}function Z(T){if(K.has(T))return;let S=new Promise((S,R)=>{let O=()=>{T.removeEventListener("complete",N),T.removeEventListener("error",M),T.removeEventListener("abort",M)},N=()=>{S(),O()},M=()=>{R(T.error||new DOMException("AbortError","AbortError")),O()};T.addEventListener("complete",N),T.addEventListener("error",M),T.addEventListener("abort",M)});K.set(T,S)}let ee={get(T,S,R){if(T instanceof IDBTransaction){if("done"===S)return K.get(T);if("objectStoreNames"===S)return T.objectStoreNames||$.get(T);if("store"===S)return R.objectStoreNames[1]?void 0:R.objectStore(R.objectStoreNames[0])}return ei(T[S])},set:(T,S,R)=>(T[S]=R,!0),has:(T,S)=>T instanceof IDBTransaction&&("done"===S||"store"===S)||S in T};function et(T){ee=T(ee)}function er(T){return T!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?U().includes(T)?function(...S){return T.apply(es(this),S),ei(V.get(this))}:function(...S){return ei(T.apply(es(this),S))}:function(S,...R){let O=T.call(es(this),S,...R);return $.set(O,S.sort?S.sort():[S]),ei(O)}}function en(T){return"function"==typeof T?er(T):(T instanceof IDBTransaction&&Z(T),M(T,L()))?new Proxy(T,ee):T}function ei(T){if(T instanceof IDBRequest)return X(T);if(Q.has(T))return Q.get(T);let S=en(T);return S!==T&&(Q.set(T,S),Y.set(S,T)),S}let es=T=>Y.get(T);function ea(T,S,{blocked:R,upgrade:O,blocking:N,terminated:M}={}){let L=indexedDB.open(T,S),U=ei(L);return O&&L.addEventListener("upgradeneeded",T=>{O(ei(L.result),T.oldVersion,T.newVersion,ei(L.transaction),T)}),R&&L.addEventListener("blocked",T=>R(T.oldVersion,T.newVersion,T)),U.then(T=>{M&&T.addEventListener("close",()=>M()),N&&T.addEventListener("versionchange",T=>N(T.oldVersion,T.newVersion,T))}).catch(()=>{}),U}function eo(T,{blocked:S}={}){let R=indexedDB.deleteDatabase(T);return S&&R.addEventListener("blocked",T=>S(T.oldVersion,T)),ei(R).then(()=>void 0)}let eu=["get","getKey","getAll","getAllKeys","count"],ec=["put","add","delete","clear"],ed=new Map;function eh(T,S){if(!(T instanceof IDBDatabase&&!(S in T)&&"string"==typeof S))return;if(ed.get(S))return ed.get(S);let R=S.replace(/FromIndex$/,""),O=S!==R,N=ec.includes(R);if(!(R in(O?IDBIndex:IDBObjectStore).prototype)||!(N||eu.includes(R)))return;let M=async function(T,...S){let M=this.transaction(T,N?"readwrite":"readonly"),L=M.store;return O&&(L=L.index(S.shift())),(await Promise.all([L[R](...S),N&&M.done]))[0]};return ed.set(S,M),M}et(T=>({...T,get:(S,R,O)=>eh(S,R)||T.get(S,R,O),has:(S,R)=>!!eh(S,R)||T.has(S,R)}))},1513:T=>{"use strict";T.exports={i8:"1.9.15"}},6541:T=>{"use strict";T.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Api":{"fields":{"name":{"type":"string","id":1},"methods":{"rule":"repeated","type":"Method","id":2},"options":{"rule":"repeated","type":"Option","id":3},"version":{"type":"string","id":4},"sourceContext":{"type":"SourceContext","id":5},"mixins":{"rule":"repeated","type":"Mixin","id":6},"syntax":{"type":"Syntax","id":7}}},"Method":{"fields":{"name":{"type":"string","id":1},"requestTypeUrl":{"type":"string","id":2},"requestStreaming":{"type":"bool","id":3},"responseTypeUrl":{"type":"string","id":4},"responseStreaming":{"type":"bool","id":5},"options":{"rule":"repeated","type":"Option","id":6},"syntax":{"type":"Syntax","id":7}}},"Mixin":{"fields":{"name":{"type":"string","id":1},"root":{"type":"string","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}}}}}}}}')},9987:T=>{"use strict";T.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"options":{"go_package":"google.golang.org/protobuf/types/descriptorpb","java_package":"com.google.protobuf","java_outer_classname":"DescriptorProtos","csharp_namespace":"Google.Protobuf.Reflection","objc_class_prefix":"GPB","cc_enable_arenas":true,"optimize_for":"SPEED"},"nested":{"FileDescriptorSet":{"edition":"proto2","fields":{"file":{"rule":"repeated","type":"FileDescriptorProto","id":1}},"extensions":[[536000000,536000000]]},"Edition":{"edition":"proto2","values":{"EDITION_UNKNOWN":0,"EDITION_LEGACY":900,"EDITION_PROTO2":998,"EDITION_PROTO3":999,"EDITION_2023":1000,"EDITION_2024":1001,"EDITION_1_TEST_ONLY":1,"EDITION_2_TEST_ONLY":2,"EDITION_99997_TEST_ONLY":99997,"EDITION_99998_TEST_ONLY":99998,"EDITION_99999_TEST_ONLY":99999,"EDITION_MAX":2147483647}},"FileDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"package":{"type":"string","id":2},"dependency":{"rule":"repeated","type":"string","id":3},"publicDependency":{"rule":"repeated","type":"int32","id":10},"weakDependency":{"rule":"repeated","type":"int32","id":11},"optionDependency":{"rule":"repeated","type":"string","id":15},"messageType":{"rule":"repeated","type":"DescriptorProto","id":4},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":5},"service":{"rule":"repeated","type":"ServiceDescriptorProto","id":6},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":7},"options":{"type":"FileOptions","id":8},"sourceCodeInfo":{"type":"SourceCodeInfo","id":9},"syntax":{"type":"string","id":12},"edition":{"type":"Edition","id":14}}},"DescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"field":{"rule":"repeated","type":"FieldDescriptorProto","id":2},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":6},"nestedType":{"rule":"repeated","type":"DescriptorProto","id":3},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":4},"extensionRange":{"rule":"repeated","type":"ExtensionRange","id":5},"oneofDecl":{"rule":"repeated","type":"OneofDescriptorProto","id":8},"options":{"type":"MessageOptions","id":7},"reservedRange":{"rule":"repeated","type":"ReservedRange","id":9},"reservedName":{"rule":"repeated","type":"string","id":10},"visibility":{"type":"SymbolVisibility","id":11}},"nested":{"ExtensionRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2},"options":{"type":"ExtensionRangeOptions","id":3}}},"ReservedRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}}}},"ExtensionRangeOptions":{"edition":"proto2","fields":{"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999},"declaration":{"rule":"repeated","type":"Declaration","id":2,"options":{"retention":"RETENTION_SOURCE"}},"features":{"type":"FeatureSet","id":50},"verification":{"type":"VerificationState","id":3,"options":{"default":"UNVERIFIED","retention":"RETENTION_SOURCE"}}},"extensions":[[1000,536870911]],"nested":{"Declaration":{"fields":{"number":{"type":"int32","id":1},"fullName":{"type":"string","id":2},"type":{"type":"string","id":3},"reserved":{"type":"bool","id":5},"repeated":{"type":"bool","id":6}},"reserved":[[4,4]]},"VerificationState":{"values":{"DECLARATION":0,"UNVERIFIED":1}}}},"FieldDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":3},"label":{"type":"Label","id":4},"type":{"type":"Type","id":5},"typeName":{"type":"string","id":6},"extendee":{"type":"string","id":2},"defaultValue":{"type":"string","id":7},"oneofIndex":{"type":"int32","id":9},"jsonName":{"type":"string","id":10},"options":{"type":"FieldOptions","id":8},"proto3Optional":{"type":"bool","id":17}},"nested":{"Type":{"values":{"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Label":{"values":{"LABEL_OPTIONAL":1,"LABEL_REPEATED":3,"LABEL_REQUIRED":2}}}},"OneofDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"options":{"type":"OneofOptions","id":2}}},"EnumDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"value":{"rule":"repeated","type":"EnumValueDescriptorProto","id":2},"options":{"type":"EnumOptions","id":3},"reservedRange":{"rule":"repeated","type":"EnumReservedRange","id":4},"reservedName":{"rule":"repeated","type":"string","id":5},"visibility":{"type":"SymbolVisibility","id":6}},"nested":{"EnumReservedRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}}}},"EnumValueDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"type":"EnumValueOptions","id":3}}},"ServiceDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"method":{"rule":"repeated","type":"MethodDescriptorProto","id":2},"options":{"type":"ServiceOptions","id":3}}},"MethodDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"inputType":{"type":"string","id":2},"outputType":{"type":"string","id":3},"options":{"type":"MethodOptions","id":4},"clientStreaming":{"type":"bool","id":5},"serverStreaming":{"type":"bool","id":6}}},"FileOptions":{"edition":"proto2","fields":{"javaPackage":{"type":"string","id":1},"javaOuterClassname":{"type":"string","id":8},"javaMultipleFiles":{"type":"bool","id":10},"javaGenerateEqualsAndHash":{"type":"bool","id":20,"options":{"deprecated":true}},"javaStringCheckUtf8":{"type":"bool","id":27},"optimizeFor":{"type":"OptimizeMode","id":9,"options":{"default":"SPEED"}},"goPackage":{"type":"string","id":11},"ccGenericServices":{"type":"bool","id":16},"javaGenericServices":{"type":"bool","id":17},"pyGenericServices":{"type":"bool","id":18},"deprecated":{"type":"bool","id":23},"ccEnableArenas":{"type":"bool","id":31,"options":{"default":true}},"objcClassPrefix":{"type":"string","id":36},"csharpNamespace":{"type":"string","id":37},"swiftPrefix":{"type":"string","id":39},"phpClassPrefix":{"type":"string","id":40},"phpNamespace":{"type":"string","id":41},"phpMetadataNamespace":{"type":"string","id":44},"rubyPackage":{"type":"string","id":45},"features":{"type":"FeatureSet","id":50},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[42,42],"php_generic_services",[38,38]],"nested":{"OptimizeMode":{"values":{"SPEED":1,"CODE_SIZE":2,"LITE_RUNTIME":3}}}},"MessageOptions":{"edition":"proto2","fields":{"messageSetWireFormat":{"type":"bool","id":1},"noStandardDescriptorAccessor":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"mapEntry":{"type":"bool","id":7},"deprecatedLegacyJsonFieldConflicts":{"type":"bool","id":11,"options":{"deprecated":true}},"features":{"type":"FeatureSet","id":12},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[4,4],[5,5],[6,6],[8,8],[9,9]]},"FieldOptions":{"edition":"proto2","fields":{"ctype":{"type":"CType","id":1,"options":{"default":"STRING"}},"packed":{"type":"bool","id":2},"jstype":{"type":"JSType","id":6,"options":{"default":"JS_NORMAL"}},"lazy":{"type":"bool","id":5},"unverifiedLazy":{"type":"bool","id":15},"deprecated":{"type":"bool","id":3},"weak":{"type":"bool","id":10,"options":{"deprecated":true}},"debugRedact":{"type":"bool","id":16},"retention":{"type":"OptionRetention","id":17},"targets":{"rule":"repeated","type":"OptionTargetType","id":19},"editionDefaults":{"rule":"repeated","type":"EditionDefault","id":20},"features":{"type":"FeatureSet","id":21},"featureSupport":{"type":"FeatureSupport","id":22},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[4,4],[18,18]],"nested":{"CType":{"values":{"STRING":0,"CORD":1,"STRING_PIECE":2}},"JSType":{"values":{"JS_NORMAL":0,"JS_STRING":1,"JS_NUMBER":2}},"OptionRetention":{"values":{"RETENTION_UNKNOWN":0,"RETENTION_RUNTIME":1,"RETENTION_SOURCE":2}},"OptionTargetType":{"values":{"TARGET_TYPE_UNKNOWN":0,"TARGET_TYPE_FILE":1,"TARGET_TYPE_EXTENSION_RANGE":2,"TARGET_TYPE_MESSAGE":3,"TARGET_TYPE_FIELD":4,"TARGET_TYPE_ONEOF":5,"TARGET_TYPE_ENUM":6,"TARGET_TYPE_ENUM_ENTRY":7,"TARGET_TYPE_SERVICE":8,"TARGET_TYPE_METHOD":9}},"EditionDefault":{"fields":{"edition":{"type":"Edition","id":3},"value":{"type":"string","id":2}}},"FeatureSupport":{"fields":{"editionIntroduced":{"type":"Edition","id":1},"editionDeprecated":{"type":"Edition","id":2},"deprecationWarning":{"type":"string","id":3},"editionRemoved":{"type":"Edition","id":4}}}}},"OneofOptions":{"edition":"proto2","fields":{"features":{"type":"FeatureSet","id":1},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"EnumOptions":{"edition":"proto2","fields":{"allowAlias":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"deprecatedLegacyJsonFieldConflicts":{"type":"bool","id":6,"options":{"deprecated":true}},"features":{"type":"FeatureSet","id":7},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[5,5]]},"EnumValueOptions":{"edition":"proto2","fields":{"deprecated":{"type":"bool","id":1},"features":{"type":"FeatureSet","id":2},"debugRedact":{"type":"bool","id":3},"featureSupport":{"type":"FieldOptions.FeatureSupport","id":4},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"ServiceOptions":{"edition":"proto2","fields":{"features":{"type":"FeatureSet","id":34},"deprecated":{"type":"bool","id":33},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"MethodOptions":{"edition":"proto2","fields":{"deprecated":{"type":"bool","id":33},"idempotencyLevel":{"type":"IdempotencyLevel","id":34,"options":{"default":"IDEMPOTENCY_UNKNOWN"}},"features":{"type":"FeatureSet","id":35},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"nested":{"IdempotencyLevel":{"values":{"IDEMPOTENCY_UNKNOWN":0,"NO_SIDE_EFFECTS":1,"IDEMPOTENT":2}}}},"UninterpretedOption":{"edition":"proto2","fields":{"name":{"rule":"repeated","type":"NamePart","id":2},"identifierValue":{"type":"string","id":3},"positiveIntValue":{"type":"uint64","id":4},"negativeIntValue":{"type":"int64","id":5},"doubleValue":{"type":"double","id":6},"stringValue":{"type":"bytes","id":7},"aggregateValue":{"type":"string","id":8}},"nested":{"NamePart":{"fields":{"namePart":{"rule":"required","type":"string","id":1},"isExtension":{"rule":"required","type":"bool","id":2}}}}},"FeatureSet":{"edition":"proto2","fields":{"fieldPresence":{"type":"FieldPresence","id":1,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_2023","edition_defaults.value":"EXPLICIT"}},"enumType":{"type":"EnumType","id":2,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"OPEN"}},"repeatedFieldEncoding":{"type":"RepeatedFieldEncoding","id":3,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"PACKED"}},"utf8Validation":{"type":"Utf8Validation","id":4,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"VERIFY"}},"messageEncoding":{"type":"MessageEncoding","id":5,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_LEGACY","edition_defaults.value":"LENGTH_PREFIXED"}},"jsonFormat":{"type":"JsonFormat","id":6,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"ALLOW"}},"enforceNamingStyle":{"type":"EnforceNamingStyle","id":7,"options":{"retention":"RETENTION_SOURCE","targets":"TARGET_TYPE_METHOD","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"STYLE2024"}},"defaultSymbolVisibility":{"type":"VisibilityFeature.DefaultSymbolVisibility","id":8,"options":{"retention":"RETENTION_SOURCE","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"EXPORT_TOP_LEVEL"}}},"extensions":[[1000,9994],[9995,9999],[10000,10000]],"reserved":[[999,999]],"nested":{"FieldPresence":{"values":{"FIELD_PRESENCE_UNKNOWN":0,"EXPLICIT":1,"IMPLICIT":2,"LEGACY_REQUIRED":3}},"EnumType":{"values":{"ENUM_TYPE_UNKNOWN":0,"OPEN":1,"CLOSED":2}},"RepeatedFieldEncoding":{"values":{"REPEATED_FIELD_ENCODING_UNKNOWN":0,"PACKED":1,"EXPANDED":2}},"Utf8Validation":{"values":{"UTF8_VALIDATION_UNKNOWN":0,"VERIFY":2,"NONE":3}},"MessageEncoding":{"values":{"MESSAGE_ENCODING_UNKNOWN":0,"LENGTH_PREFIXED":1,"DELIMITED":2}},"JsonFormat":{"values":{"JSON_FORMAT_UNKNOWN":0,"ALLOW":1,"LEGACY_BEST_EFFORT":2}},"EnforceNamingStyle":{"values":{"ENFORCE_NAMING_STYLE_UNKNOWN":0,"STYLE2024":1,"STYLE_LEGACY":2}},"VisibilityFeature":{"fields":{},"reserved":[[1,536870911]],"nested":{"DefaultSymbolVisibility":{"values":{"DEFAULT_SYMBOL_VISIBILITY_UNKNOWN":0,"EXPORT_ALL":1,"EXPORT_TOP_LEVEL":2,"LOCAL_ALL":3,"STRICT":4}}}}}},"FeatureSetDefaults":{"edition":"proto2","fields":{"defaults":{"rule":"repeated","type":"FeatureSetEditionDefault","id":1},"minimumEdition":{"type":"Edition","id":4},"maximumEdition":{"type":"Edition","id":5}},"nested":{"FeatureSetEditionDefault":{"fields":{"edition":{"type":"Edition","id":3},"overridableFeatures":{"type":"FeatureSet","id":4},"fixedFeatures":{"type":"FeatureSet","id":5}},"reserved":[[1,1],[2,2],"features"]}}},"SourceCodeInfo":{"edition":"proto2","fields":{"location":{"rule":"repeated","type":"Location","id":1}},"extensions":[[536000000,536000000]],"nested":{"Location":{"fields":{"path":{"rule":"repeated","type":"int32","id":1,"options":{"packed":true}},"span":{"rule":"repeated","type":"int32","id":2,"options":{"packed":true}},"leadingComments":{"type":"string","id":3},"trailingComments":{"type":"string","id":4},"leadingDetachedComments":{"rule":"repeated","type":"string","id":6}}}}},"GeneratedCodeInfo":{"edition":"proto2","fields":{"annotation":{"rule":"repeated","type":"Annotation","id":1}},"nested":{"Annotation":{"fields":{"path":{"rule":"repeated","type":"int32","id":1,"options":{"packed":true}},"sourceFile":{"type":"string","id":2},"begin":{"type":"int32","id":3},"end":{"type":"int32","id":4},"semantic":{"type":"Semantic","id":5}},"nested":{"Semantic":{"values":{"NONE":0,"SET":1,"ALIAS":2}}}}}},"SymbolVisibility":{"edition":"proto2","values":{"VISIBILITY_UNSET":0,"VISIBILITY_LOCAL":1,"VISIBILITY_EXPORT":2}}}}}}}}')},7674:T=>{"use strict";T.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')},3795:T=>{"use strict";T.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Type":{"fields":{"name":{"type":"string","id":1},"fields":{"rule":"repeated","type":"Field","id":2},"oneofs":{"rule":"repeated","type":"string","id":3},"options":{"rule":"repeated","type":"Option","id":4},"sourceContext":{"type":"SourceContext","id":5},"syntax":{"type":"Syntax","id":6}}},"Field":{"fields":{"kind":{"type":"Kind","id":1},"cardinality":{"type":"Cardinality","id":2},"number":{"type":"int32","id":3},"name":{"type":"string","id":4},"typeUrl":{"type":"string","id":6},"oneofIndex":{"type":"int32","id":7},"packed":{"type":"bool","id":8},"options":{"rule":"repeated","type":"Option","id":9},"jsonName":{"type":"string","id":10},"defaultValue":{"type":"string","id":11}},"nested":{"Kind":{"values":{"TYPE_UNKNOWN":0,"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Cardinality":{"values":{"CARDINALITY_UNKNOWN":0,"CARDINALITY_OPTIONAL":1,"CARDINALITY_REQUIRED":2,"CARDINALITY_REPEATED":3}}}},"Enum":{"fields":{"name":{"type":"string","id":1},"enumvalue":{"rule":"repeated","type":"EnumValue","id":2},"options":{"rule":"repeated","type":"Option","id":3},"sourceContext":{"type":"SourceContext","id":4},"syntax":{"type":"Syntax","id":5}}},"EnumValue":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"rule":"repeated","type":"Option","id":3}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}},"Any":{"fields":{"type_url":{"type":"string","id":1},"value":{"type":"bytes","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')}};